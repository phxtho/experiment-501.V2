/*! For license information please see 2.9ff7904e.chunk.js.LICENSE.txt */
(this.webpackJsonp501v2=this.webpackJsonp501v2||[]).push([[2],[function(t,e,n){"use strict";n.d(e,"e",(function(){return h})),n.d(e,"f",(function(){return p})),n.d(e,"i",(function(){return v})),n.d(e,"m",(function(){return y})),n.d(e,"k",(function(){return m})),n.d(e,"l",(function(){return g})),n.d(e,"h",(function(){return b})),n.d(e,"j",(function(){return w})),n.d(e,"n",(function(){return k})),n.d(e,"g",(function(){return O})),n.d(e,"b",(function(){return C})),n.d(e,"d",(function(){return _})),n.d(e,"a",(function(){return T})),n.d(e,"c",(function(){return N}));var r=n(5),o=n(11),i=n(10),s=n(3),a=n(31),c=n(9),u=n(7),l=(Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,u.h,Number.isInteger||function(t){return"number"===typeof t&&isFinite(t)&&c.c(t)===t}),f=(Number.isNaN,function t(){Object(s.a)(this,t),this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}),h=function(){return new f},p=function(t){for(var e=new Uint8Array(function(t){for(var e=t.cpos,n=0;n<t.bufs.length;n++)e+=t.bufs[n].length;return e}(t)),n=0,r=0;r<t.bufs.length;r++){var o=t.bufs[r];e.set(o,n),n+=o.length}return e.set(a.c(t.cbuf.buffer,0,t.cpos),n),e},d=function(t,e){var n=t.cbuf.length;t.cpos===n&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(2*n),t.cpos=0),t.cbuf[t.cpos++]=e},v=d,y=function(t,e){for(;e>u.k;)d(t,u.g|u.k&e),e>>>=7;d(t,u.k&e)},m=function(t,e){var n=c.d(e);for(n&&(e=-e),d(t,(e>u.j?u.g:0)|(n?u.f:0)|u.j&e),e>>>=6;e>0;)d(t,(e>u.k?u.g:0)|u.k&e),e>>>=7},g=function(t,e){var n=unescape(encodeURIComponent(e)),r=n.length;y(t,r);for(var o=0;o<r;o++)d(t,n.codePointAt(o))},b=function(t,e){return w(t,p(e))},w=function(t,e){var n=t.cbuf.length,r=t.cpos,o=c.g(n-r,e.length),i=e.length-o;t.cbuf.set(e.subarray(0,o),r),t.cpos+=o,i>0&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(c.f(2*n,i)),t.cbuf.set(e.subarray(o)),t.cpos=i)},k=function(t,e){y(t,e.byteLength),w(t,e)},x=function(t,e){!function(t,e){var n=t.cbuf.length;n-t.cpos<e&&(t.bufs.push(a.c(t.cbuf.buffer,0,t.cpos)),t.cbuf=new Uint8Array(2*c.f(n,e)),t.cpos=0)}(t,e);var n=new DataView(t.cbuf.buffer,t.cpos,e);return t.cpos+=e,n},S=new DataView(new ArrayBuffer(4)),O=function t(e,n){switch(typeof n){case"string":d(e,119),g(e,n);break;case"number":l(n)&&n<=u.h?(d(e,125),m(e,n)):(a=n,S.setFloat32(0,a),S.getFloat32(0)===a?(d(e,124),function(t,e){x(t,4).setFloat32(0,e)}(e,n)):(d(e,123),function(t,e){x(t,8).setFloat64(0,e)}(e,n)));break;case"bigint":d(e,122),function(t,e){x(t,8).setBigInt64(0,e)}(e,n);break;case"object":if(null===n)d(e,126);else if(n instanceof Array){d(e,117),y(e,n.length);for(var r=0;r<n.length;r++)t(e,n[r])}else if(n instanceof Uint8Array)d(e,116),k(e,n);else{d(e,118);var o=Object.keys(n);y(e,o.length);for(var i=0;i<o.length;i++){var s=o[i];g(e,s),t(e,n[s])}}break;case"boolean":d(e,n?120:121);break;default:d(e,127)}var a},C=function(t){Object(o.a)(n,t);var e=Object(i.a)(n);function n(t){var r;return Object(s.a)(this,n),(r=e.call(this)).w=t,r.s=null,r.count=0,r}return Object(r.a)(n,[{key:"write",value:function(t){this.s===t?this.count++:(this.count>0&&y(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}}]),n}(f),E=function(t){t.count>0&&(m(t.encoder,1===t.count?t.s:-t.s),t.count>1&&y(t.encoder,t.count-2))},_=function(){function t(){Object(s.a)(this,t),this.encoder=new f,this.s=0,this.count=0}return Object(r.a)(t,[{key:"write",value:function(t){this.s===t?this.count++:(E(this),this.count=1,this.s=t)}},{key:"toUint8Array",value:function(){return E(this),p(this.encoder)}}]),t}(),M=function(t){if(t.count>0){var e=t.diff<<1|(1===t.count?0:1);m(t.encoder,e),t.count>1&&y(t.encoder,t.count-2)}},T=function(){function t(){Object(s.a)(this,t),this.encoder=new f,this.s=0,this.count=0,this.diff=0}return Object(r.a)(t,[{key:"write",value:function(t){this.diff===t-this.s?(this.s=t,this.count++):(M(this),this.count=1,this.diff=t-this.s,this.s=t)}},{key:"toUint8Array",value:function(){return M(this),p(this.encoder)}}]),t}(),N=function(){function t(){Object(s.a)(this,t),this.sarr=[],this.s="",this.lensE=new _}return Object(r.a)(t,[{key:"write",value:function(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}},{key:"toUint8Array",value:function(){var t=new f;return this.sarr.push(this.s),this.s="",g(t,this.sarr.join("")),w(t,this.lensE.toUint8Array()),p(t)}}]),t}()},function(t,e,n){"use strict";t.exports=n(95)},function(t,e,n){"use strict";n.d(e,"e",(function(){return f})),n.d(e,"f",(function(){return h})),n.d(e,"l",(function(){return d})),n.d(e,"h",(function(){return v})),n.d(e,"k",(function(){return y})),n.d(e,"i",(function(){return m})),n.d(e,"j",(function(){return g})),n.d(e,"g",(function(){return k})),n.d(e,"b",(function(){return x})),n.d(e,"d",(function(){return S})),n.d(e,"a",(function(){return O})),n.d(e,"c",(function(){return C}));var r=n(5),o=n(11),i=n(10),s=n(3),a=n(31),c=n(7),u=n(9),l=function t(e){Object(s.a)(this,t),this.arr=e,this.pos=0},f=function(t){return new l(t)},h=function(t){return t.pos!==t.arr.length},p=function(t,e){var n=a.c(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,n},d=function(t){return p(t,y(t))},v=function(t){return t.arr[t.pos++]},y=function(t){for(var e=0,n=0;;){var r=t.arr[t.pos++];if(e|=(r&c.k)<<n,n+=7,r<c.g)return e>>>0;if(n>35)throw new Error("Integer out of range!")}},m=function(t){var e=t.arr[t.pos++],n=e&c.j,r=6,o=(e&c.f)>0?-1:1;if(0===(e&c.g))return o*n;for(;;){if(n|=((e=t.arr[t.pos++])&c.k)<<r,r+=7,e<c.g)return o*(n>>>0);if(r>41)throw new Error("Integer out of range!")}},g=function(t){var e=y(t);if(0===e)return"";var n=String.fromCodePoint(v(t));if(--e<100)for(;e--;)n+=String.fromCodePoint(v(t));else for(;e>0;){var r=e<1e4?e:1e4,o=t.arr.subarray(t.pos,t.pos+r);t.pos+=r,n+=String.fromCodePoint.apply(null,o),e-=r}return decodeURIComponent(escape(n))},b=function(t,e){var n=new DataView(t.arr.buffer,t.arr.byteOffset+t.pos,e);return t.pos+=e,n},w=[function(t){},function(t){return null},m,function(t){return b(t,4).getFloat32(0)},function(t){return b(t,8).getFloat64(0)},function(t){return b(t,8).getBigInt64(0)},function(t){return!1},function(t){return!0},g,function(t){for(var e=y(t),n={},r=0;r<e;r++){n[g(t)]=k(t)}return n},function(t){for(var e=y(t),n=[],r=0;r<e;r++)n.push(k(t));return n},d],k=function(t){return w[127-v(t)](t)},x=function(t){Object(o.a)(n,t);var e=Object(i.a)(n);function n(t,r){var o;return Object(s.a)(this,n),(o=e.call(this,t)).reader=r,o.s=null,o.count=0,o}return Object(r.a)(n,[{key:"read",value:function(){return 0===this.count&&(this.s=this.reader(this),h(this)?this.count=y(this)+1:this.count=-1),this.count--,this.s}}]),n}(l),S=function(t){Object(o.a)(n,t);var e=Object(i.a)(n);function n(t){var r;return Object(s.a)(this,n),(r=e.call(this,t)).s=0,r.count=0,r}return Object(r.a)(n,[{key:"read",value:function(){if(0===this.count){this.s=m(this);var t=u.d(this.s);this.count=1,t&&(this.s=-this.s,this.count=y(this)+2)}return this.count--,this.s}}]),n}(l),O=function(t){Object(o.a)(n,t);var e=Object(i.a)(n);function n(t){var r;return Object(s.a)(this,n),(r=e.call(this,t)).s=0,r.count=0,r.diff=0,r}return Object(r.a)(n,[{key:"read",value:function(){if(0===this.count){var t=m(this),e=1&t;this.diff=t>>1,this.count=1,e&&(this.count=y(this)+2)}return this.s+=this.diff,this.count--,this.s}}]),n}(l),C=function(){function t(e){Object(s.a)(this,t),this.decoder=new S(e),this.str=g(this.decoder),this.spos=0}return Object(r.a)(t,[{key:"read",value:function(){var t=this.spos+this.decoder.read(),e=this.str.slice(this.spos,t);return this.spos=t,e}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return St})),n.d(e,"b",(function(){return It})),n.d(e,"c",(function(){return At})),n.d(e,"d",(function(){return Ct})),n.d(e,"e",(function(){return Bt})),n.d(e,"f",(function(){return Ft})),n.d(e,"g",(function(){return qt})),n.d(e,"h",(function(){return Pt})),n.d(e,"i",(function(){return $t})),n.d(e,"j",(function(){return Rt}));var r=n(12);function o(t,e,n){for(var r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;var i=t.child(r),s=e.child(r);if(i!=s){if(!i.sameMarkup(s))return n;if(i.isText&&i.text!=s.text){for(var a=0;i.text[a]==s.text[a];a++)n++;return n}if(i.content.size||s.content.size){var c=o(i.content,s.content,n+1);if(null!=c)return c}n+=i.nodeSize}else n+=i.nodeSize}}function i(t,e,n,r){for(var o=t.childCount,s=e.childCount;;){if(0==o||0==s)return o==s?null:{a:n,b:r};var a=t.child(--o),c=e.child(--s),u=a.nodeSize;if(a!=c){if(!a.sameMarkup(c))return{a:n,b:r};if(a.isText&&a.text!=c.text){for(var l=0,f=Math.min(a.text.length,c.text.length);l<f&&a.text[a.text.length-l-1]==c.text[c.text.length-l-1];)l++,n--,r--;return{a:n,b:r}}if(a.content.size||c.content.size){var h=i(a.content,c.content,n-1,r-1);if(h)return h}n-=u,r-=u}else n-=u,r-=u}}var s=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},a={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};s.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var u=s+1;a.nodesBetween(Math.max(0,t-u),Math.min(a.content.size,e-u),n,r+u)}s=c}},s.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},s.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},s.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new s(r,this.size+t.size)},s.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var o=0,i=0;i<e;o++){var a=this.content[o],c=i+a.nodeSize;c>t&&((i<t||c>e)&&(a=a.isText?a.cut(Math.max(0,t-i),Math.min(a.text.length,e-i)):a.cut(Math.max(0,t-i-1),Math.min(a.content.size,e-i-1))),n.push(a),r+=a.nodeSize),i=c}return new s(n,r)},s.prototype.cutByIndex=function(t,e){return t==e?s.empty:0==t&&e==this.content.length?this:new s(this.content.slice(t,e))},s.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new s(r,o)},s.prototype.addToStart=function(t){return new s([t].concat(this.content),this.size+t.nodeSize)},s.prototype.addToEnd=function(t){return new s(this.content.concat(t),this.size+t.nodeSize)},s.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},a.firstChild.get=function(){return this.content.length?this.content[0]:null},a.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},a.childCount.get=function(){return this.content.length},s.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},s.prototype.maybeChild=function(t){return this.content[t]},s.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},s.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),o(this,t,e)},s.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),i(this,t,e,n)},s.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return u(0,t);if(t==this.size)return u(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?u(n+1,o):u(n,r);r=o}},s.prototype.toString=function(){return"<"+this.toStringInner()+">"},s.prototype.toStringInner=function(){return this.content.join(", ")},s.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},s.fromJSON=function(t,e){if(!e)return s.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new s(e.map(t.nodeFromJSON))},s.fromArray=function(t){if(!t.length)return s.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new s(e||t,n)},s.from=function(t){if(!t)return s.empty;if(t instanceof s)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new s([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(s.prototype,a);var c={index:0,offset:0};function u(t,e){return c.index=t,c.offset=e,c}function l(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!l(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e)||!l(t[o],e[o]))return!1;for(var i in e)if(!(i in t))return!1}return!0}s.empty=new s([],0);var f=function(t,e){this.type=t,this.attrs=e};function h(t){var e=Error.call(this,t);return e.__proto__=h.prototype,e}f.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},f.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},f.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},f.prototype.eq=function(t){return this==t||this.type==t.type&&l(this.attrs,t.attrs)},f.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},f.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},f.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},f.setFrom=function(t){if(!t||0==t.length)return f.none;if(t instanceof f)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},f.none=[],h.prototype=Object.create(Error.prototype),h.prototype.constructor=h,h.prototype.name="ReplaceError";var p=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},d={size:{configurable:!0}};function v(t,e,n){var r=t.findIndex(e),o=r.index,i=r.offset,s=t.maybeChild(o),a=t.findIndex(n),c=a.index,u=a.offset;if(i==e||s.isText){if(u!=n&&!t.child(c).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return t.replaceChild(o,s.copy(v(s.content,e-i-1,n-i-1)))}function y(t,e,n,r){var o=t.findIndex(e),i=o.index,s=o.offset,a=t.maybeChild(i);if(s==e||a.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));var c=y(a.content,e-s-1,n);return c&&t.replaceChild(i,a.copy(c))}function m(t,e,n){if(n.openStart>t.depth)throw new h("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new h("Inconsistent open depths");return g(t,e,n,0)}function g(t,e,n,r){var o=t.index(r),i=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){var a=g(t,e,n,r+1);return i.copy(i.content.replaceChild(o,a))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){var c=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(s.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(n,t);return S(i,O(t,c.start,c.end,e,r))}var u=t.parent,l=u.content;return S(u,l.cut(0,t.parentOffset).append(n.content).append(l.cut(e.parentOffset)))}return S(i,C(t,e,r))}function b(t,e){if(!e.type.compatibleContent(t.type))throw new h("Cannot join "+e.type.name+" onto "+t.type.name)}function w(t,e,n){var r=t.node(n);return b(r,e.node(n)),r}function k(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function x(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(k(t.nodeAfter,r),i++));for(var a=i;a<s;a++)k(o.child(a),r);e&&e.depth==n&&e.textOffset&&k(e.nodeBefore,r)}function S(t,e){if(!t.type.validContent(e))throw new h("Invalid content for node "+t.type.name);return t.copy(e)}function O(t,e,n,r,o){var i=t.depth>o&&w(t,e,o+1),a=r.depth>o&&w(n,r,o+1),c=[];return x(null,t,o,c),i&&a&&e.index(o)==n.index(o)?(b(i,a),k(S(i,O(t,e,n,r,o+1)),c)):(i&&k(S(i,C(t,e,o+1)),c),x(e,n,o,c),a&&k(S(a,C(n,r,o+1)),c)),x(r,null,o,c),new s(c)}function C(t,e,n){var r=[];(x(null,t,n,r),t.depth>n)&&k(S(w(t,e,n+1),C(t,e,n+1)),r);return x(e,null,n,r),new s(r)}d.size.get=function(){return this.content.size-this.openStart-this.openEnd},p.prototype.insertAt=function(t,e){var n=y(this.content,t+this.openStart,e,null);return n&&new p(n,this.openStart,this.openEnd)},p.prototype.removeBetween=function(t,e){return new p(v(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},p.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},p.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},p.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},p.fromJSON=function(t,e){if(!e)return p.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new p(s.fromJSON(t,e.content),n,r)},p.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new p(t,n,r)},Object.defineProperties(p.prototype,d),p.empty=new p(s.empty,0,0);var E=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},_={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};E.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},_.parent.get=function(){return this.node(this.depth)},_.doc.get=function(){return this.node(0)},E.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},E.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},E.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},E.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},E.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},E.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},E.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},_.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},_.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},_.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},E.prototype.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,o=0;o<t;o++)r+=n.child(o).nodeSize;return r},E.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return f.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},E.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},E.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},E.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new A(this,t,n)},E.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},E.prototype.max=function(t){return t.pos>this.pos?t:this},E.prototype.min=function(t){return t.pos<this.pos?t:this},E.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},E.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,u=o-c;if(n.push(i,a,r+c),!u)break;if((i=i.child(a)).isText)break;o=u-1,r+=c+1}return new E(e,n,o)},E.resolveCached=function(t,e){for(var n=0;n<M.length;n++){var r=M[n];if(r.pos==e&&r.doc==t)return r}var o=M[T]=E.resolve(t,e);return T=(T+1)%N,o},Object.defineProperties(E.prototype,_);var M=[],T=0,N=12,A=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},I={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};I.start.get=function(){return this.$from.before(this.depth+1)},I.end.get=function(){return this.$to.after(this.depth+1)},I.parent.get=function(){return this.$from.node(this.depth)},I.startIndex.get=function(){return this.$from.index(this.depth)},I.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(A.prototype,I);var j=Object.create(null),D=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||s.empty,this.marks=r||f.none},R={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};R.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},R.childCount.get=function(){return this.content.childCount},D.prototype.child=function(t){return this.content.child(t)},D.prototype.maybeChild=function(t){return this.content.maybeChild(t)},D.prototype.forEach=function(t){this.content.forEach(t)},D.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},D.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},R.textContent.get=function(){return this.textBetween(0,this.content.size,"")},D.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},R.firstChild.get=function(){return this.content.firstChild},R.lastChild.get=function(){return this.content.lastChild},D.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},D.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},D.prototype.hasMarkup=function(t,e,n){return this.type==t&&l(this.attrs,e||t.defaultAttrs||j)&&f.sameSet(this.marks,n||f.none)},D.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},D.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},D.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},D.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return p.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new p(a,r.depth-i,o.depth-i)},D.prototype.replace=function(t,e,n){return m(this.resolve(t),this.resolve(e),n)},D.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},D.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},D.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},D.prototype.resolve=function(t){return E.resolveCached(this,t)},D.prototype.resolveNoCache=function(t){return E.resolve(this,t)},D.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},R.isBlock.get=function(){return this.type.isBlock},R.isTextblock.get=function(){return this.type.isTextblock},R.inlineContent.get=function(){return this.type.inlineContent},R.isInline.get=function(){return this.type.isInline},R.isText.get=function(){return this.type.isText},R.isLeaf.get=function(){return this.type.isLeaf},R.isAtom.get=function(){return this.type.isAtom},D.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),z(this.marks,t)},D.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},D.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=s.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),a=i&&i.matchFragment(this.content,e);if(!a||!a.validEnd)return!1;for(var c=r;c<o;c++)if(!this.type.allowsMarks(n.child(c).marks))return!1;return!0},D.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},D.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},D.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},D.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},D.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=s.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(D.prototype,R);var P=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):z(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(D);function z(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var F=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},B={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};F.parse=function(t,e){var n=new L(t,e);if(null==n.next)return F.empty;var r=q(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return n(K(t,0));function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];K(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new F(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(H);i.next.push(o[s],e[a.join(",")]||n(a))}return i}}(function(t){var e=[[]];return o(i(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}function i(t,e){if("choice"==t.type)return t.exprs.reduce((function(t,n){return t.concat(i(n,e))}),[]);if("seq"==t.type)for(var s=0;;s++){var a=i(t.exprs[s],e);if(s==t.exprs.length-1)return a;o(a,e=n())}else{if("star"==t.type){var c=n();return r(e,c),o(i(t.expr,c),c),[r(c)]}if("plus"==t.type){var u=n();return o(i(t.expr,e),u),o(i(t.expr,u),u),[r(u)]}if("opt"==t.type)return[r(e)].concat(i(t.expr,e));if("range"==t.type){for(var l=e,f=0;f<t.min;f++){var h=n();o(i(t.expr,l),h),l=h}if(-1==t.max)o(i(t.expr,l),l);else for(var p=t.min;p<t.max;p++){var d=n();r(l,d),o(i(t.expr,l),d),l=d}return[r(l)]}if("name"==t.type)return[r(e,null,t.value)]}}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],u=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(u)&&r.push(u)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},F.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},F.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},B.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},B.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},F.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},F.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,a){var c=i.matchFragment(t,n);if(c&&(!e||c.validEnd))return s.from(a.map((function(t){return t.createAndFill()})));for(var u=0;u<i.next.length;u+=2){var l=i.next[u],f=i.next[u+1];if(!l.isText&&!l.hasRequiredAttrs()&&-1==r.indexOf(f)){r.push(f);var h=o(f,a.concat(l));if(h)return h}}}(this,[])},F.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},F.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},B.edgeCount.get=function(){return this.next.length>>1},F.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},F.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(F.prototype,B),F.empty=new F(!0);var L=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},$={next:{configurable:!0}};function q(t){var e=[];do{e.push(J(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function J(t){var e=[];do{e.push(U(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function U(t){for(var e=function(t){if(t.eat("(")){var e=q(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=W(t,e)}return e}function V(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function W(t,e){var n=V(t),r=n;return t.eat(",")&&(r="}"!=t.next?V(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function H(t,e){return e-t}function K(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(H)}function Y(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function G(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function Q(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new tt(t[n]);return e}$.next.get=function(){return this.tokens[this.pos]},L.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},L.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(L.prototype,$);var X=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=Q(n.attrs),this.defaultAttrs=Y(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},Z={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Z.isInline.get=function(){return!this.isBlock},Z.isTextblock.get=function(){return this.isBlock&&this.inlineContent},Z.isLeaf.get=function(){return this.contentMatch==F.empty},Z.isAtom.get=function(){return this.isLeaf||this.spec.atom},X.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},X.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},X.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:G(this.attrs,t)},X.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new D(this,this.computeAttrs(t),s.from(e),f.setFrom(n))},X.prototype.createChecked=function(t,e,n){if(e=s.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new D(this,this.computeAttrs(t),e,f.setFrom(n))},X.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=s.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e).fillBefore(s.empty,!0);return o?new D(this,t,e.append(o),f.setFrom(n)):null},X.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},X.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},X.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},X.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:f.empty:t},X.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new X(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(X.prototype,Z);var tt=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},et={isRequired:{configurable:!0}};et.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(tt.prototype,et);var nt=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=Q(r.attrs),this.rank=e,this.excluded=null;var o=Y(this.attrs);this.instance=o&&new f(this,o)};nt.prototype.create=function(t){return!t&&this.instance?this.instance:new f(this,G(this.attrs,t))},nt.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new nt(t,r++,e,o)})),n},nt.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},nt.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},nt.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var rt=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=r.a.from(t.nodes),this.spec.marks=r.a.from(t.marks),this.nodes=X.compile(this.spec.nodes,this),this.marks=nt.compile(this.spec.marks,this);var n=Object.create(null);for(var o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");var i=this.nodes[o],s=i.spec.content||"",a=i.spec.marks;i.contentMatch=n[s]||(n[s]=F.parse(s,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.markSet="_"==a?null:a?ot(this,a.split(" ")):""!=a&&i.inlineContent?null:[]}for(var c in this.marks){var u=this.marks[c],l=u.spec.excludes;u.excluded=null==l?[u]:""==l?[]:ot(this,l.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function ot(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}rt.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof X))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},rt.prototype.text=function(t,e){var n=this.nodes.text;return new P(n,n.defaultAttrs,t,f.setFrom(e))},rt.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},rt.prototype.nodeFromJSON=function(t){return D.fromJSON(this,t)},rt.prototype.markFromJSON=function(t){return f.fromJSON(this,t)},rt.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var it=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)})),this.normalizeLists=!this.tags.some((function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)}))};it.prototype.parse=function(t,e){void 0===e&&(e={});var n=new ft(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},it.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new ft(this,e,!0);return n.addAll(t,null,e.from,e.to),p.maxOpen(n.finish())},it.prototype.matchTag=function(t,e,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(pt(t,o.tag)&&(void 0===o.namespace||t.namespaceURI==o.namespace)&&(!o.context||e.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(t);if(!1===i)continue;o.attrs=i}return o}}},it.prototype.matchStyle=function(t,e,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(t)||i.context&&!n.matchesContext(i.context)||i.style.length>t.length&&(61!=i.style.charCodeAt(t.length)||i.style.slice(t.length+1)!=e))){if(i.getAttrs){var s=i.getAttrs(e);if(!1===s)continue;i.attrs=s}return i}}},it.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=dt(t)),t.mark=e}))};for(var o in t.marks)r(o);var i=function(e){var r=t.nodes[s].spec.parseDOM;r&&r.forEach((function(t){n(t=dt(t)),t.node=s}))};for(var s in t.nodes)i();return e},it.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new it(t,it.schemaRules(t)))};var st={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},at={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},ct={ol:!0,ul:!0};function ut(t){return(t?1:0)|("full"===t?2:0)}var lt=function(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=f.none,this.pendingMarks=r,this.stashMarks=[]};lt.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(s.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},lt.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=s.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(s.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},lt.prototype.popFromStashMark=function(t){for(var e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]},lt.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):vt(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}};var ft=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,i=ut(e.preserveWhitespace)|(n?4:0);r=o?new lt(o.type,o.attrs,f.none,f.none,!0,e.topMatch||o.type.contentMatch,i):new lt(n?null:t.schema.topNodeType,null,f.none,f.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},ht={top:{configurable:!0},currentPos:{configurable:!0}};function pt(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function dt(t){var e={};for(var n in t)e[n]=t[n];return e}function vt(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var i=[];return function t(n){i.push(n);for(var r=0;r<n.edgeCount;r++){var o=n.edge(r),s=o.type,a=o.next;if(s==e)return!0;if(i.indexOf(a)<0&&t(a))return!0}}(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}ht.top.get=function(){return this.nodes[this.open]},ft.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},ft.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},ft.prototype.addElement=function(t,e){var n,r=t.nodeName.toLowerCase();ct.hasOwnProperty(r)&&this.parser.normalizeLists&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&ct.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var o=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(n=this.parser.matchTag(t,this,e));if(o?o.ignore:at.hasOwnProperty(r))this.findInside(t);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(t=o.skip);var i,s=this.top,a=this.needsBlock;if(st.hasOwnProperty(r))i=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),i&&this.sync(s),this.needsBlock=a}else this.addElementByRule(t,o,!1===o.consuming?n:null)},ft.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},ft.prototype.readStyles=function(t){var e=f.none;t:for(var n=0;n<t.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(t[n],t[n+1],this,r);if(!o)continue t;if(o.ignore)return null;if(e=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(e),!1!==o.consuming)break;r=o}return e},ft.prototype.addElementByRule=function(t,e,n){var r,o,i,s=this;e.node?(o=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(o.create(e.attrs))||this.leafFallback(t):r=this.enter(o,e.attrs,e.preserveWhitespace):(i=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(i));var a=this.top;if(o&&o.isLeaf)this.findInside(t);else if(n)this.addElement(t,n);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return s.insertNode(t)}));else{var c=e.contentElement;"string"==typeof c?c=t.querySelector(c):"function"==typeof c&&(c=c(t)),c||(c=t),this.findAround(t,c,!0),this.addAll(c,r)}r&&(this.sync(a),this.open--),i&&this.removePendingMark(i,a)},ft.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&st.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},ft.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},ft.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},ft.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},ft.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:ut(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new lt(t,e,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},ft.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},ft.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},ft.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},ht.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},ft.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},ft.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},ft.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},ft.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},ft.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1);return function t(s,a){for(;s>=0;s--){var c=n[s];if(""==c){if(s==n.length-1||0==s)continue;for(;a>=i;a--)if(t(s-1,a))return!0;return!1}var u=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!u||u.name!=c&&-1==u.groups.indexOf(c))return!1;a--}return!0}(n.length-1,this.open)},ft.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},ft.prototype.addPendingMark=function(t){var e=function(t,e){for(var n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},ft.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(t)>-1)r.pendingMarks=t.removeFromSet(r.pendingMarks);else{r.activeMarks=t.removeFromSet(r.activeMarks);var o=r.popFromStashMark(t);o&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==e)break}},Object.defineProperties(ft.prototype,ht);var yt=function(t,e){this.nodes=t||{},this.marks=e||{}};function mt(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function gt(t){return t.document||window.document}yt.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=gt(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],u=r.serializeMark(c,t.isInline,e);u&&(i.push(c,o),o.appendChild(u.dom),o=u.contentDOM||u.dom)}}o.appendChild(r.serializeNode(t,e))})),n},yt.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=yt.renderSpec(gt(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},yt.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},yt.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&yt.renderSpec(gt(n),r(t,e))},yt.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var u in c=2,a)if(null!=a[u]){var l=u.indexOf(" ");l>0?s.setAttributeNS(u.slice(0,l),u.slice(l+1),a[u]):s.setAttribute(u,a[u])}for(var f=c;f<e.length;f++){var h=e[f];if(0===h){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var p=yt.renderSpec(t,h,n),d=p.dom,v=p.contentDOM;if(s.appendChild(d),v){if(i)throw new RangeError("Multiple content holes");i=v}}return{dom:s,contentDOM:i}},yt.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new yt(this.nodesFromSchema(t),this.marksFromSchema(t)))},yt.nodesFromSchema=function(t){var e=mt(t.nodes);return e.text||(e.text=function(t){return t.text}),e},yt.marksFromSchema=function(t){return mt(t.marks)};var bt=Math.pow(2,16);function wt(t){return 65535&t}var kt=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=null),this.pos=t,this.deleted=e,this.recover=n},xt=function(t,e){void 0===e&&(e=!1),this.ranges=t,this.inverted=e};xt.prototype.recover=function(t){var e=0,n=wt(t);if(!this.inverted)for(var r=0;r<n;r++)e+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+e+function(t){return(t-(65535&t))/bt}(t)},xt.prototype.mapResult=function(t,e){return void 0===e&&(e=1),this._map(t,e,!1)},xt.prototype.map=function(t,e){return void 0===e&&(e=1),this._map(t,e,!0)},xt.prototype._map=function(t,e,n){for(var r=0,o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?r:0);if(a>t)break;var c=this.ranges[s+o],u=this.ranges[s+i],l=a+c;if(t<=l){var f=a+r+((c?t==a?-1:t==l?1:e:e)<0?0:u);if(n)return f;var h=t==(e<0?a:l)?null:s/3+(t-a)*bt;return new kt(f,e<0?t!=a:t!=l,h)}r+=u-c}return n?t+r:new kt(t+r)},xt.prototype.touches=function(t,e){for(var n=0,r=wt(e),o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?n:0);if(a>t)break;var c=this.ranges[s+o];if(t<=a+c&&s==3*r)return!0;n+=this.ranges[s+i]-c}return!1},xt.prototype.forEach=function(t){for(var e=this.inverted?2:1,n=this.inverted?1:2,r=0,o=0;r<this.ranges.length;r+=3){var i=this.ranges[r],s=i-(this.inverted?o:0),a=i+(this.inverted?0:o),c=this.ranges[r+e],u=this.ranges[r+n];t(s,s+c,a,a+u),o+=u-c}},xt.prototype.invert=function(){return new xt(this.ranges,!this.inverted)},xt.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},xt.offset=function(t){return 0==t?xt.empty:new xt(t<0?[0,-t,0]:[0,0,t])},xt.empty=new xt([]);var St=function(t,e,n,r){this.maps=t||[],this.from=n||0,this.to=null==r?this.maps.length:r,this.mirror=e};function Ot(t){var e=Error.call(this,t);return e.__proto__=Ot.prototype,e}St.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.maps.length),new St(this.maps,this.mirror,t,e)},St.prototype.copy=function(){return new St(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},St.prototype.appendMap=function(t,e){this.to=this.maps.push(t),null!=e&&this.setMirror(this.maps.length-1,e)},St.prototype.appendMapping=function(t){for(var e=0,n=this.maps.length;e<t.maps.length;e++){var r=t.getMirror(e);this.appendMap(t.maps[e],null!=r&&r<e?n+r:null)}},St.prototype.getMirror=function(t){if(this.mirror)for(var e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]},St.prototype.setMirror=function(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)},St.prototype.appendMappingInverted=function(t){for(var e=t.maps.length-1,n=this.maps.length+t.maps.length;e>=0;e--){var r=t.getMirror(e);this.appendMap(t.maps[e].invert(),null!=r&&r>e?n-r-1:null)}},St.prototype.invert=function(){var t=new St;return t.appendMappingInverted(this),t},St.prototype.map=function(t,e){if(void 0===e&&(e=1),this.mirror)return this._map(t,e,!0);for(var n=this.from;n<this.to;n++)t=this.maps[n].map(t,e);return t},St.prototype.mapResult=function(t,e){return void 0===e&&(e=1),this._map(t,e,!1)},St.prototype._map=function(t,e,n){for(var r=!1,o=this.from;o<this.to;o++){var i=this.maps[o].mapResult(t,e);if(null!=i.recover){var s=this.getMirror(o);if(null!=s&&s>o&&s<this.to){o=s,t=this.maps[s].recover(i.recover);continue}}i.deleted&&(r=!0),t=i.pos}return n?t:new kt(t,r)},Ot.prototype=Object.create(Error.prototype),Ot.prototype.constructor=Ot,Ot.prototype.name="TransformError";var Ct=function(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new St},Et={before:{configurable:!0},docChanged:{configurable:!0}};function _t(){throw new Error("Override me")}Et.before.get=function(){return this.docs.length?this.docs[0]:this.doc},Ct.prototype.step=function(t){var e=this.maybeStep(t);if(e.failed)throw new Ot(e.failed);return this},Ct.prototype.maybeStep=function(t){var e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e},Et.docChanged.get=function(){return this.steps.length>0},Ct.prototype.addStep=function(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e},Object.defineProperties(Ct.prototype,Et);var Mt=Object.create(null),Tt=function(){};Tt.prototype.apply=function(t){return _t()},Tt.prototype.getMap=function(){return xt.empty},Tt.prototype.invert=function(t){return _t()},Tt.prototype.map=function(t){return _t()},Tt.prototype.merge=function(t){return null},Tt.prototype.toJSON=function(){return _t()},Tt.fromJSON=function(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");var n=Mt[e.stepType];if(!n)throw new RangeError("No step type "+e.stepType+" defined");return n.fromJSON(t,e)},Tt.jsonID=function(t,e){if(t in Mt)throw new RangeError("Duplicate use of step JSON ID "+t);return Mt[t]=e,e.prototype.jsonID=t,e};var Nt=function(t,e){this.doc=t,this.failed=e};Nt.ok=function(t){return new Nt(t,null)},Nt.fail=function(t){return new Nt(null,t)},Nt.fromReplace=function(t,e,n,r){try{return Nt.ok(t.replace(e,n,r))}catch(o){if(o instanceof h)return Nt.fail(o.message);throw o}};var At=function(t){function e(e,n,r,o){t.call(this),this.from=e,this.to=n,this.slice=r,this.structure=!!o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){return this.structure&&jt(t,this.from,this.to)?Nt.fail("Structure replace would overwrite content"):Nt.fromReplace(t,this.from,this.to,this.slice)},e.prototype.getMap=function(){return new xt([this.from,this.to-this.from,this.slice.size])},e.prototype.invert=function(t){return new e(this.from,this.from+this.slice.size,t.slice(this.from,this.to))},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted?null:new e(n.pos,Math.max(n.pos,r.pos),this.slice)},e.prototype.merge=function(t){if(!(t instanceof e)||t.structure!=this.structure)return null;if(this.from+this.slice.size!=t.from||this.slice.openEnd||t.slice.openStart){if(t.to!=this.from||this.slice.openStart||t.slice.openEnd)return null;var n=this.slice.size+t.slice.size==0?p.empty:new p(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new e(t.from,this.to,n,this.structure)}var r=this.slice.size+t.slice.size==0?p.empty:new p(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new e(this.from,this.to+(t.to-t.from),r,this.structure)},e.prototype.toJSON=function(){var t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new e(n.from,n.to,p.fromJSON(t,n.slice),!!n.structure)},e}(Tt);Tt.jsonID("replace",At);var It=function(t){function e(e,n,r,o,i,s,a){t.call(this),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=o,this.slice=i,this.insert=s,this.structure=!!a}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){if(this.structure&&(jt(t,this.from,this.gapFrom)||jt(t,this.gapTo,this.to)))return Nt.fail("Structure gap-replace would overwrite content");var e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return Nt.fail("Gap is not a flat range");var n=this.slice.insertAt(this.insert,e.content);return n?Nt.fromReplace(t,this.from,this.to,n):Nt.fail("Content does not fit in gap")},e.prototype.getMap=function(){return new xt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},e.prototype.invert=function(t){var n=this.gapTo-this.gapFrom;return new e(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),o=t.map(this.gapFrom,-1),i=t.map(this.gapTo,1);return n.deleted&&r.deleted||o<n.pos||i>r.pos?null:new e(n.pos,r.pos,o,i,this.slice,this.insert,this.structure)},e.prototype.toJSON=function(){var t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to||"number"!=typeof n.gapFrom||"number"!=typeof n.gapTo||"number"!=typeof n.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new e(n.from,n.to,n.gapFrom,n.gapTo,p.fromJSON(t,n.slice),n.insert,!!n.structure)},e}(Tt);function jt(t,e,n){for(var r=t.resolve(e),o=n-e,i=r.depth;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0)for(var s=r.node(i).maybeChild(r.indexAfter(i));o>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,o--}return!1}function Dt(t,e,n){return(0==e||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function Rt(t){for(var e=t.parent.content.cutByIndex(t.startIndex,t.endIndex),n=t.depth;;--n){var r=t.$from.node(n),o=t.$from.index(n),i=t.$to.indexAfter(n);if(n<t.depth&&r.canReplace(o,i,e))return n;if(0==n||r.type.spec.isolating||!Dt(r,o,i))break}}function Pt(t,e,n,r){void 0===r&&(r=t);var o=function(t,e){var n=t.parent,r=t.startIndex,o=t.endIndex,i=n.contentMatchAt(r).findWrapping(e);if(!i)return null;var s=i.length?i[0]:e;return n.canReplaceWith(r,o,s)?i:null}(t,e),i=o&&function(t,e){var n=t.parent,r=t.startIndex,o=t.endIndex,i=n.child(r),s=e.contentMatch.findWrapping(i.type);if(!s)return null;for(var a=(s.length?s[s.length-1]:e).contentMatch,c=r;a&&c<o;c++)a=a.matchType(n.child(c).type);if(!a||!a.validEnd)return null;return s}(r,e);return i?o.map(zt).concat({type:e,attrs:n}).concat(i.map(zt)):null}function zt(t){return{type:t,attrs:null}}function Ft(t,e,n,r){void 0===n&&(n=1);var o=t.resolve(e),i=o.depth-n,s=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(var a=o.depth-1,c=n-2;a>i;a--,c--){var u=o.node(a),l=o.index(a);if(u.type.spec.isolating)return!1;var f=u.content.cutByIndex(l,u.childCount),h=r&&r[c]||u;if(h!=u&&(f=f.replaceChild(0,h.type.create(h.attrs))),!u.canReplace(l+1,u.childCount)||!h.type.validContent(f))return!1}var p=o.indexAfter(i),d=r&&r[0];return o.node(i).canReplaceWith(p,p,d?d.type:o.node(i+1).type)}function Bt(t,e){var n=t.resolve(e),r=n.index();return Lt(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function Lt(t,e){return t&&e&&!t.isLeaf&&t.canAppend(e)}function $t(t,e,n){void 0===n&&(n=-1);for(var r=t.resolve(e),o=r.depth;;o--){var i=void 0,s=void 0,a=r.index(o);if(o==r.depth?(i=r.nodeBefore,s=r.nodeAfter):n>0?(i=r.node(o+1),a++,s=r.node(o).maybeChild(a)):(i=r.node(o).maybeChild(a-1),s=r.node(o+1)),i&&!i.isTextblock&&Lt(i,s)&&r.node(o).canReplace(a,a+1))return e;if(0==o)break;e=n<0?r.before(o):r.after(o)}}function qt(t,e,n){var r=t.resolve(e);if(!n.content.size)return e;for(var o=n.content,i=0;i<n.openStart;i++)o=o.firstChild.content;for(var s=1;s<=(0==n.openStart&&n.size?2:1);s++)for(var a=r.depth;a>=0;a--){var c=a==r.depth?0:r.pos<=(r.start(a+1)+r.end(a+1))/2?-1:1,u=r.index(a)+(c>0?1:0);if(1==s?r.node(a).canReplace(u,u,o):r.node(a).contentMatchAt(u).findWrapping(o.firstChild.type))return 0==c?r.pos:c<0?r.before(a+1):r.after(a+1)}return null}function Jt(t,e,n){for(var r=[],o=0;o<t.childCount;o++){var i=t.child(o);i.content.size&&(i=i.copy(Jt(i.content,e,i))),i.isInline&&(i=e(i,n,o)),r.push(i)}return s.fromArray(r)}Tt.jsonID("replaceAround",It),Ct.prototype.lift=function(t,e){for(var n=t.$from,r=t.$to,o=t.depth,i=n.before(o+1),a=r.after(o+1),c=i,u=a,l=s.empty,f=0,h=o,d=!1;h>e;h--)d||n.index(h)>0?(d=!0,l=s.from(n.node(h).copy(l)),f++):c--;for(var v=s.empty,y=0,m=o,g=!1;m>e;m--)g||r.after(m+1)<r.end(m)?(g=!0,v=s.from(r.node(m).copy(v)),y++):u++;return this.step(new It(c,u,i,a,new p(l.append(v),f,y),l.size-f,!0))},Ct.prototype.wrap=function(t,e){for(var n=s.empty,r=e.length-1;r>=0;r--)n=s.from(e[r].type.create(e[r].attrs,n));var o=t.start,i=t.end;return this.step(new It(o,i,o,i,new p(n,0,0),e.length,!0))},Ct.prototype.setBlockType=function(t,e,n,r){var o=this;if(void 0===e&&(e=t),!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var i=this.steps.length;return this.doc.nodesBetween(t,e,(function(t,e){if(t.isTextblock&&!t.hasMarkup(n,r)&&function(t,e,n){var r=t.resolve(e),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}(o.doc,o.mapping.slice(i).map(e),n)){o.clearIncompatible(o.mapping.slice(i).map(e,1),n);var a=o.mapping.slice(i),c=a.map(e,1),u=a.map(e+t.nodeSize,1);return o.step(new It(c,u,c+1,u-1,new p(s.from(n.create(r,null,t.marks)),0,0),1,!0)),!1}})),this},Ct.prototype.setNodeMarkup=function(t,e,n,r){var o=this.doc.nodeAt(t);if(!o)throw new RangeError("No node at given position");e||(e=o.type);var i=e.create(n,null,r||o.marks);if(o.isLeaf)return this.replaceWith(t,t+o.nodeSize,i);if(!e.validContent(o.content))throw new RangeError("Invalid content for node type "+e.name);return this.step(new It(t,t+o.nodeSize,t+1,t+o.nodeSize-1,new p(s.from(i),0,0),1,!0))},Ct.prototype.split=function(t,e,n){void 0===e&&(e=1);for(var r=this.doc.resolve(t),o=s.empty,i=s.empty,a=r.depth,c=r.depth-e,u=e-1;a>c;a--,u--){o=s.from(r.node(a).copy(o));var l=n&&n[u];i=s.from(l?l.type.create(l.attrs,i):r.node(a).copy(i))}return this.step(new At(t,t,new p(o.append(i),e,e),!0))},Ct.prototype.join=function(t,e){void 0===e&&(e=1);var n=new At(t-e,t+e,p.empty,!0);return this.step(n)};var Ut=function(t){function e(e,n,r){t.call(this),this.from=e,this.to=n,this.mark=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){var e=this,n=t.slice(this.from,this.to),r=t.resolve(this.from),o=r.node(r.sharedDepth(this.to)),i=new p(Jt(n.content,(function(t,n){return n.type.allowsMarkType(e.mark.type)?t.mark(e.mark.addToSet(t.marks)):t}),o),n.openStart,n.openEnd);return Nt.fromReplace(t,this.from,this.to,i)},e.prototype.invert=function(){return new Vt(this.from,this.to,this.mark)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new e(n.pos,r.pos,this.mark)},e.prototype.merge=function(t){if(t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from)return new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new e(n.from,n.to,t.markFromJSON(n.mark))},e}(Tt);Tt.jsonID("addMark",Ut);var Vt=function(t){function e(e,n,r){t.call(this),this.from=e,this.to=n,this.mark=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){var e=this,n=t.slice(this.from,this.to),r=new p(Jt(n.content,(function(t){return t.mark(e.mark.removeFromSet(t.marks))})),n.openStart,n.openEnd);return Nt.fromReplace(t,this.from,this.to,r)},e.prototype.invert=function(){return new Ut(this.from,this.to,this.mark)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new e(n.pos,r.pos,this.mark)},e.prototype.merge=function(t){if(t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from)return new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new e(n.from,n.to,t.markFromJSON(n.mark))},e}(Tt);function Wt(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}Tt.jsonID("removeMark",Vt),Ct.prototype.addMark=function(t,e,n){var r=this,o=[],i=[],s=null,a=null;return this.doc.nodesBetween(t,e,(function(r,c,u){if(r.isInline){var l=r.marks;if(!n.isInSet(l)&&u.type.allowsMarkType(n.type)){for(var f=Math.max(c,t),h=Math.min(c+r.nodeSize,e),p=n.addToSet(l),d=0;d<l.length;d++)l[d].isInSet(p)||(s&&s.to==f&&s.mark.eq(l[d])?s.to=h:o.push(s=new Vt(f,h,l[d])));a&&a.to==f?a.to=h:i.push(a=new Ut(f,h,n))}}})),o.forEach((function(t){return r.step(t)})),i.forEach((function(t){return r.step(t)})),this},Ct.prototype.removeMark=function(t,e,n){var r=this;void 0===n&&(n=null);var o=[],i=0;return this.doc.nodesBetween(t,e,(function(r,s){if(r.isInline){i++;var a=null;if(n instanceof nt){var c=n.isInSet(r.marks);c&&(a=[c])}else n?n.isInSet(r.marks)&&(a=[n]):a=r.marks;if(a&&a.length)for(var u=Math.min(s+r.nodeSize,e),l=0;l<a.length;l++){for(var f=a[l],h=void 0,p=0;p<o.length;p++){var d=o[p];d.step==i-1&&f.eq(o[p].style)&&(h=d)}h?(h.to=u,h.step=i):o.push({style:f,from:Math.max(s,t),to:u,step:i})}}})),o.forEach((function(t){return r.step(new Vt(t.from,t.to,t.style))})),this},Ct.prototype.clearIncompatible=function(t,e,n){void 0===n&&(n=e.contentMatch);for(var r=this.doc.nodeAt(t),o=[],i=t+1,a=0;a<r.childCount;a++){var c=r.child(a),u=i+c.nodeSize,l=n.matchType(c.type,c.attrs);if(l){n=l;for(var f=0;f<c.marks.length;f++)e.allowsMarkType(c.marks[f].type)||this.step(new Vt(i,u,c.marks[f]))}else o.push(new At(i,u,p.empty));i=u}if(!n.validEnd){var h=n.fillBefore(s.empty,!0);this.replace(i,i,new p(h,0,0))}for(var d=o.length-1;d>=0;d--)this.step(o[d]);return this},Ct.prototype.replace=function(t,e,n){void 0===e&&(e=t),void 0===n&&(n=p.empty);var r=function(t,e,n,r){if(void 0===n&&(n=e),void 0===r&&(r=p.empty),e==n&&!r.size)return null;var o=t.resolve(e),i=t.resolve(n);return Wt(o,i,r)?new At(e,n,r):new Ht(o,i,r).fit()}(this.doc,t,e,n);return r&&this.step(r),this},Ct.prototype.replaceWith=function(t,e,n){return this.replace(t,e,new p(s.from(n),0,0))},Ct.prototype.delete=function(t,e){return this.replace(t,e,p.empty)},Ct.prototype.insert=function(t,e){return this.replaceWith(t,t,e)};var Ht=function(t,e,n){this.$to=e,this.$from=t,this.unplaced=n,this.frontier=[];for(var r=0;r<=t.depth;r++){var o=t.node(r);this.frontier.push({type:o.type,match:o.contentMatchAt(t.indexAfter(r))})}this.placed=s.empty;for(var i=t.depth;i>0;i--)this.placed=s.from(t.node(i).copy(this.placed))},Kt={depth:{configurable:!0}};function Yt(t,e,n){return 0==e?t.cutByIndex(n):t.replaceChild(0,t.firstChild.copy(Yt(t.firstChild.content,e-1,n)))}function Gt(t,e,n){return 0==e?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Gt(t.lastChild.content,e-1,n)))}function Qt(t,e){for(var n=0;n<e;n++)t=t.firstChild.content;return t}function Xt(t,e,n){if(e<=0)return t;var r=t.content;return e>1&&(r=r.replaceChild(0,Xt(r.firstChild,e-1,1==r.childCount?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(s.empty,!0)))),t.copy(r)}function Zt(t,e,n,r,o){var i=t.node(e),s=o?t.indexAfter(e):t.index(e);if(s==i.childCount&&!n.compatibleContent(i.type))return null;var a=r.fillBefore(i.content,!0,s);return a&&!function(t,e,n){for(var r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}(n,i.content,s)?a:null}function te(t,e,n,r,o){if(e<n){var i=t.firstChild;t=t.replaceChild(0,i.copy(te(i.content,e+1,n,r,i)))}if(e>r){var a=o.contentMatchAt(0),c=a.fillBefore(t).append(t);t=c.append(a.matchFragment(c).fillBefore(s.empty,!0))}return t}function ee(t,e){for(var n=[],r=Math.min(t.depth,e.depth);r>=0;r--){var o=t.start(r);if(o<t.pos-(t.depth-r)||e.end(r)>e.pos+(e.depth-r)||t.node(r).type.spec.isolating||e.node(r).type.spec.isolating)break;o==e.start(r)&&n.push(r)}return n}Kt.depth.get=function(){return this.frontier.length-1},Ht.prototype.fit=function(){for(;this.unplaced.size;){var t=this.findFittable();t?this.placeNodes(t):this.openMore()||this.dropNode()}var e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,o=this.close(e<0?this.$to:r.doc.resolve(e));if(!o)return null;for(var i=this.placed,s=r.depth,a=o.depth;s&&a&&1==i.childCount;)i=i.firstChild.content,s--,a--;var c=new p(i,s,a);return e>-1?new It(r.pos,e,this.$to.pos,this.$to.end(),c,n):c.size||r.pos!=this.$to.pos?new At(r.pos,o.pos,c):void 0},Ht.prototype.findFittable=function(){for(var t=1;t<=2;t++)for(var e=this.unplaced.openStart;e>=0;e--)for(var n=void 0,r=(e?(n=Qt(this.unplaced.content,e-1).firstChild).content:this.unplaced.content).firstChild,o=this.depth;o>=0;o--){var i=this.frontier[o],a=i.type,c=i.match,u=void 0,l=void 0;if(1==t&&(r?c.matchType(r.type)||(l=c.fillBefore(s.from(r),!1)):a.compatibleContent(n.type)))return{sliceDepth:e,frontierDepth:o,parent:n,inject:l};if(2==t&&r&&(u=c.findWrapping(r.type)))return{sliceDepth:e,frontierDepth:o,parent:n,wrap:u};if(n&&c.matchType(n.type))break}},Ht.prototype.openMore=function(){var t=this.unplaced,e=t.content,n=t.openStart,r=t.openEnd,o=Qt(e,n);return!(!o.childCount||o.firstChild.isLeaf)&&(this.unplaced=new p(e,n+1,Math.max(r,o.size+n>=e.size-r?n+1:0)),!0)},Ht.prototype.dropNode=function(){var t=this.unplaced,e=t.content,n=t.openStart,r=t.openEnd,o=Qt(e,n);if(o.childCount<=1&&n>0){var i=e.size-n<=n+o.size;this.unplaced=new p(Yt(e,n-1,1),n-1,i?n-1:r)}else this.unplaced=new p(Yt(e,n,1),n,r)},Ht.prototype.placeNodes=function(t){for(var e=t.sliceDepth,n=t.frontierDepth,r=t.parent,o=t.inject,i=t.wrap;this.depth>n;)this.closeFrontierNode();if(i)for(var a=0;a<i.length;a++)this.openFrontierNode(i[a]);var c=this.unplaced,u=r?r.content:c.content,l=c.openStart-e,f=0,h=[],d=this.frontier[n],v=d.match,y=d.type;if(o){for(var m=0;m<o.childCount;m++)h.push(o.child(m));v=v.matchFragment(o)}for(var g=u.size+e-(c.content.size-c.openEnd);f<u.childCount;){var b=u.child(f),w=v.matchType(b.type);if(!w)break;(++f>1||0==l||b.content.size)&&(v=w,h.push(Xt(b.mark(y.allowedMarks(b.marks)),1==f?l:0,f==u.childCount?g:-1)))}var k=f==u.childCount;k||(g=-1),this.placed=Gt(this.placed,n,s.from(h)),this.frontier[n].match=v,k&&g<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var x=0,S=u;x<g;x++){var O=S.lastChild;this.frontier.push({type:O.type,match:O.contentMatchAt(O.childCount)}),S=O.content}this.unplaced=k?0==e?p.empty:new p(Yt(c.content,e-1,1),e-1,g<0?c.openEnd:e-1):new p(Yt(c.content,e,f),c.openStart,c.openEnd)},Ht.prototype.mustMoveInline=function(){if(!this.$to.parent.isTextblock||this.$to.end()==this.$to.pos)return-1;var t,e=this.frontier[this.depth];if(!e.type.isTextblock||!Zt(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;for(var n=this.$to.depth,r=this.$to.after(n);n>1&&r==this.$to.end(--n);)++r;return r},Ht.prototype.findCloseLevel=function(t){t:for(var e=Math.min(this.depth,t.depth);e>=0;e--){var n=this.frontier[e],r=n.match,o=n.type,i=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),s=Zt(t,e,o,r,i);if(s){for(var a=e-1;a>=0;a--){var c=this.frontier[a],u=c.match,l=Zt(t,a,c.type,u,!0);if(!l||l.childCount)continue t}return{depth:e,fit:s,move:i?t.doc.resolve(t.after(e+1)):t}}}},Ht.prototype.close=function(t){var e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=Gt(this.placed,e.depth,e.fit)),t=e.move;for(var n=e.depth+1;n<=t.depth;n++){var r=t.node(n),o=r.type.contentMatch.fillBefore(r.content,!0,t.index(n));this.openFrontierNode(r.type,r.attrs,o)}return t},Ht.prototype.openFrontierNode=function(t,e,n){var r=this.frontier[this.depth];r.match=r.match.matchType(t),this.placed=Gt(this.placed,this.depth,s.from(t.create(e,n))),this.frontier.push({type:t,match:t.contentMatch})},Ht.prototype.closeFrontierNode=function(){var t=this.frontier.pop().match.fillBefore(s.empty,!0);t.childCount&&(this.placed=Gt(this.placed,this.frontier.length,t))},Object.defineProperties(Ht.prototype,Kt),Ct.prototype.replaceRange=function(t,e,n){if(!n.size)return this.deleteRange(t,e);var r=this.doc.resolve(t),o=this.doc.resolve(e);if(Wt(r,o,n))return this.step(new At(t,e,n));var i=ee(r,this.doc.resolve(e));0==i[i.length-1]&&i.pop();var s=-(r.depth+1);i.unshift(s);for(var a=r.depth,c=r.pos-1;a>0;a--,c--){var u=r.node(a).type.spec;if(u.defining||u.isolating)break;i.indexOf(a)>-1?s=a:r.before(a)==c&&i.splice(1,0,-a)}for(var l=i.indexOf(s),f=[],h=n.openStart,d=n.content,v=0;;v++){var y=d.firstChild;if(f.push(y),v==n.openStart)break;d=y.content}h>0&&f[h-1].type.spec.defining&&r.node(l).type!=f[h-1].type?h-=1:h>=2&&f[h-1].isTextblock&&f[h-2].type.spec.defining&&r.node(l).type!=f[h-2].type&&(h-=2);for(var m=n.openStart;m>=0;m--){var g=(m+h+1)%(n.openStart+1),b=f[g];if(b)for(var w=0;w<i.length;w++){var k=i[(w+l)%i.length],x=!0;k<0&&(x=!1,k=-k);var S=r.node(k-1),O=r.index(k-1);if(S.canReplaceWith(O,O,b.type,b.marks))return this.replace(r.before(k),x?o.after(k):e,new p(te(n.content,0,n.openStart,g),g,n.openEnd))}}for(var C=this.steps.length,E=i.length-1;E>=0&&(this.replace(t,e,n),!(this.steps.length>C));E--){var _=i[E];E<0||(t=r.before(_),e=o.after(_))}return this},Ct.prototype.replaceRangeWith=function(t,e,n){if(!n.isInline&&t==e&&this.doc.resolve(t).parent.content.size){var r=function(t,e,n){var r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(0==r.parentOffset)for(var o=r.depth-1;o>=0;o--){var i=r.index(o);if(r.node(o).canReplaceWith(i,i,n))return r.before(o+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(var s=r.depth-1;s>=0;s--){var a=r.indexAfter(s);if(r.node(s).canReplaceWith(a,a,n))return r.after(s+1);if(a<r.node(s).childCount)return null}}(this.doc,t,n.type);null!=r&&(t=e=r)}return this.replaceRange(t,e,new p(s.from(n),0,0))},Ct.prototype.deleteRange=function(t,e){for(var n=this.doc.resolve(t),r=this.doc.resolve(e),o=ee(n,r),i=0;i<o.length;i++){var s=o[i],a=i==o.length-1;if(a&&0==s||n.node(s).type.contentMatch.validEnd)return this.delete(n.start(s),r.end(s));if(s>0&&(a||n.node(s-1).canReplace(n.index(s-1),r.indexAfter(s-1))))return this.delete(n.before(s),r.after(s))}for(var c=1;c<=n.depth&&c<=r.depth;c++)if(t-n.start(c)==n.depth-c&&e>n.end(c)&&r.end(c)-e!=r.depth-c)return this.delete(n.before(c),e);return this.delete(t,e)}},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}n.d(e,"a",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return pn})),n.d(e,"b",(function(){return yn})),n.d(e,"c",(function(){return Cn})),n.d(e,"d",(function(){return H})),n.d(e,"e",(function(){return Nn})),n.d(e,"f",(function(){return Ct})),n.d(e,"g",(function(){return It})),n.d(e,"h",(function(){return Ze})),n.d(e,"i",(function(){return re})),n.d(e,"j",(function(){return nn})),n.d(e,"k",(function(){return en})),n.d(e,"l",(function(){return sn})),n.d(e,"m",(function(){return at})),n.d(e,"n",(function(){return At})),n.d(e,"o",(function(){return Nt})),n.d(e,"p",(function(){return $})),n.d(e,"q",(function(){return xt})),n.d(e,"r",(function(){return Et})),n.d(e,"s",(function(){return Tt})),n.d(e,"t",(function(){return jt})),n.d(e,"u",(function(){return ut})),n.d(e,"v",(function(){return dt})),n.d(e,"w",(function(){return St})),n.d(e,"x",(function(){return z})),n.d(e,"y",(function(){return Ot})),n.d(e,"z",(function(){return P})),n.d(e,"A",(function(){return Dt})),n.d(e,"B",(function(){return Oe}));var r=n(28),o=n(17),i=n(23),s=n(27),a=n(25),c=n(18),u=n(30),l=n(5),f=n(24),h=n(22),p=n(3),d=n(11),v=n(10),y=n(40),m=n(41),g=n(9),b=n(13),w=n(0),k=n(2),x=n(50),S=n(31),O=n(15),C=n(7),E=n(35),_=n(44),M=n(19),T=n(26),N=function(t){var e;return e={},Object(o.a)(e,Symbol.iterator,(function(){return this})),Object(o.a)(e,"next",t),e},A=function(t,e){return N((function(){var n=t.next(),r=n.done,o=n.value;return{done:r,value:r?void 0:e(o)}}))},I=n(46),j=i.mark(oe),D=(y.a,function t(e,n){Object(p.a)(this,t),this.clock=e,this.len=n}),R=function t(){Object(p.a)(this,t),this.clients=new Map},P=function(t,e,n){return e.clients.forEach((function(e,r){for(var o=t.doc.store.clients.get(r),i=0;i<e.length;i++){var s=e[i];Wt(t,o,s.clock,s.len,n)}}))},z=function(t,e){var n=t.clients.get(e.client);return void 0!==n&&null!==function(t,e){for(var n=0,r=t.length-1;n<=r;){var o=Object(g.c)((n+r)/2),i=t[o],s=i.clock;if(s<=e){if(e<s+i.len)return o;n=o+1}else r=o-1}return null}(n,e.clock)},F=function(t){t.clients.forEach((function(t){var e,n;for(t.sort((function(t,e){return t.clock-e.clock})),e=1,n=1;e<t.length;e++){var r=t[n-1],o=t[e];r.clock+r.len>=o.clock?r.len=Object(g.f)(r.len,o.clock+o.len-r.clock):(n<e&&(t[n]=o),n++)}t.length=n}))},B=function(t){for(var e=new R,n=function(n){t[n].clients.forEach((function(r,o){if(!e.clients.has(o)){for(var i=r.slice(),s=n+1;s<t.length;s++)Object(m.a)(i,t[s].clients.get(o)||[]);e.clients.set(o,i)}}))},r=0;r<t.length;r++)n(r);return F(e),e},L=function(t,e,n,r){Object(b.e)(t.clients,e,(function(){return[]})).push(new D(n,r))},$=function(){return new R},q=function(t){var e=$();return t.clients.forEach((function(t,n){for(var r=[],o=0;o<t.length;o++){var i=t[o];if(i.deleted){var s=i.id.clock,a=i.length;if(o+1<t.length)for(var c=t[o+1];o+1<t.length&&c.id.clock===s+a&&c.deleted;c=t[1+ ++o])a+=c.length;r.push(new D(s,a))}}r.length>0&&e.clients.set(n,r)})),e},J=function(t,e){Object(w.m)(t.restEncoder,e.clients.size),e.clients.forEach((function(e,n){t.resetDsCurVal(),Object(w.m)(t.restEncoder,n);var r=e.length;Object(w.m)(t.restEncoder,r);for(var o=0;o<r;o++){var i=e[o];t.writeDsClock(i.clock),t.writeDsLen(i.len)}}))},U=function(t){for(var e=new R,n=Object(k.k)(t.restDecoder),r=0;r<n;r++){t.resetDsCurVal();var o=Object(k.k)(t.restDecoder),i=Object(k.k)(t.restDecoder);if(i>0)for(var s=Object(b.e)(e.clients,o,(function(){return[]})),a=0;a<i;a++)s.push(new D(t.readDsClock(),t.readDsLen()))}return e},V=function(t,e,n){for(var r=new R,o=Object(k.k)(t.restDecoder),i=0;i<o;i++){t.resetDsCurVal();for(var s=Object(k.k)(t.restDecoder),a=Object(k.k)(t.restDecoder),c=n.clients.get(s)||[],u=Bt(n,s),l=0;l<a;l++){var f=t.readDsClock(),h=f+t.readDsLen();if(f<u){u<h&&L(r,s,u,h-u);var p=$t(c,f),d=c[p];for(!d.deleted&&d.id.clock<f&&(c.splice(p+1,0,Mn(e,d,f-d.id.clock)),p++);p<c.length&&(d=c[p++]).id.clock<h;)d.deleted||(h<d.id.clock+d.length&&c.splice(p,0,Mn(e,d,h-d.id.clock)),d.delete(e))}else L(r,s,f,h-f)}}if(r.clients.size>0){var v=new et;return Object(w.m)(v.restEncoder,0),J(v,r),v.toUint8Array()}return null},W=x.c,H=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=r.guid,i=void 0===o?Object(x.d)():o,s=r.gc,a=void 0===s||s,c=r.gcFilter,u=void 0===c?function(){return!0}:c,l=r.meta,f=void 0===l?null:l,h=r.autoLoad,d=void 0!==h&&h;return Object(p.a)(this,n),(t=e.call(this)).gc=a,t.gcFilter=u,t.clientID=W(),t.guid=i,t.share=new Map,t.store=new zt,t._transaction=null,t._transactionCleanups=[],t.subdocs=new Set,t._item=null,t.shouldLoad=d,t.autoLoad=d,t.meta=f,t}return Object(l.a)(n,[{key:"load",value:function(){var t=this,e=this._item;null===e||this.shouldLoad||te(e.parent.doc,(function(e){e.subdocsLoaded.add(t)}),null,!0),this.shouldLoad=!0}},{key:"getSubdocs",value:function(){return this.subdocs}},{key:"getSubdocGuids",value:function(){return new Set(Array.from(this.subdocs).map((function(t){return t.guid})))}},{key:"transact",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;te(this,t,e)}},{key:"get",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ke,r=Object(b.e)(this.share,t,(function(){var t=new n;return t._integrate(e,null),t})),o=r.constructor;if(n!==ke&&o!==n){if(o===ke){var i=new n;i._map=r._map,r._map.forEach((function(t){for(;null!==t;t=t.left)t.parent=i})),i._start=r._start;for(var s=i._start;null!==s;s=s.right)s.parent=i;return i._length=r._length,this.share.set(t,i),i._integrate(this,null),i}throw new Error("Type with the name ".concat(t," has already been defined with a different constructor"))}return r}},{key:"getArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(t,ze)}},{key:"getText",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(t,Ze)}},{key:"getMap",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(t,Be)}},{key:"getXmlFragment",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(t,en)}},{key:"toJSON",value:function(){var t={};return this.share.forEach((function(e,n){t[n]=e.toJSON()})),t}},{key:"destroy",value:function(){var t=this;Object(m.c)(this.subdocs).forEach((function(t){return t.destroy()}));var e=this._item;if(null!==e){this._item=null;var r=e.content;e.deleted?r.doc=null:(r.doc=new n(Object(u.a)({guid:this.guid},r.opts)),r.doc._item=e),te(e.parent.doc,(function(n){e.deleted||n.subdocsAdded.add(r.doc),n.subdocsRemoved.add(t)}),null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),Object(f.a)(Object(h.a)(n.prototype),"destroy",this).call(this)}},{key:"on",value:function(t,e){Object(f.a)(Object(h.a)(n.prototype),"on",this).call(this,t,e)}},{key:"off",value:function(t,e){Object(f.a)(Object(h.a)(n.prototype),"off",this).call(this,t,e)}}]),n}(y.a),K=function(){function t(e){Object(p.a)(this,t),this.restDecoder=e}return Object(l.a)(t,[{key:"resetDsCurVal",value:function(){}},{key:"readDsClock",value:function(){return Object(k.k)(this.restDecoder)}},{key:"readDsLen",value:function(){return Object(k.k)(this.restDecoder)}}]),t}(),Y=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(){return Object(p.a)(this,n),e.apply(this,arguments)}return Object(l.a)(n,[{key:"readLeftID",value:function(){return xt(Object(k.k)(this.restDecoder),Object(k.k)(this.restDecoder))}},{key:"readRightID",value:function(){return xt(Object(k.k)(this.restDecoder),Object(k.k)(this.restDecoder))}},{key:"readClient",value:function(){return Object(k.k)(this.restDecoder)}},{key:"readInfo",value:function(){return Object(k.h)(this.restDecoder)}},{key:"readString",value:function(){return Object(k.j)(this.restDecoder)}},{key:"readParentInfo",value:function(){return 1===Object(k.k)(this.restDecoder)}},{key:"readTypeRef",value:function(){return Object(k.k)(this.restDecoder)}},{key:"readLen",value:function(){return Object(k.k)(this.restDecoder)}},{key:"readAny",value:function(){return Object(k.g)(this.restDecoder)}},{key:"readBuf",value:function(){return Object(S.a)(Object(k.l)(this.restDecoder))}},{key:"readJSON",value:function(){return JSON.parse(Object(k.j)(this.restDecoder))}},{key:"readKey",value:function(){return Object(k.j)(this.restDecoder)}}]),n}(K),G=function(){function t(e){Object(p.a)(this,t),this.dsCurrVal=0,this.restDecoder=e}return Object(l.a)(t,[{key:"resetDsCurVal",value:function(){this.dsCurrVal=0}},{key:"readDsClock",value:function(){return this.dsCurrVal+=Object(k.k)(this.restDecoder),this.dsCurrVal}},{key:"readDsLen",value:function(){var t=Object(k.k)(this.restDecoder)+1;return this.dsCurrVal+=t,t}}]),t}(),Q=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(t){var r;return Object(p.a)(this,n),(r=e.call(this,t)).keys=[],Object(k.k)(t),r.keyClockDecoder=new k.a(Object(k.l)(t)),r.clientDecoder=new k.d(Object(k.l)(t)),r.leftClockDecoder=new k.a(Object(k.l)(t)),r.rightClockDecoder=new k.a(Object(k.l)(t)),r.infoDecoder=new k.b(Object(k.l)(t),k.h),r.stringDecoder=new k.c(Object(k.l)(t)),r.parentInfoDecoder=new k.b(Object(k.l)(t),k.h),r.typeRefDecoder=new k.d(Object(k.l)(t)),r.lenDecoder=new k.d(Object(k.l)(t)),r}return Object(l.a)(n,[{key:"readLeftID",value:function(){return new wt(this.clientDecoder.read(),this.leftClockDecoder.read())}},{key:"readRightID",value:function(){return new wt(this.clientDecoder.read(),this.rightClockDecoder.read())}},{key:"readClient",value:function(){return this.clientDecoder.read()}},{key:"readInfo",value:function(){return this.infoDecoder.read()}},{key:"readString",value:function(){return this.stringDecoder.read()}},{key:"readParentInfo",value:function(){return 1===this.parentInfoDecoder.read()}},{key:"readTypeRef",value:function(){return this.typeRefDecoder.read()}},{key:"readLen",value:function(){return this.lenDecoder.read()}},{key:"readAny",value:function(){return Object(k.g)(this.restDecoder)}},{key:"readBuf",value:function(){return Object(k.l)(this.restDecoder)}},{key:"readJSON",value:function(){return Object(k.g)(this.restDecoder)}},{key:"readKey",value:function(){var t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];var e=this.stringDecoder.read();return this.keys.push(e),e}}]),n}(G),X=function(){function t(){Object(p.a)(this,t),this.restEncoder=Object(w.e)()}return Object(l.a)(t,[{key:"toUint8Array",value:function(){return Object(w.f)(this.restEncoder)}},{key:"resetDsCurVal",value:function(){}},{key:"writeDsClock",value:function(t){Object(w.m)(this.restEncoder,t)}},{key:"writeDsLen",value:function(t){Object(w.m)(this.restEncoder,t)}}]),t}(),Z=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(){return Object(p.a)(this,n),e.apply(this,arguments)}return Object(l.a)(n,[{key:"writeLeftID",value:function(t){Object(w.m)(this.restEncoder,t.client),Object(w.m)(this.restEncoder,t.clock)}},{key:"writeRightID",value:function(t){Object(w.m)(this.restEncoder,t.client),Object(w.m)(this.restEncoder,t.clock)}},{key:"writeClient",value:function(t){Object(w.m)(this.restEncoder,t)}},{key:"writeInfo",value:function(t){Object(w.i)(this.restEncoder,t)}},{key:"writeString",value:function(t){Object(w.l)(this.restEncoder,t)}},{key:"writeParentInfo",value:function(t){Object(w.m)(this.restEncoder,t?1:0)}},{key:"writeTypeRef",value:function(t){Object(w.m)(this.restEncoder,t)}},{key:"writeLen",value:function(t){Object(w.m)(this.restEncoder,t)}},{key:"writeAny",value:function(t){Object(w.g)(this.restEncoder,t)}},{key:"writeBuf",value:function(t){Object(w.n)(this.restEncoder,t)}},{key:"writeJSON",value:function(t){Object(w.l)(this.restEncoder,JSON.stringify(t))}},{key:"writeKey",value:function(t){Object(w.l)(this.restEncoder,t)}}]),n}(X),tt=function(){function t(){Object(p.a)(this,t),this.restEncoder=Object(w.e)(),this.dsCurrVal=0}return Object(l.a)(t,[{key:"toUint8Array",value:function(){return Object(w.f)(this.restEncoder)}},{key:"resetDsCurVal",value:function(){this.dsCurrVal=0}},{key:"writeDsClock",value:function(t){var e=t-this.dsCurrVal;this.dsCurrVal=t,Object(w.m)(this.restEncoder,e)}},{key:"writeDsLen",value:function(t){0===t&&Object(O.c)(),Object(w.m)(this.restEncoder,t-1),this.dsCurrVal+=t}}]),t}(),et=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(p.a)(this,n),(t=e.call(this)).keyMap=new Map,t.keyClock=0,t.keyClockEncoder=new w.a,t.clientEncoder=new w.d,t.leftClockEncoder=new w.a,t.rightClockEncoder=new w.a,t.infoEncoder=new w.b(w.i),t.stringEncoder=new w.c,t.parentInfoEncoder=new w.b(w.i),t.typeRefEncoder=new w.d,t.lenEncoder=new w.d,t}return Object(l.a)(n,[{key:"toUint8Array",value:function(){var t=Object(w.e)();return Object(w.m)(t,0),Object(w.n)(t,this.keyClockEncoder.toUint8Array()),Object(w.n)(t,this.clientEncoder.toUint8Array()),Object(w.n)(t,this.leftClockEncoder.toUint8Array()),Object(w.n)(t,this.rightClockEncoder.toUint8Array()),Object(w.n)(t,Object(w.f)(this.infoEncoder)),Object(w.n)(t,this.stringEncoder.toUint8Array()),Object(w.n)(t,Object(w.f)(this.parentInfoEncoder)),Object(w.n)(t,this.typeRefEncoder.toUint8Array()),Object(w.n)(t,this.lenEncoder.toUint8Array()),Object(w.j)(t,Object(w.f)(this.restEncoder)),Object(w.f)(t)}},{key:"writeLeftID",value:function(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}},{key:"writeRightID",value:function(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}},{key:"writeClient",value:function(t){this.clientEncoder.write(t)}},{key:"writeInfo",value:function(t){this.infoEncoder.write(t)}},{key:"writeString",value:function(t){this.stringEncoder.write(t)}},{key:"writeParentInfo",value:function(t){this.parentInfoEncoder.write(t?1:0)}},{key:"writeTypeRef",value:function(t){this.typeRefEncoder.write(t)}},{key:"writeLen",value:function(t){this.lenEncoder.write(t)}},{key:"writeAny",value:function(t){Object(w.g)(this.restEncoder,t)}},{key:"writeBuf",value:function(t){Object(w.n)(this.restEncoder,t)}},{key:"writeJSON",value:function(t){Object(w.g)(this.restEncoder,t)}},{key:"writeKey",value:function(t){void 0===this.keyMap.get(t)?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(this.keyClock++)}}]),n}(tt),nt=function(t,e,n){var r=new Map;n.forEach((function(t,n){Bt(e,n)>t&&r.set(n,t)})),Ft(e).forEach((function(t,e){n.has(e)||r.set(e,0)})),Object(w.m)(t.restEncoder,r.size),Array.from(r.entries()).sort((function(t,e){return e[0]-t[0]})).forEach((function(n){var r=Object(c.a)(n,2),o=r[0],i=r[1];!function(t,e,n,r){r=Object(g.f)(r,e[0].id.clock);var o=$t(e,r);Object(w.m)(t.restEncoder,e.length-o),t.writeClient(n),Object(w.m)(t.restEncoder,r);var i=e[o];i.write(t,r-i.id.clock);for(var s=o+1;s<e.length;s++)e[s].write(t,0)}(t,e.clients.get(o),o,i)}))},rt=function(t,e){for(var n=Object(b.c)(),r=Object(k.k)(t.restDecoder),o=0;o<r;o++){var i=Object(k.k)(t.restDecoder),s=new Array(i),a=t.readClient(),c=Object(k.k)(t.restDecoder);n.set(a,{i:0,refs:s});for(var u=0;u<i;u++){var l=t.readInfo();switch(C.i&l){case 0:var f=t.readLen();s[u]=new cn(xt(a,c),f),c+=f;break;case 10:var h=Object(k.k)(t.restDecoder);s[u]=new jn(xt(a,c),h),c+=h;break;default:var p=0===(l&(C.f|C.g)),d=new Nn(xt(a,c),null,(l&C.g)===C.g?t.readLeftID():null,null,(l&C.f)===C.f?t.readRightID():null,p?t.readParentInfo()?e.get(t.readString()):t.readLeftID():null,p&&(l&C.e)===C.e?t.readString():null,An(t,l));s[u]=d,c+=d.length}}}return n},ot=function(t,e,n){var r=[],o=Array.from(n.keys()).sort((function(t,e){return t-e}));if(0===o.length)return null;var i=function(){if(0===o.length)return null;for(var t=n.get(o[o.length-1]);t.refs.length===t.i;){if(o.pop(),!(o.length>0))return null;t=n.get(o[o.length-1])}return t},s=i();if(null===s&&0===r.length)return null;for(var c=new zt,u=new Map,l=function(t,e){var n=u.get(t);(null==n||n>e)&&u.set(t,e)},f=s.refs[s.i++],h=new Map,p=function(){var t,e=Object(a.a)(r);try{var i=function(){var e=t.value,r=e.id.client,i=n.get(r);i?(i.i--,c.clients.set(r,i.refs.slice(i.i)),n.delete(r),i.i=0,i.refs=[]):c.clients.set(r,[e]),o=o.filter((function(t){return t!==r}))};for(e.s();!(t=e.n()).done;)i()}catch(s){e.e(s)}finally{e.f()}r.length=0};;){if(f.constructor!==jn){var d=Object(b.e)(h,f.id.client,(function(){return Bt(e,f.id.client)}))-f.id.clock;if(d<0)r.push(f),l(f.id.client,f.id.clock-1),p();else{var v=f.getMissing(t,e);if(null!==v){r.push(f);var y=n.get(v)||{refs:[],i:0};if(y.refs.length!==y.i){f=y.refs[y.i++];continue}l(v,Bt(e,v)),p()}else(0===d||d<f.length)&&(f.integrate(t,d),h.set(f.id.client,f.id.clock+f.length))}}if(r.length>0)f=r.pop();else if(null!==s&&s.i<s.refs.length)f=s.refs[s.i++];else{if(null===(s=i()))break;f=s.refs[s.i++]}}if(c.clients.size>0){var m=new et;return nt(m,c,new Map),Object(w.m)(m.restEncoder,0),{missing:u,update:m.toUint8Array()}}return null},it=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Q(t);return te(e,(function(t){var e=!1,n=t.doc,o=n.store,i=rt(r,n),s=ot(t,o,i),u=o.pendingStructs;if(u){var l,f=Object(a.a)(u.missing);try{for(f.s();!(l=f.n()).done;){var h=Object(c.a)(l.value,2),p=h[0];if(h[1]<Bt(o,p)){e=!0;break}}}catch(C){f.e(C)}finally{f.f()}if(s){var d,v=Object(a.a)(s.missing);try{for(v.s();!(d=v.n()).done;){var y=Object(c.a)(d.value,2),m=y[0],g=y[1],b=u.missing.get(m);(null==b||b>g)&&u.missing.set(m,g)}}catch(C){v.e(C)}finally{v.f()}u.update=ce([u.update,s.update])}}else o.pendingStructs=s;var w=V(r,t,o);if(o.pendingDs){var x=new Q(Object(k.e)(o.pendingDs));Object(k.k)(x.restDecoder);var S=V(x,t,o);o.pendingDs=w&&S?ce([w,S]):w||S}else o.pendingDs=w;if(e){var O=o.pendingStructs.update;o.pendingStructs=null,st(t.doc,O)}}),n,!1)},st=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Q,o=Object(k.e)(e);it(o,t,n,new r(o))},at=function(t,e,n){return st(t,e,n,Y)},ct=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;nt(t,e.store,n),J(t,q(e.store))},ut=function(t,e){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint8Array([0]),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new et,r=ft(e);ct(n,t,r);var o=[n.toUint8Array()];return n.constructor===et&&(t.store.pendingDs&&o.push(t.store.pendingDs),t.store.pendingStructs&&o.push(ue(t.store.pendingStructs.update,e)),o.length>1)?ce(o):o[0]}(t,e,new Z)},lt=function(t){for(var e=new Map,n=Object(k.k)(t.restDecoder),r=0;r<n;r++){var o=Object(k.k)(t.restDecoder),i=Object(k.k)(t.restDecoder);e.set(o,i)}return e},ft=function(t){return lt(new K(Object(k.e)(t)))},ht=function(t,e){return Object(w.m)(t.restEncoder,e.size),e.forEach((function(e,n){Object(w.m)(t.restEncoder,n),Object(w.m)(t.restEncoder,e)})),t},pt=function(t,e){return ht(t,Ft(e.store))},dt=function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new tt;return t instanceof Map?ht(e,t):pt(e,t),e.toUint8Array()}(t,new X)},vt=function t(){Object(p.a)(this,t),this.l=[]},yt=function(){return new vt},mt=function(t,e){return t.l.push(e)},gt=function(t,e){var n=t.l,r=n.length;t.l=n.filter((function(t){return e!==t})),r===t.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},bt=function(t,e,n){return Object(E.a)(t.l,[e,n])},wt=function t(e,n){Object(p.a)(this,t),this.client=e,this.clock=n},kt=function(t,e){return t===e||null!==t&&null!==e&&t.client===e.client&&t.clock===e.clock},xt=function(t,e){return new wt(t,e)},St=function(t){var e,n=Object(a.a)(t.doc.share.entries());try{for(n.s();!(e=n.n()).done;){var r=Object(c.a)(e.value,2),o=r[0];if(r[1]===t)return o}}catch(i){n.e(i)}finally{n.f()}throw Object(O.c)()},Ot=function(t,e){for(;null!==e;){if(e.parent===t)return!0;e=e.parent._item}return!1},Ct=function t(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Object(p.a)(this,t),this.type=e,this.tname=n,this.item=r,this.assoc=o},Et=function(t){return new Ct(null==t.type?null:xt(t.type.client,t.type.clock),t.tname||null,null==t.item?null:xt(t.item.client,t.item.clock),null==t.assoc?0:t.assoc)},_t=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(p.a)(this,t),this.type=e,this.index=n,this.assoc=r},Mt=function(t,e,n){var r=null,o=null;return null===t._item?o=St(t):r=xt(t._item.id.client,t._item.id.clock),new Ct(r,o,e,n)},Tt=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=t._start;if(n<0){if(0===e)return Mt(t,null,n);e--}for(;null!==r;){if(!r.deleted&&r.countable){if(r.length>e)return Mt(t,xt(r.id.client,r.id.clock+e),n);e-=r.length}if(null===r.right&&n<0)return Mt(t,r.lastId,n);r=r.right}return Mt(t,null,n)},Nt=function(t,e){var n=e.store,r=t.item,o=t.type,i=t.tname,s=t.assoc,a=null,c=0;if(null!==r){if(Bt(n,r.client)<=r.clock)return null;var u=En(n,r),l=u.item;if(!(l instanceof Nn))return null;if(null===(a=l.parent)._item||!a._item.deleted){c=l.deleted||!l.countable?0:u.diff+(s>=0?0:1);for(var f=l.left;null!==f;)!f.deleted&&f.countable&&(c+=f.length),f=f.left}}else{if(null!==i)a=e.get(i);else{if(null===o)throw Object(O.c)();if(Bt(n,o.client)<=o.clock)return null;var h=En(n,o).item;if(!(h instanceof Nn&&h.content instanceof Cn))return null;a=h.content.type}c=s>=0?a._length:0}return function(t,e){return new _t(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)}(a,c,t.assoc)},At=function(t,e){return t===e||null!==t&&null!==e&&t.tname===e.tname&&kt(t.item,e.item)&&kt(t.type,e.type)&&t.assoc===e.assoc},It=function t(e,n){Object(p.a)(this,t),this.ds=e,this.sv=n},jt=function(t,e){return new It(t,e)},Dt=(jt($(),new Map),function(t){return jt(q(t.store),Ft(t.store))}),Rt=function(t,e){return void 0===e?!t.deleted:e.sv.has(t.id.client)&&(e.sv.get(t.id.client)||0)>t.id.clock&&!z(e.ds,t.id)},Pt=function t(e,n){var r=Object(b.e)(e.meta,t,_.a),o=e.doc.store;r.has(n)||(n.sv.forEach((function(t,n){t<Bt(o,n)&&Ut(e,xt(n,t))})),P(e,n.ds,(function(t){})),r.add(n))},zt=function t(){Object(p.a)(this,t),this.clients=new Map,this.pendingStructs=null,this.pendingDs=null},Ft=function(t){var e=new Map;return t.clients.forEach((function(t,n){var r=t[t.length-1];e.set(n,r.id.clock+r.length)})),e},Bt=function(t,e){var n=t.clients.get(e);if(void 0===n)return 0;var r=n[n.length-1];return r.id.clock+r.length},Lt=function(t,e){var n=t.clients.get(e.id.client);if(void 0===n)n=[],t.clients.set(e.id.client,n);else{var r=n[n.length-1];if(r.id.clock+r.length!==e.id.clock)throw Object(O.c)()}n.push(e)},$t=function(t,e){var n=0,r=t.length-1,o=t[r],i=o.id.clock;if(i===e)return r;for(var s=Object(g.c)(e/(i+o.length-1)*r);n<=r;){if((i=(o=t[s]).id.clock)<=e){if(e<i+o.length)return s;n=s+1}else r=s-1;s=Object(g.c)((n+r)/2)}throw Object(O.c)()},qt=function(t,e){var n=t.clients.get(e.client);return n[$t(n,e.clock)]},Jt=function(t,e,n){var r=$t(e,n),o=e[r];return o.id.clock<n&&o instanceof Nn?(e.splice(r+1,0,Mn(t,o,n-o.id.clock)),r+1):r},Ut=function(t,e){var n=t.doc.store.clients.get(e.client);return n[Jt(t,n,e.clock)]},Vt=function(t,e,n){var r=e.clients.get(n.client),o=$t(r,n.clock),i=r[o];return n.clock!==i.id.clock+i.length-1&&i.constructor!==cn&&r.splice(o+1,0,Mn(t,i,n.clock-i.id.clock+1)),i},Wt=function(t,e,n,r,o){if(0!==r){var i,s=n+r,a=Jt(t,e,n);do{s<(i=e[a++]).id.clock+i.length&&Jt(t,e,s),o(i)}while(a<e.length&&e[a].id.clock<s)}},Ht=function t(e,n,r){Object(p.a)(this,t),this.doc=e,this.deleteSet=new R,this.beforeState=Ft(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set},Kt=function(t,e){return!(0===e.deleteSet.clients.size&&!Object(b.a)(e.afterState,(function(t,n){return e.beforeState.get(n)!==t})))&&(F(e.deleteSet),function(t,e){nt(t,e.doc.store,e.beforeState)}(t,e),J(t,e.deleteSet),!0)},Yt=function(t,e,n){var r=e._item;(null===r||r.id.clock<(t.beforeState.get(r.id.client)||0)&&!r.deleted)&&Object(b.e)(t.changed,e,_.a).add(n)},Gt=function(t,e){var n=t[e-1],r=t[e];n.deleted===r.deleted&&n.constructor===r.constructor&&n.mergeWith(r)&&(t.splice(e,1),r instanceof Nn&&null!==r.parentSub&&r.parent._map.get(r.parentSub)===r&&r.parent._map.set(r.parentSub,n))},Qt=function(t,e,n){var r,o=Object(a.a)(t.clients.entries());try{for(o.s();!(r=o.n()).done;)for(var i=Object(c.a)(r.value,2),s=i[0],u=i[1],l=e.clients.get(s),f=u.length-1;f>=0;f--)for(var h=u[f],p=h.clock+h.len,d=$t(l,h.clock),v=l[d];d<l.length&&v.id.clock<p;v=l[++d]){var y=l[d];if(h.clock+h.len<=y.id.clock)break;y instanceof Nn&&y.deleted&&!y.keep&&n(y)&&y.gc(e,!1)}}catch(m){o.e(m)}finally{o.f()}},Xt=function(t,e){t.clients.forEach((function(t,n){for(var r=e.clients.get(n),o=t.length-1;o>=0;o--)for(var i=t[o],s=Object(g.g)(r.length-1,1+$t(r,i.clock+i.len-1)),a=r[s];s>0&&a.id.clock>=i.clock;a=r[--s])Gt(r,s)}))},Zt=function t(e,n){if(n<e.length){var r=e[n],o=r.doc,i=o.store,s=r.deleteSet,a=r._mergeStructs;try{F(s),r.afterState=Ft(r.doc.store),o._transaction=null,o.emit("beforeObserverCalls",[r,o]);var c=[];r.changed.forEach((function(t,e){return c.push((function(){null!==e._item&&e._item.deleted||e._callObserver(r,t)}))})),c.push((function(){r.changedParentTypes.forEach((function(t,e){return c.push((function(){null!==e._item&&e._item.deleted||((t=t.filter((function(t){return null===t.target._item||!t.target._item.deleted}))).forEach((function(t){t.currentTarget=e})),t.sort((function(t,e){return t.path.length-e.path.length})),bt(e._dEH,t,r))}))})),c.push((function(){return o.emit("afterTransaction",[r,o])}))})),Object(E.a)(c,[])}finally{o.gc&&Qt(s,i,o.gcFilter),Xt(s,i),r.afterState.forEach((function(t,e){var n=r.beforeState.get(e)||0;if(n!==t)for(var o=i.clients.get(e),s=Object(g.f)($t(o,n),1),a=o.length-1;a>=s;a--)Gt(o,a)}));for(var u=0;u<a.length;u++){var l=a[u].id,f=l.client,h=l.clock,p=i.clients.get(f),d=$t(p,h);d+1<p.length&&Gt(p,d+1),d>0&&Gt(p,d)}if(r.local||r.afterState.get(o.clientID)===r.beforeState.get(o.clientID)||(o.clientID=W(),Object(M.h)(M.c,M.a,"[yjs] ",M.e,M.d,"Changed the client-id because another client seems to be using it.")),o.emit("afterTransactionCleanup",[r,o]),o._observers.has("update")){var v=new Z;Kt(v,r)&&o.emit("update",[v.toUint8Array(),r.origin,o,r])}if(o._observers.has("updateV2")){var y=new et;Kt(y,r)&&o.emit("updateV2",[y.toUint8Array(),r.origin,o,r])}r.subdocsAdded.forEach((function(t){return o.subdocs.add(t)})),r.subdocsRemoved.forEach((function(t){return o.subdocs.delete(t)})),o.emit("subdocs",[{loaded:r.subdocsLoaded,added:r.subdocsAdded,removed:r.subdocsRemoved}]),r.subdocsRemoved.forEach((function(t){return t.destroy()})),e.length<=n+1?(o._transactionCleanups=[],o.emit("afterAllTransactions",[o,e])):t(e,n+1)}}},te=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=t._transactionCleanups,i=!1;null===t._transaction&&(i=!0,t._transaction=new Ht(t,n,r),o.push(t._transaction),1===o.length&&t.emit("beforeAllTransactions",[t]),t.emit("beforeTransaction",[t._transaction,t]));try{e(t._transaction)}finally{i&&o[0]===t._transaction&&Zt(o,0)}},ee=function t(e,n,r){Object(p.a)(this,t),this.ds=e,this.beforeState=n,this.afterState=r,this.meta=new Map},ne=function(t,e,n){var r=null,o=null,i=t.doc,s=t.scope;if(te(i,(function(n){for(var a=function(){var o=i.store,a=e.pop(),c=new Set,u=[],l=!1;a.afterState.forEach((function(t,e){var r=a.beforeState.get(e)||0,c=t-r,l=o.clients.get(e);r!==t&&(Ut(n,xt(e,r)),t<Bt(i.store,e)&&Ut(n,xt(e,t)),Wt(n,l,r,c,(function(e){if(e instanceof Nn){if(null!==e.redone){var r=En(o,e.id),i=r.item,a=r.diff;a>0&&(i=Ut(n,xt(i.id.client,i.id.clock+a))),i.length>c&&Ut(n,xt(i.id.client,t)),e=i}!e.deleted&&s.some((function(t){return Ot(t,e)}))&&u.push(e)}})))})),P(n,a.ds,(function(t){var e=t.id,n=e.clock,r=e.client,o=a.beforeState.get(r)||0,i=a.afterState.get(r)||0;t instanceof Nn&&s.some((function(e){return Ot(e,t)}))&&!(n>=o&&n<i)&&c.add(t)})),c.forEach((function(t){l=null!==Tn(n,t,c)||l}));for(var f=u.length-1;f>=0;f--){var h=u[f];t.deleteFilter(h)&&(h.delete(n),l=!0)}r=a};e.length>0&&null===r;)a();n.changed.forEach((function(t,e){t.has(null)&&e._searchMarker&&(e._searchMarker.length=0)})),o=n}),t),null!=r){var a=o.changedParentTypes;t.emit("stack-item-popped",[{stackItem:r,type:n,changedParentTypes:a},t])}return r},re=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=o.captureTimeout,a=void 0===i?500:i,c=o.deleteFilter,u=void 0===c?function(){return!0}:c,l=o.trackedOrigins,f=void 0===l?new Set([null]):l;return Object(p.a)(this,n),(r=e.call(this)).scope=t instanceof Array?t:[t],r.deleteFilter=u,f.add(Object(s.a)(r)),r.trackedOrigins=f,r.undoStack=[],r.redoStack=[],r.undoing=!1,r.redoing=!1,r.doc=r.scope[0].doc,r.lastChange=0,r.doc.on("afterTransaction",(function(t){if(r.scope.some((function(e){return t.changedParentTypes.has(e)}))&&(r.trackedOrigins.has(t.origin)||t.origin&&r.trackedOrigins.has(t.origin.constructor))){var e=r.undoing,n=r.redoing,o=e?r.redoStack:r.undoStack;e?r.stopCapturing():n||(r.redoStack=[]);var i=t.beforeState,c=t.afterState,u=Object(T.a)();if(u-r.lastChange<a&&o.length>0&&!e&&!n){var l=o[o.length-1];l.ds=B([l.ds,t.deleteSet]),l.afterState=c}else o.push(new ee(t.deleteSet,i,c));e||n||(r.lastChange=u),P(t,t.deleteSet,(function(t){t instanceof Nn&&r.scope.some((function(e){return Ot(e,t)}))&&_n(t,!0)})),r.emit("stack-item-added",[{stackItem:o[o.length-1],origin:t.origin,type:e?"redo":"undo",changedParentTypes:t.changedParentTypes},Object(s.a)(r)])}})),r}return Object(l.a)(n,[{key:"clear",value:function(){var t=this;this.doc.transact((function(e){var n=function(n){P(e,n.ds,(function(e){e instanceof Nn&&t.scope.some((function(t){return Ot(t,e)}))&&_n(e,!1)}))};t.undoStack.forEach(n),t.redoStack.forEach(n)})),this.undoStack=[],this.redoStack=[]}},{key:"stopCapturing",value:function(){this.lastChange=0}},{key:"undo",value:function(){var t;this.undoing=!0;try{t=ne(this,this.undoStack,"undo")}finally{this.undoing=!1}return t}},{key:"redo",value:function(){var t;this.redoing=!0;try{t=ne(this,this.redoStack,"redo")}finally{this.redoing=!1}return t}}]),n}(y.a);function oe(t){var e,n,r,o,s,a,c,u,l,f,h;return i.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:e=Object(k.k)(t.restDecoder),n=0;case 2:if(!(n<e)){i.next=34;break}r=Object(k.k)(t.restDecoder),o=t.readClient(),s=Object(k.k)(t.restDecoder),a=0;case 7:if(!(a<r)){i.next=31;break}if(10!==(c=t.readInfo())){i.next=16;break}return u=Object(k.k)(t.restDecoder),i.next=13,new jn(xt(o,s),u);case 13:s+=u,i.next=28;break;case 16:if(0===(C.i&c)){i.next=24;break}return l=0===(c&(C.f|C.g)),f=new Nn(xt(o,s),null,(c&C.g)===C.g?t.readLeftID():null,null,(c&C.f)===C.f?t.readRightID():null,l?t.readParentInfo()?t.readString():t.readLeftID():null,l&&(c&C.e)===C.e?t.readString():null,An(t,c)),i.next=21,f;case 21:s+=f.length,i.next=28;break;case 24:return h=t.readLen(),i.next=27,new cn(xt(o,s),h);case 27:s+=h;case 28:a++,i.next=7;break;case 31:n++,i.next=2;break;case 34:case"end":return i.stop()}}),j)}var ie=function(){function t(e,n){Object(p.a)(this,t),this.gen=oe(e),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}return Object(l.a)(t,[{key:"next",value:function(){do{this.curr=this.gen.next().value||null}while(this.filterSkips&&null!==this.curr&&this.curr.constructor===jn);return this.curr}}]),t}(),se=function t(e){Object(p.a)(this,t),this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]},ae=function(t,e){if(t.constructor===cn){var n=t.id,r=n.client,o=n.clock;return new cn(xt(r,o+e),t.length-e)}if(t.constructor===jn){var i=t.id,s=i.client,a=i.clock;return new jn(xt(s,a+e),t.length-e)}var c=t,u=c.id,l=u.client,f=u.clock;return new Nn(xt(l,f+e),null,xt(l,f+e-1),null,c.rightOrigin,c.parent,c.parentSub,c.content.splice(e))},ce=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:et,r=t.map((function(t){return new e(Object(k.e)(t))})),o=r.map((function(t){return new ie(t,!0)})),i=null,s=new n,a=new se(s);(o=o.filter((function(t){return null!==t.curr}))).sort((function(t,e){if(t.curr.id.client===e.curr.id.client){var n=t.curr.id.clock-e.curr.id.clock;return 0===n?t.curr.constructor===e.curr.constructor?0:t.curr.constructor===jn?1:-1:n}return e.curr.id.client-t.curr.id.client})),0!==o.length;){var c=o[0],u=c.curr.id.client;if(null!==i){for(var l=c.curr;null!==l&&l.id.clock+l.length<=i.struct.id.clock+i.struct.length&&l.id.client>=i.struct.id.client;)l=c.next();if(null===l||l.id.client!==u)continue;if(u!==i.struct.id.client)fe(a,i.struct,i.offset),i={struct:l,offset:0},c.next();else if(i.struct.id.clock+i.struct.length<l.id.clock)if(i.struct.constructor===jn)i.struct.length=l.id.clock+l.length-i.struct.id.clock;else{fe(a,i.struct,i.offset);var f=l.id.clock-i.struct.id.clock-i.struct.length,h=new jn(xt(u,i.struct.id.clock+i.struct.length),f);i={struct:h,offset:0}}else{var p=i.struct.id.clock+i.struct.length-l.id.clock;p>0&&(i.struct.constructor===jn?i.struct.length-=p:l=ae(l,p)),i.struct.mergeWith(l)||(fe(a,i.struct,i.offset),i={struct:l,offset:0},c.next())}}else i={struct:c.curr,offset:0},c.next();for(var d=c.curr;null!==d&&d.id.client===u&&d.id.clock===i.struct.id.clock+i.struct.length&&d.constructor!==jn;d=c.next())fe(a,i.struct,i.offset),i={struct:d,offset:0}}null!==i&&(fe(a,i.struct,i.offset),i=null),he(a);var v=r.map((function(t){return U(t)})),y=B(v);return J(s,y),s.toUint8Array()},ue=function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Q,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:et,o=ft(e),i=new r,s=new se(i),a=new n(Object(k.e)(t)),c=new ie(a,!1);c.curr;){var u=c.curr,l=u.id.client,f=o.get(l)||0;if(c.curr.constructor!==jn)if(u.id.clock+u.length>f)for(fe(s,u,Object(g.f)(f-u.id.clock,0)),c.next();c.curr&&c.curr.id.client===l;)fe(s,c.curr,0),c.next();else for(;c.curr&&c.curr.id.client===l&&c.curr.id.clock+c.curr.length<=f;)c.next();else c.next()}he(s);var h=U(a);return J(i,h),i.toUint8Array()},le=function(t){t.written>0&&(t.clientStructs.push({written:t.written,restEncoder:Object(w.f)(t.encoder.restEncoder)}),t.encoder.restEncoder=Object(w.e)(),t.written=0)},fe=function(t,e,n){t.written>0&&t.currClient!==e.id.client&&le(t),0===t.written&&(t.currClient=e.id.client,t.encoder.writeClient(e.id.client),Object(w.m)(t.encoder.restEncoder,e.id.clock+n)),e.write(t.encoder,n),t.written++},he=function(t){le(t);var e=t.encoder.restEncoder;Object(w.m)(e,t.clientStructs.length);for(var n=0;n<t.clientStructs.length;n++){var r=t.clientStructs[n];Object(w.m)(e,r.written),Object(w.j)(e,r.restEncoder)}},pe=function(){function t(e,n){Object(p.a)(this,t),this.target=e,this.currentTarget=e,this.transaction=n,this._changes=null}return Object(l.a)(t,[{key:"deletes",value:function(t){return z(this.transaction.deleteSet,t.id)}},{key:"adds",value:function(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}},{key:"path",get:function(){return de(this.currentTarget,this.target)}},{key:"changes",get:function(){var t=this,e=this._changes;if(null===e){var n=this.target,r=Object(_.a)(),o=Object(_.a)(),i=[],s=new Map;e={added:r,deleted:o,delta:i,keys:s};var a=this.transaction.changed.get(n);if(a.has(null)){for(var c=null,u=function(){c&&i.push(c)},l=n._start;null!==l;l=l.right)l.deleted?this.deletes(l)&&!this.adds(l)&&(null!==c&&void 0!==c.delete||(u(),c={delete:0}),c.delete+=l.length,o.add(l)):this.adds(l)?(null!==c&&void 0!==c.insert||(u(),c={insert:[]}),c.insert=c.insert.concat(l.content.getContent()),r.add(l)):(null!==c&&void 0!==c.retain||(u(),c={retain:0}),c.retain+=l.length);null!==c&&void 0===c.retain&&u()}a.forEach((function(e){if(null!==e){var r,o,i=n._map.get(e);if(t.adds(i)){for(var a=i.left;null!==a&&t.adds(a);)a=a.left;if(t.deletes(i)){if(null===a||!t.deletes(a))return;r="delete",o=Object(m.d)(a.content.getContent())}else null!==a&&t.deletes(a)?(r="update",o=Object(m.d)(a.content.getContent())):(r="add",o=void 0)}else{if(!t.deletes(i))return;r="delete",o=Object(m.d)(i.content.getContent())}s.set(e,{action:r,oldValue:o})}})),this._changes=e}return e}}]),t}(),de=function(t,e){for(var n=[];null!==e._item&&e!==t;){if(null!==e._item.parentSub)n.unshift(e._item.parentSub);else{for(var r=0,o=e._item.parent._start;o!==e._item&&null!==o;)o.deleted||r++,o=o.right;n.unshift(r)}e=e._item.parent}return n},ve=0,ye=function t(e,n){Object(p.a)(this,t),e.marker=!0,this.p=e,this.index=n,this.timestamp=ve++},me=function(t,e,n){t.p.marker=!1,t.p=e,e.marker=!0,t.index=n,t.timestamp=ve++},ge=function(t,e){if(null===t._start||0===e||null===t._searchMarker)return null;var n=0===t._searchMarker.length?null:t._searchMarker.reduce((function(t,n){return Object(g.a)(e-t.index)<Object(g.a)(e-n.index)?t:n})),r=t._start,o=0;for(null!==n&&(r=n.p,o=n.index,function(t){t.timestamp=ve++}(n));null!==r.right&&o<e;){if(!r.deleted&&r.countable){if(e<o+r.length)break;o+=r.length}r=r.right}for(;null!==r.left&&o>e;)!(r=r.left).deleted&&r.countable&&(o-=r.length);for(;null!==r.left&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)!(r=r.left).deleted&&r.countable&&(o-=r.length);return null!==n&&Object(g.a)(n.index-o)<r.parent.length/80?(me(n,r,o),n):function(t,e,n){if(t.length>=80){var r=t.reduce((function(t,e){return t.timestamp<e.timestamp?t:e}));return me(r,e,n),r}var o=new ye(e,n);return t.push(o),o}(t._searchMarker,r,o)},be=function(t,e,n){for(var r=t.length-1;r>=0;r--){var o=t[r];if(n>0){var i=o.p;for(i.marker=!1;i&&(i.deleted||!i.countable);)(i=i.left)&&!i.deleted&&i.countable&&(o.index-=i.length);if(null===i||!0===i.marker){t.splice(r,1);continue}o.p=i,i.marker=!0}(e<o.index||n>0&&e===o.index)&&(o.index=Object(g.f)(e,o.index+n))}},we=function(t,e,n){for(var r=t,o=e.changedParentTypes;Object(b.e)(o,t,(function(){return[]})).push(n),null!==t._item;)t=t._item.parent;bt(r._eH,n,e)},ke=function(){function t(){Object(p.a)(this,t),this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=yt(),this._dEH=yt(),this._searchMarker=null}return Object(l.a)(t,[{key:"_integrate",value:function(t,e){this.doc=t,this._item=e}},{key:"_copy",value:function(){throw Object(O.b)()}},{key:"clone",value:function(){throw Object(O.b)()}},{key:"_write",value:function(t){}},{key:"_callObserver",value:function(t,e){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}},{key:"observe",value:function(t){mt(this._eH,t)}},{key:"observeDeep",value:function(t){mt(this._dEH,t)}},{key:"unobserve",value:function(t){gt(this._eH,t)}},{key:"unobserveDeep",value:function(t){gt(this._dEH,t)}},{key:"toJSON",value:function(){}},{key:"parent",get:function(){return this._item?this._item.parent:null}},{key:"_first",get:function(){for(var t=this._start;null!==t&&t.deleted;)t=t.right;return t}}]),t}(),xe=function(t,e,n){e<0&&(e=t._length+e),n<0&&(n=t._length+n);for(var r=n-e,o=[],i=t._start;null!==i&&r>0;){if(i.countable&&!i.deleted){var s=i.content.getContent();if(s.length<=e)e-=s.length;else{for(var a=e;a<s.length&&r>0;a++)o.push(s[a]),r--;e=0}}i=i.right}return o},Se=function(t){for(var e=[],n=t._start;null!==n;){if(n.countable&&!n.deleted)for(var r=n.content.getContent(),o=0;o<r.length;o++)e.push(r[o]);n=n.right}return e},Oe=function(t,e){for(var n=[],r=t._start;null!==r;){if(r.countable&&Rt(r,e))for(var o=r.content.getContent(),i=0;i<o.length;i++)n.push(o[i]);r=r.right}return n},Ce=function(t,e){for(var n=0,r=t._start;null!==r;){if(r.countable&&!r.deleted)for(var o=r.content.getContent(),i=0;i<o.length;i++)e(o[i],n++,t);r=r.right}},Ee=function(t,e){var n=[];return Ce(t,(function(r,o){n.push(e(r,o,t))})),n},_e=function(t,e){var n=ge(t,e),r=t._start;for(null!==n&&(r=n.p,e-=n.index);null!==r;r=r.right)if(!r.deleted&&r.countable){if(e<r.length)return r.content.getContent()[e];e-=r.length}},Me=function(t,e,n,r){var o=n,i=t.doc,s=i.clientID,a=i.store,c=null===n?e._start:n.right,u=[],l=function(){u.length>0&&((o=new Nn(xt(s,Bt(a,s)),o,o&&o.lastId,c,c&&c.id,e,null,new vn(u))).integrate(t,0),u=[])};r.forEach((function(n){switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:u.push(n);break;default:switch(l(),n.constructor){case Uint8Array:case ArrayBuffer:(o=new Nn(xt(s,Bt(a,s)),o,o&&o.lastId,c,c&&c.id,e,null,new un(new Uint8Array(n)))).integrate(t,0);break;case H:(o=new Nn(xt(s,Bt(a,s)),o,o&&o.lastId,c,c&&c.id,e,null,new fn(n))).integrate(t,0);break;default:if(!(n instanceof ke))throw new Error("Unexpected content type in insert operation");(o=new Nn(xt(s,Bt(a,s)),o,o&&o.lastId,c,c&&c.id,e,null,new Cn(n))).integrate(t,0)}}})),l()},Te=function(t,e,n,r){if(0===n)return e._searchMarker&&be(e._searchMarker,n,r.length),Me(t,e,null,r);var o=n,i=ge(e,n),s=e._start;for(null!==i&&(s=i.p,0===(n-=i.index)&&(n+=(s=s.prev)&&s.countable&&!s.deleted?s.length:0));null!==s;s=s.right)if(!s.deleted&&s.countable){if(n<=s.length){n<s.length&&Ut(t,xt(s.id.client,s.id.clock+n));break}n-=s.length}return e._searchMarker&&be(e._searchMarker,o,r.length),Me(t,e,s,r)},Ne=function(t,e,n,r){if(0!==r){var o=n,i=r,s=ge(e,n),a=e._start;for(null!==s&&(a=s.p,n-=s.index);null!==a&&n>0;a=a.right)!a.deleted&&a.countable&&(n<a.length&&Ut(t,xt(a.id.client,a.id.clock+n)),n-=a.length);for(;r>0&&null!==a;)a.deleted||(r<a.length&&Ut(t,xt(a.id.client,a.id.clock+r)),a.delete(t),r-=a.length),a=a.right;if(r>0)throw Object(O.a)("array length exceeded");e._searchMarker&&be(e._searchMarker,o,-i+r)}},Ae=function(t,e,n){var r=e._map.get(n);void 0!==r&&r.delete(t)},Ie=function(t,e,n,r){var o,i=e._map.get(n)||null,s=t.doc,a=s.clientID;if(null==r)o=new vn([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:o=new vn([r]);break;case Uint8Array:o=new un(r);break;case H:o=new fn(r);break;default:if(!(r instanceof ke))throw new Error("Unexpected content type");o=new Cn(r)}new Nn(xt(a,Bt(s.store,a)),i,i&&i.lastId,null,null,e,n,o).integrate(t,0)},je=function(t,e){var n=t._map.get(e);return void 0===n||n.deleted?void 0:n.content.getContent()[n.length-1]},De=function(t){var e={};return t._map.forEach((function(t,n){t.deleted||(e[n]=t.content.getContent()[t.length-1])})),e},Re=function(t){return e=t.entries(),n=function(t){return!t[1].deleted},N((function(){var t;do{t=e.next()}while(!t.done&&!n(t.value));return t}));var e,n},Pe=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(t,r){var o;return Object(p.a)(this,n),(o=e.call(this,t,r))._transaction=r,o}return n}(pe),ze=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(p.a)(this,n),(t=e.call(this))._prelimContent=[],t._searchMarker=[],t}return Object(l.a)(n,[{key:"_integrate",value:function(t,e){Object(f.a)(Object(h.a)(n.prototype),"_integrate",this).call(this,t,e),this.insert(0,this._prelimContent),this._prelimContent=null}},{key:"_copy",value:function(){return new n}},{key:"clone",value:function(){var t=new n;return t.insert(0,this.toArray().map((function(t){return t instanceof ke?t.clone():t}))),t}},{key:"_callObserver",value:function(t,e){Object(f.a)(Object(h.a)(n.prototype),"_callObserver",this).call(this,t,e),we(this,t,new Pe(this,t))}},{key:"insert",value:function(t,e){var n,o=this;null!==this.doc?te(this.doc,(function(n){Te(n,o,t,e)})):(n=this._prelimContent).splice.apply(n,[t,0].concat(Object(r.a)(e)))}},{key:"push",value:function(t){this.insert(this.length,t)}},{key:"unshift",value:function(t){this.insert(0,t)}},{key:"delete",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;null!==this.doc?te(this.doc,(function(r){Ne(r,e,t,n)})):this._prelimContent.splice(t,n)}},{key:"get",value:function(t){return _e(this,t)}},{key:"toArray",value:function(){return Se(this)}},{key:"slice",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return xe(this,t,e)}},{key:"toJSON",value:function(){return this.map((function(t){return t instanceof ke?t.toJSON():t}))}},{key:"map",value:function(t){return Ee(this,t)}},{key:"forEach",value:function(t){Ce(this,t)}},{key:Symbol.iterator,value:function(){return function(t){var e,n=t._start,r=null,i=0;return e={},Object(o.a)(e,Symbol.iterator,(function(){return this})),Object(o.a)(e,"next",(function(){if(null===r){for(;null!==n&&n.deleted;)n=n.right;if(null===n)return{done:!0,value:void 0};r=n.content.getContent(),i=0,n=n.right}var t=r[i++];return r.length<=i&&(r=null),{done:!1,value:t}})),e}(this)}},{key:"_write",value:function(t){t.writeTypeRef(gn)}},{key:"length",get:function(){return null===this._prelimContent?this._length:this._prelimContent.length}}],[{key:"from",value:function(t){var e=new n;return e.push(t),e}}]),n}(ke),Fe=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(t,r,o){var i;return Object(p.a)(this,n),(i=e.call(this,t,r)).keysChanged=o,i}return n}(pe),Be=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(t){var r;return Object(p.a)(this,n),(r=e.call(this))._prelimContent=null,r._prelimContent=void 0===t?new Map:new Map(t),r}return Object(l.a)(n,[{key:"_integrate",value:function(t,e){var r=this;Object(f.a)(Object(h.a)(n.prototype),"_integrate",this).call(this,t,e),this._prelimContent.forEach((function(t,e){r.set(e,t)})),this._prelimContent=null}},{key:"_copy",value:function(){return new n}},{key:"clone",value:function(){var t=new n;return this.forEach((function(e,n){t.set(n,e instanceof ke?e.clone():e)})),t}},{key:"_callObserver",value:function(t,e){we(this,t,new Fe(this,t,e))}},{key:"toJSON",value:function(){var t={};return this._map.forEach((function(e,n){if(!e.deleted){var r=e.content.getContent()[e.length-1];t[n]=r instanceof ke?r.toJSON():r}})),t}},{key:"keys",value:function(){return A(Re(this._map),(function(t){return t[0]}))}},{key:"values",value:function(){return A(Re(this._map),(function(t){return t[1].content.getContent()[t[1].length-1]}))}},{key:"entries",value:function(){return A(Re(this._map),(function(t){return[t[0],t[1].content.getContent()[t[1].length-1]]}))}},{key:"forEach",value:function(t){var e=this;return this._map.forEach((function(n,r){n.deleted||t(n.content.getContent()[n.length-1],r,e)})),{}}},{key:Symbol.iterator,value:function(){return this.entries()}},{key:"delete",value:function(t){var e=this;null!==this.doc?te(this.doc,(function(n){Ae(n,e,t)})):this._prelimContent.delete(t)}},{key:"set",value:function(t,e){var n=this;return null!==this.doc?te(this.doc,(function(r){Ie(r,n,t,e)})):this._prelimContent.set(t,e),e}},{key:"get",value:function(t){return je(this,t)}},{key:"has",value:function(t){return function(t,e){var n=t._map.get(e);return void 0!==n&&!n.deleted}(this,t)}},{key:"_write",value:function(t){t.writeTypeRef(bn)}},{key:"size",get:function(){return Object(r.a)(Re(this._map)).length}}]),n}(ke),Le=function(t,e){return t===e||"object"===typeof t&&"object"===typeof e&&t&&e&&Object(I.a)(t,e)},$e=function(){function t(e,n,r,o){Object(p.a)(this,t),this.left=e,this.right=n,this.index=r,this.currentAttributes=o}return Object(l.a)(t,[{key:"forward",value:function(){switch(null===this.right&&Object(O.c)(),this.right.content.constructor){case hn:case yn:this.right.deleted||(this.index+=this.right.length);break;case pn:this.right.deleted||Ve(this.currentAttributes,this.right.content)}this.left=this.right,this.right=this.right.right}}]),t}(),qe=function(t,e,n){for(;null!==e.right&&n>0;){switch(e.right.content.constructor){case hn:case yn:e.right.deleted||(n<e.right.length&&Ut(t,xt(e.right.id.client,e.right.id.clock+n)),e.index+=e.right.length,n-=e.right.length);break;case pn:e.right.deleted||Ve(e.currentAttributes,e.right.content)}e.left=e.right,e.right=e.right.right}return e},Je=function(t,e,n){var r=new Map,o=ge(e,n);if(o){var i=new $e(o.p.left,o.p,o.index,r);return qe(t,i,n-o.index)}var s=new $e(null,e._start,0,r);return qe(t,s,n)},Ue=function(t,e,n,r){for(;null!==n.right&&(!0===n.right.deleted||n.right.content.constructor===pn&&Le(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();var o=t.doc,i=o.clientID,s=n.left,a=n.right;r.forEach((function(r,c){(s=new Nn(xt(i,Bt(o.store,i)),s,s&&s.lastId,a,a&&a.id,e,null,new pn(c,r))).integrate(t,0),n.right=s}))},Ve=function(t,e){var n=e.key,r=e.value;null===r?t.delete(n):t.set(n,r)},We=function(t,e){for(;null!==t.right&&(t.right.deleted||t.right.content.constructor===pn&&Le(e[t.right.content.key]||null,t.right.content.value));)t.forward()},He=function(t,e,n,r){var o=t.doc,i=o.clientID,s=new Map;for(var a in r){var c=r[a],u=n.currentAttributes.get(a)||null;if(!Le(u,c)){s.set(a,u);var l=n.left,f=n.right;n.right=new Nn(xt(i,Bt(o.store,i)),l,l&&l.lastId,f,f&&f.id,e,null,new pn(a,c)),n.right.integrate(t,0),n.forward()}}return s},Ke=function(t,e,n,r,o){n.currentAttributes.forEach((function(t,e){void 0===o[e]&&(o[e]=null)}));var i=t.doc,s=i.clientID;We(n,o);var a=He(t,e,n,o),c=r.constructor===String?new yn(r):new hn(r),u=n.left,l=n.right,f=n.index;e._searchMarker&&be(e._searchMarker,n.index,c.getLength()),(l=new Nn(xt(s,Bt(i.store,s)),u,u&&u.lastId,l,l&&l.id,e,null,c)).integrate(t,0),n.right=l,n.index=f,n.forward(),Ue(t,e,n,a)},Ye=function(t,e,n,r,o){var i=t.doc,s=i.clientID;We(n,o);for(var a=He(t,e,n,o);r>0&&null!==n.right;){if(!n.right.deleted)switch(n.right.content.constructor){case pn:var c=n.right.content,u=c.key,l=c.value,f=o[u];void 0!==f&&(Le(f,l)?a.delete(u):a.set(u,l),n.right.delete(t));break;case hn:case yn:r<n.right.length&&Ut(t,xt(n.right.id.client,n.right.id.clock+r)),r-=n.right.length}n.forward()}if(r>0){for(var h="";r>0;r--)h+="\n";n.right=new Nn(xt(s,Bt(i.store,s)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,e,null,new yn(h)),n.right.integrate(t,0),n.forward()}Ue(t,e,n,a)},Ge=function(t,e,n,r,o){for(;n&&n.content.constructor!==yn&&n.content.constructor!==hn;)n.deleted||n.content.constructor!==pn||Ve(o,n.content),n=n.right;for(var i=0;e!==n;){if(!e.deleted){var s=e.content;switch(s.constructor){case pn:var a=s.key,c=s.value;(o.get(a)||null)===c&&(r.get(a)||null)!==c||(e.delete(t),i++)}}e=e.right}return i},Qe=function(t,e,n){for(var r=n,o=Object(b.b)(e.currentAttributes),i=e.right;n>0&&null!==e.right;){if(!1===e.right.deleted)switch(e.right.content.constructor){case hn:case yn:n<e.right.length&&Ut(t,xt(e.right.id.client,e.right.id.clock+n)),n-=e.right.length,e.right.delete(t)}e.forward()}i&&Ge(t,i,e.right,o,Object(b.b)(e.currentAttributes));var s=(e.left||e.right).parent;return s._searchMarker&&be(s._searchMarker,e.index,-r+n),e},Xe=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(t,r,o){var i;return Object(p.a)(this,n),(i=e.call(this,t,r))._delta=null,i.childListChanged=!1,i.keysChanged=new Set,o.forEach((function(t){null===t?i.childListChanged=!0:i.keysChanged.add(t)})),i}return Object(l.a)(n,[{key:"delta",get:function(){var t=this;if(null===this._delta){var e=this.target.doc;this._delta=[],te(e,(function(e){for(var n=t._delta,r=new Map,o=new Map,i=t.target._start,s=null,a={},c="",u=0,l=0,f=function(){if(null!==s){var t;switch(s){case"delete":t={delete:l},l=0;break;case"insert":t={insert:c},r.size>0&&(t.attributes={},r.forEach((function(e,n){null!==e&&(t.attributes[n]=e)}))),c="";break;case"retain":if(t={retain:u},Object.keys(a).length>0)for(var e in t.attributes={},a)t.attributes[e]=a[e];u=0}n.push(t),s=null}};null!==i;){switch(i.content.constructor){case hn:t.adds(i)?t.deletes(i)||(f(),s="insert",c=i.content.embed,f()):t.deletes(i)?("delete"!==s&&(f(),s="delete"),l+=1):i.deleted||("retain"!==s&&(f(),s="retain"),u+=1);break;case yn:t.adds(i)?t.deletes(i)||("insert"!==s&&(f(),s="insert"),c+=i.content.str):t.deletes(i)?("delete"!==s&&(f(),s="delete"),l+=i.length):i.deleted||("retain"!==s&&(f(),s="retain"),u+=i.length);break;case pn:var h=i.content,p=h.key,d=h.value;if(t.adds(i)){if(!t.deletes(i)){var v=r.get(p)||null;Le(v,d)?i.delete(e):("retain"===s&&f(),Le(d,o.get(p)||null)?delete a[p]:a[p]=d)}}else if(t.deletes(i)){o.set(p,d);var y=r.get(p)||null;Le(y,d)||("retain"===s&&f(),a[p]=y)}else if(!i.deleted){o.set(p,d);var m=a[p];void 0!==m&&(Le(m,d)?i.delete(e):("retain"===s&&f(),null===d?a[p]=d:delete a[p]))}i.deleted||("insert"===s&&f(),Ve(r,i.content))}i=i.right}for(f();n.length>0;){var g=n[n.length-1];if(void 0===g.retain||void 0!==g.attributes)break;n.pop()}}))}return this._delta}}]),n}(pe),Ze=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(t){var r;return Object(p.a)(this,n),(r=e.call(this))._pending=void 0!==t?[function(){return r.insert(0,t)}]:[],r._searchMarker=[],r}return Object(l.a)(n,[{key:"_integrate",value:function(t,e){Object(f.a)(Object(h.a)(n.prototype),"_integrate",this).call(this,t,e);try{this._pending.forEach((function(t){return t()}))}catch(r){console.error(r)}this._pending=null}},{key:"_copy",value:function(){return new n}},{key:"clone",value:function(){var t=new n;return t.applyDelta(this.toDelta()),t}},{key:"_callObserver",value:function(t,e){var r=this;Object(f.a)(Object(h.a)(n.prototype),"_callObserver",this).call(this,t,e);var o=new Xe(this,t,e),i=t.doc;if(!t.local){var s,u=!1,l=Object(a.a)(t.afterState.entries());try{for(l.s();!(s=l.n()).done;){var p=Object(c.a)(s.value,2),d=p[0],v=p[1],y=t.beforeState.get(d)||0;if(v!==y&&(Wt(t,i.store.clients.get(d),y,v,(function(t){t.deleted||t.content.constructor!==pn||(u=!0)})),u))break}}catch(m){l.e(m)}finally{l.f()}u||P(t,t.deleteSet,(function(t){t instanceof cn||u||t.parent===r&&t.content.constructor===pn&&(u=!0)})),te(i,(function(t){u?function(t){var e=0;te(t.doc,(function(n){for(var r=t._start,o=t._start,i=Object(b.c)(),s=Object(b.b)(i);o;){if(!1===o.deleted)switch(o.content.constructor){case pn:Ve(s,o.content);break;case hn:case yn:e+=Ge(n,r,o,i,s),i=Object(b.b)(s),r=o}o=o.right}}))}(r):P(t,t.deleteSet,(function(e){e instanceof cn||e.parent===r&&function(t,e){for(;e&&e.right&&(e.right.deleted||e.right.content.constructor!==yn&&e.right.content.constructor!==hn);)e=e.right;for(var n=new Set;e&&(e.deleted||e.content.constructor!==yn&&e.content.constructor!==hn);){if(!e.deleted&&e.content.constructor===pn){var r=e.content.key;n.has(r)?e.delete(t):n.add(r)}e=e.left}}(t,e)}))}))}we(this,t,o)}},{key:"toString",value:function(){for(var t="",e=this._start;null!==e;)!e.deleted&&e.countable&&e.content.constructor===yn&&(t+=e.content.str),e=e.right;return t}},{key:"toJSON",value:function(){return this.toString()}},{key:"applyDelta",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.sanitize,o=void 0===r||r;null!==this.doc?te(this.doc,(function(n){for(var r=new $e(null,e._start,0,new Map),i=0;i<t.length;i++){var s=t[i];if(void 0!==s.insert){var a=o||"string"!==typeof s.insert||i!==t.length-1||null!==r.right||"\n"!==s.insert.slice(-1)?s.insert:s.insert.slice(0,-1);("string"!==typeof a||a.length>0)&&Ke(n,e,r,a,s.attributes||{})}else void 0!==s.retain?Ye(n,e,r,s.retain,s.attributes||{}):void 0!==s.delete&&Qe(n,r,s.delete)}})):this._pending.push((function(){return e.applyDelta(t)}))}},{key:"toDelta",value:function(t,e,n){var r=[],o=new Map,i=this.doc,s="",a=this._start;function c(){if(s.length>0){var t={},e=!1;o.forEach((function(n,r){e=!0,t[r]=n}));var n={insert:s};e&&(n.attributes=t),r.push(n),s=""}}return te(i,(function(i){for(t&&Pt(i,t),e&&Pt(i,e);null!==a;){if(Rt(a,t)||void 0!==e&&Rt(a,e))switch(a.content.constructor){case yn:var u=o.get("ychange");void 0===t||Rt(a,t)?void 0===e||Rt(a,e)?void 0!==u&&(c(),o.delete("ychange")):void 0!==u&&u.user===a.id.client&&"added"===u.state||(c(),o.set("ychange",n?n("added",a.id):{type:"added"})):void 0!==u&&u.user===a.id.client&&"removed"===u.state||(c(),o.set("ychange",n?n("removed",a.id):{type:"removed"})),s+=a.content.str;break;case hn:c();var l={insert:a.content.embed};o.size>0&&function(){var t={};l.attributes=t,o.forEach((function(e,n){t[n]=e}))}(),r.push(l);break;case pn:Rt(a,t)&&(c(),Ve(o,a.content))}a=a.right}c()}),Pt),r}},{key:"insert",value:function(t,e,n){var r=this;if(!(e.length<=0)){var o=this.doc;null!==o?te(o,(function(o){var i=Je(o,r,t);n||(n={},i.currentAttributes.forEach((function(t,e){n[e]=t}))),Ke(o,r,i,e,n)})):this._pending.push((function(){return r.insert(t,e,n)}))}}},{key:"insertEmbed",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.constructor!==Object)throw new Error("Embed must be an Object");var o=this.doc;null!==o?te(o,(function(o){var i=Je(o,n,t);Ke(o,n,i,e,r)})):this._pending.push((function(){return n.insertEmbed(t,e,r)}))}},{key:"delete",value:function(t,e){var n=this;if(0!==e){var r=this.doc;null!==r?te(r,(function(r){Qe(r,Je(r,n,t),e)})):this._pending.push((function(){return n.delete(t,e)}))}}},{key:"format",value:function(t,e,n){var r=this;if(0!==e){var o=this.doc;null!==o?te(o,(function(o){var i=Je(o,r,t);null!==i.right&&Ye(o,r,i,e,n)})):this._pending.push((function(){return r.format(t,e,n)}))}}},{key:"removeAttribute",value:function(t){var e=this;null!==this.doc?te(this.doc,(function(n){Ae(n,e,t)})):this._pending.push((function(){return e.removeAttribute(t)}))}},{key:"setAttribute",value:function(t,e){var n=this;null!==this.doc?te(this.doc,(function(r){Ie(r,n,t,e)})):this._pending.push((function(){return n.setAttribute(t,e)}))}},{key:"getAttribute",value:function(t){return je(this,t)}},{key:"getAttributes",value:function(t){return De(this)}},{key:"_write",value:function(t){t.writeTypeRef(wn)}},{key:"length",get:function(){return this._length}}]),n}(ke),tn=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};Object(p.a)(this,t),this._filter=n,this._root=e,this._currentNode=e._start,this._firstCall=!0}return Object(l.a)(t,[{key:Symbol.iterator,value:function(){return this}},{key:"next",value:function(){var t=this._currentNode,e=t.content.type;if(null!==t&&(!this._firstCall||t.deleted||!this._filter(e)))do{if(e=t.content.type,t.deleted||e.constructor!==nn&&e.constructor!==en||null===e._start)for(;null!==t;){if(null!==t.right){t=t.right;break}t=t.parent===this._root?null:t.parent._item}else t=e._start}while(null!==t&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,null===t?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}]),t}(),en=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(){var t;return Object(p.a)(this,n),(t=e.call(this))._prelimContent=[],t}return Object(l.a)(n,[{key:"_integrate",value:function(t,e){Object(f.a)(Object(h.a)(n.prototype),"_integrate",this).call(this,t,e),this.insert(0,this._prelimContent),this._prelimContent=null}},{key:"_copy",value:function(){return new n}},{key:"clone",value:function(){var t=new n;return t.insert(0,t.toArray().map((function(t){return t instanceof ke?t.clone():t}))),t}},{key:"createTreeWalker",value:function(t){return new tn(this,t)}},{key:"querySelector",value:function(t){t=t.toUpperCase();var e=new tn(this,(function(e){return e.nodeName&&e.nodeName.toUpperCase()===t})).next();return e.done?null:e.value}},{key:"querySelectorAll",value:function(t){return t=t.toUpperCase(),Array.from(new tn(this,(function(e){return e.nodeName&&e.nodeName.toUpperCase()===t})))}},{key:"_callObserver",value:function(t,e){we(this,t,new rn(this,e,t))}},{key:"toString",value:function(){return Ee(this,(function(t){return t.toString()})).join("")}},{key:"toJSON",value:function(){return this.toString()}},{key:"toDOM",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=t.createDocumentFragment();return void 0!==n&&n._createAssociation(r,this),Ce(this,(function(o){r.insertBefore(o.toDOM(t,e,n),null)})),r}},{key:"insert",value:function(t,e){var n,o=this;null!==this.doc?te(this.doc,(function(n){Te(n,o,t,e)})):(n=this._prelimContent).splice.apply(n,[t,0].concat(Object(r.a)(e)))}},{key:"insertAfter",value:function(t,e){var n=this;if(null!==this.doc)te(this.doc,(function(r){var o=t&&t instanceof ke?t._item:t;Me(r,n,o,e)}));else{var o=this._prelimContent,i=null===t?0:o.findIndex((function(e){return e===t}))+1;if(0===i&&null!==t)throw Object(O.a)("Reference item not found");o.splice.apply(o,[i,0].concat(Object(r.a)(e)))}}},{key:"delete",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;null!==this.doc?te(this.doc,(function(r){Ne(r,e,t,n)})):this._prelimContent.splice(t,n)}},{key:"toArray",value:function(){return Se(this)}},{key:"push",value:function(t){this.insert(this.length,t)}},{key:"unshift",value:function(t){this.insert(0,t)}},{key:"get",value:function(t){return _e(this,t)}},{key:"slice",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return xe(this,t,e)}},{key:"_write",value:function(t){t.writeTypeRef(xn)}},{key:"firstChild",get:function(){var t=this._first;return t?t.content.getContent()[0]:null}},{key:"length",get:function(){return null===this._prelimContent?this._length:this._prelimContent.length}}]),n}(ke),nn=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"UNDEFINED";return Object(p.a)(this,n),(t=e.call(this)).nodeName=r,t._prelimAttrs=new Map,t}return Object(l.a)(n,[{key:"_integrate",value:function(t,e){var r=this;Object(f.a)(Object(h.a)(n.prototype),"_integrate",this).call(this,t,e),this._prelimAttrs.forEach((function(t,e){r.setAttribute(e,t)})),this._prelimAttrs=null}},{key:"_copy",value:function(){return new n(this.nodeName)}},{key:"clone",value:function(){var t=new n(this.nodeName),e=this.getAttributes();for(var r in e)t.setAttribute(r,e[r]);return t.insert(0,t.toArray().map((function(t){return t instanceof ke?t.clone():t}))),t}},{key:"toString",value:function(){var t=this.getAttributes(),e=[],r=[];for(var o in t)r.push(o);r.sort();for(var i=r.length,s=0;s<i;s++){var a=r[s];e.push(a+'="'+t[a]+'"')}var c=this.nodeName.toLocaleLowerCase(),u=e.length>0?" "+e.join(" "):"";return"<".concat(c).concat(u,">").concat(Object(f.a)(Object(h.a)(n.prototype),"toString",this).call(this),"</").concat(c,">")}},{key:"removeAttribute",value:function(t){var e=this;null!==this.doc?te(this.doc,(function(n){Ae(n,e,t)})):this._prelimAttrs.delete(t)}},{key:"setAttribute",value:function(t,e){var n=this;null!==this.doc?te(this.doc,(function(r){Ie(r,n,t,e)})):this._prelimAttrs.set(t,e)}},{key:"getAttribute",value:function(t){return je(this,t)}},{key:"getAttributes",value:function(t){return De(this)}},{key:"toDOM",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=t.createElement(this.nodeName),o=this.getAttributes();for(var i in o)r.setAttribute(i,o[i]);return Ce(this,(function(o){r.appendChild(o.toDOM(t,e,n))})),void 0!==n&&n._createAssociation(r,this),r}},{key:"_write",value:function(t){t.writeTypeRef(kn),t.writeKey(this.nodeName)}},{key:"nextSibling",get:function(){var t=this._item?this._item.next:null;return t?t.content.type:null}},{key:"prevSibling",get:function(){var t=this._item?this._item.prev:null;return t?t.content.type:null}}]),n}(en),rn=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(t,r,o){var i;return Object(p.a)(this,n),(i=e.call(this,t,o)).childListChanged=!1,i.attributesChanged=new Set,r.forEach((function(t){null===t?i.childListChanged=!0:i.attributesChanged.add(t)})),i}return n}(pe),on=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(t){var r;return Object(p.a)(this,n),(r=e.call(this)).hookName=t,r}return Object(l.a)(n,[{key:"_copy",value:function(){return new n(this.hookName)}},{key:"clone",value:function(){var t=new n(this.hookName);return this.forEach((function(e,n){t.set(n,e)})),t}},{key:"toDOM",value:function(){arguments.length>0&&void 0!==arguments[0]||document;var t,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=e[this.hookName];return(t=void 0!==r?r.createDom(this):document.createElement(this.hookName)).setAttribute("data-yjs-hook",this.hookName),void 0!==n&&n._createAssociation(t,this),t}},{key:"_write",value:function(t){t.writeTypeRef(Sn),t.writeKey(this.hookName)}}]),n}(Be),sn=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(){return Object(p.a)(this,n),e.apply(this,arguments)}return Object(l.a)(n,[{key:"_copy",value:function(){return new n}},{key:"clone",value:function(){var t=new n;return t.applyDelta(this.toDelta()),t}},{key:"toDOM",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=arguments.length>2?arguments[2]:void 0,n=t.createTextNode(this.toString());return void 0!==e&&e._createAssociation(n,this),n}},{key:"toString",value:function(){return this.toDelta().map((function(t){var e=[];for(var n in t.attributes){var r=[];for(var o in t.attributes[n])r.push({key:o,value:t.attributes[n][o]});r.sort((function(t,e){return t.key<e.key?-1:1})),e.push({nodeName:n,attrs:r})}e.sort((function(t,e){return t.nodeName<e.nodeName?-1:1}));for(var i="",s=0;s<e.length;s++){var a=e[s];i+="<".concat(a.nodeName);for(var c=0;c<a.attrs.length;c++){var u=a.attrs[c];i+=" ".concat(u.key,'="').concat(u.value,'"')}i+=">"}i+=t.insert;for(var l=e.length-1;l>=0;l--)i+="</".concat(e[l].nodeName,">");return i})).join("")}},{key:"toJSON",value:function(){return this.toString()}},{key:"_write",value:function(t){t.writeTypeRef(On)}},{key:"nextSibling",get:function(){var t=this._item?this._item.next:null;return t?t.content.type:null}},{key:"prevSibling",get:function(){var t=this._item?this._item.prev:null;return t?t.content.type:null}}]),n}(Ze),an=function(){function t(e,n){Object(p.a)(this,t),this.id=e,this.length=n}return Object(l.a)(t,[{key:"mergeWith",value:function(t){return!1}},{key:"write",value:function(t,e,n){throw Object(O.b)()}},{key:"integrate",value:function(t,e){throw Object(O.b)()}},{key:"deleted",get:function(){throw Object(O.b)()}}]),t}(),cn=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(){return Object(p.a)(this,n),e.apply(this,arguments)}return Object(l.a)(n,[{key:"delete",value:function(){}},{key:"mergeWith",value:function(t){return this.constructor===t.constructor&&(this.length+=t.length,!0)}},{key:"integrate",value:function(t,e){e>0&&(this.id.clock+=e,this.length-=e),Lt(t.doc.store,this)}},{key:"write",value:function(t,e){t.writeInfo(0),t.writeLen(this.length-e)}},{key:"getMissing",value:function(t,e){return null}},{key:"deleted",get:function(){return!0}}]),n}(an),un=function(){function t(e){Object(p.a)(this,t),this.content=e}return Object(l.a)(t,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.content]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.content)}},{key:"splice",value:function(t){throw Object(O.b)()}},{key:"mergeWith",value:function(t){return!1}},{key:"integrate",value:function(t,e){}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){t.writeBuf(this.content)}},{key:"getRef",value:function(){return 3}}]),t}(),ln=function(){function t(e){Object(p.a)(this,t),this.len=e}return Object(l.a)(t,[{key:"getLength",value:function(){return this.len}},{key:"getContent",value:function(){return[]}},{key:"isCountable",value:function(){return!1}},{key:"copy",value:function(){return new t(this.len)}},{key:"splice",value:function(e){var n=new t(this.len-e);return this.len=e,n}},{key:"mergeWith",value:function(t){return this.len+=t.len,!0}},{key:"integrate",value:function(t,e){L(t.deleteSet,e.id.client,e.id.clock,this.len),e.markDeleted()}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){t.writeLen(this.len-e)}},{key:"getRef",value:function(){return 1}}]),t}(),fn=function(){function t(e){Object(p.a)(this,t),e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;var n={};this.opts=n,e.gc||(n.gc=!1),e.autoLoad&&(n.autoLoad=!0),null!==e.meta&&(n.meta=e.meta)}return Object(l.a)(t,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.doc]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.doc)}},{key:"splice",value:function(t){throw Object(O.b)()}},{key:"mergeWith",value:function(t){return!1}},{key:"integrate",value:function(t,e){this.doc._item=e,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}},{key:"delete",value:function(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){t.writeString(this.doc.guid),t.writeAny(this.opts)}},{key:"getRef",value:function(){return 9}}]),t}(),hn=function(){function t(e){Object(p.a)(this,t),this.embed=e}return Object(l.a)(t,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.embed]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.embed)}},{key:"splice",value:function(t){throw Object(O.b)()}},{key:"mergeWith",value:function(t){return!1}},{key:"integrate",value:function(t,e){}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){t.writeJSON(this.embed)}},{key:"getRef",value:function(){return 5}}]),t}(),pn=function(){function t(e,n){Object(p.a)(this,t),this.key=e,this.value=n}return Object(l.a)(t,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[]}},{key:"isCountable",value:function(){return!1}},{key:"copy",value:function(){return new t(this.key,this.value)}},{key:"splice",value:function(t){throw Object(O.b)()}},{key:"mergeWith",value:function(t){return!1}},{key:"integrate",value:function(t,e){e.parent._searchMarker=null}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){t.writeKey(this.key),t.writeJSON(this.value)}},{key:"getRef",value:function(){return 6}}]),t}(),dn=function(){function t(e){Object(p.a)(this,t),this.arr=e}return Object(l.a)(t,[{key:"getLength",value:function(){return this.arr.length}},{key:"getContent",value:function(){return this.arr}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.arr)}},{key:"splice",value:function(e){var n=new t(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}},{key:"mergeWith",value:function(t){return this.arr=this.arr.concat(t.arr),!0}},{key:"integrate",value:function(t,e){}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){var n=this.arr.length;t.writeLen(n-e);for(var r=e;r<n;r++){var o=this.arr[r];t.writeString(void 0===o?"undefined":JSON.stringify(o))}}},{key:"getRef",value:function(){return 2}}]),t}(),vn=function(){function t(e){Object(p.a)(this,t),this.arr=e}return Object(l.a)(t,[{key:"getLength",value:function(){return this.arr.length}},{key:"getContent",value:function(){return this.arr}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.arr)}},{key:"splice",value:function(e){var n=new t(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}},{key:"mergeWith",value:function(t){return this.arr=this.arr.concat(t.arr),!0}},{key:"integrate",value:function(t,e){}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){var n=this.arr.length;t.writeLen(n-e);for(var r=e;r<n;r++){var o=this.arr[r];t.writeAny(o)}}},{key:"getRef",value:function(){return 8}}]),t}(),yn=function(){function t(e){Object(p.a)(this,t),this.str=e}return Object(l.a)(t,[{key:"getLength",value:function(){return this.str.length}},{key:"getContent",value:function(){return this.str.split("")}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.str)}},{key:"splice",value:function(e){var n=new t(this.str.slice(e));this.str=this.str.slice(0,e);var r=this.str.charCodeAt(e-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,e-1)+"\ufffd",n.str="\ufffd"+n.str.slice(1)),n}},{key:"mergeWith",value:function(t){return this.str+=t.str,!0}},{key:"integrate",value:function(t,e){}},{key:"delete",value:function(t){}},{key:"gc",value:function(t){}},{key:"write",value:function(t,e){t.writeString(0===e?this.str:this.str.slice(e))}},{key:"getRef",value:function(){return 4}}]),t}(),mn=[function(t){return new ze},function(t){return new Be},function(t){return new Ze},function(t){return new nn(t.readKey())},function(t){return new en},function(t){return new on(t.readKey())},function(t){return new sn}],gn=0,bn=1,wn=2,kn=3,xn=4,Sn=5,On=6,Cn=function(){function t(e){Object(p.a)(this,t),this.type=e}return Object(l.a)(t,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.type]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new t(this.type._copy())}},{key:"splice",value:function(t){throw Object(O.b)()}},{key:"mergeWith",value:function(t){return!1}},{key:"integrate",value:function(t,e){this.type._integrate(t.doc,e)}},{key:"delete",value:function(t){for(var e=this.type._start;null!==e;)e.deleted?t._mergeStructs.push(e):e.delete(t),e=e.right;this.type._map.forEach((function(e){e.deleted?t._mergeStructs.push(e):e.delete(t)})),t.changed.delete(this.type)}},{key:"gc",value:function(t){for(var e=this.type._start;null!==e;)e.gc(t,!0),e=e.right;this.type._start=null,this.type._map.forEach((function(e){for(;null!==e;)e.gc(t,!0),e=e.left})),this.type._map=new Map}},{key:"write",value:function(t,e){this.type._write(t)}},{key:"getRef",value:function(){return 7}}]),t}(),En=function(t,e){var n,r=e,o=0;do{o>0&&(r=xt(r.client,r.clock+o)),n=qt(t,r),o=r.clock-n.id.clock,r=n.redone}while(null!==r&&n instanceof Nn);return{item:n,diff:o}},_n=function(t,e){for(;null!==t&&t.keep!==e;)t.keep=e,t=t.parent._item},Mn=function(t,e,n){var r=e.id,o=r.client,i=r.clock,s=new Nn(xt(o,i+n),e,xt(o,i+n-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(n));return e.deleted&&s.markDeleted(),e.keep&&(s.keep=!0),null!==e.redone&&(s.redone=xt(e.redone.client,e.redone.clock+n)),e.right=s,null!==s.right&&(s.right.left=s),t._mergeStructs.push(s),null!==s.parentSub&&null===s.right&&s.parent._map.set(s.parentSub,s),e.length=n,s},Tn=function t(e,n,r){var o=e.doc,i=o.store,s=o.clientID,a=n.redone;if(null!==a)return Ut(e,a);var c,u,l=n.parent._item;if(null===n.parentSub)c=n.left,u=n;else{for(c=n;null!==c.right;)if((c=c.right).id.client!==s)return null;null!==c.right&&(c=n.parent._map.get(n.parentSub)),u=null}if(null!==l&&!0===l.deleted&&null===l.redone&&(!r.has(l)||null===t(e,l,r)))return null;if(null!==l&&null!==l.redone){for(;null!==l.redone;)l=Ut(e,l.redone);for(;null!==c;){for(var f=c;null!==f&&f.parent._item!==l;)f=null===f.redone?null:Ut(e,f.redone);if(null!==f&&f.parent._item===l){c=f;break}c=c.left}for(;null!==u;){for(var h=u;null!==h&&h.parent._item!==l;)h=null===h.redone?null:Ut(e,h.redone);if(null!==h&&h.parent._item===l){u=h;break}u=u.right}}var p=Bt(i,s),d=xt(s,p),v=new Nn(d,c,c&&c.lastId,u,u&&u.id,null===l?n.parent:l.content.type,n.parentSub,n.content.copy());return n.redone=d,_n(v,!0),v.integrate(e,0),v},Nn=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(t,r,o,i,s,a,c,u){var l;return Object(p.a)(this,n),(l=e.call(this,t,u.getLength())).origin=o,l.left=r,l.right=i,l.rightOrigin=s,l.parent=a,l.parentSub=c,l.redone=null,l.content=u,l.info=l.content.isCountable()?C.b:0,l}return Object(l.a)(n,[{key:"markDeleted",value:function(){this.info|=C.c}},{key:"getMissing",value:function(t,e){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Bt(e,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Bt(e,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===wt&&this.id.client!==this.parent.client&&this.parent.clock>=Bt(e,this.parent.client))return this.parent.client;if(this.origin&&(this.left=Vt(t,e,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Ut(t,this.rightOrigin),this.rightOrigin=this.right.id),(this.left&&this.left.constructor===cn||this.right&&this.right.constructor===cn)&&(this.parent=null),this.parent){if(this.parent.constructor===wt){var r=qt(e,this.parent);r.constructor===cn?this.parent=null:this.parent=r.content.type}}else this.left&&this.left.constructor===n&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===n&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);return null}},{key:"integrate",value:function(t,e){if(e>0&&(this.id.clock+=e,this.left=Vt(t,t.doc.store,xt(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(e),this.length-=e),this.parent){if(!this.left&&(!this.right||null!==this.right.left)||this.left&&this.left.right!==this.right){var n,r=this.left;if(null!==r)n=r.right;else if(null!==this.parentSub)for(n=this.parent._map.get(this.parentSub)||null;null!==n&&null!==n.left;)n=n.left;else n=this.parent._start;for(var o=new Set,i=new Set;null!==n&&n!==this.right;){if(i.add(n),o.add(n),kt(this.origin,n.origin)){if(n.id.client<this.id.client)r=n,o.clear();else if(kt(this.rightOrigin,n.rightOrigin))break}else{if(null===n.origin||!i.has(qt(t.doc.store,n.origin)))break;o.has(qt(t.doc.store,n.origin))||(r=n,o.clear())}n=n.right}this.left=r}if(null!==this.left){var s=this.left.right;this.right=s,this.left.right=this}else{var a;if(null!==this.parentSub)for(a=this.parent._map.get(this.parentSub)||null;null!==a&&null!==a.left;)a=a.left;else a=this.parent._start,this.parent._start=this;this.right=a}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(t)),null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length),Lt(t.doc.store,this),this.content.integrate(t,this),Yt(t,this.parent,this.parentSub),(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(t)}else new cn(this.id,this.length).integrate(t,0)}},{key:"mergeWith",value:function(t){return!!(this.constructor===t.constructor&&kt(t.origin,this.lastId)&&this.right===t&&kt(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&null===this.redone&&null===t.redone&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content))&&(t.keep&&(this.keep=!0),this.right=t.right,null!==this.right&&(this.right.left=this),this.length+=t.length,!0)}},{key:"delete",value:function(t){if(!this.deleted){var e=this.parent;this.countable&&null===this.parentSub&&(e._length-=this.length),this.markDeleted(),L(t.deleteSet,this.id.client,this.id.clock,this.length),Yt(t,e,this.parentSub),this.content.delete(t)}}},{key:"gc",value:function(t,e){if(!this.deleted)throw Object(O.c)();this.content.gc(t),e?function(t,e,n){var r=t.clients.get(e.id.client);r[$t(r,e.id.clock)]=n}(t,this,new cn(this.id,this.length)):this.content=new ln(this.length)}},{key:"write",value:function(t,e){var n=e>0?xt(this.id.client,this.id.clock+e-1):this.origin,r=this.rightOrigin,o=this.parentSub,i=this.content.getRef()&C.i|(null===n?0:C.g)|(null===r?0:C.f)|(null===o?0:C.e);if(t.writeInfo(i),null!==n&&t.writeLeftID(n),null!==r&&t.writeRightID(r),null===n&&null===r){var s=this.parent;if(void 0!==s._item){var a=s._item;if(null===a){var c=St(s);t.writeParentInfo(!0),t.writeString(c)}else t.writeParentInfo(!1),t.writeLeftID(a.id)}else s.constructor===String?(t.writeParentInfo(!0),t.writeString(s)):s.constructor===wt?(t.writeParentInfo(!1),t.writeLeftID(s)):Object(O.c)();null!==o&&t.writeString(o)}this.content.write(t,e)}},{key:"marker",set:function(t){(this.info&C.d)>0!==t&&(this.info^=C.d)},get:function(){return(this.info&C.d)>0}},{key:"keep",get:function(){return(this.info&C.a)>0},set:function(t){this.keep!==t&&(this.info^=C.a)}},{key:"countable",get:function(){return(this.info&C.b)>0}},{key:"deleted",get:function(){return(this.info&C.c)>0},set:function(t){this.deleted!==t&&(this.info^=C.c)}},{key:"next",get:function(){for(var t=this.right;null!==t&&t.deleted;)t=t.right;return t}},{key:"prev",get:function(){for(var t=this.left;null!==t&&t.deleted;)t=t.left;return t}},{key:"lastId",get:function(){return 1===this.length?this.id:xt(this.id.client,this.id.clock+this.length-1)}}]),n}(an),An=function(t,e){return In[e&C.i](t)},In=[function(){Object(O.c)()},function(t){return new ln(t.readLen())},function(t){for(var e=t.readLen(),n=[],r=0;r<e;r++){var o=t.readString();"undefined"===o?n.push(void 0):n.push(JSON.parse(o))}return new dn(n)},function(t){return new un(t.readBuf())},function(t){return new yn(t.readString())},function(t){return new hn(t.readJSON())},function(t){return new pn(t.readString(),t.readJSON())},function(t){return new Cn(mn[t.readTypeRef()](t))},function(t){for(var e=t.readLen(),n=[],r=0;r<e;r++)n.push(t.readAny());return new vn(n)},function(t){return new fn(new H(Object(u.a)({guid:t.readString()},t.readAny())))},function(){Object(O.c)()}],jn=function(t){Object(d.a)(n,t);var e=Object(v.a)(n);function n(){return Object(p.a)(this,n),e.apply(this,arguments)}return Object(l.a)(n,[{key:"delete",value:function(){}},{key:"mergeWith",value:function(t){return this.constructor===t.constructor&&(this.length+=t.length,!0)}},{key:"integrate",value:function(t,e){Object(O.c)()}},{key:"write",value:function(t,e){t.writeInfo(10),Object(w.m)(t.restEncoder,this.length-e)}},{key:"getMissing",value:function(t,e){return null}},{key:"deleted",get:function(){return!0}}]),n}(an)},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return s})),n.d(e,"e",(function(){return a})),n.d(e,"f",(function(){return c})),n.d(e,"g",(function(){return u})),n.d(e,"i",(function(){return l})),n.d(e,"j",(function(){return f})),n.d(e,"k",(function(){return h})),n.d(e,"l",(function(){return p})),n.d(e,"h",(function(){return d}));var r=1,o=2,i=4,s=8,a=32,c=64,u=128,l=31,f=63,h=127,p=255,d=2147483647},function(t,e,n){"use strict";function r(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];if(!t){var i;if(void 0===e)i=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=0;(i=new Error(e.replace(/%s/g,(function(){return r[s++]})))).name="Invariant Violation"}throw i.framesToPop=1,i}}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return o})),n.d(e,"h",(function(){return i})),n.d(e,"e",(function(){return s})),n.d(e,"g",(function(){return a})),n.d(e,"f",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"d",(function(){return l}));var r=Math.floor,o=(Math.ceil,Math.abs),i=(Math.imul,Math.round),s=Math.log10,a=(Math.log2,Math.log,Math.sqrt,function(t,e){return t<e?t:e}),c=function(t,e){return t>e?t:e},u=(Number.isNaN,Math.pow,function(t){return Math.pow(10,t)}),l=(Math.sign,function(t){return 0!==t?t<0:1/t<0})},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(22);function o(t){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(27);function s(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?Object(i.a)(t):e}function a(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=Object(r.a)(t);if(e){var i=Object(r.a)(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return s(this,n)}}},function(t,e,n){"use strict";function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}n.d(e,"a",(function(){return o}))},function(t,e,n){"use strict";function r(t){this.content=t}r.prototype={constructor:r,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return-1==e?void 0:this.content[e+1]},update:function(t,e,n){var o=n&&n!=t?this.remove(n):this,i=o.find(t),s=o.content.slice();return-1==i?s.push(n||t,e):(s[i+1]=e,n&&(s[i]=n)),new r(s)},remove:function(t){var e=this.find(t);if(-1==e)return this;var n=this.content.slice();return n.splice(e,2),new r(n)},addToStart:function(t,e){return new r([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new r(n)},addBefore:function(t,e,n){var o=this.remove(e),i=o.content.slice(),s=o.find(t);return i.splice(-1==s?i.length:s,0,e,n),new r(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return(t=r.from(t)).size?new r(t.content.concat(this.subtract(t).content)):this},append:function(t){return(t=r.from(t)).size?new r(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=r.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},get size(){return this.content.length>>1}},r.from=function(t){if(t instanceof r)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new r(e)};var o=r;e.a=o},function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return s})),n.d(e,"e",(function(){return a})),n.d(e,"d",(function(){return c})),n.d(e,"a",(function(){return u}));var r=n(18),o=n(25),i=function(){return new Map},s=function(t){var e=i();return t.forEach((function(t,n){e.set(n,t)})),e},a=function(t,e,n){var r=t.get(e);return void 0===r&&t.set(e,r=n()),r},c=function(t,e){var n,i=[],s=Object(o.a)(t);try{for(s.s();!(n=s.n()).done;){var a=Object(r.a)(n.value,2),c=a[0],u=a[1];i.push(e(u,c))}}catch(l){s.e(l)}finally{s.f()}return i},u=function(t,e){var n,i=Object(o.a)(t);try{for(i.s();!(n=i.n()).done;){var s=Object(r.a)(n.value,2),a=s[0];if(e(s[1],a))return!0}}catch(c){i.e(c)}finally{i.f()}return!1}},function(t,e,n){"use strict";t.exports=n(94)},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i}));var r=function(t){return new Error(t)},o=function(){throw r("Method unimplemented")},i=function(){throw r("Unexpected case")}},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return s}));var r=n(32),o=new r.c("y-sync"),i=new r.c("y-undo"),s=new r.c("yjs-cursor")},function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(56);function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}}(t,e)||Object(r.a)(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"e",(function(){return v})),n.d(e,"b",(function(){return m})),n.d(e,"d",(function(){return b})),n.d(e,"c",(function(){return k})),n.d(e,"f",(function(){return x})),n.d(e,"h",(function(){return E})),n.d(e,"g",(function(){return A}));n(3),n(5);var r,o,i=n(28),s=n(17),a=n(45),c=Symbol,u=n(20),l=n(21),f=(JSON.stringify,JSON.parse,n(13)),h=(n(47),n(9),n(26)),p=n(35),d=c(),v=c(),y=c(),m=c(),g=c(),b=c(),w=c(),k=c(),x=c(),S=(r={},Object(s.a)(r,d,u.a("font-weight","bold")),Object(s.a)(r,v,u.a("font-weight","normal")),Object(s.a)(r,y,u.a("color","blue")),Object(s.a)(r,g,u.a("color","green")),Object(s.a)(r,m,u.a("color","grey")),Object(s.a)(r,b,u.a("color","red")),Object(s.a)(r,w,u.a("color","purple")),Object(s.a)(r,k,u.a("color","orange")),Object(s.a)(r,x,u.a("color","black")),r),O=(o={},Object(s.a)(o,d,"\x1b[1m"),Object(s.a)(o,v,"\x1b[2m"),Object(s.a)(o,y,"\x1b[34m"),Object(s.a)(o,g,"\x1b[32m"),Object(s.a)(o,m,"\x1b[37m"),Object(s.a)(o,b,"\x1b[31m"),Object(s.a)(o,w,"\x1b[35m"),Object(s.a)(o,k,"\x1b[38;5;208m"),Object(s.a)(o,x,"\x1b[0m"),o),C=a.c?function(t){for(var e=[],n=[],r=0;r<t.length;r++){var o=t[r],i=O[o];if(void 0!==i)e.push(i);else{if(o.constructor!==String&&o.constructor!==Number)break;e.push(o)}}for(r>0&&(e.push("\x1b[0m"),n.push(e.join("")));r<t.length;r++){var s=t[r];s instanceof Symbol||n.push(s)}return n}:function(t){for(var e=[],n=[],r=f.c(),o=[],i=0;i<t.length;i++){var s=t[i],a=S[s];if(void 0!==a)r.set(a.left,a.right);else{if(s.constructor!==String&&s.constructor!==Number)break;var c=l.e(r);i>0||c.length>0?(e.push("%c"+s),n.push(c)):e.push(s)}}for(i>0&&(o=n).unshift(e.join(""));i<t.length;i++){var u=t[i];u instanceof Symbol||o.push(u)}return o},E=function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=console).log.apply(t,Object(i.a)(C(n))),_.forEach((function(t){return t.print(n)}))},_=new Set,M=[g,w,k,y],T=0,N=h.a(),A=function(t){var e=M[T],n=a.a("log"),r=null!==n&&("*"===n||"true"===n||new RegExp(n,"gi").test(t));return T=(T+1)%M.length,t+=": ",r?function(){var n=h.a(),r=n-N;N=n;for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];E.apply(void 0,[e,t,x].concat(Object(i.a)(s.map((function(t){return"string"===typeof t||"symbol"===typeof t?t:JSON.stringify(t)}))),[e," +"+r+"ms"]))}:p.d}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var r=n(3),o=function t(e,n){Object(r.a)(this,t),this.left=e,this.right=n},i=function(t,e){return new o(t,e)},s=function(t,e){return t.forEach((function(t){return e(t.left,t.right)}))}},function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return l})),n.d(e,"d",(function(){return f})),n.d(e,"f",(function(){return h})),n.d(e,"e",(function(){return p}));var r=n(20),o=n(13),i="undefined"!==typeof document?document:{},s=function(t){return i.createElement(t)},a=("undefined"!==typeof DOMParser&&new DOMParser,function(t,e){return r.b(e,(function(e,n){!1===n?t.removeAttribute(e):!0===n?t.setAttribute(e,""):t.setAttribute(e,n)})),t}),c=function(t){for(var e=i.createDocumentFragment(),n=0;n<t.length;n++)d(e,t[n]);return e},u=function(t,e){return d(t,c(e)),t},l=function(t,e,n){return t.addEventListener(e,n)},f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return u(a(s(t),e),n)},h=function(t){return i.createTextNode(t)},p=function(t){return o.d(t,(function(t,e){return"".concat(e,":").concat(t,";")})).join("")},d=function(t,e){return t.appendChild(e)};i.ELEMENT_NODE,i.TEXT_NODE,i.CDATA_SECTION_NODE,i.COMMENT_NODE,i.DOCUMENT_NODE,i.DOCUMENT_TYPE_NODE,i.DOCUMENT_FRAGMENT_NODE},function(t,e,n){"use strict";function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.d(e,"a",(function(){return r}))},function(t,e,n){t.exports=n(102)},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(22);function o(t,e,n){return(o="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Object(r.a)(t)););return t}(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(56);function o(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=Object(r.a)(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,s=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw s}}}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n(9);var r=Date.now},function(t,e,n){"use strict";function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(58);var o=n(56);function i(t){return function(t){if(Array.isArray(t))return Object(r.a)(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Object(o.a)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(t,e,n){"use strict";var r,o="object"===typeof Reflect?Reflect:null,i=o&&"function"===typeof o.apply?o.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};r=o&&"function"===typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var s=Number.isNaN||function(t){return t!==t};function a(){a.init.call(this)}t.exports=a,t.exports.once=function(t,e){return new Promise((function(n,r){function o(){void 0!==i&&t.removeListener("error",i),n([].slice.call(arguments))}var i;"error"!==e&&(i=function(n){t.removeListener(e,o),r(n)},t.once("error",i)),t.once(e,o)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function u(t){if("function"!==typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function f(t,e,n,r){var o,i,s,a;if(u(n),void 0===(i=t._events)?(i=t._events=Object.create(null),t._eventsCount=0):(void 0!==i.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),s=i[e]),void 0===s)s=i[e]=n,++t._eventsCount;else if("function"===typeof s?s=i[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(o=l(t))>0&&s.length>o&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return t}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},o=h.bind(r);return o.listener=n,r.wrapFn=o,o}function d(t,e,n){var r=t._events;if(void 0===r)return[];var o=r[e];return void 0===o?[]:"function"===typeof o?n?[o.listener||o]:[o]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(o):y(o,o.length)}function v(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function y(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(t){if("number"!==typeof t||t<0||s(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");c=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!==typeof t||t<0||s(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[t];if(void 0===c)return!1;if("function"===typeof c)i(c,this,e);else{var u=c.length,l=y(c,u);for(n=0;n<u;++n)i(l[n],this,e)}return!0},a.prototype.addListener=function(t,e){return f(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return f(this,t,e,!0)},a.prototype.once=function(t,e){return u(e),this.on(t,p(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){return u(e),this.prependListener(t,p(this,t,e)),this},a.prototype.removeListener=function(t,e){var n,r,o,i,s;if(u(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0===--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!==typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===e||n[i].listener===e){s=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,o),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,s||e)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},a.prototype.listeners=function(t){return d(this,t,!0)},a.prototype.rawListeners=function(t){return d(this,t,!1)},a.listenerCount=function(t,e){return"function"===typeof t.listenerCount?t.listenerCount(e):v.call(t,e)},a.prototype.listenerCount=v,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(17);function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}},function(t,e,n){"use strict";(function(t){n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return a})),n.d(e,"e",(function(){return c})),n.d(e,"d",(function(){return u})),n.d(e,"a",(function(){return l}));var r=n(48),o=n(45),i=(n(0),n(2),function(t){return new Uint8Array(t)}),s=function(t,e,n){return new Uint8Array(t,e,n)},a=function(t){return new Uint8Array(t)},c=o.b?function(t){for(var e="",n=0;n<t.byteLength;n++)e+=r.c(t[n]);return btoa(e)}:function(e){return t.from(e.buffer,e.byteOffset,e.byteLength).toString("base64")},u=o.b?function(t){for(var e=atob(t),n=i(e.length),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}:function(e){var n=t.from(e,"base64");return new Uint8Array(n.buffer,n.byteOffset,n.byteLength)},l=function(t){var e=i(t.byteLength);return e.set(t),e}}).call(this,n(103).Buffer)},function(t,e,n){"use strict";n.d(e,"a",(function(){return zt})),n.d(e,"b",(function(){return $t})),n.d(e,"c",(function(){return Ut})),n.d(e,"d",(function(){return kt})),n.d(e,"e",(function(){return Ot}));var r=n(12);function o(t,e,n){for(var r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;var i=t.child(r),s=e.child(r);if(i!=s){if(!i.sameMarkup(s))return n;if(i.isText&&i.text!=s.text){for(var a=0;i.text[a]==s.text[a];a++)n++;return n}if(i.content.size||s.content.size){var c=o(i.content,s.content,n+1);if(null!=c)return c}n+=i.nodeSize}else n+=i.nodeSize}}function i(t,e,n,r){for(var o=t.childCount,s=e.childCount;;){if(0==o||0==s)return o==s?null:{a:n,b:r};var a=t.child(--o),c=e.child(--s),u=a.nodeSize;if(a!=c){if(!a.sameMarkup(c))return{a:n,b:r};if(a.isText&&a.text!=c.text){for(var l=0,f=Math.min(a.text.length,c.text.length);l<f&&a.text[a.text.length-l-1]==c.text[c.text.length-l-1];)l++,n--,r--;return{a:n,b:r}}if(a.content.size||c.content.size){var h=i(a.content,c.content,n-1,r-1);if(h)return h}n-=u,r-=u}else n-=u,r-=u}}var s=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},a={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};s.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var u=s+1;a.nodesBetween(Math.max(0,t-u),Math.min(a.content.size,e-u),n,r+u)}s=c}},s.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},s.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},s.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new s(r,this.size+t.size)},s.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var o=0,i=0;i<e;o++){var a=this.content[o],c=i+a.nodeSize;c>t&&((i<t||c>e)&&(a=a.isText?a.cut(Math.max(0,t-i),Math.min(a.text.length,e-i)):a.cut(Math.max(0,t-i-1),Math.min(a.content.size,e-i-1))),n.push(a),r+=a.nodeSize),i=c}return new s(n,r)},s.prototype.cutByIndex=function(t,e){return t==e?s.empty:0==t&&e==this.content.length?this:new s(this.content.slice(t,e))},s.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new s(r,o)},s.prototype.addToStart=function(t){return new s([t].concat(this.content),this.size+t.nodeSize)},s.prototype.addToEnd=function(t){return new s(this.content.concat(t),this.size+t.nodeSize)},s.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},a.firstChild.get=function(){return this.content.length?this.content[0]:null},a.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},a.childCount.get=function(){return this.content.length},s.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},s.prototype.maybeChild=function(t){return this.content[t]},s.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},s.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),o(this,t,e)},s.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),i(this,t,e,n)},s.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return u(0,t);if(t==this.size)return u(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?u(n+1,o):u(n,r);r=o}},s.prototype.toString=function(){return"<"+this.toStringInner()+">"},s.prototype.toStringInner=function(){return this.content.join(", ")},s.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},s.fromJSON=function(t,e){if(!e)return s.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new s(e.map(t.nodeFromJSON))},s.fromArray=function(t){if(!t.length)return s.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new s(e||t,n)},s.from=function(t){if(!t)return s.empty;if(t instanceof s)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new s([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(s.prototype,a);var c={index:0,offset:0};function u(t,e){return c.index=t,c.offset=e,c}function l(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!l(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e)||!l(t[o],e[o]))return!1;for(var i in e)if(!(i in t))return!1}return!0}s.empty=new s([],0);var f=function(t,e){this.type=t,this.attrs=e};function h(t){var e=Error.call(this,t);return e.__proto__=h.prototype,e}f.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},f.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},f.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},f.prototype.eq=function(t){return this==t||this.type==t.type&&l(this.attrs,t.attrs)},f.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},f.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},f.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},f.setFrom=function(t){if(!t||0==t.length)return f.none;if(t instanceof f)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},f.none=[],h.prototype=Object.create(Error.prototype),h.prototype.constructor=h,h.prototype.name="ReplaceError";var p=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},d={size:{configurable:!0}};function v(t,e,n){var r=t.findIndex(e),o=r.index,i=r.offset,s=t.maybeChild(o),a=t.findIndex(n),c=a.index,u=a.offset;if(i==e||s.isText){if(u!=n&&!t.child(c).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return t.replaceChild(o,s.copy(v(s.content,e-i-1,n-i-1)))}function y(t,e,n,r){var o=t.findIndex(e),i=o.index,s=o.offset,a=t.maybeChild(i);if(s==e||a.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));var c=y(a.content,e-s-1,n);return c&&t.replaceChild(i,a.copy(c))}function m(t,e,n){if(n.openStart>t.depth)throw new h("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new h("Inconsistent open depths");return g(t,e,n,0)}function g(t,e,n,r){var o=t.index(r),i=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){var a=g(t,e,n,r+1);return i.copy(i.content.replaceChild(o,a))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){var c=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(s.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(n,t);return S(i,O(t,c.start,c.end,e,r))}var u=t.parent,l=u.content;return S(u,l.cut(0,t.parentOffset).append(n.content).append(l.cut(e.parentOffset)))}return S(i,C(t,e,r))}function b(t,e){if(!e.type.compatibleContent(t.type))throw new h("Cannot join "+e.type.name+" onto "+t.type.name)}function w(t,e,n){var r=t.node(n);return b(r,e.node(n)),r}function k(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function x(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(k(t.nodeAfter,r),i++));for(var a=i;a<s;a++)k(o.child(a),r);e&&e.depth==n&&e.textOffset&&k(e.nodeBefore,r)}function S(t,e){if(!t.type.validContent(e))throw new h("Invalid content for node "+t.type.name);return t.copy(e)}function O(t,e,n,r,o){var i=t.depth>o&&w(t,e,o+1),a=r.depth>o&&w(n,r,o+1),c=[];return x(null,t,o,c),i&&a&&e.index(o)==n.index(o)?(b(i,a),k(S(i,O(t,e,n,r,o+1)),c)):(i&&k(S(i,C(t,e,o+1)),c),x(e,n,o,c),a&&k(S(a,C(n,r,o+1)),c)),x(r,null,o,c),new s(c)}function C(t,e,n){var r=[];(x(null,t,n,r),t.depth>n)&&k(S(w(t,e,n+1),C(t,e,n+1)),r);return x(e,null,n,r),new s(r)}d.size.get=function(){return this.content.size-this.openStart-this.openEnd},p.prototype.insertAt=function(t,e){var n=y(this.content,t+this.openStart,e,null);return n&&new p(n,this.openStart,this.openEnd)},p.prototype.removeBetween=function(t,e){return new p(v(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},p.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},p.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},p.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},p.fromJSON=function(t,e){if(!e)return p.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new p(s.fromJSON(t,e.content),n,r)},p.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new p(t,n,r)},Object.defineProperties(p.prototype,d),p.empty=new p(s.empty,0,0);var E=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},_={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};E.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},_.parent.get=function(){return this.node(this.depth)},_.doc.get=function(){return this.node(0)},E.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},E.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},E.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},E.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},E.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},E.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},E.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},_.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},_.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},_.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},E.prototype.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,o=0;o<t;o++)r+=n.child(o).nodeSize;return r},E.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return f.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},E.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},E.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},E.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new A(this,t,n)},E.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},E.prototype.max=function(t){return t.pos>this.pos?t:this},E.prototype.min=function(t){return t.pos<this.pos?t:this},E.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},E.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,u=o-c;if(n.push(i,a,r+c),!u)break;if((i=i.child(a)).isText)break;o=u-1,r+=c+1}return new E(e,n,o)},E.resolveCached=function(t,e){for(var n=0;n<M.length;n++){var r=M[n];if(r.pos==e&&r.doc==t)return r}var o=M[T]=E.resolve(t,e);return T=(T+1)%N,o},Object.defineProperties(E.prototype,_);var M=[],T=0,N=12,A=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},I={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};I.start.get=function(){return this.$from.before(this.depth+1)},I.end.get=function(){return this.$to.after(this.depth+1)},I.parent.get=function(){return this.$from.node(this.depth)},I.startIndex.get=function(){return this.$from.index(this.depth)},I.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(A.prototype,I);var j=Object.create(null),D=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||s.empty,this.marks=r||f.none},R={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};R.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},R.childCount.get=function(){return this.content.childCount},D.prototype.child=function(t){return this.content.child(t)},D.prototype.maybeChild=function(t){return this.content.maybeChild(t)},D.prototype.forEach=function(t){this.content.forEach(t)},D.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},D.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},R.textContent.get=function(){return this.textBetween(0,this.content.size,"")},D.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},R.firstChild.get=function(){return this.content.firstChild},R.lastChild.get=function(){return this.content.lastChild},D.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},D.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},D.prototype.hasMarkup=function(t,e,n){return this.type==t&&l(this.attrs,e||t.defaultAttrs||j)&&f.sameSet(this.marks,n||f.none)},D.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},D.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},D.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},D.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return p.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new p(a,r.depth-i,o.depth-i)},D.prototype.replace=function(t,e,n){return m(this.resolve(t),this.resolve(e),n)},D.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},D.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},D.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},D.prototype.resolve=function(t){return E.resolveCached(this,t)},D.prototype.resolveNoCache=function(t){return E.resolve(this,t)},D.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},R.isBlock.get=function(){return this.type.isBlock},R.isTextblock.get=function(){return this.type.isTextblock},R.inlineContent.get=function(){return this.type.inlineContent},R.isInline.get=function(){return this.type.isInline},R.isText.get=function(){return this.type.isText},R.isLeaf.get=function(){return this.type.isLeaf},R.isAtom.get=function(){return this.type.isAtom},D.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),z(this.marks,t)},D.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},D.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=s.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),a=i&&i.matchFragment(this.content,e);if(!a||!a.validEnd)return!1;for(var c=r;c<o;c++)if(!this.type.allowsMarks(n.child(c).marks))return!1;return!0},D.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},D.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},D.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},D.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},D.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=s.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(D.prototype,R);var P=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):z(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(D);function z(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var F=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},B={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};F.parse=function(t,e){var n=new L(t,e);if(null==n.next)return F.empty;var r=q(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return n(K(t,0));function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];K(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new F(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(H);i.next.push(o[s],e[a.join(",")]||n(a))}return i}}(function(t){var e=[[]];return o(i(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}function i(t,e){if("choice"==t.type)return t.exprs.reduce((function(t,n){return t.concat(i(n,e))}),[]);if("seq"==t.type)for(var s=0;;s++){var a=i(t.exprs[s],e);if(s==t.exprs.length-1)return a;o(a,e=n())}else{if("star"==t.type){var c=n();return r(e,c),o(i(t.expr,c),c),[r(c)]}if("plus"==t.type){var u=n();return o(i(t.expr,e),u),o(i(t.expr,u),u),[r(u)]}if("opt"==t.type)return[r(e)].concat(i(t.expr,e));if("range"==t.type){for(var l=e,f=0;f<t.min;f++){var h=n();o(i(t.expr,l),h),l=h}if(-1==t.max)o(i(t.expr,l),l);else for(var p=t.min;p<t.max;p++){var d=n();r(l,d),o(i(t.expr,l),d),l=d}return[r(l)]}if("name"==t.type)return[r(e,null,t.value)]}}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],u=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(u)&&r.push(u)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},F.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},F.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},B.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},B.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},F.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},F.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,a){var c=i.matchFragment(t,n);if(c&&(!e||c.validEnd))return s.from(a.map((function(t){return t.createAndFill()})));for(var u=0;u<i.next.length;u+=2){var l=i.next[u],f=i.next[u+1];if(!l.isText&&!l.hasRequiredAttrs()&&-1==r.indexOf(f)){r.push(f);var h=o(f,a.concat(l));if(h)return h}}}(this,[])},F.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},F.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},B.edgeCount.get=function(){return this.next.length>>1},F.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},F.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(F.prototype,B),F.empty=new F(!0);var L=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},$={next:{configurable:!0}};function q(t){var e=[];do{e.push(J(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function J(t){var e=[];do{e.push(U(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function U(t){for(var e=function(t){if(t.eat("(")){var e=q(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=W(t,e)}return e}function V(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function W(t,e){var n=V(t),r=n;return t.eat(",")&&(r="}"!=t.next?V(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function H(t,e){return e-t}function K(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(H)}function Y(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function G(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function Q(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new tt(t[n]);return e}$.next.get=function(){return this.tokens[this.pos]},L.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},L.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(L.prototype,$);var X=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=Q(n.attrs),this.defaultAttrs=Y(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},Z={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Z.isInline.get=function(){return!this.isBlock},Z.isTextblock.get=function(){return this.isBlock&&this.inlineContent},Z.isLeaf.get=function(){return this.contentMatch==F.empty},Z.isAtom.get=function(){return this.isLeaf||this.spec.atom},X.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},X.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},X.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:G(this.attrs,t)},X.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new D(this,this.computeAttrs(t),s.from(e),f.setFrom(n))},X.prototype.createChecked=function(t,e,n){if(e=s.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new D(this,this.computeAttrs(t),e,f.setFrom(n))},X.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=s.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e).fillBefore(s.empty,!0);return o?new D(this,t,e.append(o),f.setFrom(n)):null},X.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},X.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},X.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},X.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:f.empty:t},X.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new X(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(X.prototype,Z);var tt=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},et={isRequired:{configurable:!0}};et.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(tt.prototype,et);var nt=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=Q(r.attrs),this.rank=e,this.excluded=null;var o=Y(this.attrs);this.instance=o&&new f(this,o)};nt.prototype.create=function(t){return!t&&this.instance?this.instance:new f(this,G(this.attrs,t))},nt.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new nt(t,r++,e,o)})),n},nt.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},nt.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},nt.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var rt=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=r.a.from(t.nodes),this.spec.marks=r.a.from(t.marks),this.nodes=X.compile(this.spec.nodes,this),this.marks=nt.compile(this.spec.marks,this);var n=Object.create(null);for(var o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");var i=this.nodes[o],s=i.spec.content||"",a=i.spec.marks;i.contentMatch=n[s]||(n[s]=F.parse(s,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.markSet="_"==a?null:a?ot(this,a.split(" ")):""!=a&&i.inlineContent?null:[]}for(var c in this.marks){var u=this.marks[c],l=u.spec.excludes;u.excluded=null==l?[u]:""==l?[]:ot(this,l.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function ot(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}rt.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof X))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},rt.prototype.text=function(t,e){var n=this.nodes.text;return new P(n,n.defaultAttrs,t,f.setFrom(e))},rt.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},rt.prototype.nodeFromJSON=function(t){return D.fromJSON(this,t)},rt.prototype.markFromJSON=function(t){return f.fromJSON(this,t)},rt.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var it=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)})),this.normalizeLists=!this.tags.some((function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)}))};it.prototype.parse=function(t,e){void 0===e&&(e={});var n=new ft(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},it.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new ft(this,e,!0);return n.addAll(t,null,e.from,e.to),p.maxOpen(n.finish())},it.prototype.matchTag=function(t,e,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(pt(t,o.tag)&&(void 0===o.namespace||t.namespaceURI==o.namespace)&&(!o.context||e.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(t);if(!1===i)continue;o.attrs=i}return o}}},it.prototype.matchStyle=function(t,e,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(t)||i.context&&!n.matchesContext(i.context)||i.style.length>t.length&&(61!=i.style.charCodeAt(t.length)||i.style.slice(t.length+1)!=e))){if(i.getAttrs){var s=i.getAttrs(e);if(!1===s)continue;i.attrs=s}return i}}},it.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=dt(t)),t.mark=e}))};for(var o in t.marks)r(o);var i=function(e){var r=t.nodes[s].spec.parseDOM;r&&r.forEach((function(t){n(t=dt(t)),t.node=s}))};for(var s in t.nodes)i();return e},it.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new it(t,it.schemaRules(t)))};var st={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},at={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},ct={ol:!0,ul:!0};function ut(t){return(t?1:0)|("full"===t?2:0)}var lt=function(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=f.none,this.pendingMarks=r,this.stashMarks=[]};lt.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(s.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},lt.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=s.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(s.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},lt.prototype.popFromStashMark=function(t){for(var e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]},lt.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):vt(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}};var ft=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,i=ut(e.preserveWhitespace)|(n?4:0);r=o?new lt(o.type,o.attrs,f.none,f.none,!0,e.topMatch||o.type.contentMatch,i):new lt(n?null:t.schema.topNodeType,null,f.none,f.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},ht={top:{configurable:!0},currentPos:{configurable:!0}};function pt(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function dt(t){var e={};for(var n in t)e[n]=t[n];return e}function vt(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var i=[];return function t(n){i.push(n);for(var r=0;r<n.edgeCount;r++){var o=n.edge(r),s=o.type,a=o.next;if(s==e)return!0;if(i.indexOf(a)<0&&t(a))return!0}}(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}ht.top.get=function(){return this.nodes[this.open]},ft.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},ft.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},ft.prototype.addElement=function(t,e){var n,r=t.nodeName.toLowerCase();ct.hasOwnProperty(r)&&this.parser.normalizeLists&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&ct.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var o=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(n=this.parser.matchTag(t,this,e));if(o?o.ignore:at.hasOwnProperty(r))this.findInside(t);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(t=o.skip);var i,s=this.top,a=this.needsBlock;if(st.hasOwnProperty(r))i=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),i&&this.sync(s),this.needsBlock=a}else this.addElementByRule(t,o,!1===o.consuming?n:null)},ft.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},ft.prototype.readStyles=function(t){var e=f.none;t:for(var n=0;n<t.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(t[n],t[n+1],this,r);if(!o)continue t;if(o.ignore)return null;if(e=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(e),!1!==o.consuming)break;r=o}return e},ft.prototype.addElementByRule=function(t,e,n){var r,o,i,s=this;e.node?(o=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(o.create(e.attrs))||this.leafFallback(t):r=this.enter(o,e.attrs,e.preserveWhitespace):(i=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(i));var a=this.top;if(o&&o.isLeaf)this.findInside(t);else if(n)this.addElement(t,n);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return s.insertNode(t)}));else{var c=e.contentElement;"string"==typeof c?c=t.querySelector(c):"function"==typeof c&&(c=c(t)),c||(c=t),this.findAround(t,c,!0),this.addAll(c,r)}r&&(this.sync(a),this.open--),i&&this.removePendingMark(i,a)},ft.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&st.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},ft.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},ft.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},ft.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},ft.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:ut(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new lt(t,e,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},ft.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},ft.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},ft.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},ht.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},ft.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},ft.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},ft.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},ft.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},ft.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1);return function t(s,a){for(;s>=0;s--){var c=n[s];if(""==c){if(s==n.length-1||0==s)continue;for(;a>=i;a--)if(t(s-1,a))return!0;return!1}var u=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!u||u.name!=c&&-1==u.groups.indexOf(c))return!1;a--}return!0}(n.length-1,this.open)},ft.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},ft.prototype.addPendingMark=function(t){var e=function(t,e){for(var n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},ft.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(t)>-1)r.pendingMarks=t.removeFromSet(r.pendingMarks);else{r.activeMarks=t.removeFromSet(r.activeMarks);var o=r.popFromStashMark(t);o&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==e)break}},Object.defineProperties(ft.prototype,ht);var yt=function(t,e){this.nodes=t||{},this.marks=e||{}};function mt(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function gt(t){return t.document||window.document}yt.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=gt(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],u=r.serializeMark(c,t.isInline,e);u&&(i.push(c,o),o.appendChild(u.dom),o=u.contentDOM||u.dom)}}o.appendChild(r.serializeNode(t,e))})),n},yt.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=yt.renderSpec(gt(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},yt.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},yt.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&yt.renderSpec(gt(n),r(t,e))},yt.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var u in c=2,a)if(null!=a[u]){var l=u.indexOf(" ");l>0?s.setAttributeNS(u.slice(0,l),u.slice(l+1),a[u]):s.setAttribute(u,a[u])}for(var f=c;f<e.length;f++){var h=e[f];if(0===h){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var p=yt.renderSpec(t,h,n),d=p.dom,v=p.contentDOM;if(s.appendChild(d),v){if(i)throw new RangeError("Multiple content holes");i=v}}return{dom:s,contentDOM:i}},yt.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new yt(this.nodesFromSchema(t),this.marksFromSchema(t)))},yt.nodesFromSchema=function(t){var e=mt(t.nodes);return e.text||(e.text=function(t){return t.text}),e},yt.marksFromSchema=function(t){return mt(t.marks)};var bt=n(4),wt=Object.create(null),kt=function(t,e,n){this.ranges=n||[new St(t.min(e),t.max(e))],this.$anchor=t,this.$head=e},xt={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};xt.anchor.get=function(){return this.$anchor.pos},xt.head.get=function(){return this.$head.pos},xt.from.get=function(){return this.$from.pos},xt.to.get=function(){return this.$to.pos},xt.$from.get=function(){return this.ranges[0].$from},xt.$to.get=function(){return this.ranges[0].$to},xt.empty.get=function(){for(var t=this.ranges,e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0},kt.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},kt.prototype.replace=function(t,e){void 0===e&&(e=p.empty);for(var n=e.content.lastChild,r=null,o=0;o<e.openEnd;o++)r=n,n=n.lastChild;for(var i=t.steps.length,s=this.ranges,a=0;a<s.length;a++){var c=s[a],u=c.$from,l=c.$to,f=t.mapping.slice(i);t.replaceRange(f.map(u.pos),f.map(l.pos),a?p.empty:e),0==a&&At(t,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}},kt.prototype.replaceWith=function(t,e){for(var n=t.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],s=i.$from,a=i.$to,c=t.mapping.slice(n),u=c.map(s.pos),l=c.map(a.pos);o?t.deleteRange(u,l):(t.replaceRangeWith(u,l,e),At(t,n,e.isInline?-1:1))}},kt.findFrom=function(t,e,n){var r=t.parent.inlineContent?new Ot(t):Nt(t.node(0),t.parent,t.pos,t.index(),e,n);if(r)return r;for(var o=t.depth-1;o>=0;o--){var i=e<0?Nt(t.node(0),t.node(o),t.before(o+1),t.index(o),e,n):Nt(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,e,n);if(i)return i}},kt.near=function(t,e){return void 0===e&&(e=1),this.findFrom(t,e)||this.findFrom(t,-e)||new Mt(t.node(0))},kt.atStart=function(t){return Nt(t,t,0,0,1)||new Mt(t)},kt.atEnd=function(t){return Nt(t,t,t.content.size,t.childCount,-1)||new Mt(t)},kt.fromJSON=function(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=wt[e.type];if(!n)throw new RangeError("No selection type "+e.type+" defined");return n.fromJSON(t,e)},kt.jsonID=function(t,e){if(t in wt)throw new RangeError("Duplicate use of selection JSON ID "+t);return wt[t]=e,e.prototype.jsonID=t,e},kt.prototype.getBookmark=function(){return Ot.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(kt.prototype,xt),kt.prototype.visible=!0;var St=function(t,e){this.$from=t,this.$to=e},Ot=function(t){function e(e,n){void 0===n&&(n=e),t.call(this,e,n)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},e.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));if(!o.parent.inlineContent)return t.near(o);var i=n.resolve(r.map(this.anchor));return new e(i.parent.inlineContent?i:o,o)},e.prototype.replace=function(e,n){if(void 0===n&&(n=p.empty),t.prototype.replace.call(this,e,n),n==p.empty){var r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head},e.prototype.getBookmark=function(){return new Ct(this.anchor,this.head)},e.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(n.anchor),t.resolve(n.head))},e.create=function(t,e,n){void 0===n&&(n=e);var r=t.resolve(e);return new this(r,n==e?r:t.resolve(n))},e.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=i>=0?1:-1),!r.parent.inlineContent){var s=t.findFrom(r,o,!0)||t.findFrom(r,-o,!0);if(!s)return t.near(r,o);r=s.$head}return n.parent.inlineContent||(0==i||(n=(t.findFrom(n,-o,!0)||t.findFrom(n,o,!0)).$anchor).pos<r.pos!=i<0)&&(n=r),new e(n,r)},Object.defineProperties(e.prototype,n),e}(kt);kt.jsonID("text",Ot);var Ct=function(t,e){this.anchor=t,this.head=e};Ct.prototype.map=function(t){return new Ct(t.map(this.anchor),t.map(this.head))},Ct.prototype.resolve=function(t){return Ot.between(t.resolve(this.anchor),t.resolve(this.head))};var Et=function(t){function e(e){var n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);t.call(this,e,r),this.node=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(n,r){var o=r.mapResult(this.anchor),i=o.deleted,s=o.pos,a=n.resolve(s);return i?t.near(a):new e(a)},e.prototype.content=function(){return new p(s.from(this.node),0,0)},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor},e.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},e.prototype.getBookmark=function(){return new _t(this.anchor)},e.fromJSON=function(t,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(n.anchor))},e.create=function(t,e){return new this(t.resolve(e))},e.isSelectable=function(t){return!t.isText&&!1!==t.type.spec.selectable},e}(kt);Et.prototype.visible=!1,kt.jsonID("node",Et);var _t=function(t){this.anchor=t};_t.prototype.map=function(t){var e=t.mapResult(this.anchor),n=e.deleted,r=e.pos;return n?new Ct(r,r):new _t(r)},_t.prototype.resolve=function(t){var e=t.resolve(this.anchor),n=e.nodeAfter;return n&&Et.isSelectable(n)?new Et(e):kt.near(e)};var Mt=function(t){function e(e){t.call(this,e.resolve(0),e.resolve(e.content.size))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.replace=function(e,n){if(void 0===n&&(n=p.empty),n==p.empty){e.delete(0,e.doc.content.size);var r=t.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else t.prototype.replace.call(this,e,n)},e.prototype.toJSON=function(){return{type:"all"}},e.fromJSON=function(t){return new e(t)},e.prototype.map=function(t){return new e(t)},e.prototype.eq=function(t){return t instanceof e},e.prototype.getBookmark=function(){return Tt},e}(kt);kt.jsonID("all",Mt);var Tt={map:function(){return this},resolve:function(t){return new Mt(t)}};function Nt(t,e,n,r,o,i){if(e.inlineContent)return Ot.create(t,n);for(var s=r-(o>0?0:1);o>0?s<e.childCount:s>=0;s+=o){var a=e.child(s);if(a.isAtom){if(!i&&Et.isSelectable(a))return Et.create(t,n-(o<0?a.nodeSize:0))}else{var c=Nt(t,a,n+o,o<0?a.childCount:0,o,i);if(c)return c}n+=a.nodeSize*o}}function At(t,e,n){var r=t.steps.length-1;if(!(r<e)){var o,i=t.steps[r];if(i instanceof bt.c||i instanceof bt.b)t.mapping.maps[r].forEach((function(t,e,n,r){null==o&&(o=r)})),t.setSelection(kt.near(t.doc.resolve(o),n))}}var It=function(t){function e(e){t.call(this,e.doc),this.time=Date.now(),this.curSelection=e.selection,this.curSelectionFor=0,this.storedMarks=e.storedMarks,this.updated=0,this.meta=Object.create(null)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},e.prototype.setSelection=function(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return(1&this.updated)>0},e.prototype.setStoredMarks=function(t){return this.storedMarks=t,this.updated|=2,this},e.prototype.ensureMarks=function(t){return f.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this},e.prototype.addStoredMark=function(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))},e.prototype.removeStoredMark=function(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(2&this.updated)>0},e.prototype.addStep=function(e,n){t.prototype.addStep.call(this,e,n),this.updated=-3&this.updated,this.storedMarks=null},e.prototype.setTime=function(t){return this.time=t,this},e.prototype.replaceSelection=function(t){return this.selection.replace(this,t),this},e.prototype.replaceSelectionWith=function(t,e){var n=this.selection;return!1!==e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||f.none))),n.replaceWith(this,t),this},e.prototype.deleteSelection=function(){return this.selection.replace(this),this},e.prototype.insertText=function(t,e,n){void 0===n&&(n=e);var r=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();if(!t)return this.deleteRange(e,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(e);o=n==e?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(e,n,r.text(t,o)),this.selection.empty||this.setSelection(kt.near(this.selection.$to)),this},e.prototype.setMeta=function(t,e){return this.meta["string"==typeof t?t:t.key]=e,this},e.prototype.getMeta=function(t){return this.meta["string"==typeof t?t:t.key]},n.isGeneric.get=function(){for(var t in this.meta)return!1;return!0},e.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(e.prototype,n),e}(bt.d);function jt(t,e){return e&&t?t.bind(e):t}var Dt=function(t,e,n){this.name=t,this.init=jt(e.init,n),this.apply=jt(e.apply,n)},Rt=[new Dt("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new Dt("selection",{init:function(t,e){return t.selection||kt.atStart(e.doc)},apply:function(t){return t.selection}}),new Dt("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Dt("scrollToSelection",{init:function(){return 0},apply:function(t,e){return t.scrolledIntoView?e+1:e}})],Pt=function(t,e){var n=this;this.schema=t,this.fields=Rt.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),e&&e.forEach((function(t){if(n.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");n.plugins.push(t),n.pluginsByKey[t.key]=t,t.spec.state&&n.fields.push(new Dt(t.key,t.spec.state,t))}))},zt=function(t){this.config=t},Ft={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};Ft.schema.get=function(){return this.config.schema},Ft.plugins.get=function(){return this.config.plugins},zt.prototype.apply=function(t){return this.applyTransaction(t).state},zt.prototype.filterTransaction=function(t,e){void 0===e&&(e=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=e){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,t,this))return!1}return!0},zt.prototype.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var e=[t],n=this.applyInner(t),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var s=this.config.plugins[i];if(s.spec.appendTransaction){var a=r?r[i].n:0,c=r?r[i].state:this,u=a<e.length&&s.spec.appendTransaction.call(s,a?e.slice(a):e,c,n);if(u&&n.filterTransaction(u,i)){if(u.setMeta("appendedTransaction",t),!r){r=[];for(var l=0;l<this.config.plugins.length;l++)r.push(l<i?{state:n,n:e.length}:{state:this,n:0})}e.push(u),n=n.applyInner(u),o=!0}r&&(r[i]={state:n,n:e.length})}}if(!o)return{state:n,transactions:e}}},zt.prototype.applyInner=function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var e=new zt(this.config),n=this.config.fields,r=0;r<n.length;r++){var o=n[r];e[o.name]=o.apply(t,this[o.name],this,e)}for(var i=0;i<Bt.length;i++)Bt[i](this,t,e);return e},Ft.tr.get=function(){return new It(this)},zt.create=function(t){for(var e=new Pt(t.doc?t.doc.type.schema:t.schema,t.plugins),n=new zt(e),r=0;r<e.fields.length;r++)n[e.fields[r].name]=e.fields[r].init(t,n);return n},zt.prototype.reconfigure=function(t){for(var e=new Pt(this.schema,t.plugins),n=e.fields,r=new zt(e),o=0;o<n.length;o++){var i=n[o].name;r[i]=this.hasOwnProperty(i)?this[i]:n[o].init(t,r)}return r},zt.prototype.toJSON=function(t){var e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map((function(t){return t.toJSON()}))),t&&"object"==typeof t)for(var n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=t[n],o=r.spec.state;o&&o.toJSON&&(e[n]=o.toJSON.call(r,this[r.key]))}return e},zt.fromJSON=function(t,e,n){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var r=new Pt(t.schema,t.plugins),o=new zt(r);return r.fields.forEach((function(r){if("doc"==r.name)o.doc=D.fromJSON(t.schema,e.doc);else if("selection"==r.name)o.selection=kt.fromJSON(o.doc,e.selection);else if("storedMarks"==r.name)e.storedMarks&&(o.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(n)for(var i in n){var s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(e,i))return void(o[r.name]=a.fromJSON.call(s,t,e[i],o))}o[r.name]=r.init(t,o)}})),o},zt.addApplyListener=function(t){Bt.push(t)},zt.removeApplyListener=function(t){var e=Bt.indexOf(t);e>-1&&Bt.splice(e,1)},Object.defineProperties(zt.prototype,Ft);var Bt=[];function Lt(t,e,n){for(var r in t){var o=t[r];o instanceof Function?o=o.bind(e):"handleDOMEvents"==r&&(o=Lt(o,e,{})),n[r]=o}return n}var $t=function(t){this.props={},t.props&&Lt(t.props,this,this.props),this.spec=t,this.key=t.key?t.key.key:Jt("plugin")};$t.prototype.getState=function(t){return t[this.key]};var qt=Object.create(null);function Jt(t){return t in qt?t+"$"+ ++qt[t]:(qt[t]=0,t+"$")}var Ut=function(t){void 0===t&&(t="key"),this.key=Jt(t)};Ut.prototype.get=function(t){return t.config.pluginsByKey[this.key]},Ut.prototype.getState=function(t){return t[this.key]}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return D})),n.d(e,"c",(function(){return rt})),n.d(e,"d",(function(){return p}));var r=n(12);function o(t,e,n){for(var r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;var i=t.child(r),s=e.child(r);if(i!=s){if(!i.sameMarkup(s))return n;if(i.isText&&i.text!=s.text){for(var a=0;i.text[a]==s.text[a];a++)n++;return n}if(i.content.size||s.content.size){var c=o(i.content,s.content,n+1);if(null!=c)return c}n+=i.nodeSize}else n+=i.nodeSize}}function i(t,e,n,r){for(var o=t.childCount,s=e.childCount;;){if(0==o||0==s)return o==s?null:{a:n,b:r};var a=t.child(--o),c=e.child(--s),u=a.nodeSize;if(a!=c){if(!a.sameMarkup(c))return{a:n,b:r};if(a.isText&&a.text!=c.text){for(var l=0,f=Math.min(a.text.length,c.text.length);l<f&&a.text[a.text.length-l-1]==c.text[c.text.length-l-1];)l++,n--,r--;return{a:n,b:r}}if(a.content.size||c.content.size){var h=i(a.content,c.content,n-1,r-1);if(h)return h}n-=u,r-=u}else n-=u,r-=u}}var s=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},a={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};s.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var u=s+1;a.nodesBetween(Math.max(0,t-u),Math.min(a.content.size,e-u),n,r+u)}s=c}},s.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},s.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},s.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new s(r,this.size+t.size)},s.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var o=0,i=0;i<e;o++){var a=this.content[o],c=i+a.nodeSize;c>t&&((i<t||c>e)&&(a=a.isText?a.cut(Math.max(0,t-i),Math.min(a.text.length,e-i)):a.cut(Math.max(0,t-i-1),Math.min(a.content.size,e-i-1))),n.push(a),r+=a.nodeSize),i=c}return new s(n,r)},s.prototype.cutByIndex=function(t,e){return t==e?s.empty:0==t&&e==this.content.length?this:new s(this.content.slice(t,e))},s.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new s(r,o)},s.prototype.addToStart=function(t){return new s([t].concat(this.content),this.size+t.nodeSize)},s.prototype.addToEnd=function(t){return new s(this.content.concat(t),this.size+t.nodeSize)},s.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},a.firstChild.get=function(){return this.content.length?this.content[0]:null},a.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},a.childCount.get=function(){return this.content.length},s.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},s.prototype.maybeChild=function(t){return this.content[t]},s.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},s.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),o(this,t,e)},s.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),i(this,t,e,n)},s.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return u(0,t);if(t==this.size)return u(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?u(n+1,o):u(n,r);r=o}},s.prototype.toString=function(){return"<"+this.toStringInner()+">"},s.prototype.toStringInner=function(){return this.content.join(", ")},s.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},s.fromJSON=function(t,e){if(!e)return s.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new s(e.map(t.nodeFromJSON))},s.fromArray=function(t){if(!t.length)return s.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new s(e||t,n)},s.from=function(t){if(!t)return s.empty;if(t instanceof s)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new s([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(s.prototype,a);var c={index:0,offset:0};function u(t,e){return c.index=t,c.offset=e,c}function l(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!l(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e)||!l(t[o],e[o]))return!1;for(var i in e)if(!(i in t))return!1}return!0}s.empty=new s([],0);var f=function(t,e){this.type=t,this.attrs=e};function h(t){var e=Error.call(this,t);return e.__proto__=h.prototype,e}f.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},f.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},f.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},f.prototype.eq=function(t){return this==t||this.type==t.type&&l(this.attrs,t.attrs)},f.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},f.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},f.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},f.setFrom=function(t){if(!t||0==t.length)return f.none;if(t instanceof f)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},f.none=[],h.prototype=Object.create(Error.prototype),h.prototype.constructor=h,h.prototype.name="ReplaceError";var p=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},d={size:{configurable:!0}};function v(t,e,n){var r=t.findIndex(e),o=r.index,i=r.offset,s=t.maybeChild(o),a=t.findIndex(n),c=a.index,u=a.offset;if(i==e||s.isText){if(u!=n&&!t.child(c).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return t.replaceChild(o,s.copy(v(s.content,e-i-1,n-i-1)))}function y(t,e,n,r){var o=t.findIndex(e),i=o.index,s=o.offset,a=t.maybeChild(i);if(s==e||a.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));var c=y(a.content,e-s-1,n);return c&&t.replaceChild(i,a.copy(c))}function m(t,e,n){if(n.openStart>t.depth)throw new h("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new h("Inconsistent open depths");return g(t,e,n,0)}function g(t,e,n,r){var o=t.index(r),i=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){var a=g(t,e,n,r+1);return i.copy(i.content.replaceChild(o,a))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){var c=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(s.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(n,t);return S(i,O(t,c.start,c.end,e,r))}var u=t.parent,l=u.content;return S(u,l.cut(0,t.parentOffset).append(n.content).append(l.cut(e.parentOffset)))}return S(i,C(t,e,r))}function b(t,e){if(!e.type.compatibleContent(t.type))throw new h("Cannot join "+e.type.name+" onto "+t.type.name)}function w(t,e,n){var r=t.node(n);return b(r,e.node(n)),r}function k(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function x(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(k(t.nodeAfter,r),i++));for(var a=i;a<s;a++)k(o.child(a),r);e&&e.depth==n&&e.textOffset&&k(e.nodeBefore,r)}function S(t,e){if(!t.type.validContent(e))throw new h("Invalid content for node "+t.type.name);return t.copy(e)}function O(t,e,n,r,o){var i=t.depth>o&&w(t,e,o+1),a=r.depth>o&&w(n,r,o+1),c=[];return x(null,t,o,c),i&&a&&e.index(o)==n.index(o)?(b(i,a),k(S(i,O(t,e,n,r,o+1)),c)):(i&&k(S(i,C(t,e,o+1)),c),x(e,n,o,c),a&&k(S(a,C(n,r,o+1)),c)),x(r,null,o,c),new s(c)}function C(t,e,n){var r=[];(x(null,t,n,r),t.depth>n)&&k(S(w(t,e,n+1),C(t,e,n+1)),r);return x(e,null,n,r),new s(r)}d.size.get=function(){return this.content.size-this.openStart-this.openEnd},p.prototype.insertAt=function(t,e){var n=y(this.content,t+this.openStart,e,null);return n&&new p(n,this.openStart,this.openEnd)},p.prototype.removeBetween=function(t,e){return new p(v(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},p.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},p.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},p.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},p.fromJSON=function(t,e){if(!e)return p.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new p(s.fromJSON(t,e.content),n,r)},p.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new p(t,n,r)},Object.defineProperties(p.prototype,d),p.empty=new p(s.empty,0,0);var E=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},_={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};E.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},_.parent.get=function(){return this.node(this.depth)},_.doc.get=function(){return this.node(0)},E.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},E.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},E.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},E.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},E.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},E.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},E.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},_.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},_.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},_.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},E.prototype.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,o=0;o<t;o++)r+=n.child(o).nodeSize;return r},E.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return f.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},E.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},E.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},E.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new A(this,t,n)},E.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},E.prototype.max=function(t){return t.pos>this.pos?t:this},E.prototype.min=function(t){return t.pos<this.pos?t:this},E.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},E.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,u=o-c;if(n.push(i,a,r+c),!u)break;if((i=i.child(a)).isText)break;o=u-1,r+=c+1}return new E(e,n,o)},E.resolveCached=function(t,e){for(var n=0;n<M.length;n++){var r=M[n];if(r.pos==e&&r.doc==t)return r}var o=M[T]=E.resolve(t,e);return T=(T+1)%N,o},Object.defineProperties(E.prototype,_);var M=[],T=0,N=12,A=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},I={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};I.start.get=function(){return this.$from.before(this.depth+1)},I.end.get=function(){return this.$to.after(this.depth+1)},I.parent.get=function(){return this.$from.node(this.depth)},I.startIndex.get=function(){return this.$from.index(this.depth)},I.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(A.prototype,I);var j=Object.create(null),D=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||s.empty,this.marks=r||f.none},R={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};R.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},R.childCount.get=function(){return this.content.childCount},D.prototype.child=function(t){return this.content.child(t)},D.prototype.maybeChild=function(t){return this.content.maybeChild(t)},D.prototype.forEach=function(t){this.content.forEach(t)},D.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},D.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},R.textContent.get=function(){return this.textBetween(0,this.content.size,"")},D.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},R.firstChild.get=function(){return this.content.firstChild},R.lastChild.get=function(){return this.content.lastChild},D.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},D.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},D.prototype.hasMarkup=function(t,e,n){return this.type==t&&l(this.attrs,e||t.defaultAttrs||j)&&f.sameSet(this.marks,n||f.none)},D.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},D.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},D.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},D.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return p.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new p(a,r.depth-i,o.depth-i)},D.prototype.replace=function(t,e,n){return m(this.resolve(t),this.resolve(e),n)},D.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},D.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},D.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},D.prototype.resolve=function(t){return E.resolveCached(this,t)},D.prototype.resolveNoCache=function(t){return E.resolve(this,t)},D.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},R.isBlock.get=function(){return this.type.isBlock},R.isTextblock.get=function(){return this.type.isTextblock},R.inlineContent.get=function(){return this.type.inlineContent},R.isInline.get=function(){return this.type.isInline},R.isText.get=function(){return this.type.isText},R.isLeaf.get=function(){return this.type.isLeaf},R.isAtom.get=function(){return this.type.isAtom},D.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),z(this.marks,t)},D.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},D.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=s.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),a=i&&i.matchFragment(this.content,e);if(!a||!a.validEnd)return!1;for(var c=r;c<o;c++)if(!this.type.allowsMarks(n.child(c).marks))return!1;return!0},D.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},D.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},D.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},D.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},D.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=s.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(D.prototype,R);var P=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):z(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(D);function z(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var F=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},B={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};F.parse=function(t,e){var n=new L(t,e);if(null==n.next)return F.empty;var r=q(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return n(K(t,0));function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];K(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new F(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(H);i.next.push(o[s],e[a.join(",")]||n(a))}return i}}(function(t){var e=[[]];return o(i(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}function i(t,e){if("choice"==t.type)return t.exprs.reduce((function(t,n){return t.concat(i(n,e))}),[]);if("seq"==t.type)for(var s=0;;s++){var a=i(t.exprs[s],e);if(s==t.exprs.length-1)return a;o(a,e=n())}else{if("star"==t.type){var c=n();return r(e,c),o(i(t.expr,c),c),[r(c)]}if("plus"==t.type){var u=n();return o(i(t.expr,e),u),o(i(t.expr,u),u),[r(u)]}if("opt"==t.type)return[r(e)].concat(i(t.expr,e));if("range"==t.type){for(var l=e,f=0;f<t.min;f++){var h=n();o(i(t.expr,l),h),l=h}if(-1==t.max)o(i(t.expr,l),l);else for(var p=t.min;p<t.max;p++){var d=n();r(l,d),o(i(t.expr,l),d),l=d}return[r(l)]}if("name"==t.type)return[r(e,null,t.value)]}}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],u=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(u)&&r.push(u)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},F.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},F.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},B.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},B.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},F.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},F.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,a){var c=i.matchFragment(t,n);if(c&&(!e||c.validEnd))return s.from(a.map((function(t){return t.createAndFill()})));for(var u=0;u<i.next.length;u+=2){var l=i.next[u],f=i.next[u+1];if(!l.isText&&!l.hasRequiredAttrs()&&-1==r.indexOf(f)){r.push(f);var h=o(f,a.concat(l));if(h)return h}}}(this,[])},F.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},F.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},B.edgeCount.get=function(){return this.next.length>>1},F.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},F.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(F.prototype,B),F.empty=new F(!0);var L=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},$={next:{configurable:!0}};function q(t){var e=[];do{e.push(J(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function J(t){var e=[];do{e.push(U(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function U(t){for(var e=function(t){if(t.eat("(")){var e=q(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=W(t,e)}return e}function V(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function W(t,e){var n=V(t),r=n;return t.eat(",")&&(r="}"!=t.next?V(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function H(t,e){return e-t}function K(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(H)}function Y(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function G(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function Q(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new tt(t[n]);return e}$.next.get=function(){return this.tokens[this.pos]},L.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},L.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(L.prototype,$);var X=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=Q(n.attrs),this.defaultAttrs=Y(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},Z={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Z.isInline.get=function(){return!this.isBlock},Z.isTextblock.get=function(){return this.isBlock&&this.inlineContent},Z.isLeaf.get=function(){return this.contentMatch==F.empty},Z.isAtom.get=function(){return this.isLeaf||this.spec.atom},X.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},X.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},X.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:G(this.attrs,t)},X.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new D(this,this.computeAttrs(t),s.from(e),f.setFrom(n))},X.prototype.createChecked=function(t,e,n){if(e=s.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new D(this,this.computeAttrs(t),e,f.setFrom(n))},X.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=s.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e).fillBefore(s.empty,!0);return o?new D(this,t,e.append(o),f.setFrom(n)):null},X.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},X.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},X.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},X.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:f.empty:t},X.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new X(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(X.prototype,Z);var tt=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},et={isRequired:{configurable:!0}};et.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(tt.prototype,et);var nt=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=Q(r.attrs),this.rank=e,this.excluded=null;var o=Y(this.attrs);this.instance=o&&new f(this,o)};nt.prototype.create=function(t){return!t&&this.instance?this.instance:new f(this,G(this.attrs,t))},nt.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new nt(t,r++,e,o)})),n},nt.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t},nt.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},nt.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var rt=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=r.a.from(t.nodes),this.spec.marks=r.a.from(t.marks),this.nodes=X.compile(this.spec.nodes,this),this.marks=nt.compile(this.spec.marks,this);var n=Object.create(null);for(var o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");var i=this.nodes[o],s=i.spec.content||"",a=i.spec.marks;i.contentMatch=n[s]||(n[s]=F.parse(s,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.markSet="_"==a?null:a?ot(this,a.split(" ")):""!=a&&i.inlineContent?null:[]}for(var c in this.marks){var u=this.marks[c],l=u.spec.excludes;u.excluded=null==l?[u]:""==l?[]:ot(this,l.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function ot(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}rt.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof X))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},rt.prototype.text=function(t,e){var n=this.nodes.text;return new P(n,n.defaultAttrs,t,f.setFrom(e))},rt.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},rt.prototype.nodeFromJSON=function(t){return D.fromJSON(this,t)},rt.prototype.markFromJSON=function(t){return f.fromJSON(this,t)},rt.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var it=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)})),this.normalizeLists=!this.tags.some((function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)}))};it.prototype.parse=function(t,e){void 0===e&&(e={});var n=new ft(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},it.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new ft(this,e,!0);return n.addAll(t,null,e.from,e.to),p.maxOpen(n.finish())},it.prototype.matchTag=function(t,e,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(pt(t,o.tag)&&(void 0===o.namespace||t.namespaceURI==o.namespace)&&(!o.context||e.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(t);if(!1===i)continue;o.attrs=i}return o}}},it.prototype.matchStyle=function(t,e,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(t)||i.context&&!n.matchesContext(i.context)||i.style.length>t.length&&(61!=i.style.charCodeAt(t.length)||i.style.slice(t.length+1)!=e))){if(i.getAttrs){var s=i.getAttrs(e);if(!1===s)continue;i.attrs=s}return i}}},it.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=dt(t)),t.mark=e}))};for(var o in t.marks)r(o);var i=function(e){var r=t.nodes[s].spec.parseDOM;r&&r.forEach((function(t){n(t=dt(t)),t.node=s}))};for(var s in t.nodes)i();return e},it.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new it(t,it.schemaRules(t)))};var st={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},at={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},ct={ol:!0,ul:!0};function ut(t){return(t?1:0)|("full"===t?2:0)}var lt=function(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=f.none,this.pendingMarks=r,this.stashMarks=[]};lt.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(s.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},lt.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=s.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(s.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},lt.prototype.popFromStashMark=function(t){for(var e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]},lt.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):vt(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}};var ft=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,i=ut(e.preserveWhitespace)|(n?4:0);r=o?new lt(o.type,o.attrs,f.none,f.none,!0,e.topMatch||o.type.contentMatch,i):new lt(n?null:t.schema.topNodeType,null,f.none,f.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},ht={top:{configurable:!0},currentPos:{configurable:!0}};function pt(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function dt(t){var e={};for(var n in t)e[n]=t[n];return e}function vt(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var i=[];return function t(n){i.push(n);for(var r=0;r<n.edgeCount;r++){var o=n.edge(r),s=o.type,a=o.next;if(s==e)return!0;if(i.indexOf(a)<0&&t(a))return!0}}(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}ht.top.get=function(){return this.nodes[this.open]},ft.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},ft.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},ft.prototype.addElement=function(t,e){var n,r=t.nodeName.toLowerCase();ct.hasOwnProperty(r)&&this.parser.normalizeLists&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&ct.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var o=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(n=this.parser.matchTag(t,this,e));if(o?o.ignore:at.hasOwnProperty(r))this.findInside(t);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(t=o.skip);var i,s=this.top,a=this.needsBlock;if(st.hasOwnProperty(r))i=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),i&&this.sync(s),this.needsBlock=a}else this.addElementByRule(t,o,!1===o.consuming?n:null)},ft.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},ft.prototype.readStyles=function(t){var e=f.none;t:for(var n=0;n<t.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(t[n],t[n+1],this,r);if(!o)continue t;if(o.ignore)return null;if(e=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(e),!1!==o.consuming)break;r=o}return e},ft.prototype.addElementByRule=function(t,e,n){var r,o,i,s=this;e.node?(o=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(o.create(e.attrs))||this.leafFallback(t):r=this.enter(o,e.attrs,e.preserveWhitespace):(i=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(i));var a=this.top;if(o&&o.isLeaf)this.findInside(t);else if(n)this.addElement(t,n);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return s.insertNode(t)}));else{var c=e.contentElement;"string"==typeof c?c=t.querySelector(c):"function"==typeof c&&(c=c(t)),c||(c=t),this.findAround(t,c,!0),this.addAll(c,r)}r&&(this.sync(a),this.open--),i&&this.removePendingMark(i,a)},ft.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&st.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},ft.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},ft.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},ft.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},ft.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:ut(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new lt(t,e,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},ft.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},ft.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},ft.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},ht.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},ft.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},ft.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},ft.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},ft.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},ft.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1);return function t(s,a){for(;s>=0;s--){var c=n[s];if(""==c){if(s==n.length-1||0==s)continue;for(;a>=i;a--)if(t(s-1,a))return!0;return!1}var u=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!u||u.name!=c&&-1==u.groups.indexOf(c))return!1;a--}return!0}(n.length-1,this.open)},ft.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},ft.prototype.addPendingMark=function(t){var e=function(t,e){for(var n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},ft.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(t)>-1)r.pendingMarks=t.removeFromSet(r.pendingMarks);else{r.activeMarks=t.removeFromSet(r.activeMarks);var o=r.popFromStashMark(t);o&&r.type&&r.type.allowsMarkType(o.type)&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==e)break}},Object.defineProperties(ft.prototype,ht);var yt=function(t,e){this.nodes=t||{},this.marks=e||{}};function mt(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function gt(t){return t.document||window.document}yt.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=gt(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],u=r.serializeMark(c,t.isInline,e);u&&(i.push(c,o),o.appendChild(u.dom),o=u.contentDOM||u.dom)}}o.appendChild(r.serializeNode(t,e))})),n},yt.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=yt.renderSpec(gt(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},yt.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},yt.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&yt.renderSpec(gt(n),r(t,e))},yt.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var u in c=2,a)if(null!=a[u]){var l=u.indexOf(" ");l>0?s.setAttributeNS(u.slice(0,l),u.slice(l+1),a[u]):s.setAttribute(u,a[u])}for(var f=c;f<e.length;f++){var h=e[f];if(0===h){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var p=yt.renderSpec(t,h,n),d=p.dom,v=p.contentDOM;if(s.appendChild(d),v){if(i)throw new RangeError("Multiple content holes");i=v}}return{dom:s,contentDOM:i}},yt.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new yt(this.nodesFromSchema(t),this.marksFromSchema(t)))},yt.nodesFromSchema=function(t){var e=mt(t.nodes);return e.text||(e.text=function(t){return t.text}),e},yt.marksFromSchema=function(t){return mt(t.marks)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1),o="undefined"!==typeof window?r.useLayoutEffect:r.useEffect},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"d",(function(){return a})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return u}));var r=n(25),o=n(28),i=(n(41),n(46)),s=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;try{for(;r<e.length;r++)e[r].apply(e,Object(o.a)(n))}finally{r<e.length&&t(e,n,r+1)}},a=function(){},c=function(t,e){return t===e},u=function t(e,n){if(null==e||null==n)return c(e,n);if(e.constructor!==n.constructor)return!1;if(e===n)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),n=new Uint8Array(n);case Uint8Array:if(e.byteLength!==n.byteLength)return!1;for(var o=0;o<e.length;o++)if(e[o]!==n[o])return!1;break;case Set:if(e.size!==n.size)return!1;var s,a=Object(r.a)(e);try{for(a.s();!(s=a.n()).done;){var u=s.value;if(!n.has(u))return!1}}catch(v){a.e(v)}finally{a.f()}break;case Map:if(e.size!==n.size)return!1;var l,f=Object(r.a)(e.keys());try{for(f.s();!(l=f.n()).done;){var h=l.value;if(!n.has(h)||!t(e.get(h),n.get(h)))return!1}}catch(v){f.e(v)}finally{f.f()}break;case Object:if(i.d(e)!==i.d(n))return!1;for(var p in e)if(!i.b(e,p)||!t(e[p],n[p]))return!1;break;case Array:if(e.length!==n.length)return!1;for(var d=0;d<e.length;d++)if(!t(e[d],n[d]))return!1;break;default:return!1}return!0}},function(t,e,n){"use strict";n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return h}));n(67);var r=n(6),o=(n(49),n(33),n(15)),i=n(13),s=n(47),a=null,c=function(){var t=a;a=null,t.forEach((function(t,e){var n=e.state.tr;t.forEach((function(t,e){n.setMeta(e,t)})),e.dispatch(n)}))},u=function(t,e,n){a||(a=new Map,s.b(0,c)),i.e(a,t,i.c).set(e,n)},l=function(t,e,n){if(0===t)return r.s(e,0);for(var i=null===e._first?null:e._first.content.type;null!==i&&e!==i;){if(i.constructor===r.l){if(i._length>=t)return r.s(i,t);if(t-=i._length,null!==i._item&&null!==i._item.next)i=i._item.next.content.type;else{do{i=null===i._item?null:i._item.parent,t--}while(i!==e&&null!==i&&null!==i._item&&null===i._item.next);null!==i&&i!==e&&(i=null===i._item?null:i._item.next.content.type)}}else{var s=(n.get(i)||{nodeSize:0}).nodeSize;if(null!==i._first&&t<s)i=i._first.content.type,t--;else{if(1===t&&0===i._length&&s>1)return new r.f(null===i._item?null:i._item.id,null===i._item?r.w(i):null,null);if(t-=s,null!==i._item&&null!==i._item.next)i=i._item.next.content.type;else{if(0===t)return i=null===i._item?i:i._item.parent,new r.f(null===i._item?null:i._item.id,null===i._item?r.w(i):null,null);do{i=i._item.parent,t--}while(i!==e&&null===i._item.next);i!==e&&(i=i._item.next.content.type)}}}if(null===i)throw o.c();if(0===t&&i.constructor!==r.l&&i!==e)return f(i._item.parent,i._item)}return r.s(e,e._length)},f=function(t,e){var n=null,o=null;return null===t._item?o=r.w(t):n=r.q(t._item.id.client,t._item.id.clock),new r.f(n,o,e.id)},h=function(t,e,n,o){var i=r.o(n,t);if(null===i||i.type!==e&&!r.y(e,i.type._item))return null;var s=i.type,a=0;if(s.constructor===r.l)a=i.index;else if(null===s._item||!s._item.deleted){for(var c=s._first,u=0;u<s._length&&u<i.index&&null!==c;){if(!c.deleted){var l=c.content.type;u++,l.constructor===r.l?a+=l._length:a+=o.get(l).nodeSize}c=c.right}a+=1}for(;s!==e&&null!==s._item;){var f=s._item.parent;if(null===f._item||!f._item.deleted){a+=1;for(var h=f._first;null!==h;){var p=h.content.type;if(p===s)break;h.deleted||(p.constructor===r.l?a+=p._length:a+=o.get(p).nodeSize),h=h.right}}s=f}return a-1}},function(t,e){"function"===typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}},function(t,e,n){"use strict";var r,o,i,s=[n(122),n(123),n(124),n(125),n(126),n(127)],a=-1,c=[],u=!1;function l(){r&&o&&(r=!1,o.length?c=o.concat(c):a=-1,c.length&&f())}function f(){if(!r){u=!1,r=!0;for(var t=c.length,e=setTimeout(l);t;){for(o=c,c=[];o&&++a<t;)o[a].run();a=-1,t=c.length}o=null,a=-1,r=!1,clearTimeout(e)}}for(var h=-1,p=s.length;++h<p;)if(s[h]&&s[h].test&&s[h].test()){i=s[h].install(f);break}function d(t,e){this.fun=t,this.array=e}d.prototype.run=function(){var t=this.fun,e=this.array;switch(e.length){case 0:return t();case 1:return t(e[0]);case 2:return t(e[0],e[1]);case 3:return t(e[0],e[1],e[2]);default:return t.apply(null,e)}},t.exports=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new d(t,e)),u||r||(u=!0,i())}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(28),o=n(3),i=n(5),s=n(13),a=n(44),c=n(41),u=function(){function t(){Object(o.a)(this,t),this._observers=s.c()}return Object(i.a)(t,[{key:"on",value:function(t,e){s.e(this._observers,t,a.a).add(e)}},{key:"once",value:function(t,e){var n=this;this.on(t,(function r(){n.off(t,r),e.apply(void 0,arguments)}))}},{key:"off",value:function(t,e){var n=this._observers.get(t);void 0!==n&&(n.delete(e),0===n.size&&this._observers.delete(t))}},{key:"emit",value:function(t,e){return c.c((this._observers.get(t)||s.c()).values()).forEach((function(t){return t.apply(void 0,Object(r.a)(e))}))}},{key:"destroy",value:function(){this._observers=s.c()}}]),t}()},function(t,e,n){"use strict";n.d(e,"d",(function(){return r})),n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return s}));var r=function(t){return t[t.length-1]},o=function(t,e){for(var n=0;n<e.length;n++)t.push(e[n])},i=Array.from,s=function(t,e){return t.length===e.length&&(n=function(t,n){return t===e[n]},t.every(n));var n}},function(t,e,n){"use strict";n.d(e,"a",(function(){return m})),n.d(e,"d",(function(){return g})),n.d(e,"c",(function(){return b})),n.d(e,"b",(function(){return w}));var r=n(3),o=n(5),i=n(27),s=n(24),a=n(22),c=n(11),u=n(10),l=n(0),f=n(2),h=n(26),p=n(9),d=n(40),v=n(35),y=3e4,m=function(t){Object(c.a)(n,t);var e=Object(u.a)(n);function n(t){var o;return Object(r.a)(this,n),(o=e.call(this)).doc=t,o.states=new Map,o.meta=new Map,o._checkInterval=setInterval((function(){var e=h.a();null!==o.getLocalState()&&15e3<=e-o.meta.get(t.clientID).lastUpdated&&o.setLocalState(o.getLocalState());var n=[];o.meta.forEach((function(r,i){i!==t.clientID&&y<=e-r.lastUpdated&&o.states.has(i)&&n.push(i)})),n.length>0&&g(Object(i.a)(o),n,"timeout")}),p.c(3e3)),t.on("destroy",(function(){o.destroy()})),o.setLocalState({}),o}return Object(o.a)(n,[{key:"destroy",value:function(){Object(s.a)(Object(a.a)(n.prototype),"destroy",this).call(this),clearInterval(this._checkInterval)}},{key:"getLocalState",value:function(){return this.states.get(this.doc.clientID)||null}},{key:"setLocalState",value:function(t){var e=this.doc.clientID,n=this.meta.get(e),r=void 0===n?0:n.clock+1,o=this.states.get(e);null===t?this.states.delete(e):this.states.set(e,t),this.meta.set(e,{clock:r,lastUpdated:h.a()});var i=[],s=[],a=[],c=[];null===t?c.push(e):null==o?null!=t&&i.push(e):(s.push(e),v.b(o,t)||a.push(e)),(i.length>0||a.length>0||c.length>0)&&this.emit("change",[{added:i,updated:a,removed:c},"local"]),this.emit("update",[{added:i,updated:s,removed:c},"local"])}},{key:"setLocalStateField",value:function(t,e){var n=this.getLocalState();null!==n&&(n[t]=e,this.setLocalState(n))}},{key:"getStates",value:function(){return this.states}}]),n}(d.a),g=function(t,e,n){for(var r=[],o=0;o<e.length;o++){var i=e[o];if(t.states.has(i)){if(t.states.delete(i),i===t.doc.clientID){var s=t.meta.get(i);t.meta.set(i,{clock:s.clock+1,lastUpdated:h.a()})}r.push(i)}}r.length>0&&(t.emit("change",[{added:[],updated:[],removed:r},n]),t.emit("update",[{added:[],updated:[],removed:r},n]))},b=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.states,r=e.length,o=l.e();l.m(o,r);for(var i=0;i<r;i++){var s=e[i],a=n.get(s)||null,c=t.meta.get(s).clock;l.m(o,s),l.m(o,c),l.l(o,JSON.stringify(a))}return l.f(o)},w=function(t,e,n){for(var r=f.e(e),o=h.a(),i=[],s=[],a=[],c=[],u=f.k(r),l=0;l<u;l++){var p=f.k(r),d=f.k(r),y=JSON.parse(f.j(r)),m=t.meta.get(p),g=t.states.get(p),b=void 0===m?0:m.clock;(b<d||b===d&&null===y&&t.states.has(p))&&(null===y?p===t.doc.clientID&&null!=t.getLocalState()?d++:t.states.delete(p):t.states.set(p,y),t.meta.set(p,{clock:d,lastUpdated:o}),void 0===m&&null!==y?i.push(p):void 0!==m&&null===y?c.push(p):null!==y&&(v.b(y,g)||a.push(p),s.push(p)))}(i.length>0||a.length>0||c.length>0)&&t.emit("change",[{added:i,updated:a,removed:c},n]),(i.length>0||s.length>0||c.length>0)&&t.emit("update",[{added:i,updated:s,removed:c},n])}},function(t,e,n){"use strict";function r(t,e,n,r,o,i,s){try{var a=t[i](s),c=a.value}catch(u){return void n(u)}a.done?e(c):Promise.resolve(c).then(r,o)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(o,i){var s=t.apply(e,n);function a(t){r(s,o,i,a,c,"next",t)}function c(t){r(s,o,i,a,c,"throw",t)}a(void 0)}))}}n.d(e,"a",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){return new Set}},function(t,e,n){"use strict";(function(t){n.d(e,"c",(function(){return l})),n.d(e,"b",(function(){return f})),n.d(e,"a",(function(){return d}));var r,o,i=n(18),s=n(13),a=n(48),c=n(74),u=n(63),l="undefined"!==typeof t&&t.release&&/node|io\.js/.test(t.release.name),f="undefined"!==typeof window&&!l,h=("undefined"!==typeof navigator&&/Mac/.test(navigator.platform),[]),p=function(){if(void 0===r)if(l){r=s.c();for(var e=t.argv,n=null,o=0;o<e.length;o++){var c=e[o];"-"===c[0]?(null!==n&&r.set(n,""),n=c):null!==n?(r.set(n,c),n=null):h.push(c)}null!==n&&r.set(n,"")}else"object"===typeof location?(r=s.c(),(location.search||"?").slice(1).split("&").forEach((function(t){if(0!==t.length){var e=t.split("="),n=Object(i.a)(e,2),o=n[0],s=n[1];r.set("--".concat(a.b(o,"-")),s),r.set("-".concat(a.b(o,"-")),s)}}))):r=s.c();return r},d=function(t){return l?c.a(Object({NODE_ENV:"production",PUBLIC_URL:"/experiment-501.V2",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})[t.toUpperCase()]):c.a(u.a.getItem(t))};(function(t){return p().has(t)})("--"+(o="production"))||d(o)}).call(this,n(70))},function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"d",(function(){return o})),n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return s}));Object.assign;var r=Object.keys,o=function(t){return r(t).length},i=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s=function(t,e){return t===e||o(t)===o(e)&&function(t,e){for(var n in t)if(!e(t[n],n))return!1;return!0}(t,(function(t,n){return(void 0!==t||i(e,n))&&e[n]===t}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return l}));var r=n(3),o=n(5),i=[],s=function(){for(var t=0;t<i.length;t++)i[t]();i=[]},a=function(t){i.push(t),1===i.length&&setTimeout(s,0)},c=function(t){return function(){function e(t){Object(r.a)(this,e),this._=t}return Object(o.a)(e,[{key:"destroy",value:function(){t(this._)}}]),e}()},u=c(clearTimeout),l=function(t,e){return new u(setTimeout(e,t))};c(clearInterval),c((function(t){return"undefined"!==typeof requestAnimationFrame&&cancelAnimationFrame(t)})),c((function(t){return"undefined"!==typeof cancelIdleCallback&&cancelIdleCallback(t)}))},function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return c}));var r=String.fromCharCode,o=(String.fromCodePoint,/^\s*/g),i=/([A-Z])/g,s=function(t,e){return function(t){return t.replace(o,"")}(t.replace(i,(function(t){return"".concat(e).concat(function(t){return t.toLowerCase()}(t))})))},a="undefined"!==typeof TextEncoder?new TextEncoder:null,c=a?function(t){return a.encode(t)}:function(t){for(var e=unescape(encodeURIComponent(t)),n=e.length,r=new Uint8Array(n),o=0;o<n;o++)r[o]=e.codePointAt(o);return r},u="undefined"===typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});u&&1===u.decode(new Uint8Array).length&&(u=null)},function(t,e,n){"use strict";n.d(e,"a",(function(){return dr})),n.d(e,"b",(function(){return gr})),n.d(e,"c",(function(){return Tr}));var r=n(12);function o(t,e,n){for(var r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;var i=t.child(r),s=e.child(r);if(i!=s){if(!i.sameMarkup(s))return n;if(i.isText&&i.text!=s.text){for(var a=0;i.text[a]==s.text[a];a++)n++;return n}if(i.content.size||s.content.size){var c=o(i.content,s.content,n+1);if(null!=c)return c}n+=i.nodeSize}else n+=i.nodeSize}}function i(t,e,n,r){for(var o=t.childCount,s=e.childCount;;){if(0==o||0==s)return o==s?null:{a:n,b:r};var a=t.child(--o),c=e.child(--s),u=a.nodeSize;if(a!=c){if(!a.sameMarkup(c))return{a:n,b:r};if(a.isText&&a.text!=c.text){for(var l=0,f=Math.min(a.text.length,c.text.length);l<f&&a.text[a.text.length-l-1]==c.text[c.text.length-l-1];)l++,n--,r--;return{a:n,b:r}}if(a.content.size||c.content.size){var h=i(a.content,c.content,n-1,r-1);if(h)return h}n-=u,r-=u}else n-=u,r-=u}}var s=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},a={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};s.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var u=s+1;a.nodesBetween(Math.max(0,t-u),Math.min(a.content.size,e-u),n,r+u)}s=c}},s.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},s.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},s.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new s(r,this.size+t.size)},s.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var o=0,i=0;i<e;o++){var a=this.content[o],c=i+a.nodeSize;c>t&&((i<t||c>e)&&(a=a.isText?a.cut(Math.max(0,t-i),Math.min(a.text.length,e-i)):a.cut(Math.max(0,t-i-1),Math.min(a.content.size,e-i-1))),n.push(a),r+=a.nodeSize),i=c}return new s(n,r)},s.prototype.cutByIndex=function(t,e){return t==e?s.empty:0==t&&e==this.content.length?this:new s(this.content.slice(t,e))},s.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new s(r,o)},s.prototype.addToStart=function(t){return new s([t].concat(this.content),this.size+t.nodeSize)},s.prototype.addToEnd=function(t){return new s(this.content.concat(t),this.size+t.nodeSize)},s.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},a.firstChild.get=function(){return this.content.length?this.content[0]:null},a.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},a.childCount.get=function(){return this.content.length},s.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},s.prototype.maybeChild=function(t){return this.content[t]},s.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},s.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),o(this,t,e)},s.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),i(this,t,e,n)},s.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return u(0,t);if(t==this.size)return u(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?u(n+1,o):u(n,r);r=o}},s.prototype.toString=function(){return"<"+this.toStringInner()+">"},s.prototype.toStringInner=function(){return this.content.join(", ")},s.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},s.fromJSON=function(t,e){if(!e)return s.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new s(e.map(t.nodeFromJSON))},s.fromArray=function(t){if(!t.length)return s.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new s(e||t,n)},s.from=function(t){if(!t)return s.empty;if(t instanceof s)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new s([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(s.prototype,a);var c={index:0,offset:0};function u(t,e){return c.index=t,c.offset=e,c}function l(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!l(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e)||!l(t[o],e[o]))return!1;for(var i in e)if(!(i in t))return!1}return!0}s.empty=new s([],0);var f=function(t,e){this.type=t,this.attrs=e};function h(t){var e=Error.call(this,t);return e.__proto__=h.prototype,e}f.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},f.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},f.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},f.prototype.eq=function(t){return this==t||this.type==t.type&&l(this.attrs,t.attrs)},f.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},f.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},f.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},f.setFrom=function(t){if(!t||0==t.length)return f.none;if(t instanceof f)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},f.none=[],h.prototype=Object.create(Error.prototype),h.prototype.constructor=h,h.prototype.name="ReplaceError";var p=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},d={size:{configurable:!0}};function v(t,e,n){var r=t.findIndex(e),o=r.index,i=r.offset,s=t.maybeChild(o),a=t.findIndex(n),c=a.index,u=a.offset;if(i==e||s.isText){if(u!=n&&!t.child(c).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return t.replaceChild(o,s.copy(v(s.content,e-i-1,n-i-1)))}function y(t,e,n,r){var o=t.findIndex(e),i=o.index,s=o.offset,a=t.maybeChild(i);if(s==e||a.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));var c=y(a.content,e-s-1,n);return c&&t.replaceChild(i,a.copy(c))}function m(t,e,n){if(n.openStart>t.depth)throw new h("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new h("Inconsistent open depths");return g(t,e,n,0)}function g(t,e,n,r){var o=t.index(r),i=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){var a=g(t,e,n,r+1);return i.copy(i.content.replaceChild(o,a))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){var c=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(s.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(n,t);return S(i,O(t,c.start,c.end,e,r))}var u=t.parent,l=u.content;return S(u,l.cut(0,t.parentOffset).append(n.content).append(l.cut(e.parentOffset)))}return S(i,C(t,e,r))}function b(t,e){if(!e.type.compatibleContent(t.type))throw new h("Cannot join "+e.type.name+" onto "+t.type.name)}function w(t,e,n){var r=t.node(n);return b(r,e.node(n)),r}function k(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function x(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(k(t.nodeAfter,r),i++));for(var a=i;a<s;a++)k(o.child(a),r);e&&e.depth==n&&e.textOffset&&k(e.nodeBefore,r)}function S(t,e){if(!t.type.validContent(e))throw new h("Invalid content for node "+t.type.name);return t.copy(e)}function O(t,e,n,r,o){var i=t.depth>o&&w(t,e,o+1),a=r.depth>o&&w(n,r,o+1),c=[];return x(null,t,o,c),i&&a&&e.index(o)==n.index(o)?(b(i,a),k(S(i,O(t,e,n,r,o+1)),c)):(i&&k(S(i,C(t,e,o+1)),c),x(e,n,o,c),a&&k(S(a,C(n,r,o+1)),c)),x(r,null,o,c),new s(c)}function C(t,e,n){var r=[];(x(null,t,n,r),t.depth>n)&&k(S(w(t,e,n+1),C(t,e,n+1)),r);return x(e,null,n,r),new s(r)}d.size.get=function(){return this.content.size-this.openStart-this.openEnd},p.prototype.insertAt=function(t,e){var n=y(this.content,t+this.openStart,e,null);return n&&new p(n,this.openStart,this.openEnd)},p.prototype.removeBetween=function(t,e){return new p(v(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},p.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},p.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},p.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},p.fromJSON=function(t,e){if(!e)return p.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new p(s.fromJSON(t,e.content),n,r)},p.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new p(t,n,r)},Object.defineProperties(p.prototype,d),p.empty=new p(s.empty,0,0);var E=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},_={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};E.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},_.parent.get=function(){return this.node(this.depth)},_.doc.get=function(){return this.node(0)},E.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},E.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},E.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},E.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},E.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},E.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},E.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},_.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},_.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},_.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},E.prototype.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,o=0;o<t;o++)r+=n.child(o).nodeSize;return r},E.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return f.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},E.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},E.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},E.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new A(this,t,n)},E.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},E.prototype.max=function(t){return t.pos>this.pos?t:this},E.prototype.min=function(t){return t.pos<this.pos?t:this},E.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},E.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,u=o-c;if(n.push(i,a,r+c),!u)break;if((i=i.child(a)).isText)break;o=u-1,r+=c+1}return new E(e,n,o)},E.resolveCached=function(t,e){for(var n=0;n<M.length;n++){var r=M[n];if(r.pos==e&&r.doc==t)return r}var o=M[T]=E.resolve(t,e);return T=(T+1)%N,o},Object.defineProperties(E.prototype,_);var M=[],T=0,N=12,A=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},I={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};I.start.get=function(){return this.$from.before(this.depth+1)},I.end.get=function(){return this.$to.after(this.depth+1)},I.parent.get=function(){return this.$from.node(this.depth)},I.startIndex.get=function(){return this.$from.index(this.depth)},I.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(A.prototype,I);var j=Object.create(null),D=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||s.empty,this.marks=r||f.none},R={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};R.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},R.childCount.get=function(){return this.content.childCount},D.prototype.child=function(t){return this.content.child(t)},D.prototype.maybeChild=function(t){return this.content.maybeChild(t)},D.prototype.forEach=function(t){this.content.forEach(t)},D.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},D.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},R.textContent.get=function(){return this.textBetween(0,this.content.size,"")},D.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},R.firstChild.get=function(){return this.content.firstChild},R.lastChild.get=function(){return this.content.lastChild},D.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},D.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},D.prototype.hasMarkup=function(t,e,n){return this.type==t&&l(this.attrs,e||t.defaultAttrs||j)&&f.sameSet(this.marks,n||f.none)},D.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},D.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},D.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},D.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return p.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new p(a,r.depth-i,o.depth-i)},D.prototype.replace=function(t,e,n){return m(this.resolve(t),this.resolve(e),n)},D.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},D.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},D.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},D.prototype.resolve=function(t){return E.resolveCached(this,t)},D.prototype.resolveNoCache=function(t){return E.resolve(this,t)},D.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},R.isBlock.get=function(){return this.type.isBlock},R.isTextblock.get=function(){return this.type.isTextblock},R.inlineContent.get=function(){return this.type.inlineContent},R.isInline.get=function(){return this.type.isInline},R.isText.get=function(){return this.type.isText},R.isLeaf.get=function(){return this.type.isLeaf},R.isAtom.get=function(){return this.type.isAtom},D.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),z(this.marks,t)},D.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},D.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=s.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),a=i&&i.matchFragment(this.content,e);if(!a||!a.validEnd)return!1;for(var c=r;c<o;c++)if(!this.type.allowsMarks(n.child(c).marks))return!1;return!0},D.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},D.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},D.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},D.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},D.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=s.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(D.prototype,R);var P=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):z(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(D);function z(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var F=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},B={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};F.parse=function(t,e){var n=new L(t,e);if(null==n.next)return F.empty;var r=q(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return n(K(t,0));function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];K(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new F(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(H);i.next.push(o[s],e[a.join(",")]||n(a))}return i}}(function(t){var e=[[]];return o(i(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}function i(t,e){if("choice"==t.type)return t.exprs.reduce((function(t,n){return t.concat(i(n,e))}),[]);if("seq"==t.type)for(var s=0;;s++){var a=i(t.exprs[s],e);if(s==t.exprs.length-1)return a;o(a,e=n())}else{if("star"==t.type){var c=n();return r(e,c),o(i(t.expr,c),c),[r(c)]}if("plus"==t.type){var u=n();return o(i(t.expr,e),u),o(i(t.expr,u),u),[r(u)]}if("opt"==t.type)return[r(e)].concat(i(t.expr,e));if("range"==t.type){for(var l=e,f=0;f<t.min;f++){var h=n();o(i(t.expr,l),h),l=h}if(-1==t.max)o(i(t.expr,l),l);else for(var p=t.min;p<t.max;p++){var d=n();r(l,d),o(i(t.expr,l),d),l=d}return[r(l)]}if("name"==t.type)return[r(e,null,t.value)]}}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],u=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(u)&&r.push(u)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},F.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},F.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},B.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},B.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},F.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},F.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,a){var c=i.matchFragment(t,n);if(c&&(!e||c.validEnd))return s.from(a.map((function(t){return t.createAndFill()})));for(var u=0;u<i.next.length;u+=2){var l=i.next[u],f=i.next[u+1];if(!l.isText&&!l.hasRequiredAttrs()&&-1==r.indexOf(f)){r.push(f);var h=o(f,a.concat(l));if(h)return h}}}(this,[])},F.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},F.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},B.edgeCount.get=function(){return this.next.length>>1},F.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},F.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(F.prototype,B),F.empty=new F(!0);var L=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},$={next:{configurable:!0}};function q(t){var e=[];do{e.push(J(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function J(t){var e=[];do{e.push(U(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function U(t){for(var e=function(t){if(t.eat("(")){var e=q(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=W(t,e)}return e}function V(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function W(t,e){var n=V(t),r=n;return t.eat(",")&&(r="}"!=t.next?V(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function H(t,e){return e-t}function K(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(H)}function Y(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function G(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function Q(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new tt(t[n]);return e}$.next.get=function(){return this.tokens[this.pos]},L.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},L.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(L.prototype,$);var X=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=Q(n.attrs),this.defaultAttrs=Y(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},Z={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Z.isInline.get=function(){return!this.isBlock},Z.isTextblock.get=function(){return this.isBlock&&this.inlineContent},Z.isLeaf.get=function(){return this.contentMatch==F.empty},Z.isAtom.get=function(){return this.isLeaf||this.spec.atom},X.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},X.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},X.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:G(this.attrs,t)},X.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new D(this,this.computeAttrs(t),s.from(e),f.setFrom(n))},X.prototype.createChecked=function(t,e,n){if(e=s.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new D(this,this.computeAttrs(t),e,f.setFrom(n))},X.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=s.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e).fillBefore(s.empty,!0);return o?new D(this,t,e.append(o),f.setFrom(n)):null},X.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},X.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},X.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},X.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:f.empty:t},X.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new X(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(X.prototype,Z);var tt=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},et={isRequired:{configurable:!0}};et.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(tt.prototype,et);var nt=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=Q(r.attrs),this.rank=e,this.excluded=null;var o=Y(this.attrs);this.instance=o&&new f(this,o)};nt.prototype.create=function(t){return!t&&this.instance?this.instance:new f(this,G(this.attrs,t))},nt.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new nt(t,r++,e,o)})),n},nt.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},nt.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},nt.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var rt=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=r.a.from(t.nodes),this.spec.marks=r.a.from(t.marks),this.nodes=X.compile(this.spec.nodes,this),this.marks=nt.compile(this.spec.marks,this);var n=Object.create(null);for(var o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");var i=this.nodes[o],s=i.spec.content||"",a=i.spec.marks;i.contentMatch=n[s]||(n[s]=F.parse(s,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.markSet="_"==a?null:a?ot(this,a.split(" ")):""!=a&&i.inlineContent?null:[]}for(var c in this.marks){var u=this.marks[c],l=u.spec.excludes;u.excluded=null==l?[u]:""==l?[]:ot(this,l.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function ot(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}rt.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof X))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},rt.prototype.text=function(t,e){var n=this.nodes.text;return new P(n,n.defaultAttrs,t,f.setFrom(e))},rt.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},rt.prototype.nodeFromJSON=function(t){return D.fromJSON(this,t)},rt.prototype.markFromJSON=function(t){return f.fromJSON(this,t)},rt.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var it=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)})),this.normalizeLists=!this.tags.some((function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)}))};it.prototype.parse=function(t,e){void 0===e&&(e={});var n=new ft(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},it.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new ft(this,e,!0);return n.addAll(t,null,e.from,e.to),p.maxOpen(n.finish())},it.prototype.matchTag=function(t,e,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(pt(t,o.tag)&&(void 0===o.namespace||t.namespaceURI==o.namespace)&&(!o.context||e.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(t);if(!1===i)continue;o.attrs=i}return o}}},it.prototype.matchStyle=function(t,e,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(t)||i.context&&!n.matchesContext(i.context)||i.style.length>t.length&&(61!=i.style.charCodeAt(t.length)||i.style.slice(t.length+1)!=e))){if(i.getAttrs){var s=i.getAttrs(e);if(!1===s)continue;i.attrs=s}return i}}},it.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=dt(t)),t.mark=e}))};for(var o in t.marks)r(o);var i=function(e){var r=t.nodes[s].spec.parseDOM;r&&r.forEach((function(t){n(t=dt(t)),t.node=s}))};for(var s in t.nodes)i();return e},it.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new it(t,it.schemaRules(t)))};var st={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},at={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},ct={ol:!0,ul:!0};function ut(t){return(t?1:0)|("full"===t?2:0)}var lt=function(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=f.none,this.pendingMarks=r,this.stashMarks=[]};lt.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(s.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},lt.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=s.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(s.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},lt.prototype.popFromStashMark=function(t){for(var e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]},lt.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):vt(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}};var ft=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,i=ut(e.preserveWhitespace)|(n?4:0);r=o?new lt(o.type,o.attrs,f.none,f.none,!0,e.topMatch||o.type.contentMatch,i):new lt(n?null:t.schema.topNodeType,null,f.none,f.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},ht={top:{configurable:!0},currentPos:{configurable:!0}};function pt(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function dt(t){var e={};for(var n in t)e[n]=t[n];return e}function vt(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var i=[];return function t(n){i.push(n);for(var r=0;r<n.edgeCount;r++){var o=n.edge(r),s=o.type,a=o.next;if(s==e)return!0;if(i.indexOf(a)<0&&t(a))return!0}}(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}ht.top.get=function(){return this.nodes[this.open]},ft.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},ft.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},ft.prototype.addElement=function(t,e){var n,r=t.nodeName.toLowerCase();ct.hasOwnProperty(r)&&this.parser.normalizeLists&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&ct.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var o=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(n=this.parser.matchTag(t,this,e));if(o?o.ignore:at.hasOwnProperty(r))this.findInside(t);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(t=o.skip);var i,s=this.top,a=this.needsBlock;if(st.hasOwnProperty(r))i=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),i&&this.sync(s),this.needsBlock=a}else this.addElementByRule(t,o,!1===o.consuming?n:null)},ft.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},ft.prototype.readStyles=function(t){var e=f.none;t:for(var n=0;n<t.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(t[n],t[n+1],this,r);if(!o)continue t;if(o.ignore)return null;if(e=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(e),!1!==o.consuming)break;r=o}return e},ft.prototype.addElementByRule=function(t,e,n){var r,o,i,s=this;e.node?(o=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(o.create(e.attrs))||this.leafFallback(t):r=this.enter(o,e.attrs,e.preserveWhitespace):(i=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(i));var a=this.top;if(o&&o.isLeaf)this.findInside(t);else if(n)this.addElement(t,n);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return s.insertNode(t)}));else{var c=e.contentElement;"string"==typeof c?c=t.querySelector(c):"function"==typeof c&&(c=c(t)),c||(c=t),this.findAround(t,c,!0),this.addAll(c,r)}r&&(this.sync(a),this.open--),i&&this.removePendingMark(i,a)},ft.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&st.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},ft.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},ft.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},ft.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},ft.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:ut(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new lt(t,e,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},ft.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},ft.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},ft.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},ht.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},ft.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},ft.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},ft.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},ft.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},ft.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1);return function t(s,a){for(;s>=0;s--){var c=n[s];if(""==c){if(s==n.length-1||0==s)continue;for(;a>=i;a--)if(t(s-1,a))return!0;return!1}var u=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!u||u.name!=c&&-1==u.groups.indexOf(c))return!1;a--}return!0}(n.length-1,this.open)},ft.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},ft.prototype.addPendingMark=function(t){var e=function(t,e){for(var n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},ft.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(t)>-1)r.pendingMarks=t.removeFromSet(r.pendingMarks);else{r.activeMarks=t.removeFromSet(r.activeMarks);var o=r.popFromStashMark(t);o&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==e)break}},Object.defineProperties(ft.prototype,ht);var yt=function(t,e){this.nodes=t||{},this.marks=e||{}};function mt(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function gt(t){return t.document||window.document}yt.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=gt(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],u=r.serializeMark(c,t.isInline,e);u&&(i.push(c,o),o.appendChild(u.dom),o=u.contentDOM||u.dom)}}o.appendChild(r.serializeNode(t,e))})),n},yt.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=yt.renderSpec(gt(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},yt.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},yt.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&yt.renderSpec(gt(n),r(t,e))},yt.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var u in c=2,a)if(null!=a[u]){var l=u.indexOf(" ");l>0?s.setAttributeNS(u.slice(0,l),u.slice(l+1),a[u]):s.setAttribute(u,a[u])}for(var f=c;f<e.length;f++){var h=e[f];if(0===h){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var p=yt.renderSpec(t,h,n),d=p.dom,v=p.contentDOM;if(s.appendChild(d),v){if(i)throw new RangeError("Multiple content holes");i=v}}return{dom:s,contentDOM:i}},yt.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new yt(this.nodesFromSchema(t),this.marksFromSchema(t)))},yt.nodesFromSchema=function(t){var e=mt(t.nodes);return e.text||(e.text=function(t){return t.text}),e},yt.marksFromSchema=function(t){return mt(t.marks)};var bt=n(4),wt=Object.create(null),kt=function(t,e,n){this.ranges=n||[new St(t.min(e),t.max(e))],this.$anchor=t,this.$head=e},xt={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};xt.anchor.get=function(){return this.$anchor.pos},xt.head.get=function(){return this.$head.pos},xt.from.get=function(){return this.$from.pos},xt.to.get=function(){return this.$to.pos},xt.$from.get=function(){return this.ranges[0].$from},xt.$to.get=function(){return this.ranges[0].$to},xt.empty.get=function(){for(var t=this.ranges,e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0},kt.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},kt.prototype.replace=function(t,e){void 0===e&&(e=p.empty);for(var n=e.content.lastChild,r=null,o=0;o<e.openEnd;o++)r=n,n=n.lastChild;for(var i=t.steps.length,s=this.ranges,a=0;a<s.length;a++){var c=s[a],u=c.$from,l=c.$to,f=t.mapping.slice(i);t.replaceRange(f.map(u.pos),f.map(l.pos),a?p.empty:e),0==a&&At(t,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}},kt.prototype.replaceWith=function(t,e){for(var n=t.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],s=i.$from,a=i.$to,c=t.mapping.slice(n),u=c.map(s.pos),l=c.map(a.pos);o?t.deleteRange(u,l):(t.replaceRangeWith(u,l,e),At(t,n,e.isInline?-1:1))}},kt.findFrom=function(t,e,n){var r=t.parent.inlineContent?new Ot(t):Nt(t.node(0),t.parent,t.pos,t.index(),e,n);if(r)return r;for(var o=t.depth-1;o>=0;o--){var i=e<0?Nt(t.node(0),t.node(o),t.before(o+1),t.index(o),e,n):Nt(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,e,n);if(i)return i}},kt.near=function(t,e){return void 0===e&&(e=1),this.findFrom(t,e)||this.findFrom(t,-e)||new Mt(t.node(0))},kt.atStart=function(t){return Nt(t,t,0,0,1)||new Mt(t)},kt.atEnd=function(t){return Nt(t,t,t.content.size,t.childCount,-1)||new Mt(t)},kt.fromJSON=function(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=wt[e.type];if(!n)throw new RangeError("No selection type "+e.type+" defined");return n.fromJSON(t,e)},kt.jsonID=function(t,e){if(t in wt)throw new RangeError("Duplicate use of selection JSON ID "+t);return wt[t]=e,e.prototype.jsonID=t,e},kt.prototype.getBookmark=function(){return Ot.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(kt.prototype,xt),kt.prototype.visible=!0;var St=function(t,e){this.$from=t,this.$to=e},Ot=function(t){function e(e,n){void 0===n&&(n=e),t.call(this,e,n)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},e.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));if(!o.parent.inlineContent)return t.near(o);var i=n.resolve(r.map(this.anchor));return new e(i.parent.inlineContent?i:o,o)},e.prototype.replace=function(e,n){if(void 0===n&&(n=p.empty),t.prototype.replace.call(this,e,n),n==p.empty){var r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head},e.prototype.getBookmark=function(){return new Ct(this.anchor,this.head)},e.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(n.anchor),t.resolve(n.head))},e.create=function(t,e,n){void 0===n&&(n=e);var r=t.resolve(e);return new this(r,n==e?r:t.resolve(n))},e.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=i>=0?1:-1),!r.parent.inlineContent){var s=t.findFrom(r,o,!0)||t.findFrom(r,-o,!0);if(!s)return t.near(r,o);r=s.$head}return n.parent.inlineContent||(0==i||(n=(t.findFrom(n,-o,!0)||t.findFrom(n,o,!0)).$anchor).pos<r.pos!=i<0)&&(n=r),new e(n,r)},Object.defineProperties(e.prototype,n),e}(kt);kt.jsonID("text",Ot);var Ct=function(t,e){this.anchor=t,this.head=e};Ct.prototype.map=function(t){return new Ct(t.map(this.anchor),t.map(this.head))},Ct.prototype.resolve=function(t){return Ot.between(t.resolve(this.anchor),t.resolve(this.head))};var Et=function(t){function e(e){var n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);t.call(this,e,r),this.node=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(n,r){var o=r.mapResult(this.anchor),i=o.deleted,s=o.pos,a=n.resolve(s);return i?t.near(a):new e(a)},e.prototype.content=function(){return new p(s.from(this.node),0,0)},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor},e.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},e.prototype.getBookmark=function(){return new _t(this.anchor)},e.fromJSON=function(t,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(n.anchor))},e.create=function(t,e){return new this(t.resolve(e))},e.isSelectable=function(t){return!t.isText&&!1!==t.type.spec.selectable},e}(kt);Et.prototype.visible=!1,kt.jsonID("node",Et);var _t=function(t){this.anchor=t};_t.prototype.map=function(t){var e=t.mapResult(this.anchor),n=e.deleted,r=e.pos;return n?new Ct(r,r):new _t(r)},_t.prototype.resolve=function(t){var e=t.resolve(this.anchor),n=e.nodeAfter;return n&&Et.isSelectable(n)?new Et(e):kt.near(e)};var Mt=function(t){function e(e){t.call(this,e.resolve(0),e.resolve(e.content.size))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.replace=function(e,n){if(void 0===n&&(n=p.empty),n==p.empty){e.delete(0,e.doc.content.size);var r=t.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else t.prototype.replace.call(this,e,n)},e.prototype.toJSON=function(){return{type:"all"}},e.fromJSON=function(t){return new e(t)},e.prototype.map=function(t){return new e(t)},e.prototype.eq=function(t){return t instanceof e},e.prototype.getBookmark=function(){return Tt},e}(kt);kt.jsonID("all",Mt);var Tt={map:function(){return this},resolve:function(t){return new Mt(t)}};function Nt(t,e,n,r,o,i){if(e.inlineContent)return Ot.create(t,n);for(var s=r-(o>0?0:1);o>0?s<e.childCount:s>=0;s+=o){var a=e.child(s);if(a.isAtom){if(!i&&Et.isSelectable(a))return Et.create(t,n-(o<0?a.nodeSize:0))}else{var c=Nt(t,a,n+o,o<0?a.childCount:0,o,i);if(c)return c}n+=a.nodeSize*o}}function At(t,e,n){var r=t.steps.length-1;if(!(r<e)){var o,i=t.steps[r];if(i instanceof bt.c||i instanceof bt.b)t.mapping.maps[r].forEach((function(t,e,n,r){null==o&&(o=r)})),t.setSelection(kt.near(t.doc.resolve(o),n))}}var It=function(t){function e(e){t.call(this,e.doc),this.time=Date.now(),this.curSelection=e.selection,this.curSelectionFor=0,this.storedMarks=e.storedMarks,this.updated=0,this.meta=Object.create(null)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},e.prototype.setSelection=function(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return(1&this.updated)>0},e.prototype.setStoredMarks=function(t){return this.storedMarks=t,this.updated|=2,this},e.prototype.ensureMarks=function(t){return f.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this},e.prototype.addStoredMark=function(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))},e.prototype.removeStoredMark=function(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(2&this.updated)>0},e.prototype.addStep=function(e,n){t.prototype.addStep.call(this,e,n),this.updated=-3&this.updated,this.storedMarks=null},e.prototype.setTime=function(t){return this.time=t,this},e.prototype.replaceSelection=function(t){return this.selection.replace(this,t),this},e.prototype.replaceSelectionWith=function(t,e){var n=this.selection;return!1!==e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||f.none))),n.replaceWith(this,t),this},e.prototype.deleteSelection=function(){return this.selection.replace(this),this},e.prototype.insertText=function(t,e,n){void 0===n&&(n=e);var r=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();if(!t)return this.deleteRange(e,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(e);o=n==e?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(e,n,r.text(t,o)),this.selection.empty||this.setSelection(kt.near(this.selection.$to)),this},e.prototype.setMeta=function(t,e){return this.meta["string"==typeof t?t:t.key]=e,this},e.prototype.getMeta=function(t){return this.meta["string"==typeof t?t:t.key]},n.isGeneric.get=function(){for(var t in this.meta)return!1;return!0},e.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(e.prototype,n),e}(bt.d);function jt(t,e){return e&&t?t.bind(e):t}var Dt=function(t,e,n){this.name=t,this.init=jt(e.init,n),this.apply=jt(e.apply,n)},Rt=[new Dt("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new Dt("selection",{init:function(t,e){return t.selection||kt.atStart(e.doc)},apply:function(t){return t.selection}}),new Dt("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Dt("scrollToSelection",{init:function(){return 0},apply:function(t,e){return t.scrolledIntoView?e+1:e}})],Pt=function(t,e){var n=this;this.schema=t,this.fields=Rt.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),e&&e.forEach((function(t){if(n.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");n.plugins.push(t),n.pluginsByKey[t.key]=t,t.spec.state&&n.fields.push(new Dt(t.key,t.spec.state,t))}))},zt=function(t){this.config=t},Ft={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};Ft.schema.get=function(){return this.config.schema},Ft.plugins.get=function(){return this.config.plugins},zt.prototype.apply=function(t){return this.applyTransaction(t).state},zt.prototype.filterTransaction=function(t,e){void 0===e&&(e=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=e){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,t,this))return!1}return!0},zt.prototype.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var e=[t],n=this.applyInner(t),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var s=this.config.plugins[i];if(s.spec.appendTransaction){var a=r?r[i].n:0,c=r?r[i].state:this,u=a<e.length&&s.spec.appendTransaction.call(s,a?e.slice(a):e,c,n);if(u&&n.filterTransaction(u,i)){if(u.setMeta("appendedTransaction",t),!r){r=[];for(var l=0;l<this.config.plugins.length;l++)r.push(l<i?{state:n,n:e.length}:{state:this,n:0})}e.push(u),n=n.applyInner(u),o=!0}r&&(r[i]={state:n,n:e.length})}}if(!o)return{state:n,transactions:e}}},zt.prototype.applyInner=function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var e=new zt(this.config),n=this.config.fields,r=0;r<n.length;r++){var o=n[r];e[o.name]=o.apply(t,this[o.name],this,e)}for(var i=0;i<Bt.length;i++)Bt[i](this,t,e);return e},Ft.tr.get=function(){return new It(this)},zt.create=function(t){for(var e=new Pt(t.schema||t.doc.type.schema,t.plugins),n=new zt(e),r=0;r<e.fields.length;r++)n[e.fields[r].name]=e.fields[r].init(t,n);return n},zt.prototype.reconfigure=function(t){for(var e=new Pt(t.schema||this.schema,t.plugins),n=e.fields,r=new zt(e),o=0;o<n.length;o++){var i=n[o].name;r[i]=this.hasOwnProperty(i)?this[i]:n[o].init(t,r)}return r},zt.prototype.toJSON=function(t){var e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map((function(t){return t.toJSON()}))),t&&"object"==typeof t)for(var n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=t[n],o=r.spec.state;o&&o.toJSON&&(e[n]=o.toJSON.call(r,this[r.key]))}return e},zt.fromJSON=function(t,e,n){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var r=new Pt(t.schema,t.plugins),o=new zt(r);return r.fields.forEach((function(r){if("doc"==r.name)o.doc=D.fromJSON(t.schema,e.doc);else if("selection"==r.name)o.selection=kt.fromJSON(o.doc,e.selection);else if("storedMarks"==r.name)e.storedMarks&&(o.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(n)for(var i in n){var s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(e,i))return void(o[r.name]=a.fromJSON.call(s,t,e[i],o))}o[r.name]=r.init(t,o)}})),o},zt.addApplyListener=function(t){Bt.push(t)},zt.removeApplyListener=function(t){var e=Bt.indexOf(t);e>-1&&Bt.splice(e,1)},Object.defineProperties(zt.prototype,Ft);var Bt=[];function Lt(t,e,n){for(var r in t){var o=t[r];o instanceof Function?o=o.bind(e):"handleDOMEvents"==r&&(o=Lt(o,e,{})),n[r]=o}return n}(function(t){this.props={},t.props&&Lt(t.props,this,this.props),this.spec=t,this.key=t.key?t.key.key:qt("plugin")}).prototype.getState=function(t){return t[this.key]};var $t=Object.create(null);function qt(t){return t in $t?t+"$"+ ++$t[t]:($t[t]=0,t+"$")}var Jt=function(t){void 0===t&&(t="key"),this.key=qt(t)};Jt.prototype.get=function(t){return t.config.pluginsByKey[this.key]},Jt.prototype.getState=function(t){return t[this.key]};var Ut={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var Vt=/Edge\/(\d+)/.exec(navigator.userAgent),Wt=/MSIE \d/.test(navigator.userAgent),Ht=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);Ut.mac=/Mac/.test(navigator.platform);var Kt=Ut.ie=!!(Wt||Ht||Vt);Ut.ie_version=Wt?document.documentMode||6:Ht?+Ht[1]:Vt?+Vt[1]:null,Ut.gecko=!Kt&&/gecko\/(\d+)/i.test(navigator.userAgent),Ut.gecko_version=Ut.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var Yt=!Kt&&/Chrome\/(\d+)/.exec(navigator.userAgent);Ut.chrome=!!Yt,Ut.chrome_version=Yt&&+Yt[1],Ut.safari=!Kt&&/Apple Computer/.test(navigator.vendor),Ut.ios=Ut.safari&&(/Mobile\/\w+/.test(navigator.userAgent)||navigator.maxTouchPoints>2),Ut.android=/Android \d/.test(navigator.userAgent),Ut.webkit="webkitFontSmoothing"in document.documentElement.style,Ut.webkit_version=Ut.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var Gt=function(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e},Qt=function(t){var e=t.parentNode;return e&&11==e.nodeType?e.host:e},Xt=null,Zt=function(t,e,n){var r=Xt||(Xt=document.createRange());return r.setEnd(t,null==n?t.nodeValue.length:n),r.setStart(t,e||0),r},te=function(t,e,n,r){return n&&(ne(t,e,n,r,-1)||ne(t,e,n,r,1))},ee=/^(img|br|input|textarea|hr)$/i;function ne(t,e,n,r,o){for(;;){if(t==n&&e==r)return!0;if(e==(o<0?0:re(t))){var i=t.parentNode;if(1!=i.nodeType||oe(t)||ee.test(t.nodeName)||"false"==t.contentEditable)return!1;e=Gt(t)+(o<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if("false"==(t=t.childNodes[e+(o<0?-1:0)]).contentEditable)return!1;e=o<0?re(t):0}}}function re(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function oe(t){for(var e,n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}var ie=function(t){var e=t.isCollapsed;return e&&Ut.chrome&&t.rangeCount&&!t.getRangeAt(0).collapsed&&(e=!1),e};function se(t,e){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function ae(t){return{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function ce(t,e){return"number"==typeof t?t:t[e]}function ue(t){var e=t.getBoundingClientRect();return{left:e.left,right:e.left+t.clientWidth,top:e.top,bottom:e.top+t.clientHeight}}function le(t,e,n){for(var r=t.someProp("scrollThreshold")||0,o=t.someProp("scrollMargin")||5,i=t.dom.ownerDocument,s=n||t.dom;s;s=Qt(s))if(1==s.nodeType){var a=s==i.body||1!=s.nodeType,c=a?ae(i):ue(s),u=0,l=0;if(e.top<c.top+ce(r,"top")?l=-(c.top-e.top+ce(o,"top")):e.bottom>c.bottom-ce(r,"bottom")&&(l=e.bottom-c.bottom+ce(o,"bottom")),e.left<c.left+ce(r,"left")?u=-(c.left-e.left+ce(o,"left")):e.right>c.right-ce(r,"right")&&(u=e.right-c.right+ce(o,"right")),u||l)if(a)i.defaultView.scrollBy(u,l);else{var f=s.scrollLeft,h=s.scrollTop;l&&(s.scrollTop+=l),u&&(s.scrollLeft+=u);var p=s.scrollLeft-f,d=s.scrollTop-h;e={left:e.left-p,top:e.top-d,right:e.right-p,bottom:e.bottom-d}}if(a)break}}function fe(t){for(var e=[],n=t.ownerDocument;t&&(e.push({dom:t,top:t.scrollTop,left:t.scrollLeft}),t!=n);t=Qt(t));return e}function he(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=r.dom,i=r.top,s=r.left;o.scrollTop!=i+e&&(o.scrollTop=i+e),o.scrollLeft!=s&&(o.scrollLeft=s)}}var pe=null;function de(t,e){for(var n,r,o=2e8,i=0,s=e.top,a=e.top,c=t.firstChild,u=0;c;c=c.nextSibling,u++){var l=void 0;if(1==c.nodeType)l=c.getClientRects();else{if(3!=c.nodeType)continue;l=Zt(c).getClientRects()}for(var f=0;f<l.length;f++){var h=l[f];if(h.top<=s&&h.bottom>=a){s=Math.max(h.bottom,s),a=Math.min(h.top,a);var p=h.left>e.left?h.left-e.left:h.right<e.left?e.left-h.right:0;if(p<o){n=c,o=p,r=p&&3==n.nodeType?{left:h.right<e.left?h.right:h.left,top:e.top}:e,1==c.nodeType&&p&&(i=u+(e.left>=(h.left+h.right)/2?1:0));continue}}!n&&(e.left>=h.right&&e.top>=h.top||e.left>=h.left&&e.top>=h.bottom)&&(i=u+1)}}return n&&3==n.nodeType?function(t,e){for(var n=t.nodeValue.length,r=document.createRange(),o=0;o<n;o++){r.setEnd(t,o+1),r.setStart(t,o);var i=ge(r,1);if(i.top!=i.bottom&&ve(e,i))return{node:t,offset:o+(e.left>=(i.left+i.right)/2?1:0)}}return{node:t,offset:0}}(n,r):!n||o&&1==n.nodeType?{node:t,offset:i}:de(n,r)}function ve(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function ye(t,e,n){var r=t.childNodes.length;if(r&&n.top<n.bottom)for(var o=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),i=o;;){var s=t.childNodes[i];if(1==s.nodeType)for(var a=s.getClientRects(),c=0;c<a.length;c++){var u=a[c];if(ve(e,u))return ye(s,e,u)}if((i=(i+1)%r)==o)break}return t}function me(t,e){var n,r,o,i,s=t.root;if(s.caretPositionFromPoint)try{var a=s.caretPositionFromPoint(e.left,e.top);a&&(o=(n=a).offsetNode,i=n.offset)}catch(v){}if(!o&&s.caretRangeFromPoint){var c=s.caretRangeFromPoint(e.left,e.top);c&&(o=(r=c).startContainer,i=r.startOffset)}var u,l=s.elementFromPoint(e.left,e.top+1);if(!l||!t.dom.contains(1!=l.nodeType?l.parentNode:l)){var f=t.dom.getBoundingClientRect();if(!ve(e,f))return null;if(!(l=ye(t.dom,e,f)))return null}if(Ut.safari&&l.draggable&&(o=i=null),l=function(t,e){var n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}(l,e),o){if(Ut.gecko&&1==o.nodeType&&(i=Math.min(i,o.childNodes.length))<o.childNodes.length){var h,p=o.childNodes[i];"IMG"==p.nodeName&&(h=p.getBoundingClientRect()).right<=e.left&&h.bottom>e.top&&i++}o==t.dom&&i==o.childNodes.length-1&&1==o.lastChild.nodeType&&e.top>o.lastChild.getBoundingClientRect().bottom?u=t.state.doc.content.size:0!=i&&1==o.nodeType&&"BR"==o.childNodes[i-1].nodeName||(u=function(t,e,n,r){for(var o=-1,i=e;i!=t.dom;){var s=t.docView.nearestDesc(i,!0);if(!s)return null;if(s.node.isBlock&&s.parent){var a=s.dom.getBoundingClientRect();if(a.left>r.left||a.top>r.top)o=s.posBefore;else{if(!(a.right<r.left||a.bottom<r.top))break;o=s.posAfter}}i=s.dom.parentNode}return o>-1?o:t.docView.posFromDOM(e,n)}(t,o,i,e))}null==u&&(u=function(t,e,n){var r=de(e,n),o=r.node,i=r.offset,s=-1;if(1==o.nodeType&&!o.firstChild){var a=o.getBoundingClientRect();s=a.left!=a.right&&n.left>(a.left+a.right)/2?1:-1}return t.docView.posFromDOM(o,i,s)}(t,l,e));var d=t.docView.nearestDesc(l,!0);return{pos:u,inside:d?d.posAtStart-d.border:-1}}function ge(t,e){var n=t.getClientRects();return n.length?n[e<0?0:n.length-1]:t.getBoundingClientRect()}var be=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function we(t,e,n){var r=t.docView.domFromPos(e,n<0?-1:1),o=r.node,i=r.offset,s=Ut.webkit||Ut.gecko;if(3==o.nodeType){if(!s||!be.test(o.nodeValue)&&(n<0?i:i!=o.nodeValue.length)){var a=i,c=i,u=n<0?1:-1;return n<0&&!i?(c++,u=-1):n>=0&&i==o.nodeValue.length?(a--,u=1):n<0?a--:c++,ke(ge(Zt(o,a,c),u),u<0)}var l=ge(Zt(o,i,i),n);if(Ut.gecko&&i&&/\s/.test(o.nodeValue[i-1])&&i<o.nodeValue.length){var f=ge(Zt(o,i-1,i-1),-1);if(f.top==l.top){var h=ge(Zt(o,i,i+1),-1);if(h.top!=l.top)return ke(h,h.left<f.left)}}return l}if(!t.state.doc.resolve(e).parent.inlineContent){if(i&&(n<0||i==re(o))){var p=o.childNodes[i-1];if(1==p.nodeType)return xe(p.getBoundingClientRect(),!1)}if(i<re(o)){var d=o.childNodes[i];if(1==d.nodeType)return xe(d.getBoundingClientRect(),!0)}return xe(o.getBoundingClientRect(),n>=0)}if(i&&(n<0||i==re(o))){var v=o.childNodes[i-1],y=3==v.nodeType?Zt(v,re(v)-(s?0:1)):1!=v.nodeType||"BR"==v.nodeName&&v.nextSibling?null:v;if(y)return ke(ge(y,1),!1)}if(i<re(o)){var m=o.childNodes[i],g=3==m.nodeType?Zt(m,0,s?0:1):1==m.nodeType?m:null;if(g)return ke(ge(g,-1),!0)}return ke(ge(3==o.nodeType?Zt(o):o,-n),n>=0)}function ke(t,e){if(0==t.width)return t;var n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function xe(t,e){if(0==t.height)return t;var n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function Se(t,e,n){var r=t.state,o=t.root.activeElement;r!=e&&t.updateState(e),o!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),o!=t.dom&&o&&o.focus()}}var Oe=/[\u0590-\u08ac]/;var Ce=null,Ee=null,_e=!1;function Me(t,e,n){return Ce==e&&Ee==n?_e:(Ce=e,Ee=n,_e="up"==n||"down"==n?function(t,e,n){var r=e.selection,o="up"==n?r.$from:r.$to;return Se(t,e,(function(){for(var e=t.docView.domFromPos(o.pos,"up"==n?-1:1).node;;){var r=t.docView.nearestDesc(e,!0);if(!r)break;if(r.node.isBlock){e=r.dom;break}e=r.dom.parentNode}for(var i=we(t,o.pos,1),s=e.firstChild;s;s=s.nextSibling){var a=void 0;if(1==s.nodeType)a=s.getClientRects();else{if(3!=s.nodeType)continue;a=Zt(s,0,s.nodeValue.length).getClientRects()}for(var c=0;c<a.length;c++){var u=a[c];if(u.bottom>u.top&&("up"==n?u.bottom<i.top+1:u.top>i.bottom-1))return!1}}return!0}))}(t,e,n):function(t,e,n){var r=e.selection.$head;if(!r.parent.isTextblock)return!1;var o=r.parentOffset,i=!o,s=o==r.parent.content.size,a=getSelection();return Oe.test(r.parent.textContent)&&a.modify?Se(t,e,(function(){var e=a.getRangeAt(0),o=a.focusNode,i=a.focusOffset,s=a.caretBidiLevel;a.modify("move",n,"character");var c=!(r.depth?t.docView.domAfterPos(r.before()):t.dom).contains(1==a.focusNode.nodeType?a.focusNode:a.focusNode.parentNode)||o==a.focusNode&&i==a.focusOffset;return a.removeAllRanges(),a.addRange(e),null!=s&&(a.caretBidiLevel=s),c})):"left"==n||"backward"==n?i:s}(t,e,n))}var Te=function(t,e,n,r){this.parent=t,this.children=e,this.dom=n,n.pmViewDesc=this,this.contentDOM=r,this.dirty=0},Ne={beforePosition:{configurable:!0},size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0},domAtom:{configurable:!0}};Te.prototype.matchesWidget=function(){return!1},Te.prototype.matchesMark=function(){return!1},Te.prototype.matchesNode=function(){return!1},Te.prototype.matchesHack=function(){return!1},Ne.beforePosition.get=function(){return!1},Te.prototype.parseRule=function(){return null},Te.prototype.stopEvent=function(){return!1},Ne.size.get=function(){for(var t=0,e=0;e<this.children.length;e++)t+=this.children[e].size;return t},Ne.border.get=function(){return 0},Te.prototype.destroy=function(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var t=0;t<this.children.length;t++)this.children[t].destroy()},Te.prototype.posBeforeChild=function(t){for(var e=0,n=this.posAtStart;e<this.children.length;e++){var r=this.children[e];if(r==t)return n;n+=r.size}},Ne.posBefore.get=function(){return this.parent.posBeforeChild(this)},Ne.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},Ne.posAfter.get=function(){return this.posBefore+this.size},Ne.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},Te.prototype.localPosFromDOM=function(t,e,n){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(n<0){var r,o;if(t==this.contentDOM)r=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.previousSibling}for(;r&&(!(o=r.pmViewDesc)||o.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(o)+o.size:this.posAtStart}var i,s;if(t==this.contentDOM)i=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;i=t.nextSibling}for(;i&&(!(s=i.pmViewDesc)||s.parent!=this);)i=i.nextSibling;return i?this.posBeforeChild(s):this.posAtEnd}var a;if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))a=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(var c=t;;c=c.parentNode){if(c==this.dom){a=!1;break}if(c.parentNode.firstChild!=c)break}if(null==a&&e==t.childNodes.length)for(var u=t;;u=u.parentNode){if(u==this.dom){a=!0;break}if(u.parentNode.lastChild!=u)break}}return(null==a?n>0:a)?this.posAtEnd:this.posAtStart},Te.prototype.nearestDesc=function(t,e){for(var n=!0,r=t;r;r=r.parentNode){var o=this.getDesc(r);if(o&&(!e||o.node)){if(!n||!o.nodeDOM||(1==o.nodeDOM.nodeType?o.nodeDOM.contains(1==t.nodeType?t:t.parentNode):o.nodeDOM==t))return o;n=!1}}},Te.prototype.getDesc=function(t){for(var e=t.pmViewDesc,n=e;n;n=n.parent)if(n==this)return e},Te.prototype.posFromDOM=function(t,e,n){for(var r=t;r;r=r.parentNode){var o=this.getDesc(r);if(o)return o.localPosFromDOM(t,e,n)}return-1},Te.prototype.descAt=function(t){for(var e=0,n=0;e<this.children.length;e++){var r=this.children[e],o=n+r.size;if(n==t&&o!=n){for(;!r.border&&r.children.length;)r=r.children[0];return r}if(t<o)return r.descAt(t-n-r.border);n=o}},Te.prototype.domFromPos=function(t,e){if(!this.contentDOM)return{node:this.dom,offset:0};for(var n=0,r=0,o=!0;;r++,o=!1){for(;r<this.children.length&&(this.children[r].beforePosition||this.children[r].dom.parentNode!=this.contentDOM);)n+=this.children[r++].size;var i=r==this.children.length?null:this.children[r];if(n==t&&(0==e||!i||!i.size||i.border||e<0&&o)||i&&i.domAtom&&t<n+i.size)return{node:this.contentDOM,offset:i?Gt(i.dom):this.contentDOM.childNodes.length};if(!i)throw new Error("Invalid position "+t);var s=n+i.size;if(!i.domAtom&&(e<0&&!i.border?s>=t:s>t))return i.domFromPos(t-n-i.border,e);n=s}},Te.prototype.parseRange=function(t,e,n){if(void 0===n&&(n=0),0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var r=-1,o=-1,i=n,s=0;;s++){var a=this.children[s],c=i+a.size;if(-1==r&&t<=c){var u=i+a.border;if(t>=u&&e<=c-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(t,e,u);t=i;for(var l=s;l>0;l--){var f=this.children[l-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){r=Gt(f.dom)+1;break}t-=f.size}-1==r&&(r=0)}if(r>-1&&(c>e||s==this.children.length-1)){e=c;for(var h=s+1;h<this.children.length;h++){var p=this.children[h];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(-1)){o=Gt(p.dom);break}e+=p.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=c}return{node:this.contentDOM,from:t,to:e,fromOffset:r,toOffset:o}},Te.prototype.emptyChildAt=function(t){if(this.border||!this.contentDOM||!this.children.length)return!1;var e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)},Te.prototype.domAfterPos=function(t){var e=this.domFromPos(t,0),n=e.node,r=e.offset;if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+t);return n.childNodes[r]},Te.prototype.setSelection=function(t,e,n,r){for(var o=Math.min(t,e),i=Math.max(t,e),s=0,a=0;s<this.children.length;s++){var c=this.children[s],u=a+c.size;if(o>a&&i<u)return c.setSelection(t-a-c.border,e-a-c.border,n,r);a=u}var l=this.domFromPos(t,t?-1:1),f=e==t?l:this.domFromPos(e,e?-1:1),h=n.getSelection(),p=!1;if((Ut.gecko||Ut.safari)&&t==e){var d=l.node,v=l.offset;if(3==d.nodeType)(p=v&&"\n"==d.nodeValue[v-1])&&v==d.nodeValue.length&&d.nextSibling&&"BR"==d.nextSibling.nodeName&&(l=f={node:d.parentNode,offset:Gt(d)+1});else{var y=d.childNodes[v-1];p=y&&("BR"==y.nodeName||"false"==y.contentEditable)}}if(r||p&&Ut.safari||!te(l.node,l.offset,h.anchorNode,h.anchorOffset)||!te(f.node,f.offset,h.focusNode,h.focusOffset)){var m=!1;if((h.extend||t==e)&&!p){h.collapse(l.node,l.offset);try{t!=e&&h.extend(f.node,f.offset),m=!0}catch(w){if(!(w instanceof DOMException))throw w}}if(!m){if(t>e){var g=l;l=f,f=g}var b=document.createRange();b.setEnd(f.node,f.offset),b.setStart(l.node,l.offset),h.removeAllRanges(),h.addRange(b)}}},Te.prototype.ignoreMutation=function(t){return!this.contentDOM&&"selection"!=t.type},Ne.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},Te.prototype.markDirty=function(t,e){for(var n=0,r=0;r<this.children.length;r++){var o=this.children[r],i=n+o.size;if(n==i?t<=i&&e>=n:t<i&&e>n){var s=n+o.border,a=i-o.border;if(t>=s&&e<=a)return this.dirty=t==n||e==i?2:1,void(t!=s||e!=a||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(t-s,e-s):o.dirty=3);o.dirty=3}n=i}this.dirty=2},Te.prototype.markParentsDirty=function(){for(var t=1,e=this.parent;e;e=e.parent,t++){var n=1==t?2:1;e.dirty<n&&(e.dirty=n)}},Ne.domAtom.get=function(){return!1},Object.defineProperties(Te.prototype,Ne);var Ae=[],Ie=function(t){function e(e,n,r,o){var i,s=n.type.toDOM;if("function"==typeof s&&(s=s(r,(function(){return i?i.parent?i.parent.posBeforeChild(i):void 0:o}))),!n.type.spec.raw){if(1!=s.nodeType){var a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable=!1,s.classList.add("ProseMirror-widget")}t.call(this,e,Ae,s,null),this.widget=n,i=this}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={beforePosition:{configurable:!0},domAtom:{configurable:!0}};return n.beforePosition.get=function(){return this.widget.type.side<0},e.prototype.matchesWidget=function(t){return 0==this.dirty&&t.type.eq(this.widget.type)},e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.stopEvent=function(t){var e=this.widget.spec.stopEvent;return!!e&&e(t)},e.prototype.ignoreMutation=function(t){return"selection"!=t.type||this.widget.spec.ignoreSelection},n.domAtom.get=function(){return!0},Object.defineProperties(e.prototype,n),e}(Te),je=function(t){function e(e,n,r,o){t.call(this,e,Ae,n,null),this.textDOM=r,this.text=o}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0}};return n.size.get=function(){return this.text.length},e.prototype.localPosFromDOM=function(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e},e.prototype.domFromPos=function(t){return{node:this.textDOM,offset:t}},e.prototype.ignoreMutation=function(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue},Object.defineProperties(e.prototype,n),e}(Te),De=function(t){function e(e,n,r,o){t.call(this,e,[],r,o),this.mark=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.create=function(t,n,r,o){var i=o.nodeViews[n.type.name],s=i&&i(n,o,r);return s&&s.dom||(s=yt.renderSpec(document,n.type.spec.toDOM(n,r))),new e(t,n,s.dom,s.contentDOM||s.dom)},e.prototype.parseRule=function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},e.prototype.matchesMark=function(t){return 3!=this.dirty&&this.mark.eq(t)},e.prototype.markDirty=function(e,n){if(t.prototype.markDirty.call(this,e,n),0!=this.dirty){for(var r=this.parent;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}},e.prototype.slice=function(t,n,r){var o=e.create(this.parent,this.mark,!0,r),i=this.children,s=this.size;n<s&&(i=Qe(i,n,s,r)),t>0&&(i=Qe(i,0,t,r));for(var a=0;a<i.length;a++)i[a].parent=o;return o.children=i,o},e}(Te),Re=function(t){function e(e,n,r,o,i,s,a,c,u){t.call(this,e,n.isLeaf?Ae:[],i,s),this.nodeDOM=a,this.node=n,this.outerDeco=r,this.innerDeco=o,s&&this.updateChildren(c,u)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0},border:{configurable:!0},domAtom:{configurable:!0}};return e.create=function(t,n,r,o,i,s){var a,c,u=i.nodeViews[n.type.name],l=u&&u(n,i,(function(){return c?c.parent?c.parent.posBeforeChild(c):void 0:s}),r),f=l&&l.dom,h=l&&l.contentDOM;if(n.isText)if(f){if(3!=f.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else f=document.createTextNode(n.text);else f||(f=(a=yt.renderSpec(document,n.type.spec.toDOM(n))).dom,h=a.contentDOM);h||n.isText||"BR"==f.nodeName||(f.hasAttribute("contenteditable")||(f.contentEditable=!1),n.type.spec.draggable&&(f.draggable=!0));var p=f;return f=We(f,r,n),l?c=new Be(t,n,r,o,f,h,p,l,i,s+1):n.isText?new ze(t,n,r,o,f,p,i):new e(t,n,r,o,f,h,p,i,s+1)},e.prototype.parseRule=function(){var t=this;if(this.node.type.spec.reparseInView)return null;var e={node:this.node.type.name,attrs:this.node.attrs};return this.node.type.spec.code&&(e.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?e.contentElement=this.contentDOM:e.getContent=function(){return t.contentDOM?s.empty:t.node.content},e},e.prototype.matchesNode=function(t,e,n){return 0==this.dirty&&t.eq(this.node)&&He(e,this.outerDeco)&&n.eq(this.innerDeco)},n.size.get=function(){return this.node.nodeSize},n.border.get=function(){return this.node.isLeaf?0:1},e.prototype.updateChildren=function(t,e){var n=this,r=this.node.inlineContent,o=e,i=r&&t.composing&&this.localCompositionNode(t,e),s=new Ye(this,i&&i.node);!function(t,e,n,r){var o=e.locals(t),i=0;if(0==o.length){for(var s=0;s<t.childCount;s++){var a=t.child(s);r(a,o,e.forChild(i,a),s),i+=a.nodeSize}return}for(var c=0,u=[],l=null,f=0;;){if(c<o.length&&o[c].to==i){for(var h=o[c++],p=void 0;c<o.length&&o[c].to==i;)(p||(p=[h])).push(o[c++]);if(p){p.sort(Ge);for(var d=0;d<p.length;d++)n(p[d],f,!!l)}else n(h,f,!!l)}var v=void 0,y=void 0;if(l)y=-1,v=l,l=null;else{if(!(f<t.childCount))break;y=f,v=t.child(f++)}for(var m=0;m<u.length;m++)u[m].to<=i&&u.splice(m--,1);for(;c<o.length&&o[c].from<=i&&o[c].to>i;)u.push(o[c++]);var g=i+v.nodeSize;if(v.isText){var b=g;c<o.length&&o[c].from<b&&(b=o[c].from);for(var w=0;w<u.length;w++)u[w].to<b&&(b=u[w].to);b<g&&(l=v.cut(b-i),v=v.cut(0,b-i),g=b,y=-1)}r(v,u.length?v.isInline&&!v.isLeaf?u.filter((function(t){return!t.inline})):u.slice():Ae,e.forChild(i,v),y),i=g}}(this.node,this.innerDeco,(function(e,i,a){e.spec.marks?s.syncToMarks(e.spec.marks,r,t):e.type.side>=0&&!a&&s.syncToMarks(i==n.node.childCount?f.none:n.node.child(i).marks,r,t),s.placeWidget(e,t,o)}),(function(e,n,i,a){s.syncToMarks(e.marks,r,t),s.findNodeMatch(e,n,i,a)||s.updateNextNode(e,n,i,t,a)||s.addNode(e,n,i,t,o),o+=e.nodeSize})),s.syncToMarks(Ae,r,t),this.node.isTextblock&&s.addTextblockHacks(),s.destroyRest(),(s.changed||2==this.dirty)&&(i&&this.protectLocalComposition(t,i),Le(this.contentDOM,this.children,t),Ut.ios&&function(t){if("UL"==t.nodeName||"OL"==t.nodeName){var e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}(this.dom))},e.prototype.localCompositionNode=function(t,e){var n=t.state.selection,r=n.from,o=n.to;if(!(!(t.state.selection instanceof Ot)||r<e||o>e+this.node.content.size)){var i=t.root.getSelection(),s=function(t,e){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0){if(t.childNodes.length>e&&3==t.childNodes[e].nodeType)return t.childNodes[e];e=re(t=t.childNodes[e-1])}else{if(!(1==t.nodeType&&e<t.childNodes.length))return null;t=t.childNodes[e],e=0}}}(i.focusNode,i.focusOffset);if(s&&this.dom.contains(s.parentNode)){var a=s.nodeValue,c=function(t,e,n,r){for(var o=0,i=0;o<t.childCount&&i<=r;){var s=t.child(o++),a=i;if(i+=s.nodeSize,s.isText){for(var c=s.text;o<t.childCount;){var u=t.child(o++);if(i+=u.nodeSize,!u.isText)break;c+=u.text}if(i>=n){var l=c.lastIndexOf(e,r-a);if(l>=0&&l+e.length+a>=n)return a+l}}}return-1}(this.node.content,a,r-e,o-e);return c<0?null:{node:s,pos:c,text:a}}}},e.prototype.protectLocalComposition=function(t,e){var n=e.node,r=e.pos,o=e.text;if(!this.getDesc(n)){for(var i=n;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=null)}var s=new je(this,i,n,o);t.compositionNodes.push(s),this.children=Qe(this.children,r,r+o.length,t,s)}},e.prototype.update=function(t,e,n,r){return!(3==this.dirty||!t.sameMarkup(this.node))&&(this.updateInner(t,e,n,r),!0)},e.prototype.updateInner=function(t,e,n,r){this.updateOuterDeco(e),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0},e.prototype.updateOuterDeco=function(t){if(!He(t,this.outerDeco)){var e=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=Ue(this.dom,this.nodeDOM,Je(this.outerDeco,this.node,e),Je(t,this.node,e)),this.dom!=n&&(n.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=t}},e.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)},e.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")},n.domAtom.get=function(){return this.node.isAtom},Object.defineProperties(e.prototype,n),e}(Te);function Pe(t,e,n,r,o){return We(r,e,t),new Re(null,t,e,n,r,r,r,o,0)}var ze=function(t){function e(e,n,r,o,i,s,a){t.call(this,e,n,r,o,i,null,s,a)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={domAtom:{configurable:!0}};return e.prototype.parseRule=function(){for(var t=this.nodeDOM.parentNode;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}},e.prototype.update=function(t,e,n,r){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node))&&(this.updateOuterDeco(e),0==this.dirty&&t.text==this.node.text||t.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=t.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=t,this.dirty=0,!0)},e.prototype.inParent=function(){for(var t=this.parent.contentDOM,e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1},e.prototype.domFromPos=function(t){return{node:this.nodeDOM,offset:t}},e.prototype.localPosFromDOM=function(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):t.prototype.localPosFromDOM.call(this,e,n,r)},e.prototype.ignoreMutation=function(t){return"characterData"!=t.type&&"selection"!=t.type},e.prototype.slice=function(t,n,r){var o=this.node.cut(t,n),i=document.createTextNode(o.text);return new e(this.parent,o,this.outerDeco,this.innerDeco,i,i,r)},n.domAtom.get=function(){return!1},Object.defineProperties(e.prototype,n),e}(Re),Fe=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={domAtom:{configurable:!0}};return e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.matchesHack=function(){return 0==this.dirty},n.domAtom.get=function(){return!0},Object.defineProperties(e.prototype,n),e}(Te),Be=function(t){function e(e,n,r,o,i,s,a,c,u,l){t.call(this,e,n,r,o,i,s,a,u,l),this.spec=c}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(e,n,r,o){if(3==this.dirty)return!1;if(this.spec.update){var i=this.spec.update(e,n);return i&&this.updateInner(e,n,r,o),i}return!(!this.contentDOM&&!e.isLeaf)&&t.prototype.update.call(this,e,n,r,o)},e.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():t.prototype.selectNode.call(this)},e.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():t.prototype.deselectNode.call(this)},e.prototype.setSelection=function(e,n,r,o){this.spec.setSelection?this.spec.setSelection(e,n,r):t.prototype.setSelection.call(this,e,n,r,o)},e.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),t.prototype.destroy.call(this)},e.prototype.stopEvent=function(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)},e.prototype.ignoreMutation=function(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):t.prototype.ignoreMutation.call(this,e)},e}(Re);function Le(t,e,n){for(var r=t.firstChild,o=!1,i=0;i<e.length;i++){var s=e[i],a=s.dom;if(a.parentNode==t){for(;a!=r;)r=Ke(r),o=!0;r=r.nextSibling}else o=!0,t.insertBefore(a,r);if(s instanceof De){var c=r?r.previousSibling:t.lastChild;Le(s.contentDOM,s.children,n),r=c?c.nextSibling:t.firstChild}}for(;r;)r=Ke(r),o=!0;o&&n.trackWrites==t&&(n.trackWrites=null)}function $e(t){t&&(this.nodeName=t)}$e.prototype=Object.create(null);var qe=[new $e];function Je(t,e,n){if(0==t.length)return qe;for(var r=n?qe[0]:new $e,o=[r],i=0;i<t.length;i++){var s=t[i].type.attrs;if(s)for(var a in s.nodeName&&o.push(r=new $e(s.nodeName)),s){var c=s[a];null!=c&&(n&&1==o.length&&o.push(r=new $e(e.isInline?"span":"div")),"class"==a?r.class=(r.class?r.class+" ":"")+c:"style"==a?r.style=(r.style?r.style+";":"")+c:"nodeName"!=a&&(r[a]=c))}}return o}function Ue(t,e,n,r){if(n==qe&&r==qe)return e;for(var o=e,i=0;i<r.length;i++){var s=r[i],a=n[i];if(i){var c=void 0;a&&a.nodeName==s.nodeName&&o!=t&&(c=o.parentNode)&&c.tagName.toLowerCase()==s.nodeName||((c=document.createElement(s.nodeName)).pmIsDeco=!0,c.appendChild(o),a=qe[0]),o=c}Ve(o,a||qe[0],s)}return o}function Ve(t,e,n){for(var r in e)"class"==r||"style"==r||"nodeName"==r||r in n||t.removeAttribute(r);for(var o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=e[o]&&t.setAttribute(o,n[o]);if(e.class!=n.class){for(var i=e.class?e.class.split(" "):Ae,s=n.class?n.class.split(" "):Ae,a=0;a<i.length;a++)-1==s.indexOf(i[a])&&t.classList.remove(i[a]);for(var c=0;c<s.length;c++)-1==i.indexOf(s[c])&&t.classList.add(s[c])}if(e.style!=n.style){if(e.style)for(var u,l=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;u=l.exec(e.style);)t.style.removeProperty(u[1]);n.style&&(t.style.cssText+=n.style)}}function We(t,e,n){return Ue(t,t,qe,Je(e,n,1!=t.nodeType))}function He(t,e){if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function Ke(t){var e=t.nextSibling;return t.parentNode.removeChild(t),e}var Ye=function(t,e){this.top=t,this.lock=e,this.index=0,this.stack=[],this.changed=!1;var n=function(t,e){for(var n=[],r=t.childCount,o=e.length-1;r>0&&o>=0;o--){var i=e[o],s=i.node;if(s){if(s!=t.child(r-1))break;n.push(i),--r}}return{nodes:n.reverse(),offset:r}}(t.node.content,t.children);this.preMatched=n.nodes,this.preMatchOffset=n.offset};function Ge(t,e){return t.type.side-e.type.side}function Qe(t,e,n,r,o){for(var i=[],s=0,a=0;s<t.length;s++){var c=t[s],u=a,l=a+=c.size;u>=n||l<=e?i.push(c):(u<e&&i.push(c.slice(0,e-u,r)),o&&(i.push(o),o=null),l>n&&i.push(c.slice(n-u,c.size,r)))}return i}function Xe(t,e){var n=t.root.getSelection(),r=t.state.doc;if(!n.focusNode)return null;var o=t.docView.nearestDesc(n.focusNode),i=o&&0==o.size,s=t.docView.posFromDOM(n.focusNode,n.focusOffset);if(s<0)return null;var a,c,u=r.resolve(s);if(ie(n)){for(a=u;o&&!o.node;)o=o.parent;if(o&&o.node.isAtom&&Et.isSelectable(o.node)&&o.parent&&(!o.node.isInline||!function(t,e,n){for(var r=0==e,o=e==re(t);r||o;){if(t==n)return!0;var i=Gt(t);if(!(t=t.parentNode))return!1;r=r&&0==i,o=o&&i==re(t)}}(n.focusNode,n.focusOffset,o.dom))){var l=o.posBefore;c=new Et(s==l?u:r.resolve(l))}}else{var f=t.docView.posFromDOM(n.anchorNode,n.anchorOffset);if(f<0)return null;a=r.resolve(f)}c||(c=an(t,a,u,"pointer"==e||t.state.selection.head<u.pos&&!i?1:-1));return c}function Ze(t,e){var n=t.state.selection;if(on(t,n),t.editable?t.hasFocus():cn(t)&&document.activeElement&&document.activeElement.contains(t.dom)){if(t.domObserver.disconnectSelection(),t.cursorWrapper)!function(t){var e=t.root.getSelection(),n=document.createRange(),r=t.cursorWrapper.dom,o="IMG"==r.nodeName;o?n.setEnd(r.parentNode,Gt(r)+1):n.setEnd(r,0);n.collapse(!1),e.removeAllRanges(),e.addRange(n),!o&&!t.state.selection.visible&&Ut.ie&&Ut.ie_version<=11&&(r.disabled=!0,r.disabled=!1)}(t);else{var r,o,i=n.anchor,s=n.head;!tn||n instanceof Ot||(n.$from.parent.inlineContent||(r=en(t,n.from)),n.empty||n.$from.parent.inlineContent||(o=en(t,n.to))),t.docView.setSelection(i,s,t.root,e),tn&&(r&&rn(r),o&&rn(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(t){var e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.hideSelectionGuard);var n=t.root.getSelection(),r=n.anchorNode,o=n.anchorOffset;e.addEventListener("selectionchange",t.hideSelectionGuard=function(){n.anchorNode==r&&n.anchorOffset==o||(e.removeEventListener("selectionchange",t.hideSelectionGuard),t.dom.classList.remove("ProseMirror-hideselection"))})}(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}Ye.prototype.getPreMatch=function(t){return t>=this.preMatchOffset?this.preMatched[t-this.preMatchOffset]:null},Ye.prototype.destroyBetween=function(t,e){if(t!=e){for(var n=t;n<e;n++)this.top.children[n].destroy();this.top.children.splice(t,e-t),this.changed=!0}},Ye.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},Ye.prototype.syncToMarks=function(t,e,n){for(var r=0,o=this.stack.length>>1,i=Math.min(o,t.length);r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(t[r])&&!1!==t[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<t.length;){this.stack.push(this.top,this.index+1);for(var s=-1,a=this.index;a<Math.min(this.index+3,this.top.children.length);a++)if(this.top.children[a].matchesMark(t[o])){s=a;break}if(s>-1)s>this.index&&(this.changed=!0,this.destroyBetween(this.index,s)),this.top=this.top.children[this.index];else{var c=De.create(this.top,t[o],e,n);this.top.children.splice(this.index,0,c),this.top=c,this.changed=!0}this.index=0,o++}},Ye.prototype.findNodeMatch=function(t,e,n,r){var o=-1,i=r<0?void 0:this.getPreMatch(r),s=this.top.children;if(i&&i.matchesNode(t,e,n))o=s.indexOf(i);else for(var a=this.index,c=Math.min(s.length,a+5);a<c;a++){var u=s[a];if(u.matchesNode(t,e,n)&&this.preMatched.indexOf(u)<0){o=a;break}}return!(o<0)&&(this.destroyBetween(this.index,o),this.index++,!0)},Ye.prototype.updateNextNode=function(t,e,n,r,o){for(var i=this.index;i<this.top.children.length;i++){var s=this.top.children[i];if(s instanceof Re){var a=this.preMatched.indexOf(s);if(a>-1&&a+this.preMatchOffset!=o)return!1;var c=s.dom;if(!(this.lock&&(c==this.lock||1==c.nodeType&&c.contains(this.lock.parentNode))&&!(t.isText&&s.node&&s.node.isText&&s.nodeDOM.nodeValue==t.text&&3!=s.dirty&&He(e,s.outerDeco)))&&s.update(t,e,n,r))return this.destroyBetween(this.index,i),s.dom!=c&&(this.changed=!0),this.index++,!0;break}}return!1},Ye.prototype.addNode=function(t,e,n,r,o){this.top.children.splice(this.index++,0,Re.create(this.top,t,e,n,r,o)),this.changed=!0},Ye.prototype.placeWidget=function(t,e,n){var r=this.index<this.top.children.length?this.top.children[this.index]:null;if(!r||!r.matchesWidget(t)||t!=r.widget&&r.widget.type.toDOM.parentNode){var o=new Ie(this.top,t,e,n);this.top.children.splice(this.index++,0,o),this.changed=!0}else this.index++},Ye.prototype.addTextblockHacks=function(){for(var t=this.top.children[this.index-1];t instanceof De;)t=t.children[t.children.length-1];if(!t||!(t instanceof ze)||/\n$/.test(t.node.text))if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack())this.index++;else{var e=document.createElement("br");this.top.children.splice(this.index++,0,new Fe(this.top,Ae,e,null)),this.changed=!0}};var tn=Ut.safari||Ut.chrome&&Ut.chrome_version<63;function en(t,e){var n=t.docView.domFromPos(e,0),r=n.node,o=n.offset,i=o<r.childNodes.length?r.childNodes[o]:null,s=o?r.childNodes[o-1]:null;if(Ut.safari&&i&&"false"==i.contentEditable)return nn(i);if((!i||"false"==i.contentEditable)&&(!s||"false"==s.contentEditable)){if(i)return nn(i);if(s)return nn(s)}}function nn(t){return t.contentEditable="true",Ut.safari&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function rn(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function on(t,e){if(e instanceof Et){var n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(sn(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else sn(t)}function sn(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=null)}function an(t,e,n,r){return t.someProp("createSelectionBetween",(function(r){return r(t,e,n)}))||Ot.between(e,n,r)}function cn(t){var e=t.root.getSelection();if(!e.anchorNode)return!1;try{return t.dom.contains(3==e.anchorNode.nodeType?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(3==e.focusNode.nodeType?e.focusNode.parentNode:e.focusNode))}catch(n){return!1}}function un(t,e){var n=t.selection,r=n.$anchor,o=n.$head,i=e>0?r.max(o):r.min(o),s=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return s&&kt.findFrom(s,e)}function ln(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function fn(t,e,n){var r=t.state.selection;if(!(r instanceof Ot)){if(r instanceof Et&&r.node.isInline)return ln(t,new Ot(e>0?r.$to:r.$from));var o=un(t.state,e);return!!o&&ln(t,o)}if(!r.empty||n.indexOf("s")>-1)return!1;if(t.endOfTextblock(e>0?"right":"left")){var i=un(t.state,e);return!!(i&&i instanceof Et)&&ln(t,i)}if(!(Ut.mac&&n.indexOf("m")>-1)){var s,a=r.$head,c=a.textOffset?null:e<0?a.nodeBefore:a.nodeAfter;if(!c||c.isText)return!1;var u=e<0?a.pos-c.nodeSize:a.pos;return!!(c.isAtom||(s=t.docView.descAt(u))&&!s.contentDOM)&&(Et.isSelectable(c)?ln(t,new Et(e<0?t.state.doc.resolve(a.pos-c.nodeSize):a)):!!Ut.webkit&&ln(t,new Ot(t.state.doc.resolve(e<0?u:u+c.nodeSize))))}}function hn(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function pn(t){var e=t.pmViewDesc;return e&&0==e.size&&(t.nextSibling||"BR"!=t.nodeName)}function dn(t){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n){var o,i,s=!1;for(Ut.gecko&&1==n.nodeType&&r<hn(n)&&pn(n.childNodes[r])&&(s=!0);;)if(r>0){if(1!=n.nodeType)break;var a=n.childNodes[r-1];if(pn(a))o=n,i=--r;else{if(3!=a.nodeType)break;r=(n=a).nodeValue.length}}else{if(yn(n))break;for(var c=n.previousSibling;c&&pn(c);)o=n.parentNode,i=Gt(c),c=c.previousSibling;if(c)r=hn(n=c);else{if((n=n.parentNode)==t.dom)break;r=0}}s?mn(t,e,n,r):o&&mn(t,e,o,i)}}function vn(t){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n){for(var o,i,s=hn(n);;)if(r<s){if(1!=n.nodeType)break;if(!pn(n.childNodes[r]))break;o=n,i=++r}else{if(yn(n))break;for(var a=n.nextSibling;a&&pn(a);)o=a.parentNode,i=Gt(a)+1,a=a.nextSibling;if(a)r=0,s=hn(n=a);else{if((n=n.parentNode)==t.dom)break;r=s=0}}o&&mn(t,e,o,i)}}function yn(t){var e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function mn(t,e,n,r){if(ie(e)){var o=document.createRange();o.setEnd(n,r),o.setStart(n,r),e.removeAllRanges(),e.addRange(o)}else e.extend&&e.extend(n,r);t.domObserver.setCurSelection();var i=t.state;setTimeout((function(){t.state==i&&Ze(t)}),50)}function gn(t,e,n){var r=t.state.selection;if(r instanceof Ot&&!r.empty||n.indexOf("s")>-1)return!1;if(Ut.mac&&n.indexOf("m")>-1)return!1;var o=r.$from,i=r.$to;if(!o.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){var s=un(t.state,e);if(s&&s instanceof Et)return ln(t,s)}if(!o.parent.inlineContent){var a=e<0?o:i,c=r instanceof Mt?kt.near(a,e):kt.findFrom(a,e);return!!c&&ln(t,c)}return!1}function bn(t,e){if(!(t.state.selection instanceof Ot))return!0;var n=t.state.selection,r=n.$head,o=n.$anchor,i=n.empty;if(!r.sameParent(o))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;var s=!r.textOffset&&(e<0?r.nodeBefore:r.nodeAfter);if(s&&!s.isText){var a=t.state.tr;return e<0?a.delete(r.pos-s.nodeSize,r.pos):a.delete(r.pos,r.pos+s.nodeSize),t.dispatch(a),!0}return!1}function wn(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function kn(t,e){var n=e.keyCode,r=function(t){var e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}(e);return 8==n||Ut.mac&&72==n&&"c"==r?bn(t,-1)||dn(t):46==n||Ut.mac&&68==n&&"c"==r?bn(t,1)||vn(t):13==n||27==n||(37==n?fn(t,-1,r)||dn(t):39==n?fn(t,1,r)||vn(t):38==n?gn(t,-1,r)||dn(t):40==n?function(t){if(Ut.safari&&!(t.state.selection.$head.parentOffset>0)){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n&&1==n.nodeType&&0==r&&n.firstChild&&"false"==n.firstChild.contentEditable){var o=n.firstChild;wn(t,o,!0),setTimeout((function(){return wn(t,o,!1)}),20)}}}(t)||gn(t,1,r)||vn(t):r==(Ut.mac?"m":"c")&&(66==n||73==n||89==n||90==n))}function xn(t){var e=t.pmViewDesc;if(e)return e.parseRule();if("BR"==t.nodeName&&t.parentNode){if(Ut.safari&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){var n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}if(t.parentNode.lastChild==t||Ut.safari&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if("IMG"==t.nodeName&&t.getAttribute("mark-placeholder"))return{ignore:!0}}function Sn(t,e,n,r,o){if(e<0){var i=t.lastSelectionTime>Date.now()-50?t.lastSelectionOrigin:null,a=Xe(t,i);if(a&&!t.state.selection.eq(a)){var c=t.state.tr.setSelection(a);"pointer"==i?c.setMeta("pointer",!0):"key"==i&&c.scrollIntoView(),t.dispatch(c)}}else{var u=t.state.doc.resolve(e),l=u.sharedDepth(n);e=u.before(l+1),n=t.state.doc.resolve(n).after(l+1);var f=t.state.selection,h=function(t,e,n){var r=t.docView.parseRange(e,n),o=r.node,i=r.fromOffset,s=r.toOffset,a=r.from,c=r.to,u=t.root.getSelection(),l=null,f=u.anchorNode;if(f&&t.dom.contains(1==f.nodeType?f:f.parentNode)&&(l=[{node:f,offset:u.anchorOffset}],ie(u)||l.push({node:u.focusNode,offset:u.focusOffset})),Ut.chrome&&8===t.lastKeyCode)for(var h=s;h>i;h--){var p=o.childNodes[h-1],d=p.pmViewDesc;if("BR"==p.nodeType&&!d){s=h;break}if(!d||d.size)break}var v=t.state.doc,y=t.someProp("domParser")||it.fromSchema(t.state.schema),m=v.resolve(a),g=null,b=y.parse(o,{topNode:m.parent,topMatch:m.parent.contentMatchAt(m.index()),topOpen:!0,from:i,to:s,preserveWhitespace:!m.parent.type.spec.code||"full",editableContent:!0,findPositions:l,ruleFromNode:xn,context:m});if(l&&null!=l[0].pos){var w=l[0].pos,k=l[1]&&l[1].pos;null==k&&(k=w),g={anchor:w+a,head:k+a}}return{doc:b,sel:g,from:a,to:c}}(t,e,n);if(Ut.chrome&&t.cursorWrapper&&h.sel&&h.sel.anchor==t.cursorWrapper.deco.from){var p=t.cursorWrapper.deco.type.toDOM.nextSibling,d=p&&p.nodeValue?p.nodeValue.length:1;h.sel={anchor:h.sel.anchor+d,head:h.sel.anchor+d}}var v,y,m=t.state.doc,g=m.slice(h.from,h.to);8===t.lastKeyCode&&Date.now()-100<t.lastKeyCodeTime?(v=t.state.selection.to,y="end"):(v=t.state.selection.from,y="start"),t.lastKeyCode=null;var b=function(t,e,n,r,o){var i=t.findDiffStart(e,n);if(null==i)return null;var s=t.findDiffEnd(e,n+t.size,n+e.size),a=s.a,c=s.b;if("end"==o){r-=a+Math.max(0,i-Math.min(a,c))-i}if(a<i&&t.size<e.size){c=(i-=r<=i&&r>=a?i-r:0)+(c-a),a=i}else if(c<i){a=(i-=r<=i&&r>=c?i-r:0)+(a-c),c=i}return{start:i,endA:a,endB:c}}(g.content,h.doc.content,h.from,v,y);if(!b){if(!(r&&f instanceof Ot&&!f.empty&&f.$head.sameParent(f.$anchor))||t.composing||h.sel&&h.sel.anchor!=h.sel.head){if(Ut.ios&&t.lastIOSEnter>Date.now()-225&&o.some((function(t){return"DIV"==t.nodeName||"P"==t.nodeName}))&&t.someProp("handleKeyDown",(function(e){return e(t,se(13,"Enter"))})))return void(t.lastIOSEnter=0);if(h.sel){var w=On(t,t.state.doc,h.sel);w&&!w.eq(t.state.selection)&&t.dispatch(t.state.tr.setSelection(w))}return}b={start:f.from,endA:f.to,endB:f.to}}t.domChangeCount++,t.state.selection.from<t.state.selection.to&&b.start==b.endB&&t.state.selection instanceof Ot&&(b.start>t.state.selection.from&&b.start<=t.state.selection.from+2?b.start=t.state.selection.from:b.endA<t.state.selection.to&&b.endA>=t.state.selection.to-2&&(b.endB+=t.state.selection.to-b.endA,b.endA=t.state.selection.to)),Ut.ie&&Ut.ie_version<=11&&b.endB==b.start+1&&b.endA==b.start&&b.start>h.from&&" \xa0"==h.doc.textBetween(b.start-h.from-1,b.start-h.from+1)&&(b.start--,b.endA--,b.endB--);var k,x=h.doc.resolveNoCache(b.start-h.from),S=h.doc.resolveNoCache(b.endB-h.from),O=x.sameParent(S)&&x.parent.inlineContent;if((Ut.ios&&t.lastIOSEnter>Date.now()-225&&(!O||o.some((function(t){return"DIV"==t.nodeName||"P"==t.nodeName})))||!O&&x.pos<h.doc.content.size&&(k=kt.findFrom(h.doc.resolve(x.pos+1),1,!0))&&k.head==S.pos)&&t.someProp("handleKeyDown",(function(e){return e(t,se(13,"Enter"))})))t.lastIOSEnter=0;else if(t.state.selection.anchor>b.start&&function(t,e,n,r,o){if(!r.parent.isTextblock||n-e<=o.pos-r.pos||Cn(r,!0,!1)<o.pos)return!1;var i=t.resolve(e);if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;var s=t.resolve(Cn(i,!0,!0));if(!s.parent.isTextblock||s.pos>n||Cn(s,!0,!1)<n)return!1;return r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(m,b.start,b.endA,x,S)&&t.someProp("handleKeyDown",(function(e){return e(t,se(8,"Backspace"))})))Ut.android&&Ut.chrome&&t.domObserver.suppressSelectionUpdates();else{Ut.android&&!O&&x.start()!=S.start()&&0==S.parentOffset&&x.depth==S.depth&&h.sel&&h.sel.anchor==h.sel.head&&h.sel.head==b.endA&&(b.endB-=2,S=h.doc.resolveNoCache(b.endB-h.from),setTimeout((function(){t.someProp("handleKeyDown",(function(e){return e(t,se(13,"Enter"))}))}),20));var C,E,_,M,T=b.start,N=b.endA;if(O)if(x.pos==S.pos)Ut.ie&&Ut.ie_version<=11&&0==x.parentOffset&&(t.domObserver.suppressSelectionUpdates(),setTimeout((function(){return Ze(t)}),20)),C=t.state.tr.delete(T,N),E=m.resolve(b.start).marksAcross(m.resolve(b.endA));else if(b.endA==b.endB&&(M=m.resolve(b.start))&&(_=function(t,e){for(var n,r,o,i=t.firstChild.marks,a=e.firstChild.marks,c=i,u=a,l=0;l<a.length;l++)c=a[l].removeFromSet(c);for(var f=0;f<i.length;f++)u=i[f].removeFromSet(u);if(1==c.length&&0==u.length)r=c[0],n="add",o=function(t){return t.mark(r.addToSet(t.marks))};else{if(0!=c.length||1!=u.length)return null;r=u[0],n="remove",o=function(t){return t.mark(r.removeFromSet(t.marks))}}for(var h=[],p=0;p<e.childCount;p++)h.push(o(e.child(p)));if(s.from(h).eq(t))return{mark:r,type:n}}(x.parent.content.cut(x.parentOffset,S.parentOffset),M.parent.content.cut(M.parentOffset,b.endA-M.start()))))C=t.state.tr,"add"==_.type?C.addMark(T,N,_.mark):C.removeMark(T,N,_.mark);else if(x.parent.child(x.index()).isText&&x.index()==S.index()-(S.textOffset?0:1)){var A=x.parent.textBetween(x.parentOffset,S.parentOffset);if(t.someProp("handleTextInput",(function(e){return e(t,T,N,A)})))return;C=t.state.tr.insertText(A,T,N)}if(C||(C=t.state.tr.replace(T,N,h.doc.slice(b.start-h.from,b.endB-h.from))),h.sel){var I=On(t,C.doc,h.sel);I&&!(Ut.chrome&&Ut.android&&t.composing&&I.empty&&(I.head==T||I.head==C.mapping.map(N)-1)||Ut.ie&&I.empty&&I.head==T)&&C.setSelection(I)}E&&C.ensureMarks(E),t.dispatch(C.scrollIntoView())}}}function On(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:an(t,e.resolve(n.anchor),e.resolve(n.head))}function Cn(t,e,n){for(var r=t.depth,o=e?t.end():t.pos;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,o++,e=!1;if(n)for(var i=t.node(r).maybeChild(t.indexAfter(r));i&&!i.isLeaf;)i=i.firstChild,o++;return o}function En(t,e){for(var n=[],r=e.content,o=e.openStart,i=e.openEnd;o>1&&i>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,i--;var s=r.firstChild;n.push(s.type.name,s.attrs!=s.type.defaultAttrs?s.attrs:null),r=s.content}var a=t.someProp("clipboardSerializer")||yt.fromSchema(t.state.schema),c=Dn(),u=c.createElement("div");u.appendChild(a.serializeFragment(r,{document:c}));for(var l,f=u.firstChild;f&&1==f.nodeType&&(l=In[f.nodeName.toLowerCase()]);){for(var h=l.length-1;h>=0;h--){for(var p=c.createElement(l[h]);u.firstChild;)p.appendChild(u.firstChild);u.appendChild(p)}f=u.firstChild}return f&&1==f.nodeType&&f.setAttribute("data-pm-slice",o+" "+i+" "+JSON.stringify(n)),{dom:u,text:t.someProp("clipboardTextSerializer",(function(t){return t(e)}))||e.content.textBetween(0,e.content.size,"\n\n")}}function _n(t,e,n,r,o){var i,a,c=o.parent.type.spec.code;if(!n&&!e)return null;var u=e&&(r||c||!n);if(u){if(t.someProp("transformPastedText",(function(t){e=t(e,c||r)})),c)return new p(s.from(t.state.schema.text(e)),0,0);var l=t.someProp("clipboardTextParser",(function(t){return t(e,o,r)}));l?a=l:(i=document.createElement("div"),e.trim().split(/(?:\r\n?|\n)+/).forEach((function(t){i.appendChild(document.createElement("p")).textContent=t})))}else t.someProp("transformPastedHTML",(function(t){n=t(n)})),i=function(t){var e=/(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));var n,r=Dn().createElement("div"),o=/(?:<meta [^>]*>)*<([a-z][^>\s]+)/i.exec(t),i=0;(n=o&&In[o[1].toLowerCase()])&&(t=n.map((function(t){return"<"+t+">"})).join("")+t+n.map((function(t){return"</"+t+">"})).reverse().join(""),i=n.length);r.innerHTML=t;for(var s=0;s<i;s++)r=r.firstChild;return r}(n);var f=i&&i.querySelector("[data-pm-slice]"),h=f&&/^(\d+) (\d+) (.*)/.exec(f.getAttribute("data-pm-slice"));if(!a){var d=t.someProp("clipboardParser")||t.someProp("domParser")||it.fromSchema(t.state.schema);a=d.parseSlice(i,{preserveWhitespace:!(!u&&!h),context:o})}return a=h?function(t,e){if(!t.size)return t;var n,r=t.content.firstChild.type.schema;try{n=JSON.parse(e)}catch(l){return t}for(var o=t.content,i=t.openStart,a=t.openEnd,c=n.length-2;c>=0;c-=2){var u=r.nodes[n[c]];if(!u||u.hasRequiredAttrs())break;o=s.from(u.create(n[c+1],o)),i++,a++}return new p(o,i,a)}(function(t,e,n){e<t.openStart&&(t=new p(An(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd));n<t.openEnd&&(t=new p(An(t.content,1,n,t.openEnd,0,0),t.openStart,n));return t}(a,+h[1],+h[2]),h[3]):p.maxOpen(function(t,e){if(t.childCount<2)return t;for(var n=function(n){var r=e.node(n).contentMatchAt(e.index(n)),o=void 0,i=[];if(t.forEach((function(t){if(i){var e,n=r.findWrapping(t.type);if(!n)return i=null;if(e=i.length&&o.length&&Tn(n,o,t,i[i.length-1],0))i[i.length-1]=e;else{i.length&&(i[i.length-1]=Nn(i[i.length-1],o.length));var s=Mn(t,n);i.push(s),r=r.matchType(s.type,s.attrs),o=n}}})),i)return{v:s.from(i)}},r=e.depth;r>=0;r--){var o=n(r);if(o)return o.v}return t}(a.content,o),!1),t.someProp("transformPasted",(function(t){a=t(a)})),a}function Mn(t,e,n){void 0===n&&(n=0);for(var r=e.length-1;r>=n;r--)t=e[r].create(null,s.from(t));return t}function Tn(t,e,n,r,o){if(o<t.length&&o<e.length&&t[o]==e[o]){var i=Tn(t,e,n,r.lastChild,o+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(o==t.length-1?n.type:t[o+1]))return r.copy(r.content.append(s.from(Mn(n,t,o+1))))}}function Nn(t,e){if(0==e)return t;var n=t.content.replaceChild(t.childCount-1,Nn(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(s.empty,!0);return t.copy(n.append(r))}function An(t,e,n,r,o,i){var a=e<0?t.firstChild:t.lastChild,c=a.content;return o<r-1&&(c=An(c,e,n,r,o+1,i)),o>=n&&(c=e<0?a.contentMatchAt(0).fillBefore(c,t.childCount>1||i<=o).append(c):c.append(a.contentMatchAt(a.childCount).fillBefore(s.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,a.copy(c))}var In={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},jn=null;function Dn(){return jn||(jn=document.implementation.createHTMLDocument("title"))}var Rn={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Pn=Ut.ie&&Ut.ie_version<=11,zn=function(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};zn.prototype.set=function(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset},zn.prototype.eq=function(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset};var Fn=function(t,e){var n=this;this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=window.MutationObserver&&new window.MutationObserver((function(t){for(var e=0;e<t.length;e++)n.queue.push(t[e]);Ut.ie&&Ut.ie_version<=11&&t.some((function(t){return"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length}))?n.flushSoon():n.flush()})),this.currentSelection=new zn,Pn&&(this.onCharData=function(t){n.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),n.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};Fn.prototype.flushSoon=function(){var t=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((function(){t.flushingSoon=-1,t.flush()}),20))},Fn.prototype.forceFlush=function(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())},Fn.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,Rn),Pn&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},Fn.prototype.stop=function(){var t=this;if(this.observer){var e=this.observer.takeRecords();if(e.length){for(var n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout((function(){return t.flush()}),20)}this.observer.disconnect()}Pn&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},Fn.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},Fn.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},Fn.prototype.suppressSelectionUpdates=function(){var t=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return t.suppressingSelectionUpdates=!1}),50)},Fn.prototype.onSelectionChange=function(){if((!(t=this.view).editable||t.root.activeElement==t.dom)&&cn(t)){var t;if(this.suppressingSelectionUpdates)return Ze(this.view);if(Ut.ie&&Ut.ie_version<=11&&!this.view.state.selection.empty){var e=this.view.root.getSelection();if(e.focusNode&&te(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}},Fn.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())},Fn.prototype.ignoreSelectionChange=function(t){if(0==t.rangeCount)return!0;var e=t.getRangeAt(0).commonAncestorContainer,n=this.view.docView.nearestDesc(e);return n&&n.ignoreMutation({type:"selection",target:3==e.nodeType?e.parentNode:e})?(this.setCurSelection(),!0):void 0},Fn.prototype.flush=function(){if(this.view.docView&&!(this.flushingSoon>-1)){var t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);var e=this.view.root.getSelection(),n=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(e)&&cn(this.view)&&!this.ignoreSelectionChange(e),r=-1,o=-1,i=!1,s=[];if(this.view.editable)for(var a=0;a<t.length;a++){var c=this.registerMutation(t[a],s);c&&(r=r<0?c.from:Math.min(c.from,r),o=o<0?c.to:Math.max(c.to,o),c.typeOver&&(i=!0))}if(Ut.gecko&&s.length>1){var u=s.filter((function(t){return"BR"==t.nodeName}));if(2==u.length){var l=u[0],f=u[1];l.parentNode&&l.parentNode.parentNode==f.parentNode?f.remove():l.remove()}}(r>-1||n)&&(r>-1&&(this.view.docView.markDirty(r,o),function(t){if(Bn)return;Bn=!0,"normal"==getComputedStyle(t.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.")}(this.view)),this.handleDOMChange(r,o,i,s),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(e)||Ze(this.view),this.currentSelection.set(e))}},Fn.prototype.registerMutation=function(t,e){if(e.indexOf(t.target)>-1)return null;var n=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(n==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(t))return null;if("childList"==t.type){var r=t.previousSibling,o=t.nextSibling;if(Ut.ie&&Ut.ie_version<=11&&t.addedNodes.length)for(var i=0;i<t.addedNodes.length;i++){var s=t.addedNodes[i],a=s.previousSibling,c=s.nextSibling;(!a||Array.prototype.indexOf.call(t.addedNodes,a)<0)&&(r=a),(!c||Array.prototype.indexOf.call(t.addedNodes,c)<0)&&(o=c)}for(var u=r&&r.parentNode==t.target?Gt(r)+1:0,l=n.localPosFromDOM(t.target,u,-1),f=o&&o.parentNode==t.target?Gt(o):t.target.childNodes.length,h=0;h<t.addedNodes.length;h++)e.push(t.addedNodes[h]);return{from:l,to:n.localPosFromDOM(t.target,f,1)}}return"attributes"==t.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}};var Bn=!1;var Ln={},$n={};function qn(t,e){t.lastSelectionOrigin=e,t.lastSelectionTime=Date.now()}function Jn(t){t.someProp("handleDOMEvents",(function(e){for(var n in e)t.eventHandlers[n]||t.dom.addEventListener(n,t.eventHandlers[n]=function(e){return Un(t,e)})}))}function Un(t,e){return t.someProp("handleDOMEvents",(function(n){var r=n[e.type];return!!r&&(r(t,e)||e.defaultPrevented)}))}function Vn(t){return{left:t.clientX,top:t.clientY}}function Wn(t,e,n,r,o){if(-1==r)return!1;for(var i=t.state.doc.resolve(r),s=function(r){if(t.someProp(e,(function(e){return r>i.depth?e(t,n,i.nodeAfter,i.before(r),o,!0):e(t,n,i.node(r),i.before(r),o,!1)})))return{v:!0}},a=i.depth+1;a>0;a--){var c=s(a);if(c)return c.v}return!1}function Hn(t,e,n){t.focused||t.focus();var r=t.state.tr.setSelection(e);"pointer"==n&&r.setMeta("pointer",!0),t.dispatch(r)}function Kn(t,e,n,r,o){return Wn(t,"handleClickOn",e,n,r)||t.someProp("handleClick",(function(n){return n(t,e,r)}))||(o?function(t,e){if(-1==e)return!1;var n,r,o=t.state.selection;o instanceof Et&&(n=o.node);for(var i=t.state.doc.resolve(e),s=i.depth+1;s>0;s--){var a=s>i.depth?i.nodeAfter:i.node(s);if(Et.isSelectable(a)){r=n&&o.$from.depth>0&&s>=o.$from.depth&&i.before(o.$from.depth+1)==o.$from.pos?i.before(o.$from.depth):i.before(s);break}}return null!=r&&(Hn(t,Et.create(t.state.doc,r),"pointer"),!0)}(t,n):function(t,e){if(-1==e)return!1;var n=t.state.doc.resolve(e),r=n.nodeAfter;return!!(r&&r.isAtom&&Et.isSelectable(r))&&(Hn(t,new Et(n),"pointer"),!0)}(t,n))}function Yn(t,e,n,r){return Wn(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",(function(n){return n(t,e,r)}))}function Gn(t,e,n,r){return Wn(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",(function(n){return n(t,e,r)}))||function(t,e){var n=t.state.doc;if(-1==e)return!!n.inlineContent&&(Hn(t,Ot.create(n,0,n.content.size),"pointer"),!0);for(var r=n.resolve(e),o=r.depth+1;o>0;o--){var i=o>r.depth?r.nodeAfter:r.node(o),s=r.before(o);if(i.inlineContent)Hn(t,Ot.create(n,s+1,s+1+i.content.size),"pointer");else{if(!Et.isSelectable(i))continue;Hn(t,Et.create(n,s),"pointer")}return!0}}(t,n)}function Qn(t){return or(t)}$n.keydown=function(t,e){if(t.shiftKey=16==e.keyCode||e.shiftKey,!tr(t,e))if(t.domObserver.forceFlush(),t.lastKeyCode=e.keyCode,t.lastKeyCodeTime=Date.now(),!Ut.ios||13!=e.keyCode||e.ctrlKey||e.altKey||e.metaKey)t.someProp("handleKeyDown",(function(n){return n(t,e)}))||kn(t,e)?e.preventDefault():qn(t,"key");else{var n=Date.now();t.lastIOSEnter=n,t.lastIOSEnterFallbackTimeout=setTimeout((function(){t.lastIOSEnter==n&&(t.someProp("handleKeyDown",(function(e){return e(t,se(13,"Enter"))})),t.lastIOSEnter=0)}),200)}},$n.keyup=function(t,e){16==e.keyCode&&(t.shiftKey=!1)},$n.keypress=function(t,e){if(!(tr(t,e)||!e.charCode||e.ctrlKey&&!e.altKey||Ut.mac&&e.metaKey))if(t.someProp("handleKeyPress",(function(n){return n(t,e)})))e.preventDefault();else{var n=t.state.selection;if(!(n instanceof Ot)||!n.$from.sameParent(n.$to)){var r=String.fromCharCode(e.charCode);t.someProp("handleTextInput",(function(e){return e(t,n.$from.pos,n.$to.pos,r)}))||t.dispatch(t.state.tr.insertText(r).scrollIntoView()),e.preventDefault()}}};var Xn=Ut.mac?"metaKey":"ctrlKey";Ln.mousedown=function(t,e){t.shiftKey=e.shiftKey;var n=Qn(t),r=Date.now(),o="singleClick";r-t.lastClick.time<500&&function(t,e){var n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}(e,t.lastClick)&&!e[Xn]&&("singleClick"==t.lastClick.type?o="doubleClick":"doubleClick"==t.lastClick.type&&(o="tripleClick")),t.lastClick={time:r,x:e.clientX,y:e.clientY,type:o};var i=t.posAtCoords(Vn(e));i&&("singleClick"==o?t.mouseDown=new Zn(t,i,e,n):("doubleClick"==o?Yn:Gn)(t,i.pos,i.inside,e)?e.preventDefault():qn(t,"pointer"))};var Zn=function(t,e,n,r){var o,i,s=this;if(this.view=t,this.startDoc=t.state.doc,this.pos=e,this.event=n,this.flushed=r,this.selectNode=n[Xn],this.allowDefault=n.shiftKey,e.inside>-1)o=t.state.doc.nodeAt(e.inside),i=e.inside;else{var a=t.state.doc.resolve(e.pos);o=a.parent,i=a.depth?a.before():0}this.mightDrag=null;var c=r?null:n.target,u=c?t.docView.nearestDesc(c,!0):null;this.target=u?u.dom:null,(o.type.spec.draggable&&!1!==o.type.spec.selectable||t.state.selection instanceof Et&&i==t.state.selection.from)&&(this.mightDrag={node:o,pos:i,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&Ut.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){return s.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),qn(t,"pointer")};function tr(t,e){return!!t.composing||!!(Ut.safari&&Math.abs(e.timeStamp-t.compositionEndedAt)<500)&&(t.compositionEndedAt=-2e8,!0)}Zn.prototype.done=function(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.view.mouseDown=null},Zn.prototype.up=function(t){if(this.done(),this.view.dom.contains(3==t.target.nodeType?t.target.parentNode:t.target)){var e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(Vn(t))),this.allowDefault||!e?qn(this.view,"pointer"):Kn(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():this.flushed||Ut.safari&&this.mightDrag&&!this.mightDrag.node.isAtom||Ut.chrome&&!(this.view.state.selection instanceof Ot)&&(e.pos==this.view.state.selection.from||e.pos==this.view.state.selection.to)?(Hn(this.view,kt.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault()):qn(this.view,"pointer")}},Zn.prototype.move=function(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0),qn(this.view,"pointer")},Ln.touchdown=function(t){Qn(t),qn(t,"pointer")},Ln.contextmenu=function(t){return Qn(t)};var er=Ut.android?5e3:-1;function nr(t,e){clearTimeout(t.composingTimeout),e>-1&&(t.composingTimeout=setTimeout((function(){return or(t)}),e))}function rr(t){for(t.composing=!1;t.compositionNodes.length>0;)t.compositionNodes.pop().markParentsDirty()}function or(t,e){if(t.domObserver.forceFlush(),rr(t),e||t.docView.dirty){var n=Xe(t);return n&&!n.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(n)):t.updateState(t.state),!0}return!1}$n.compositionstart=$n.compositionupdate=function(t){if(!t.composing){t.domObserver.flush();var e=t.state,n=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some((function(t){return!1===t.type.spec.inclusive}))))t.markCursor=t.state.storedMarks||n.marks(),or(t,!0),t.markCursor=null;else if(or(t),Ut.gecko&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length)for(var r=t.root.getSelection(),o=r.focusNode,i=r.focusOffset;o&&1==o.nodeType&&0!=i;){var s=i<0?o.lastChild:o.childNodes[i-1];if(!s)break;if(3==s.nodeType){r.collapse(s,s.nodeValue.length);break}o=s,i=-1}t.composing=!0}nr(t,er)},$n.compositionend=function(t,e){t.composing&&(t.composing=!1,t.compositionEndedAt=e.timeStamp,nr(t,20))};var ir=Ut.ie&&Ut.ie_version<15||Ut.ios&&Ut.webkit_version<604;function sr(t,e,n,r){var o=_n(t,e,n,t.shiftKey,t.state.selection.$from);if(t.someProp("handlePaste",(function(e){return e(t,r,o||p.empty)})))return!0;if(!o)return!1;var i=function(t){return 0==t.openStart&&0==t.openEnd&&1==t.content.childCount?t.content.firstChild:null}(o),s=i?t.state.tr.replaceSelectionWith(i,t.shiftKey):t.state.tr.replaceSelection(o);return t.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}Ln.copy=$n.cut=function(t,e){var n=t.state.selection,r="cut"==e.type;if(!n.empty){var o=ir?null:e.clipboardData,i=En(t,n.content()),s=i.dom,a=i.text;o?(e.preventDefault(),o.clearData(),o.setData("text/html",s.innerHTML),o.setData("text/plain",a)):function(t,e){if(t.dom.parentNode){var n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";var r=getSelection(),o=document.createRange();o.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout((function(){n.parentNode&&n.parentNode.removeChild(n),t.focus()}),50)}}(t,s),r&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},$n.paste=function(t,e){var n=ir?null:e.clipboardData;n&&sr(t,n.getData("text/plain"),n.getData("text/html"),e)?e.preventDefault():function(t,e){if(t.dom.parentNode){var n=t.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout((function(){t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?sr(t,r.value,null,e):sr(t,r.textContent,r.innerHTML,e)}),50)}}(t,e)};var ar=function(t,e){this.slice=t,this.move=e},cr=Ut.mac?"altKey":"ctrlKey";for(var ur in Ln.dragstart=function(t,e){var n=t.mouseDown;if(n&&n.done(),e.dataTransfer){var r=t.state.selection,o=r.empty?null:t.posAtCoords(Vn(e));if(o&&o.pos>=r.from&&o.pos<=(r instanceof Et?r.to-1:r.to));else if(n&&n.mightDrag)t.dispatch(t.state.tr.setSelection(Et.create(t.state.doc,n.mightDrag.pos)));else if(e.target&&1==e.target.nodeType){var i=t.docView.nearestDesc(e.target,!0);if(!i||!i.node.type.spec.draggable||i==t.docView)return;t.dispatch(t.state.tr.setSelection(Et.create(t.state.doc,i.posBefore)))}var s=t.state.selection.content(),a=En(t,s),c=a.dom,u=a.text;e.dataTransfer.clearData(),e.dataTransfer.setData(ir?"Text":"text/html",c.innerHTML),ir||e.dataTransfer.setData("text/plain",u),t.dragging=new ar(s,!e[cr])}},Ln.dragend=function(t){var e=t.dragging;window.setTimeout((function(){t.dragging==e&&(t.dragging=null)}),50)},$n.dragover=$n.dragenter=function(t,e){return e.preventDefault()},$n.drop=function(t,e){var n=t.dragging;if(t.dragging=null,e.dataTransfer){var r=t.posAtCoords(Vn(e));if(r){var o=t.state.doc.resolve(r.pos);if(o){var i=n&&n.slice||_n(t,e.dataTransfer.getData(ir?"Text":"text/plain"),ir?null:e.dataTransfer.getData("text/html"),!1,o),s=n&&!e[cr];if(t.someProp("handleDrop",(function(n){return n(t,e,i||p.empty,s)})))e.preventDefault();else if(i){e.preventDefault();var a=i?Object(bt.g)(t.state.doc,o.pos,i):o.pos;null==a&&(a=o.pos);var c=t.state.tr;s&&c.deleteSelection();var u=c.mapping.map(a),l=0==i.openStart&&0==i.openEnd&&1==i.content.childCount,f=c.doc;if(l?c.replaceRangeWith(u,u,i.content.firstChild):c.replaceRange(u,u,i),!c.doc.eq(f)){var h=c.doc.resolve(u);if(l&&Et.isSelectable(i.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(i.content.firstChild))c.setSelection(new Et(h));else{var d=c.mapping.map(a);c.mapping.maps[c.mapping.maps.length-1].forEach((function(t,e,n,r){return d=r})),c.setSelection(an(t,h,c.doc.resolve(d)))}t.focus(),t.dispatch(c.setMeta("uiEvent","drop"))}}}}}},Ln.focus=function(t){t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout((function(){t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.root.getSelection())&&Ze(t)}),20))},Ln.blur=function(t){t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),t.domObserver.currentSelection.set({}),t.focused=!1)},Ln.beforeinput=function(t,e){if(Ut.chrome&&Ut.android&&"deleteContentBackward"==e.inputType){var n=t.domChangeCount;setTimeout((function(){if(t.domChangeCount==n&&(t.dom.blur(),t.focus(),!t.someProp("handleKeyDown",(function(e){return e(t,se(8,"Backspace"))})))){var e=t.state.selection.$cursor;e&&e.pos>0&&t.dispatch(t.state.tr.delete(e.pos-1,e.pos).scrollIntoView())}}),50)}},$n)Ln[ur]=$n[ur];function lr(t,e){if(t==e)return!0;for(var n in t)if(t[n]!==e[n])return!1;for(var r in e)if(!(r in t))return!1;return!0}var fr=function(t,e){this.spec=e||mr,this.side=this.spec.side||0,this.toDOM=t};fr.prototype.map=function(t,e,n,r){var o=t.mapResult(e.from+r,this.side<0?-1:1),i=o.pos;return o.deleted?null:new dr(i-n,i-n,this)},fr.prototype.valid=function(){return!0},fr.prototype.eq=function(t){return this==t||t instanceof fr&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&lr(this.spec,t.spec))};var hr=function(t,e){this.spec=e||mr,this.attrs=t};hr.prototype.map=function(t,e,n,r){var o=t.map(e.from+r,this.spec.inclusiveStart?-1:1)-n,i=t.map(e.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new dr(o,i,this)},hr.prototype.valid=function(t,e){return e.from<e.to},hr.prototype.eq=function(t){return this==t||t instanceof hr&&lr(this.attrs,t.attrs)&&lr(this.spec,t.spec)},hr.is=function(t){return t.type instanceof hr};var pr=function(t,e){this.spec=e||mr,this.attrs=t};pr.prototype.map=function(t,e,n,r){var o=t.mapResult(e.from+r,1);if(o.deleted)return null;var i=t.mapResult(e.to+r,-1);return i.deleted||i.pos<=o.pos?null:new dr(o.pos-n,i.pos-n,this)},pr.prototype.valid=function(t,e){var n=t.content.findIndex(e.from),r=n.index,o=n.offset;return o==e.from&&o+t.child(r).nodeSize==e.to},pr.prototype.eq=function(t){return this==t||t instanceof pr&&lr(this.attrs,t.attrs)&&lr(this.spec,t.spec)};var dr=function(t,e,n){this.from=t,this.to=e,this.type=n},vr={spec:{configurable:!0},inline:{configurable:!0}};dr.prototype.copy=function(t,e){return new dr(t,e,this.type)},dr.prototype.eq=function(t,e){return void 0===e&&(e=0),this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to},dr.prototype.map=function(t,e,n){return this.type.map(t,this,e,n)},dr.widget=function(t,e,n){return new dr(t,t,new fr(e,n))},dr.inline=function(t,e,n,r){return new dr(t,e,new hr(n,r))},dr.node=function(t,e,n,r){return new dr(t,e,new pr(n,r))},vr.spec.get=function(){return this.type.spec},vr.inline.get=function(){return this.type instanceof hr},Object.defineProperties(dr.prototype,vr);var yr=[],mr={},gr=function(t,e){this.local=t&&t.length?t:yr,this.children=e&&e.length?e:yr};gr.create=function(t,e){return e.length?Or(e,t,0,mr):br},gr.prototype.find=function(t,e,n){var r=[];return this.findInner(null==t?0:t,null==e?1e9:e,r,0,n),r},gr.prototype.findInner=function(t,e,n,r,o){for(var i=0;i<this.local.length;i++){var s=this.local[i];s.from<=e&&s.to>=t&&(!o||o(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(var a=0;a<this.children.length;a+=3)if(this.children[a]<e&&this.children[a+1]>t){var c=this.children[a]+1;this.children[a+2].findInner(t-c,e-c,n,r+c,o)}},gr.prototype.map=function(t,e,n){return this==br||0==t.maps.length?this:this.mapInner(t,e,0,0,n||mr)},gr.prototype.mapInner=function(t,e,n,r,o){for(var i,s=0;s<this.local.length;s++){var a=this.local[s].map(t,n,r);a&&a.type.valid(e,a)?(i||(i=[])).push(a):o.onRemove&&o.onRemove(this.local[s].spec)}return this.children.length?function(t,e,n,r,o,i,s){for(var a=t.slice(),c=function(t,e,n,r){for(var s=0;s<a.length;s+=3){var c=a[s+1],u=void 0;-1==c||t>c+i||(e>=a[s]+i?a[s+1]=-1:n>=o&&(u=r-n-(e-t))&&(a[s]+=u,a[s+1]+=u))}},u=0;u<n.maps.length;u++)n.maps[u].forEach(c);for(var l=!1,f=0;f<a.length;f+=3)if(-1==a[f+1]){var h=n.map(t[f]+i),p=h-o;if(p<0||p>=r.content.size){l=!0;continue}var d=n.map(t[f+1]+i,-1)-o,v=r.content.findIndex(p),y=v.index,m=v.offset,g=r.maybeChild(y);if(g&&m==p&&m+g.nodeSize==d){var b=a[f+2].mapInner(n,g,h+1,t[f]+i+1,s);b!=br?(a[f]=p,a[f+1]=d,a[f+2]=b):(a[f+1]=-2,l=!0)}else l=!0}if(l){var w=Or(function(t,e,n,r,o,i,s){function a(t,e){for(var i=0;i<t.local.length;i++){var c=t.local[i].map(r,o,e);c?n.push(c):s.onRemove&&s.onRemove(t.local[i].spec)}for(var u=0;u<t.children.length;u+=3)a(t.children[u+2],t.children[u]+e+1)}for(var c=0;c<t.length;c+=3)-1==t[c+1]&&a(t[c+2],e[c]+i+1);return n}(a,t,e||[],n,o,i,s),r,0,s);e=w.local;for(var k=0;k<a.length;k+=3)a[k+1]<0&&(a.splice(k,3),k-=3);for(var x=0,S=0;x<w.children.length;x+=3){for(var O=w.children[x];S<a.length&&a[S]<O;)S+=3;a.splice(S,0,w.children[x],w.children[x+1],w.children[x+2])}}return new gr(e&&e.sort(Cr),a)}(this.children,i,t,e,n,r,o):i?new gr(i.sort(Cr)):br},gr.prototype.add=function(t,e){return e.length?this==br?gr.create(t,e):this.addInner(t,e,0):this},gr.prototype.addInner=function(t,e,n){var r,o=this,i=0;t.forEach((function(t,s){var a,c=s+n;if(a=xr(e,t,c)){for(r||(r=o.children.slice());i<r.length&&r[i]<s;)i+=3;r[i]==s?r[i+2]=r[i+2].addInner(t,a,c+1):r.splice(i,0,s,s+t.nodeSize,Or(a,t,c+1,mr)),i+=3}}));for(var s=kr(i?Sr(e):e,-n),a=0;a<s.length;a++)s[a].type.valid(t,s[a])||s.splice(a--,1);return new gr(s.length?this.local.concat(s).sort(Cr):this.local,r||this.children)},gr.prototype.remove=function(t){return 0==t.length||this==br?this:this.removeInner(t,0)},gr.prototype.removeInner=function(t,e){for(var n=this.children,r=this.local,o=0;o<n.length;o+=3){for(var i=void 0,s=n[o]+e,a=n[o+1]+e,c=0,u=void 0;c<t.length;c++)(u=t[c])&&u.from>s&&u.to<a&&(t[c]=null,(i||(i=[])).push(u));if(i){n==this.children&&(n=this.children.slice());var l=n[o+2].removeInner(i,s+1);l!=br?n[o+2]=l:(n.splice(o,3),o-=3)}}if(r.length)for(var f=0,h=void 0;f<t.length;f++)if(h=t[f])for(var p=0;p<r.length;p++)r[p].eq(h,e)&&(r==this.local&&(r=this.local.slice()),r.splice(p--,1));return n==this.children&&r==this.local?this:r.length||n.length?new gr(r,n):br},gr.prototype.forChild=function(t,e){if(this==br)return this;if(e.isLeaf)return gr.empty;for(var n,r,o=0;o<this.children.length;o+=3)if(this.children[o]>=t){this.children[o]==t&&(n=this.children[o+2]);break}for(var i=t+1,s=i+e.content.size,a=0;a<this.local.length;a++){var c=this.local[a];if(c.from<s&&c.to>i&&c.type instanceof hr){var u=Math.max(i,c.from)-i,l=Math.min(s,c.to)-i;u<l&&(r||(r=[])).push(c.copy(u,l))}}if(r){var f=new gr(r.sort(Cr));return n?new wr([f,n]):f}return n||br},gr.prototype.eq=function(t){if(this==t)return!0;if(!(t instanceof gr)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(var e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(var n=0;n<this.children.length;n+=3)if(this.children[n]!=t.children[n]||this.children[n+1]!=t.children[n+1]||!this.children[n+2].eq(t.children[n+2]))return!1;return!0},gr.prototype.locals=function(t){return Er(this.localsInner(t))},gr.prototype.localsInner=function(t){if(this==br)return yr;if(t.inlineContent||!this.local.some(hr.is))return this.local;for(var e=[],n=0;n<this.local.length;n++)this.local[n].type instanceof hr||e.push(this.local[n]);return e};var br=new gr;gr.empty=br,gr.removeOverlap=Er;var wr=function(t){this.members=t};function kr(t,e){if(!e||!t.length)return t;for(var n=[],r=0;r<t.length;r++){var o=t[r];n.push(new dr(o.from+e,o.to+e,o.type))}return n}function xr(t,e,n){if(e.isLeaf)return null;for(var r=n+e.nodeSize,o=null,i=0,s=void 0;i<t.length;i++)(s=t[i])&&s.from>n&&s.to<r&&((o||(o=[])).push(s),t[i]=null);return o}function Sr(t){for(var e=[],n=0;n<t.length;n++)null!=t[n]&&e.push(t[n]);return e}function Or(t,e,n,r){var o=[],i=!1;e.forEach((function(e,s){var a=xr(t,e,s+n);if(a){i=!0;var c=Or(a,e,n+s+1,r);c!=br&&o.push(s,s+e.nodeSize,c)}}));for(var s=kr(i?Sr(t):t,-n).sort(Cr),a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||o.length?new gr(s,o):br}function Cr(t,e){return t.from-e.from||t.to-e.to}function Er(t){for(var e=t,n=0;n<e.length-1;n++){var r=e[n];if(r.from!=r.to)for(var o=n+1;o<e.length;o++){var i=e[o];if(i.from!=r.from){i.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,i.from),_r(e,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(e==t&&(e=t.slice()),e[o]=i.copy(i.from,r.to),_r(e,o+1,i.copy(r.to,i.to)))}}return e}function _r(t,e,n){for(;e<t.length&&Cr(n,t[e])>0;)e++;t.splice(e,0,n)}function Mr(t){var e=[];return t.someProp("decorations",(function(n){var r=n(t.state);r&&r!=br&&e.push(r)})),t.cursorWrapper&&e.push(gr.create(t.state.doc,[t.cursorWrapper.deco])),wr.from(e)}wr.prototype.forChild=function(t,e){if(e.isLeaf)return gr.empty;for(var n=[],r=0;r<this.members.length;r++){var o=this.members[r].forChild(t,e);o!=br&&(o instanceof wr?n=n.concat(o.members):n.push(o))}return wr.from(n)},wr.prototype.eq=function(t){if(!(t instanceof wr)||t.members.length!=this.members.length)return!1;for(var e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0},wr.prototype.locals=function(t){for(var e,n=!0,r=0;r<this.members.length;r++){var o=this.members[r].localsInner(t);if(o.length)if(e){n&&(e=e.slice(),n=!1);for(var i=0;i<o.length;i++)e.push(o[i])}else e=o}return e?Er(n?e:e.sort(Cr)):yr},wr.from=function(t){switch(t.length){case 0:return br;case 1:return t[0];default:return new wr(t)}};var Tr=function(t,e){this._props=e,this.state=e.state,this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.trackWrites=null,this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):t.apply?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=jr(this),this.markCursor=null,this.cursorWrapper=null,Ir(this),this.nodeViews=Dr(this),this.docView=Pe(this.state.doc,Ar(this),Mr(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,function(t){t.shiftKey=!1,t.mouseDown=null,t.lastKeyCode=null,t.lastKeyCodeTime=0,t.lastClick={time:0,x:0,y:0,type:""},t.lastSelectionOrigin=null,t.lastSelectionTime=0,t.lastIOSEnter=0,t.lastIOSEnterFallbackTimeout=null,t.composing=!1,t.composingTimeout=null,t.compositionNodes=[],t.compositionEndedAt=-2e8,t.domObserver=new Fn(t,(function(e,n,r,o){return Sn(t,e,n,r,o)})),t.domObserver.start(),t.domChangeCount=0,t.eventHandlers=Object.create(null);var e=function(e){var n=Ln[e];t.dom.addEventListener(e,t.eventHandlers[e]=function(e){!function(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(var n=e.target;n!=t.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}(t,e)||Un(t,e)||!t.editable&&e.type in $n||n(t,e)})};for(var n in Ln)e(n);Ut.safari&&t.dom.addEventListener("input",(function(){return null})),Jn(t)}(this),this.pluginViews=[],this.updatePluginViews()},Nr={props:{configurable:!0},root:{configurable:!0}};function Ar(t){var e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",(function(n){if("function"==typeof n&&(n=n(t.state)),n)for(var r in n)"class"==r?e.class+=" "+n[r]:e[r]||"contenteditable"==r||"nodeName"==r||(e[r]=String(n[r]))})),[dr.node(0,t.state.doc.content.size,e)]}function Ir(t){if(t.markCursor){var e=document.createElement("img");e.setAttribute("mark-placeholder","true"),t.cursorWrapper={dom:e,deco:dr.widget(t.state.selection.head,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function jr(t){return!t.someProp("editable",(function(e){return!1===e(t.state)}))}function Dr(t){var e={};return t.someProp("nodeViews",(function(t){for(var n in t)Object.prototype.hasOwnProperty.call(e,n)||(e[n]=t[n])})),e}Nr.props.get=function(){if(this._props.state!=this.state){var t=this._props;for(var e in this._props={},t)this._props[e]=t[e];this._props.state=this.state}return this._props},Tr.prototype.update=function(t){t.handleDOMEvents!=this._props.handleDOMEvents&&Jn(this),this._props=t,this.updateStateInner(t.state,!0)},Tr.prototype.setProps=function(t){var e={};for(var n in this._props)e[n]=this._props[n];for(var r in e.state=this.state,t)e[r]=t[r];this.update(e)},Tr.prototype.updateState=function(t){this.updateStateInner(t,this.state.plugins!=t.plugins)},Tr.prototype.updateStateInner=function(t,e){var n=this,r=this.state,o=!1,i=!1;if(t.storedMarks&&this.composing&&(rr(this),i=!0),this.state=t,e){var s=Dr(this);(function(t,e){var n=0,r=0;for(var o in t){if(t[o]!=e[o])return!0;n++}for(var i in e)r++;return n!=r})(s,this.nodeViews)&&(this.nodeViews=s,o=!0),Jn(this)}this.editable=jr(this),Ir(this);var a=Mr(this),c=Ar(this),u=e?"reset":t.scrollToSelection>r.scrollToSelection?"to selection":"preserve",l=o||!this.docView.matchesNode(t.doc,c,a);!l&&t.selection.eq(r.selection)||(i=!0);var f="preserve"==u&&i&&null==this.dom.style.overflowAnchor&&function(t){for(var e,n,r=t.dom.getBoundingClientRect(),o=Math.max(0,r.top),i=(r.left+r.right)/2,s=o+1;s<Math.min(innerHeight,r.bottom);s+=5){var a=t.root.elementFromPoint(i,s);if(a!=t.dom&&t.dom.contains(a)){var c=a.getBoundingClientRect();if(c.top>=o-20){e=a,n=c.top;break}}}return{refDOM:e,refTop:n,stack:fe(t.dom)}}(this);if(i){this.domObserver.stop();var h=l&&(Ut.ie||Ut.chrome)&&!this.composing&&!r.selection.empty&&!t.selection.empty&&function(t,e){var n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}(r.selection,t.selection);if(l){var p=Ut.chrome?this.trackWrites=this.root.getSelection().focusNode:null;!o&&this.docView.update(t.doc,c,a,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=Pe(t.doc,c,a,this.dom,this)),p&&!this.trackWrites&&(h=!0)}h||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&function(t){var e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.root.getSelection();return te(e.node,e.offset,n.anchorNode,n.anchorOffset)}(this))?Ze(this,h):(on(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(r),"reset"==u)this.dom.scrollTop=0;else if("to selection"==u){var d=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",(function(t){return t(n)}))||(t.selection instanceof Et?le(this,this.docView.domAfterPos(t.selection.from).getBoundingClientRect(),d):le(this,this.coordsAtPos(t.selection.head,1),d))}else f&&function(t){var e=t.refDOM,n=t.refTop,r=t.stack,o=e?e.getBoundingClientRect().top:0;he(r,0==o?0:o-n)}(f)},Tr.prototype.destroyPluginViews=function(){for(var t;t=this.pluginViews.pop();)t.destroy&&t.destroy()},Tr.prototype.updatePluginViews=function(t){if(t&&t.plugins==this.state.plugins)for(var e=0;e<this.pluginViews.length;e++){var n=this.pluginViews[e];n.update&&n.update(this,t)}else{this.destroyPluginViews();for(var r=0;r<this.state.plugins.length;r++){var o=this.state.plugins[r];o.spec.view&&this.pluginViews.push(o.spec.view(this))}}},Tr.prototype.someProp=function(t,e){var n,r=this._props&&this._props[t];if(null!=r&&(n=e?e(r):r))return n;var o=this.state.plugins;if(o)for(var i=0;i<o.length;i++){var s=o[i].props[t];if(null!=s&&(n=e?e(s):s))return n}},Tr.prototype.hasFocus=function(){return this.root.activeElement==this.dom},Tr.prototype.focus=function(){this.domObserver.stop(),this.editable&&function(t){if(t.setActive)return t.setActive();if(pe)return t.focus(pe);var e=fe(t);t.focus(null==pe?{get preventScroll(){return pe={preventScroll:!0},!0}}:void 0),pe||(pe=!1,he(e,0))}(this.dom),Ze(this),this.domObserver.start()},Nr.root.get=function(){var t=this._root;if(null==t)for(var e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=function(){return document.getSelection()}),this._root=e;return t||document},Tr.prototype.posAtCoords=function(t){return me(this,t)},Tr.prototype.coordsAtPos=function(t,e){return void 0===e&&(e=1),we(this,t,e)},Tr.prototype.domAtPos=function(t,e){return void 0===e&&(e=0),this.docView.domFromPos(t,e)},Tr.prototype.nodeDOM=function(t){var e=this.docView.descAt(t);return e?e.nodeDOM:null},Tr.prototype.posAtDOM=function(t,e,n){void 0===n&&(n=-1);var r=this.docView.posFromDOM(t,e,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r},Tr.prototype.endOfTextblock=function(t,e){return Me(this,e||this.state,t)},Tr.prototype.destroy=function(){this.docView&&(!function(t){for(var e in t.domObserver.stop(),t.eventHandlers)t.dom.removeEventListener(e,t.eventHandlers[e]);clearTimeout(t.composingTimeout),clearTimeout(t.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Mr(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},Tr.prototype.dispatchEvent=function(t){return function(t,e){Un(t,e)||!Ln[e.type]||!t.editable&&e.type in $n||Ln[e.type](t,e)}(this,t)},Tr.prototype.dispatch=function(t){var e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))},Object.defineProperties(Tr.prototype,Nr)},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"d",(function(){return f}));var r=n(9),o=n(75),i=n.n(o),s=(i.a.performance,i.a.cryptoRandomBuffer),a=Math.random,c=function(){return new Uint32Array(s(4))[0]},u=function(t){return t[r.c(a()*t.length)]},l=[1e7]+-1e3+-4e3+-8e3+-1e11,f=function(){return l.replace(/[018]/g,(function(t){return(t^c()&15>>t/4).toString(16)}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return l})),n.d(e,"c",(function(){return a}));var r=n(72),o=function(){return Math.random().toString(36).substring(7).split("").join(".")},i={INIT:"@@redux/INIT"+o(),REPLACE:"@@redux/REPLACE"+o(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+o()}};function s(t){if("object"!==typeof t||null===t)return!1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function a(t,e,n){var o;if("function"===typeof e&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"===typeof e&&"undefined"===typeof n&&(n=e,e=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error("Expected the enhancer to be a function.");return n(a)(t,e)}if("function"!==typeof t)throw new Error("Expected the reducer to be a function.");var c=t,u=e,l=[],f=l,h=!1;function p(){f===l&&(f=l.slice())}function d(){if(h)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return u}function v(t){if("function"!==typeof t)throw new Error("Expected the listener to be a function.");if(h)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var e=!0;return p(),f.push(t),function(){if(e){if(h)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");e=!1,p();var n=f.indexOf(t);f.splice(n,1),l=null}}}function y(t){if(!s(t))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if("undefined"===typeof t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(h)throw new Error("Reducers may not dispatch actions.");try{h=!0,u=c(u,t)}finally{h=!1}for(var e=l=f,n=0;n<e.length;n++){(0,e[n])()}return t}function m(t){if("function"!==typeof t)throw new Error("Expected the nextReducer to be a function.");c=t,y({type:i.REPLACE})}function g(){var t,e=v;return(t={subscribe:function(t){if("object"!==typeof t||null===t)throw new TypeError("Expected the observer to be an object.");function n(){t.next&&t.next(d())}return n(),{unsubscribe:e(n)}}})[r.a]=function(){return this},t}return y({type:i.INIT}),(o={dispatch:y,subscribe:v,getState:d,replaceReducer:m})[r.a]=g,o}function c(t,e){return function(){return e(t.apply(this,arguments))}}function u(t,e){if("function"===typeof t)return c(t,e);if("object"!==typeof t||null===t)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===t?"null":typeof t)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var n={};for(var r in t){var o=t[r];"function"===typeof o&&(n[r]=c(o,e))}return n}function l(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return 0===e.length?function(t){return t}:1===e.length?e[0]:e.reduce((function(t,e){return function(){return t(e.apply(void 0,arguments))}}))}},function(t,e,n){"use strict";function r(t,e,n,r){var o=n?n.call(r,t,e):void 0;if(void 0!==o)return!!o;if(t===e)return!0;if("object"!==typeof t||!t||"object"!==typeof e||!e)return!1;var i=Object.keys(t),s=Object.keys(e);if(i.length!==s.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(e),c=0;c<i.length;c++){var u=i[c];if(!a(u))return!1;var l=t[u],f=e[u];if(!1===(o=n?n.call(r,l,f,u):void 0)||void 0===o&&l!==f)return!1}return!0}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return y})),n.d(e,"c",(function(){return w}));var r=n(1),o=n.n(r),i=(n(130),o.a.createContext(null));var s=function(t){t()},a={notify:function(){}};function c(){var t=s,e=null,n=null;return{clear:function(){e=null,n=null},notify:function(){t((function(){for(var t=e;t;)t.callback(),t=t.next}))},get:function(){for(var t=[],n=e;n;)t.push(n),n=n.next;return t},subscribe:function(t){var r=!0,o=n={callback:t,next:null,prev:n};return o.prev?o.prev.next=o:e=o,function(){r&&null!==e&&(r=!1,o.next?o.next.prev=o.prev:n=o.prev,o.prev?o.prev.next=o.next:e=o.next)}}}}var u=function(){function t(t,e){this.store=t,this.parentSub=e,this.unsubscribe=null,this.listeners=a,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var e=t.prototype;return e.addNestedSub=function(t){return this.trySubscribe(),this.listeners.subscribe(t)},e.notifyNestedSubs=function(){this.listeners.notify()},e.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},e.isSubscribed=function(){return Boolean(this.unsubscribe)},e.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=c())},e.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=a)},t}();var l=function(t){var e=t.store,n=t.context,s=t.children,a=Object(r.useMemo)((function(){var t=new u(e);return t.onStateChange=t.notifyNestedSubs,{store:e,subscription:t}}),[e]),c=Object(r.useMemo)((function(){return e.getState()}),[e]);Object(r.useEffect)((function(){var t=a.subscription;return t.trySubscribe(),c!==e.getState()&&t.notifyNestedSubs(),function(){t.tryUnsubscribe(),t.onStateChange=null}}),[a,c]);var l=n||i;return o.a.createElement(l.Provider,{value:a},s)};n(78),n(71);var f="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement?r.useLayoutEffect:r.useEffect;n(51);function h(){return Object(r.useContext)(i)}function p(t){void 0===t&&(t=i);var e=t===i?h:function(){return Object(r.useContext)(t)};return function(){return e().store}}var d=p();function v(t){void 0===t&&(t=i);var e=t===i?d:p(t);return function(){return e().dispatch}}var y=v(),m=function(t,e){return t===e};function g(t){void 0===t&&(t=i);var e=t===i?h:function(){return Object(r.useContext)(t)};return function(t,n){void 0===n&&(n=m);var o=e(),i=function(t,e,n,o){var i,s=Object(r.useReducer)((function(t){return t+1}),0)[1],a=Object(r.useMemo)((function(){return new u(n,o)}),[n,o]),c=Object(r.useRef)(),l=Object(r.useRef)(),h=Object(r.useRef)(),p=Object(r.useRef)(),d=n.getState();try{i=t!==l.current||d!==h.current||c.current?t(d):p.current}catch(v){throw c.current&&(v.message+="\nThe error may be correlated with this previous error:\n"+c.current.stack+"\n\n"),v}return f((function(){l.current=t,h.current=d,p.current=i,c.current=void 0})),f((function(){function t(){try{var t=l.current(n.getState());if(e(t,p.current))return;p.current=t}catch(v){c.current=v}s()}return a.onStateChange=t,a.trySubscribe(),t(),function(){return a.tryUnsubscribe()}}),[n,a]),i}(t,n,o.store,o.subscription);return Object(r.useDebugValue)(i),i}}var b,w=g(),k=n(61);b=k.unstable_batchedUpdates,s=b},function(t,e,n){"use strict";n.d(e,"a",(function(){return ie})),n.d(e,"b",(function(){return oe}));for(var r={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},o={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},i="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),s="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),a="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),c="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),u="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),l=i&&(c||+i[1]<57)||a&&c,f=0;f<10;f++)r[48+f]=r[96+f]=String(f);for(f=1;f<=24;f++)r[f+111]="F"+f;for(f=65;f<=90;f++)r[f]=String.fromCharCode(f+32),o[f]=String.fromCharCode(f);for(var h in r)o.hasOwnProperty(h)||(o[h]=r[h]);var p=n(12);function d(t,e,n){for(var r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;var o=t.child(r),i=e.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(var s=0;o.text[s]==i.text[s];s++)n++;return n}if(o.content.size||i.content.size){var a=d(o.content,i.content,n+1);if(null!=a)return a}n+=o.nodeSize}else n+=o.nodeSize}}function v(t,e,n,r){for(var o=t.childCount,i=e.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};var s=t.child(--o),a=e.child(--i),c=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){for(var u=0,l=Math.min(s.text.length,a.text.length);u<l&&s.text[s.text.length-u-1]==a.text[a.text.length-u-1];)u++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){var f=v(s.content,a.content,n-1,r-1);if(f)return f}n-=c,r-=c}else n-=c,r-=c}}var y=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},m={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};y.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var u=s+1;a.nodesBetween(Math.max(0,t-u),Math.min(a.content.size,e-u),n,r+u)}s=c}},y.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},y.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},y.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new y(r,this.size+t.size)},y.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var o=0,i=0;i<e;o++){var s=this.content[o],a=i+s.nodeSize;a>t&&((i<t||a>e)&&(s=s.isText?s.cut(Math.max(0,t-i),Math.min(s.text.length,e-i)):s.cut(Math.max(0,t-i-1),Math.min(s.content.size,e-i-1))),n.push(s),r+=s.nodeSize),i=a}return new y(n,r)},y.prototype.cutByIndex=function(t,e){return t==e?y.empty:0==t&&e==this.content.length?this:new y(this.content.slice(t,e))},y.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new y(r,o)},y.prototype.addToStart=function(t){return new y([t].concat(this.content),this.size+t.nodeSize)},y.prototype.addToEnd=function(t){return new y(this.content.concat(t),this.size+t.nodeSize)},y.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},m.firstChild.get=function(){return this.content.length?this.content[0]:null},m.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},m.childCount.get=function(){return this.content.length},y.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},y.prototype.maybeChild=function(t){return this.content[t]},y.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},y.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),d(this,t,e)},y.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),v(this,t,e,n)},y.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return b(0,t);if(t==this.size)return b(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?b(n+1,o):b(n,r);r=o}},y.prototype.toString=function(){return"<"+this.toStringInner()+">"},y.prototype.toStringInner=function(){return this.content.join(", ")},y.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},y.fromJSON=function(t,e){if(!e)return y.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new y(e.map(t.nodeFromJSON))},y.fromArray=function(t){if(!t.length)return y.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new y(e||t,n)},y.from=function(t){if(!t)return y.empty;if(t instanceof y)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new y([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(y.prototype,m);var g={index:0,offset:0};function b(t,e){return g.index=t,g.offset=e,g}function w(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!w(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e)||!w(t[o],e[o]))return!1;for(var i in e)if(!(i in t))return!1}return!0}y.empty=new y([],0);var k=function(t,e){this.type=t,this.attrs=e};function x(t){var e=Error.call(this,t);return e.__proto__=x.prototype,e}k.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},k.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},k.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},k.prototype.eq=function(t){return this==t||this.type==t.type&&w(this.attrs,t.attrs)},k.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},k.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},k.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},k.setFrom=function(t){if(!t||0==t.length)return k.none;if(t instanceof k)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},k.none=[],x.prototype=Object.create(Error.prototype),x.prototype.constructor=x,x.prototype.name="ReplaceError";var S=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},O={size:{configurable:!0}};function C(t,e,n){var r=t.findIndex(e),o=r.index,i=r.offset,s=t.maybeChild(o),a=t.findIndex(n),c=a.index,u=a.offset;if(i==e||s.isText){if(u!=n&&!t.child(c).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return t.replaceChild(o,s.copy(C(s.content,e-i-1,n-i-1)))}function E(t,e,n,r){var o=t.findIndex(e),i=o.index,s=o.offset,a=t.maybeChild(i);if(s==e||a.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));var c=E(a.content,e-s-1,n);return c&&t.replaceChild(i,a.copy(c))}function _(t,e,n){if(n.openStart>t.depth)throw new x("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new x("Inconsistent open depths");return M(t,e,n,0)}function M(t,e,n,r){var o=t.index(r),i=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){var s=M(t,e,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){var a=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(y.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(n,t);return j(i,D(t,a.start,a.end,e,r))}var c=t.parent,u=c.content;return j(c,u.cut(0,t.parentOffset).append(n.content).append(u.cut(e.parentOffset)))}return j(i,R(t,e,r))}function T(t,e){if(!e.type.compatibleContent(t.type))throw new x("Cannot join "+e.type.name+" onto "+t.type.name)}function N(t,e,n){var r=t.node(n);return T(r,e.node(n)),r}function A(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function I(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(A(t.nodeAfter,r),i++));for(var a=i;a<s;a++)A(o.child(a),r);e&&e.depth==n&&e.textOffset&&A(e.nodeBefore,r)}function j(t,e){if(!t.type.validContent(e))throw new x("Invalid content for node "+t.type.name);return t.copy(e)}function D(t,e,n,r,o){var i=t.depth>o&&N(t,e,o+1),s=r.depth>o&&N(n,r,o+1),a=[];return I(null,t,o,a),i&&s&&e.index(o)==n.index(o)?(T(i,s),A(j(i,D(t,e,n,r,o+1)),a)):(i&&A(j(i,R(t,e,o+1)),a),I(e,n,o,a),s&&A(j(s,R(n,r,o+1)),a)),I(r,null,o,a),new y(a)}function R(t,e,n){var r=[];(I(null,t,n,r),t.depth>n)&&A(j(N(t,e,n+1),R(t,e,n+1)),r);return I(e,null,n,r),new y(r)}O.size.get=function(){return this.content.size-this.openStart-this.openEnd},S.prototype.insertAt=function(t,e){var n=E(this.content,t+this.openStart,e,null);return n&&new S(n,this.openStart,this.openEnd)},S.prototype.removeBetween=function(t,e){return new S(C(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},S.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},S.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},S.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},S.fromJSON=function(t,e){if(!e)return S.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new S(y.fromJSON(t,e.content),n,r)},S.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new S(t,n,r)},Object.defineProperties(S.prototype,O),S.empty=new S(y.empty,0,0);var P=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},z={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};P.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},z.parent.get=function(){return this.node(this.depth)},z.doc.get=function(){return this.node(0)},P.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},P.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},P.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},P.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},P.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},P.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},P.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},z.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},z.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},z.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},P.prototype.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,o=0;o<t;o++)r+=n.child(o).nodeSize;return r},P.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return k.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},P.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},P.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},P.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new $(this,t,n)},P.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},P.prototype.max=function(t){return t.pos>this.pos?t:this},P.prototype.min=function(t){return t.pos<this.pos?t:this},P.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},P.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,u=o-c;if(n.push(i,a,r+c),!u)break;if((i=i.child(a)).isText)break;o=u-1,r+=c+1}return new P(e,n,o)},P.resolveCached=function(t,e){for(var n=0;n<F.length;n++){var r=F[n];if(r.pos==e&&r.doc==t)return r}var o=F[B]=P.resolve(t,e);return B=(B+1)%L,o},Object.defineProperties(P.prototype,z);var F=[],B=0,L=12,$=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},q={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};q.start.get=function(){return this.$from.before(this.depth+1)},q.end.get=function(){return this.$to.after(this.depth+1)},q.parent.get=function(){return this.$from.node(this.depth)},q.startIndex.get=function(){return this.$from.index(this.depth)},q.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties($.prototype,q);var J=Object.create(null),U=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||y.empty,this.marks=r||k.none},V={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};V.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},V.childCount.get=function(){return this.content.childCount},U.prototype.child=function(t){return this.content.child(t)},U.prototype.maybeChild=function(t){return this.content.maybeChild(t)},U.prototype.forEach=function(t){this.content.forEach(t)},U.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},U.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},V.textContent.get=function(){return this.textBetween(0,this.content.size,"")},U.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},V.firstChild.get=function(){return this.content.firstChild},V.lastChild.get=function(){return this.content.lastChild},U.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},U.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},U.prototype.hasMarkup=function(t,e,n){return this.type==t&&w(this.attrs,e||t.defaultAttrs||J)&&k.sameSet(this.marks,n||k.none)},U.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},U.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},U.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},U.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return S.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new S(a,r.depth-i,o.depth-i)},U.prototype.replace=function(t,e,n){return _(this.resolve(t),this.resolve(e),n)},U.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},U.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},U.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},U.prototype.resolve=function(t){return P.resolveCached(this,t)},U.prototype.resolveNoCache=function(t){return P.resolve(this,t)},U.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},V.isBlock.get=function(){return this.type.isBlock},V.isTextblock.get=function(){return this.type.isTextblock},V.inlineContent.get=function(){return this.type.inlineContent},V.isInline.get=function(){return this.type.isInline},V.isText.get=function(){return this.type.isText},V.isLeaf.get=function(){return this.type.isLeaf},V.isAtom.get=function(){return this.type.isAtom},U.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),H(this.marks,t)},U.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},U.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=y.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,e);if(!s||!s.validEnd)return!1;for(var a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0},U.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},U.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},U.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},U.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},U.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=y.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(U.prototype,V);var W=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):H(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(U);function H(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var K=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},Y={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};K.parse=function(t,e){var n=new G(t,e);if(null==n.next)return K.empty;var r=X(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return n(ot(t,0));function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];ot(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new K(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(rt);i.next.push(o[s],e[a.join(",")]||n(a))}return i}}(function(t){var e=[[]];return o(i(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}function i(t,e){if("choice"==t.type)return t.exprs.reduce((function(t,n){return t.concat(i(n,e))}),[]);if("seq"==t.type)for(var s=0;;s++){var a=i(t.exprs[s],e);if(s==t.exprs.length-1)return a;o(a,e=n())}else{if("star"==t.type){var c=n();return r(e,c),o(i(t.expr,c),c),[r(c)]}if("plus"==t.type){var u=n();return o(i(t.expr,e),u),o(i(t.expr,u),u),[r(u)]}if("opt"==t.type)return[r(e)].concat(i(t.expr,e));if("range"==t.type){for(var l=e,f=0;f<t.min;f++){var h=n();o(i(t.expr,l),h),l=h}if(-1==t.max)o(i(t.expr,l),l);else for(var p=t.min;p<t.max;p++){var d=n();r(l,d),o(i(t.expr,l),d),l=d}return[r(l)]}if("name"==t.type)return[r(e,null,t.value)]}}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],u=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(u)&&r.push(u)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},K.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},K.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},Y.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},Y.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},K.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},K.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,s){var a=i.matchFragment(t,n);if(a&&(!e||a.validEnd))return y.from(s.map((function(t){return t.createAndFill()})));for(var c=0;c<i.next.length;c+=2){var u=i.next[c],l=i.next[c+1];if(!u.isText&&!u.hasRequiredAttrs()&&-1==r.indexOf(l)){r.push(l);var f=o(l,s.concat(u));if(f)return f}}}(this,[])},K.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},K.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},Y.edgeCount.get=function(){return this.next.length>>1},K.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},K.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(K.prototype,Y),K.empty=new K(!0);var G=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},Q={next:{configurable:!0}};function X(t){var e=[];do{e.push(Z(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function Z(t){var e=[];do{e.push(tt(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function tt(t){for(var e=function(t){if(t.eat("(")){var e=X(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=nt(t,e)}return e}function et(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function nt(t,e){var n=et(t),r=n;return t.eat(",")&&(r="}"!=t.next?et(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function rt(t,e){return e-t}function ot(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(rt)}function it(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function st(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function at(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new lt(t[n]);return e}Q.next.get=function(){return this.tokens[this.pos]},G.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},G.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(G.prototype,Q);var ct=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=at(n.attrs),this.defaultAttrs=it(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},ut={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};ut.isInline.get=function(){return!this.isBlock},ut.isTextblock.get=function(){return this.isBlock&&this.inlineContent},ut.isLeaf.get=function(){return this.contentMatch==K.empty},ut.isAtom.get=function(){return this.isLeaf||this.spec.atom},ct.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},ct.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},ct.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:st(this.attrs,t)},ct.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new U(this,this.computeAttrs(t),y.from(e),k.setFrom(n))},ct.prototype.createChecked=function(t,e,n){if(e=y.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new U(this,this.computeAttrs(t),e,k.setFrom(n))},ct.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=y.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e).fillBefore(y.empty,!0);return o?new U(this,t,e.append(o),k.setFrom(n)):null},ct.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},ct.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},ct.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},ct.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:k.empty:t},ct.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new ct(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(ct.prototype,ut);var lt=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},ft={isRequired:{configurable:!0}};ft.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(lt.prototype,ft);var ht=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=at(r.attrs),this.rank=e,this.excluded=null;var o=it(this.attrs);this.instance=o&&new k(this,o)};ht.prototype.create=function(t){return!t&&this.instance?this.instance:new k(this,st(this.attrs,t))},ht.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new ht(t,r++,e,o)})),n},ht.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},ht.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},ht.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var pt=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=p.a.from(t.nodes),this.spec.marks=p.a.from(t.marks),this.nodes=ct.compile(this.spec.nodes,this),this.marks=ht.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],i=o.spec.content||"",s=o.spec.marks;o.contentMatch=n[i]||(n[i]=K.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==s?null:s?dt(this,s.split(" ")):""!=s&&o.inlineContent?null:[]}for(var a in this.marks){var c=this.marks[a],u=c.spec.excludes;c.excluded=null==u?[c]:""==u?[]:dt(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function dt(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}pt.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof ct))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},pt.prototype.text=function(t,e){var n=this.nodes.text;return new W(n,n.defaultAttrs,t,k.setFrom(e))},pt.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},pt.prototype.nodeFromJSON=function(t){return U.fromJSON(this,t)},pt.prototype.markFromJSON=function(t){return k.fromJSON(this,t)},pt.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var vt=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)})),this.normalizeLists=!this.tags.some((function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)}))};vt.prototype.parse=function(t,e){void 0===e&&(e={});var n=new kt(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},vt.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new kt(this,e,!0);return n.addAll(t,null,e.from,e.to),S.maxOpen(n.finish())},vt.prototype.matchTag=function(t,e,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(St(t,o.tag)&&(void 0===o.namespace||t.namespaceURI==o.namespace)&&(!o.context||e.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(t);if(!1===i)continue;o.attrs=i}return o}}},vt.prototype.matchStyle=function(t,e,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(t)||i.context&&!n.matchesContext(i.context)||i.style.length>t.length&&(61!=i.style.charCodeAt(t.length)||i.style.slice(t.length+1)!=e))){if(i.getAttrs){var s=i.getAttrs(e);if(!1===s)continue;i.attrs=s}return i}}},vt.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=Ot(t)),t.mark=e}))};for(var o in t.marks)r(o);var i=function(e){var r=t.nodes[s].spec.parseDOM;r&&r.forEach((function(t){n(t=Ot(t)),t.node=s}))};for(var s in t.nodes)i();return e},vt.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new vt(t,vt.schemaRules(t)))};var yt={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},mt={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},gt={ol:!0,ul:!0};function bt(t){return(t?1:0)|("full"===t?2:0)}var wt=function(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=k.none,this.pendingMarks=r,this.stashMarks=[]};wt.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(y.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},wt.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=y.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(y.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},wt.prototype.popFromStashMark=function(t){for(var e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]},wt.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):Ct(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}};var kt=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,i=bt(e.preserveWhitespace)|(n?4:0);r=o?new wt(o.type,o.attrs,k.none,k.none,!0,e.topMatch||o.type.contentMatch,i):new wt(n?null:t.schema.topNodeType,null,k.none,k.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},xt={top:{configurable:!0},currentPos:{configurable:!0}};function St(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Ot(t){var e={};for(var n in t)e[n]=t[n];return e}function Ct(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var i=[];return function t(n){i.push(n);for(var r=0;r<n.edgeCount;r++){var o=n.edge(r),s=o.type,a=o.next;if(s==e)return!0;if(i.indexOf(a)<0&&t(a))return!0}}(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}xt.top.get=function(){return this.nodes[this.open]},kt.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},kt.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},kt.prototype.addElement=function(t,e){var n,r=t.nodeName.toLowerCase();gt.hasOwnProperty(r)&&this.parser.normalizeLists&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&gt.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var o=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(n=this.parser.matchTag(t,this,e));if(o?o.ignore:mt.hasOwnProperty(r))this.findInside(t);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(t=o.skip);var i,s=this.top,a=this.needsBlock;if(yt.hasOwnProperty(r))i=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),i&&this.sync(s),this.needsBlock=a}else this.addElementByRule(t,o,!1===o.consuming?n:null)},kt.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},kt.prototype.readStyles=function(t){var e=k.none;t:for(var n=0;n<t.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(t[n],t[n+1],this,r);if(!o)continue t;if(o.ignore)return null;if(e=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(e),!1!==o.consuming)break;r=o}return e},kt.prototype.addElementByRule=function(t,e,n){var r,o,i,s=this;e.node?(o=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(o.create(e.attrs))||this.leafFallback(t):r=this.enter(o,e.attrs,e.preserveWhitespace):(i=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(i));var a=this.top;if(o&&o.isLeaf)this.findInside(t);else if(n)this.addElement(t,n);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return s.insertNode(t)}));else{var c=e.contentElement;"string"==typeof c?c=t.querySelector(c):"function"==typeof c&&(c=c(t)),c||(c=t),this.findAround(t,c,!0),this.addAll(c,r)}r&&(this.sync(a),this.open--),i&&this.removePendingMark(i,a)},kt.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&yt.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},kt.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},kt.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},kt.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},kt.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:bt(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new wt(t,e,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},kt.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},kt.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},kt.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},xt.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},kt.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},kt.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},kt.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},kt.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},kt.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1);return function t(s,a){for(;s>=0;s--){var c=n[s];if(""==c){if(s==n.length-1||0==s)continue;for(;a>=i;a--)if(t(s-1,a))return!0;return!1}var u=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!u||u.name!=c&&-1==u.groups.indexOf(c))return!1;a--}return!0}(n.length-1,this.open)},kt.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},kt.prototype.addPendingMark=function(t){var e=function(t,e){for(var n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},kt.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(t)>-1)r.pendingMarks=t.removeFromSet(r.pendingMarks);else{r.activeMarks=t.removeFromSet(r.activeMarks);var o=r.popFromStashMark(t);o&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==e)break}},Object.defineProperties(kt.prototype,xt);var Et=function(t,e){this.nodes=t||{},this.marks=e||{}};function _t(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Mt(t){return t.document||window.document}Et.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=Mt(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],u=r.serializeMark(c,t.isInline,e);u&&(i.push(c,o),o.appendChild(u.dom),o=u.contentDOM||u.dom)}}o.appendChild(r.serializeNode(t,e))})),n},Et.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=Et.renderSpec(Mt(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},Et.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},Et.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&Et.renderSpec(Mt(n),r(t,e))},Et.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var u in c=2,a)if(null!=a[u]){var l=u.indexOf(" ");l>0?s.setAttributeNS(u.slice(0,l),u.slice(l+1),a[u]):s.setAttribute(u,a[u])}for(var f=c;f<e.length;f++){var h=e[f];if(0===h){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var p=Et.renderSpec(t,h,n),d=p.dom,v=p.contentDOM;if(s.appendChild(d),v){if(i)throw new RangeError("Multiple content holes");i=v}}return{dom:s,contentDOM:i}},Et.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new Et(this.nodesFromSchema(t),this.marksFromSchema(t)))},Et.nodesFromSchema=function(t){var e=_t(t.nodes);return e.text||(e.text=function(t){return t.text}),e},Et.marksFromSchema=function(t){return _t(t.marks)};var Tt=n(4),Nt=Object.create(null),At=function(t,e,n){this.ranges=n||[new jt(t.min(e),t.max(e))],this.$anchor=t,this.$head=e},It={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};It.anchor.get=function(){return this.$anchor.pos},It.head.get=function(){return this.$head.pos},It.from.get=function(){return this.$from.pos},It.to.get=function(){return this.$to.pos},It.$from.get=function(){return this.ranges[0].$from},It.$to.get=function(){return this.ranges[0].$to},It.empty.get=function(){for(var t=this.ranges,e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0},At.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},At.prototype.replace=function(t,e){void 0===e&&(e=S.empty);for(var n=e.content.lastChild,r=null,o=0;o<e.openEnd;o++)r=n,n=n.lastChild;for(var i=t.steps.length,s=this.ranges,a=0;a<s.length;a++){var c=s[a],u=c.$from,l=c.$to,f=t.mapping.slice(i);t.replaceRange(f.map(u.pos),f.map(l.pos),a?S.empty:e),0==a&&$t(t,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}},At.prototype.replaceWith=function(t,e){for(var n=t.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],s=i.$from,a=i.$to,c=t.mapping.slice(n),u=c.map(s.pos),l=c.map(a.pos);o?t.deleteRange(u,l):(t.replaceRangeWith(u,l,e),$t(t,n,e.isInline?-1:1))}},At.findFrom=function(t,e,n){var r=t.parent.inlineContent?new Dt(t):Lt(t.node(0),t.parent,t.pos,t.index(),e,n);if(r)return r;for(var o=t.depth-1;o>=0;o--){var i=e<0?Lt(t.node(0),t.node(o),t.before(o+1),t.index(o),e,n):Lt(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,e,n);if(i)return i}},At.near=function(t,e){return void 0===e&&(e=1),this.findFrom(t,e)||this.findFrom(t,-e)||new Ft(t.node(0))},At.atStart=function(t){return Lt(t,t,0,0,1)||new Ft(t)},At.atEnd=function(t){return Lt(t,t,t.content.size,t.childCount,-1)||new Ft(t)},At.fromJSON=function(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=Nt[e.type];if(!n)throw new RangeError("No selection type "+e.type+" defined");return n.fromJSON(t,e)},At.jsonID=function(t,e){if(t in Nt)throw new RangeError("Duplicate use of selection JSON ID "+t);return Nt[t]=e,e.prototype.jsonID=t,e},At.prototype.getBookmark=function(){return Dt.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(At.prototype,It),At.prototype.visible=!0;var jt=function(t,e){this.$from=t,this.$to=e},Dt=function(t){function e(e,n){void 0===n&&(n=e),t.call(this,e,n)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},e.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));if(!o.parent.inlineContent)return t.near(o);var i=n.resolve(r.map(this.anchor));return new e(i.parent.inlineContent?i:o,o)},e.prototype.replace=function(e,n){if(void 0===n&&(n=S.empty),t.prototype.replace.call(this,e,n),n==S.empty){var r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head},e.prototype.getBookmark=function(){return new Rt(this.anchor,this.head)},e.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(n.anchor),t.resolve(n.head))},e.create=function(t,e,n){void 0===n&&(n=e);var r=t.resolve(e);return new this(r,n==e?r:t.resolve(n))},e.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=i>=0?1:-1),!r.parent.inlineContent){var s=t.findFrom(r,o,!0)||t.findFrom(r,-o,!0);if(!s)return t.near(r,o);r=s.$head}return n.parent.inlineContent||(0==i||(n=(t.findFrom(n,-o,!0)||t.findFrom(n,o,!0)).$anchor).pos<r.pos!=i<0)&&(n=r),new e(n,r)},Object.defineProperties(e.prototype,n),e}(At);At.jsonID("text",Dt);var Rt=function(t,e){this.anchor=t,this.head=e};Rt.prototype.map=function(t){return new Rt(t.map(this.anchor),t.map(this.head))},Rt.prototype.resolve=function(t){return Dt.between(t.resolve(this.anchor),t.resolve(this.head))};var Pt=function(t){function e(e){var n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);t.call(this,e,r),this.node=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(n,r){var o=r.mapResult(this.anchor),i=o.deleted,s=o.pos,a=n.resolve(s);return i?t.near(a):new e(a)},e.prototype.content=function(){return new S(y.from(this.node),0,0)},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor},e.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},e.prototype.getBookmark=function(){return new zt(this.anchor)},e.fromJSON=function(t,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(n.anchor))},e.create=function(t,e){return new this(t.resolve(e))},e.isSelectable=function(t){return!t.isText&&!1!==t.type.spec.selectable},e}(At);Pt.prototype.visible=!1,At.jsonID("node",Pt);var zt=function(t){this.anchor=t};zt.prototype.map=function(t){var e=t.mapResult(this.anchor),n=e.deleted,r=e.pos;return n?new Rt(r,r):new zt(r)},zt.prototype.resolve=function(t){var e=t.resolve(this.anchor),n=e.nodeAfter;return n&&Pt.isSelectable(n)?new Pt(e):At.near(e)};var Ft=function(t){function e(e){t.call(this,e.resolve(0),e.resolve(e.content.size))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.replace=function(e,n){if(void 0===n&&(n=S.empty),n==S.empty){e.delete(0,e.doc.content.size);var r=t.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else t.prototype.replace.call(this,e,n)},e.prototype.toJSON=function(){return{type:"all"}},e.fromJSON=function(t){return new e(t)},e.prototype.map=function(t){return new e(t)},e.prototype.eq=function(t){return t instanceof e},e.prototype.getBookmark=function(){return Bt},e}(At);At.jsonID("all",Ft);var Bt={map:function(){return this},resolve:function(t){return new Ft(t)}};function Lt(t,e,n,r,o,i){if(e.inlineContent)return Dt.create(t,n);for(var s=r-(o>0?0:1);o>0?s<e.childCount:s>=0;s+=o){var a=e.child(s);if(a.isAtom){if(!i&&Pt.isSelectable(a))return Pt.create(t,n-(o<0?a.nodeSize:0))}else{var c=Lt(t,a,n+o,o<0?a.childCount:0,o,i);if(c)return c}n+=a.nodeSize*o}}function $t(t,e,n){var r=t.steps.length-1;if(!(r<e)){var o,i=t.steps[r];if(i instanceof Tt.c||i instanceof Tt.b)t.mapping.maps[r].forEach((function(t,e,n,r){null==o&&(o=r)})),t.setSelection(At.near(t.doc.resolve(o),n))}}var qt=function(t){function e(e){t.call(this,e.doc),this.time=Date.now(),this.curSelection=e.selection,this.curSelectionFor=0,this.storedMarks=e.storedMarks,this.updated=0,this.meta=Object.create(null)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},e.prototype.setSelection=function(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return(1&this.updated)>0},e.prototype.setStoredMarks=function(t){return this.storedMarks=t,this.updated|=2,this},e.prototype.ensureMarks=function(t){return k.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this},e.prototype.addStoredMark=function(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))},e.prototype.removeStoredMark=function(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(2&this.updated)>0},e.prototype.addStep=function(e,n){t.prototype.addStep.call(this,e,n),this.updated=-3&this.updated,this.storedMarks=null},e.prototype.setTime=function(t){return this.time=t,this},e.prototype.replaceSelection=function(t){return this.selection.replace(this,t),this},e.prototype.replaceSelectionWith=function(t,e){var n=this.selection;return!1!==e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||k.none))),n.replaceWith(this,t),this},e.prototype.deleteSelection=function(){return this.selection.replace(this),this},e.prototype.insertText=function(t,e,n){void 0===n&&(n=e);var r=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();if(!t)return this.deleteRange(e,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(e);o=n==e?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(e,n,r.text(t,o)),this.selection.empty||this.setSelection(At.near(this.selection.$to)),this},e.prototype.setMeta=function(t,e){return this.meta["string"==typeof t?t:t.key]=e,this},e.prototype.getMeta=function(t){return this.meta["string"==typeof t?t:t.key]},n.isGeneric.get=function(){for(var t in this.meta)return!1;return!0},e.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(e.prototype,n),e}(Tt.d);function Jt(t,e){return e&&t?t.bind(e):t}var Ut=function(t,e,n){this.name=t,this.init=Jt(e.init,n),this.apply=Jt(e.apply,n)},Vt=[new Ut("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new Ut("selection",{init:function(t,e){return t.selection||At.atStart(e.doc)},apply:function(t){return t.selection}}),new Ut("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Ut("scrollToSelection",{init:function(){return 0},apply:function(t,e){return t.scrolledIntoView?e+1:e}})],Wt=function(t,e){var n=this;this.schema=t,this.fields=Vt.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),e&&e.forEach((function(t){if(n.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");n.plugins.push(t),n.pluginsByKey[t.key]=t,t.spec.state&&n.fields.push(new Ut(t.key,t.spec.state,t))}))},Ht=function(t){this.config=t},Kt={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};Kt.schema.get=function(){return this.config.schema},Kt.plugins.get=function(){return this.config.plugins},Ht.prototype.apply=function(t){return this.applyTransaction(t).state},Ht.prototype.filterTransaction=function(t,e){void 0===e&&(e=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=e){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,t,this))return!1}return!0},Ht.prototype.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var e=[t],n=this.applyInner(t),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var s=this.config.plugins[i];if(s.spec.appendTransaction){var a=r?r[i].n:0,c=r?r[i].state:this,u=a<e.length&&s.spec.appendTransaction.call(s,a?e.slice(a):e,c,n);if(u&&n.filterTransaction(u,i)){if(u.setMeta("appendedTransaction",t),!r){r=[];for(var l=0;l<this.config.plugins.length;l++)r.push(l<i?{state:n,n:e.length}:{state:this,n:0})}e.push(u),n=n.applyInner(u),o=!0}r&&(r[i]={state:n,n:e.length})}}if(!o)return{state:n,transactions:e}}},Ht.prototype.applyInner=function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var e=new Ht(this.config),n=this.config.fields,r=0;r<n.length;r++){var o=n[r];e[o.name]=o.apply(t,this[o.name],this,e)}for(var i=0;i<Yt.length;i++)Yt[i](this,t,e);return e},Kt.tr.get=function(){return new qt(this)},Ht.create=function(t){for(var e=new Wt(t.schema||t.doc.type.schema,t.plugins),n=new Ht(e),r=0;r<e.fields.length;r++)n[e.fields[r].name]=e.fields[r].init(t,n);return n},Ht.prototype.reconfigure=function(t){for(var e=new Wt(t.schema||this.schema,t.plugins),n=e.fields,r=new Ht(e),o=0;o<n.length;o++){var i=n[o].name;r[i]=this.hasOwnProperty(i)?this[i]:n[o].init(t,r)}return r},Ht.prototype.toJSON=function(t){var e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map((function(t){return t.toJSON()}))),t&&"object"==typeof t)for(var n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=t[n],o=r.spec.state;o&&o.toJSON&&(e[n]=o.toJSON.call(r,this[r.key]))}return e},Ht.fromJSON=function(t,e,n){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var r=new Wt(t.schema,t.plugins),o=new Ht(r);return r.fields.forEach((function(r){if("doc"==r.name)o.doc=U.fromJSON(t.schema,e.doc);else if("selection"==r.name)o.selection=At.fromJSON(o.doc,e.selection);else if("storedMarks"==r.name)e.storedMarks&&(o.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(n)for(var i in n){var s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(e,i))return void(o[r.name]=a.fromJSON.call(s,t,e[i],o))}o[r.name]=r.init(t,o)}})),o},Ht.addApplyListener=function(t){Yt.push(t)},Ht.removeApplyListener=function(t){var e=Yt.indexOf(t);e>-1&&Yt.splice(e,1)},Object.defineProperties(Ht.prototype,Kt);var Yt=[];function Gt(t,e,n){for(var r in t){var o=t[r];o instanceof Function?o=o.bind(e):"handleDOMEvents"==r&&(o=Gt(o,e,{})),n[r]=o}return n}var Qt=function(t){this.props={},t.props&&Gt(t.props,this,this.props),this.spec=t,this.key=t.key?t.key.key:Zt("plugin")};Qt.prototype.getState=function(t){return t[this.key]};var Xt=Object.create(null);function Zt(t){return t in Xt?t+"$"+ ++Xt[t]:(Xt[t]=0,t+"$")}var te=function(t){void 0===t&&(t="key"),this.key=Zt(t)};te.prototype.get=function(t){return t.config.pluginsByKey[this.key]},te.prototype.getState=function(t){return t[this.key]};var ee="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);function ne(t){var e,n,r,o,i=t.split(/-(?!$)/),s=i[i.length-1];"Space"==s&&(s=" ");for(var a=0;a<i.length-1;a++){var c=i[a];if(/^(cmd|meta|m)$/i.test(c))o=!0;else if(/^a(lt)?$/i.test(c))e=!0;else if(/^(c|ctrl|control)$/i.test(c))n=!0;else if(/^s(hift)?$/i.test(c))r=!0;else{if(!/^mod$/i.test(c))throw new Error("Unrecognized modifier name: "+c);ee?o=!0:n=!0}}return e&&(s="Alt-"+s),n&&(s="Ctrl-"+s),o&&(s="Meta-"+s),r&&(s="Shift-"+s),s}function re(t,e,n){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),!1!==n&&e.shiftKey&&(t="Shift-"+t),t}function oe(t){return new Qt({props:{handleKeyDown:ie(t)}})}function ie(t){var e=function(t){var e=Object.create(null);for(var n in t)e[ne(n)]=t[n];return e}(t);return function(t,n){var i,a=function(t){var e=!(l&&(t.ctrlKey||t.altKey||t.metaKey)||(s||u)&&t.shiftKey&&t.key&&1==t.key.length)&&t.key||(t.shiftKey?o:r)[t.keyCode]||t.key||"Unidentified";return"Esc"==e&&(e="Escape"),"Del"==e&&(e="Delete"),"Left"==e&&(e="ArrowLeft"),"Up"==e&&(e="ArrowUp"),"Right"==e&&(e="ArrowRight"),"Down"==e&&(e="ArrowDown"),e}(n),c=1==a.length&&" "!=a,f=e[re(a,n,!c)];if(f&&f(t.state,t.dispatch,t))return!0;if(c&&(n.shiftKey||n.altKey||n.metaKey||a.charCodeAt(0)>127)&&(i=r[n.keyCode])&&i!=a){var h=e[re(i,n,!0)];if(h&&h(t.state,t.dispatch,t))return!0}else if(c&&n.shiftKey){var p=e[re(a,n,!0)];if(p&&p(t.state,t.dispatch,t))return!0}return!1}}},function(t,e,n){"use strict";t.exports=function(t){return function(){var e=arguments.length;if(e){for(var n=[],r=-1;++r<e;)n[r]=arguments[r];return t.call(this,n)}return t.call(this,[])}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(58);function o(t,e){if(t){if("string"===typeof t)return Object(r.a)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(t,e):void 0}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(1),o=n(8),i=n(60);function s(){var t=Object(r.useContext)(i.a).dragDropManager;return Object(o.a)(null!=t,"Expected drag drop context"),t}},function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function r(t){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return null!==t&&"object"===r(t)&&Object.prototype.hasOwnProperty.call(t,"current")}n.d(e,"a",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return zt})),n.d(e,"b",(function(){return Ft}));var r=n(1),o=n(51),i="dnd-core/INIT_COORDS",s="dnd-core/BEGIN_DRAG",a="dnd-core/PUBLISH_DRAG_SOURCE",c="dnd-core/HOVER",u="dnd-core/DROP",l="dnd-core/END_DRAG",f=function(t,e){return t===e};function h(t,e){return!t&&!e||!(!t||!e)&&(t.x===e.x&&t.y===e.y)}function p(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f;if(t.length!==e.length)return!1;for(var r=0;r<t.length;++r)if(!n(t[r],e[r]))return!1;return!0}function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){y(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var m={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function g(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,e=arguments.length>1?arguments[1]:void 0,n=e.payload;switch(e.type){case i:case s:return{initialSourceClientOffset:n.sourceClientOffset,initialClientOffset:n.clientOffset,clientOffset:n.clientOffset};case c:return h(t.clientOffset,n.clientOffset)?t:v(v({},t),{},{clientOffset:n.clientOffset});case l:case u:return m;default:return t}}var b="dnd-core/ADD_SOURCE",w="dnd-core/ADD_TARGET",k="dnd-core/REMOVE_SOURCE",x="dnd-core/REMOVE_TARGET";function S(t){return(S="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function O(t,e,n){return e.split(".").reduce((function(t,e){return t&&t[e]?t[e]:n||null}),t)}function C(t,e){return t.filter((function(t){return t!==e}))}function E(t){return"object"===S(t)}function _(t,e){var n=new Map,r=function(t){n.set(t,n.has(t)?n.get(t)+1:1)};t.forEach(r),e.forEach(r);var o=[];return n.forEach((function(t,e){1===t&&o.push(e)})),o}function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(Object(n),!0).forEach((function(e){N(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function N(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var A={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function I(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,e=arguments.length>1?arguments[1]:void 0,n=e.payload;switch(e.type){case s:return T(T({},t),{},{itemType:n.itemType,item:n.item,sourceId:n.sourceId,isSourcePublic:n.isSourcePublic,dropResult:null,didDrop:!1});case a:return T(T({},t),{},{isSourcePublic:!0});case c:return T(T({},t),{},{targetIds:n.targetIds});case x:return-1===t.targetIds.indexOf(n.targetId)?t:T(T({},t),{},{targetIds:C(t.targetIds,n.targetId)});case u:return T(T({},t),{},{dropResult:n.dropResult,didDrop:!0,targetIds:[]});case l:return T(T({},t),{},{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return t}}function j(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case b:case w:return t+1;case k:case x:return t-1;default:return t}}var D=[],R=[];function P(t,e){return t!==D&&(t===R||"undefined"===typeof e||(n=t,e.filter((function(t){return n.indexOf(t)>-1}))).length>0);var n}function z(){var t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c:break;case b:case w:case x:case k:return D;case s:case a:case l:case u:default:return R}var e=t.payload,n=e.targetIds,r=void 0===n?[]:n,o=e.prevTargetIds,i=void 0===o?[]:o,f=_(r,i),h=f.length>0||!p(r,i);if(!h)return D;var d=i[i.length-1],v=r[r.length-1];return d!==v&&(d&&f.push(d),v&&f.push(v)),f}function F(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t+1}function B(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?B(Object(n),!0).forEach((function(e){$(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function $(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return{dirtyHandlerIds:z(t.dirtyHandlerIds,{type:e.type,payload:L(L({},e.payload),{},{prevTargetIds:O(t,"dragOperation.targetIds",[])})}),dragOffset:g(t.dragOffset,e),refCount:j(t.refCount,e),dragOperation:I(t.dragOperation,e),stateId:F(t.stateId)}}D.__IS_NONE__=!0,R.__IS_ALL__=!0;var J=n(8);function U(t,e){return{type:i,payload:{sourceClientOffset:e||null,clientOffset:t||null}}}var V={type:i,payload:{clientOffset:null,sourceClientOffset:null}};function W(t){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{publishSource:!0},r=n.publishSource,o=void 0===r||r,i=n.clientOffset,a=n.getSourceClientOffset,c=t.getMonitor(),u=t.getRegistry();t.dispatch(U(i)),H(e,c,u);var l=G(e,c);if(null!==l){var f=null;if(i){if(!a)throw new Error("getSourceClientOffset must be defined");K(a),f=a(l)}t.dispatch(U(i,f));var h=u.getSource(l),p=h.beginDrag(c,l);Y(p),u.pinSource(l);var d=u.getSourceType(l);return{type:s,payload:{itemType:d,item:p,sourceId:l,clientOffset:i||null,sourceClientOffset:f||null,isSourcePublic:!!o}}}t.dispatch(V)}}function H(t,e,n){Object(J.a)(!e.isDragging(),"Cannot call beginDrag while dragging."),t.forEach((function(t){Object(J.a)(n.getSource(t),"Expected sourceIds to be registered.")}))}function K(t){Object(J.a)("function"===typeof t,"When clientOffset is provided, getSourceClientOffset must be a function.")}function Y(t){Object(J.a)(E(t),"Item must be an object.")}function G(t,e){for(var n=null,r=t.length-1;r>=0;r--)if(e.canDragSource(t[r])){n=t[r];break}return n}function Q(t){return function(){if(t.getMonitor().isDragging())return{type:a}}}function X(t,e){return null===e?null===t:Array.isArray(t)?t.some((function(t){return t===e})):t===e}function Z(t){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.clientOffset;tt(e);var o=e.slice(0),i=t.getMonitor(),s=t.getRegistry();et(o,i,s);var a=i.getItemType();return nt(o,s,a),rt(o,i,s),{type:c,payload:{targetIds:o,clientOffset:r||null}}}}function tt(t){Object(J.a)(Array.isArray(t),"Expected targetIds to be an array.")}function et(t,e,n){Object(J.a)(e.isDragging(),"Cannot call hover while not dragging."),Object(J.a)(!e.didDrop(),"Cannot call hover after drop.");for(var r=0;r<t.length;r++){var o=t[r];Object(J.a)(t.lastIndexOf(o)===r,"Expected targetIds to be unique in the passed array.");var i=n.getTarget(o);Object(J.a)(i,"Expected targetIds to be registered.")}}function nt(t,e,n){for(var r=t.length-1;r>=0;r--){var o=t[r];X(e.getTargetType(o),n)||t.splice(r,1)}}function rt(t,e,n){t.forEach((function(t){n.getTarget(t).hover(e,t)}))}function ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function it(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ot(Object(n),!0).forEach((function(e){st(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function st(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function at(t){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.getMonitor(),r=t.getRegistry();ct(n);var o=lt(n);o.forEach((function(o,i){var s=ut(o,i,r,n),a={type:u,payload:{dropResult:it(it({},e),s)}};t.dispatch(a)}))}}function ct(t){Object(J.a)(t.isDragging(),"Cannot call drop while not dragging."),Object(J.a)(!t.didDrop(),"Cannot call drop twice during one drag operation.")}function ut(t,e,n,r){var o=n.getTarget(t),i=o?o.drop(r,t):void 0;return function(t){Object(J.a)("undefined"===typeof t||E(t),"Drop result must either be an object or undefined.")}(i),"undefined"===typeof i&&(i=0===e?{}:r.getDropResult()),i}function lt(t){var e=t.getTargetIds().filter(t.canDropOnTarget,t);return e.reverse(),e}function ft(t){return function(){var e=t.getMonitor(),n=t.getRegistry();!function(t){Object(J.a)(t.isDragging(),"Cannot call endDrag while not dragging.")}(e);var r=e.getSourceId();null!=r&&(n.getSource(r,!0).endDrag(e,r),n.unpinSource());return{type:l}}}function ht(t,e){return{x:t.x-e.x,y:t.y-e.y}}function pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var dt,vt=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.store=e,this.registry=n}var e,n,r;return e=t,(n=[{key:"subscribeToStateChange",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{handlerIds:void 0},r=n.handlerIds;Object(J.a)("function"===typeof t,"listener must be a function."),Object(J.a)("undefined"===typeof r||Array.isArray(r),"handlerIds, when specified, must be an array of strings.");var o=this.store.getState().stateId,i=function(){var n=e.store.getState(),i=n.stateId;try{i===o||i===o+1&&!P(n.dirtyHandlerIds,r)||t()}finally{o=i}};return this.store.subscribe(i)}},{key:"subscribeToOffsetChange",value:function(t){var e=this;Object(J.a)("function"===typeof t,"listener must be a function.");var n=this.store.getState().dragOffset;return this.store.subscribe((function(){var r=e.store.getState().dragOffset;r!==n&&(n=r,t())}))}},{key:"canDragSource",value:function(t){if(!t)return!1;var e=this.registry.getSource(t);return Object(J.a)(e,"Expected to find a valid source."),!this.isDragging()&&e.canDrag(this,t)}},{key:"canDropOnTarget",value:function(t){if(!t)return!1;var e=this.registry.getTarget(t);return Object(J.a)(e,"Expected to find a valid target."),!(!this.isDragging()||this.didDrop())&&X(this.registry.getTargetType(t),this.getItemType())&&e.canDrop(this,t)}},{key:"isDragging",value:function(){return Boolean(this.getItemType())}},{key:"isDraggingSource",value:function(t){if(!t)return!1;var e=this.registry.getSource(t,!0);return Object(J.a)(e,"Expected to find a valid source."),!(!this.isDragging()||!this.isSourcePublic())&&this.registry.getSourceType(t)===this.getItemType()&&e.isDragging(this,t)}},{key:"isOverTarget",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shallow:!1};if(!t)return!1;var n=e.shallow;if(!this.isDragging())return!1;var r=this.registry.getTargetType(t),o=this.getItemType();if(o&&!X(r,o))return!1;var i=this.getTargetIds();if(!i.length)return!1;var s=i.indexOf(t);return n?s===i.length-1:s>-1}},{key:"getItemType",value:function(){return this.store.getState().dragOperation.itemType}},{key:"getItem",value:function(){return this.store.getState().dragOperation.item}},{key:"getSourceId",value:function(){return this.store.getState().dragOperation.sourceId}},{key:"getTargetIds",value:function(){return this.store.getState().dragOperation.targetIds}},{key:"getDropResult",value:function(){return this.store.getState().dragOperation.dropResult}},{key:"didDrop",value:function(){return this.store.getState().dragOperation.didDrop}},{key:"isSourcePublic",value:function(){return Boolean(this.store.getState().dragOperation.isSourcePublic)}},{key:"getInitialClientOffset",value:function(){return this.store.getState().dragOffset.initialClientOffset}},{key:"getInitialSourceClientOffset",value:function(){return this.store.getState().dragOffset.initialSourceClientOffset}},{key:"getClientOffset",value:function(){return this.store.getState().dragOffset.clientOffset}},{key:"getSourceClientOffset",value:function(){return function(t){var e,n,r=t.clientOffset,o=t.initialClientOffset,i=t.initialSourceClientOffset;return r&&o&&i?ht((n=i,{x:(e=r).x+n.x,y:e.y+n.y}),o):null}(this.store.getState().dragOffset)}},{key:"getDifferenceFromInitialOffset",value:function(){return function(t){var e=t.clientOffset,n=t.initialClientOffset;return e&&n?ht(e,n):null}(this.store.getState().dragOffset)}}])&&pt(e.prototype,n),r&&pt(e,r),t}(),yt=0;function mt(t){return(mt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gt(t,e){e&&Array.isArray(t)?t.forEach((function(t){return gt(t,!1)})):Object(J.a)("string"===typeof t||"symbol"===mt(t),e?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}!function(t){t.SOURCE="SOURCE",t.TARGET="TARGET"}(dt||(dt={}));var bt=n(73),wt=[],kt=[],xt=bt.a.makeRequestCallFromTimer((function(){if(kt.length)throw kt.shift()}));function St(t){var e;(e=wt.length?wt.pop():new Ot).task=t,Object(bt.a)(e)}var Ot=function(){function t(){}return t.prototype.call=function(){try{this.task.call()}catch(t){St.onerror?St.onerror(t):(kt.push(t),xt())}finally{this.task=null,wt[wt.length]=this}},t}();function Ct(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Et(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return _t(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _t(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Mt(t){var e=(yt++).toString();switch(t){case dt.SOURCE:return"S".concat(e);case dt.TARGET:return"T".concat(e);default:throw new Error("Unknown Handler Role: ".concat(t))}}function Tt(t){switch(t[0]){case"S":return dt.SOURCE;case"T":return dt.TARGET;default:Object(J.a)(!1,"Cannot parse handler ID: ".concat(t))}}function Nt(t,e){var n=t.entries(),r=!1;do{var o=n.next(),i=o.done;if(Et(o.value,2)[1]===e)return!0;r=!!i}while(!r);return!1}var At=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=e}var e,n,r;return e=t,(n=[{key:"addSource",value:function(t,e){gt(t),function(t){Object(J.a)("function"===typeof t.canDrag,"Expected canDrag to be a function."),Object(J.a)("function"===typeof t.beginDrag,"Expected beginDrag to be a function."),Object(J.a)("function"===typeof t.endDrag,"Expected endDrag to be a function.")}(e);var n=this.addHandler(dt.SOURCE,t,e);return this.store.dispatch(function(t){return{type:b,payload:{sourceId:t}}}(n)),n}},{key:"addTarget",value:function(t,e){gt(t,!0),function(t){Object(J.a)("function"===typeof t.canDrop,"Expected canDrop to be a function."),Object(J.a)("function"===typeof t.hover,"Expected hover to be a function."),Object(J.a)("function"===typeof t.drop,"Expected beginDrag to be a function.")}(e);var n=this.addHandler(dt.TARGET,t,e);return this.store.dispatch(function(t){return{type:w,payload:{targetId:t}}}(n)),n}},{key:"containsHandler",value:function(t){return Nt(this.dragSources,t)||Nt(this.dropTargets,t)}},{key:"getSource",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(J.a)(this.isSourceId(t),"Expected a valid source ID.");var n=e&&t===this.pinnedSourceId,r=n?this.pinnedSource:this.dragSources.get(t);return r}},{key:"getTarget",value:function(t){return Object(J.a)(this.isTargetId(t),"Expected a valid target ID."),this.dropTargets.get(t)}},{key:"getSourceType",value:function(t){return Object(J.a)(this.isSourceId(t),"Expected a valid source ID."),this.types.get(t)}},{key:"getTargetType",value:function(t){return Object(J.a)(this.isTargetId(t),"Expected a valid target ID."),this.types.get(t)}},{key:"isSourceId",value:function(t){return Tt(t)===dt.SOURCE}},{key:"isTargetId",value:function(t){return Tt(t)===dt.TARGET}},{key:"removeSource",value:function(t){var e=this;Object(J.a)(this.getSource(t),"Expected an existing source."),this.store.dispatch(function(t){return{type:k,payload:{sourceId:t}}}(t)),St((function(){e.dragSources.delete(t),e.types.delete(t)}))}},{key:"removeTarget",value:function(t){Object(J.a)(this.getTarget(t),"Expected an existing target."),this.store.dispatch(function(t){return{type:x,payload:{targetId:t}}}(t)),this.dropTargets.delete(t),this.types.delete(t)}},{key:"pinSource",value:function(t){var e=this.getSource(t);Object(J.a)(e,"Expected an existing source."),this.pinnedSourceId=t,this.pinnedSource=e}},{key:"unpinSource",value:function(){Object(J.a)(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}},{key:"addHandler",value:function(t,e,n){var r=Mt(t);return this.types.set(r,e),t===dt.SOURCE?this.dragSources.set(r,n):t===dt.TARGET&&this.dropTargets.set(r,n),r}}])&&Ct(e.prototype,n),r&&Ct(e,r),t}();function It(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Dt(t){var e="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;return Object(o.c)(q,t&&e&&e({name:"dnd-core",instanceId:"dnd-core"}))}var Rt=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];It(this,t),this.isSetUp=!1,this.handleRefCountChange=function(){var t=e.store.getState().refCount>0;e.backend&&(t&&!e.isSetUp?(e.backend.setup(),e.isSetUp=!0):!t&&e.isSetUp&&(e.backend.teardown(),e.isSetUp=!1))};var r=Dt(n);this.store=r,this.monitor=new vt(r,new At(r)),r.subscribe(this.handleRefCountChange)}var e,n,r;return e=t,(n=[{key:"receiveBackend",value:function(t){this.backend=t}},{key:"getMonitor",value:function(){return this.monitor}},{key:"getBackend",value:function(){return this.backend}},{key:"getRegistry",value:function(){return this.monitor.registry}},{key:"getActions",value:function(){var t=this,e=this.store.dispatch,n=function(t){return{beginDrag:W(t),publishDragSource:Q(t),hover:Z(t),drop:at(t),endDrag:ft(t)}}(this);return Object.keys(n).reduce((function(r,o){var i,s=n[o];return r[o]=(i=s,function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];var s=i.apply(t,r);"undefined"!==typeof s&&e(s)}),r}),{})}},{key:"dispatch",value:function(t){this.store.dispatch(t)}}])&&jt(e.prototype,n),r&&jt(e,r),t}();function Pt(t,e,n,r){var o=new Rt(r),i=t(o,e,n);return o.receiveBackend(i),o}var zt=r.createContext({dragDropManager:void 0});function Ft(t,e,n,r){return{dragDropManager:Pt(t,e,n,r)}}},function(t,e,n){"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(96)},function(t,e,n){"use strict";function r(t,e,n){var r=n.getRegistry(),o=r.addTarget(t,e);return[o,function(){return r.removeTarget(o)}]}function o(t,e,n){var r=n.getRegistry(),o=r.addSource(t,e);return[o,function(){return r.removeSource(o)}]}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(3),o=n(5),i=new(function(){function t(){Object(r.a)(this,t),this.map=new Map}return Object(o.a)(t,[{key:"setItem",value:function(t,e){this.map.set(t,e)}},{key:"getItem",value:function(t){return this.map.get(t)}}]),t}());try{"undefined"!==typeof localStorage&&(i=localStorage)}catch(a){}var s=i},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){var t=!0;return function(e,n){if(t){t=!1;try{e()}finally{t=!0}}else void 0!==n&&n()}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(34),o=n(52),i=n(1);function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t,e,n){var a=c(function(t,e,n){var a=s(Object(i.useState)((function(){return e(t)})),2),c=a[0],u=a[1],l=Object(i.useCallback)((function(){var r=e(t);Object(o.a)(c,r)||(u(r),n&&n())}),[c,t,n]);return Object(r.a)(l,[]),[c,l]}(t,e,n),2),u=a[0],l=a[1];return Object(r.a)((function(){var e=t.getHandlerId();if(null!=e)return t.subscribeToStateChange(l,{handlerIds:[e]})}),[t,l]),u}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(1),o=n(8);function i(t,e){"function"===typeof t?t(e):t.current=e}function s(t,e){var n=t.ref;return Object(o.a)("string"!==typeof n,"Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://facebook.github.io/react/docs/more-about-refs.html#the-ref-callback-attribute"),n?Object(r.cloneElement)(t,{ref:function(t){i(n,t),i(e,t)}}):Object(r.cloneElement)(t,{ref:e})}function a(t){if("string"!==typeof t.type){var e=t.type.displayName||t.type.name||"the component";throw new Error("Only native element nodes can now be passed to React DnD connectors."+"You can either wrap ".concat(e," into a <div>, or turn it into a ")+"drag source or a drop target itself.")}}function c(t){var e={};return Object.keys(t).forEach((function(n){var o=t[n];if(n.endsWith("Ref"))e[n]=t[n];else{var i=function(t){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Object(r.isValidElement)(e)){var o=e;return t(o,n),o}var i=e;return a(i),s(i,n?function(e){return t(e,n)}:t)}}(o);e[n]=function(){return i}}})),e}},function(t,e,n){"use strict";n.d(e,"c",(function(){return S})),n.d(e,"a",(function(){return O})),n.d(e,"b",(function(){return B}));var r=n(3),o=n(5),i=n(64),s=n(33),a=n(32),c=n(9),u=n(46),l=n(44),f=n(35),h=function(t,e){for(var n=0,r=0;n<t.length&&n<e.length&&t[n]===e[n];)n++;if(n!==t.length||n!==e.length)for(;r+n<t.length&&r+n<e.length&&t[t.length-r-1]===e[e.length-r-1];)r++;return{index:n,remove:t.length-n-r,insert:e.slice(n,e.length-r)}},p=n(15),d=n(16),v=n(6),y=n(36),m=n(50),g=n(45),b=n(21),w=function(t,e){return void 0===e?!t.deleted:e.sv.has(t.id.client)&&e.sv.get(t.id.client)>t.id.clock&&!v.x(e.ds,t.id)},k=[{light:"#ecd44433",dark:"#ecd444"}],x=function(t,e,n){if(!t.has(n)){if(t.size<e.length){var r=l.a();t.forEach((function(t){return r.add(t)})),e=e.filter((function(t){return!r.has(t)}))}t.set(n,m.a(e))}return t.get(n)},S=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.colors,r=void 0===n?k:n,o=e.colorMapping,i=void 0===o?new Map:o,s=e.permanentUserData,c=void 0===s?null:s,u=!1,l=new a.b({props:{editable:function(t){var e=d.b.getState(t);return null==e.snapshot&&null==e.prevSnapshot}},key:d.b,state:{init:function(e,n){return{type:t,doc:t.doc,binding:null,snapshot:null,prevSnapshot:null,isChangeOrigin:!1,colors:r,colorMapping:i,permanentUserData:c}},apply:function(t,e){var n=t.getMeta(d.b);if(void 0!==n)for(var r in e=Object.assign({},e),n)e[r]=n[r];return e.isChangeOrigin=void 0!==n&&!!n.isChangeOrigin,null!==e.binding&&(void 0===n||null==n.snapshot&&null==n.prevSnapshot||setTimeout((function(){null==n.restore?e.binding._renderSnapshot(n.snapshot,n.prevSnapshot,e):(e.binding._renderSnapshot(n.snapshot,n.snapshot,e),delete e.restore,delete e.snapshot,delete e.prevSnapshot,e.binding._prosemirrorChanged(e.binding.prosemirrorView.state.doc))}),0)),e}},view:function(e){var n=new C(t,e);return setTimeout((function(){n._forceRerender(),e.dispatch(e.state.tr.setMeta(d.b,{binding:n}))}),0),{update:function(){var t=l.getState(e.state);null==t.snapshot&&null==t.prevSnapshot&&(!u&&f.b(e.state.doc.type.createAndFill().content.toJSON(),e.state.doc.content.toJSON())||(u=!0,n._prosemirrorChanged(e.state.doc)))},destroy:function(){n.destroy()}}}});return l},O=function(t,e){return{anchor:Object(y.a)(e.selection.anchor,t.type,t.mapping),head:Object(y.a)(e.selection.head,t.type,t.mapping)}},C=function(){function t(e,n){var o=this;Object(r.a)(this,t),this.type=e,this.prosemirrorView=n,this.mux=Object(i.a)(),this.mapping=new Map,this._observeFunction=this._typeChanged.bind(this),this.doc=e.doc,this.beforeTransactionSelection=null,this.doc.on("beforeAllTransactions",(function(){null===o.beforeTransactionSelection&&(o.beforeTransactionSelection=O(o,n.state))})),this.doc.on("afterAllTransactions",(function(t){o.beforeTransactionSelection=null})),e.observeDeep(this._observeFunction),this._domSelectionInView=null}return Object(o.a)(t,[{key:"_isLocalCursorInView",value:function(){var t=this;return!!this.prosemirrorView.hasFocus()&&(g.b&&null===this._domSelectionInView&&(setTimeout((function(){t._domSelectionInView=null}),0),this._domSelectionInView=this._isDomSelectionInView()),this._domSelectionInView)}},{key:"_isDomSelectionInView",value:function(){var t=this.prosemirrorView._root.getSelection(),e=this.prosemirrorView._root.createRange();e.setStart(t.anchorNode,t.anchorOffset),e.setEnd(t.focusNode,t.focusOffset),0===e.getClientRects().length&&e.startContainer&&e.collapsed&&e.selectNodeContents(e.startContainer);var n=e.getBoundingClientRect(),r=b.c.documentElement;return n.bottom>=0&&n.right>=0&&n.left<=(window.innerWidth||r.clientWidth||0)&&n.top<=(window.innerHeight||r.clientHeight||0)}},{key:"renderSnapshot",value:function(t,e){e||(e=v.t(v.p(),new Map)),this.prosemirrorView.dispatch(this.prosemirrorView.state.tr.setMeta(d.b,{snapshot:t,prevSnapshot:e}))}},{key:"unrenderSnapshot",value:function(){var t=this;this.mapping=new Map,this.mux((function(){var e=t.type.toArray().map((function(e){return _(e,t.prosemirrorView.state.schema,t.mapping)})).filter((function(t){return null!==t})),n=t.prosemirrorView.state.tr.replace(0,t.prosemirrorView.state.doc.content.size,new s.d(new s.a(e),0,0));n.setMeta(d.b,{snapshot:null,prevSnapshot:null}),t.prosemirrorView.dispatch(n)}))}},{key:"_forceRerender",value:function(){var t=this;this.mapping=new Map,this.mux((function(){var e=t.type.toArray().map((function(e){return _(e,t.prosemirrorView.state.schema,t.mapping)})).filter((function(t){return null!==t})),n=t.prosemirrorView.state.tr.replace(0,t.prosemirrorView.state.doc.content.size,new s.d(new s.a(e),0,0));t.prosemirrorView.dispatch(n)}))}},{key:"_renderSnapshot",value:function(t,e,n){var r=this;t||(t=v.A(this.doc)),this.mapping=new Map,this.mux((function(){r.doc.transact((function(o){var i=n.permanentUserData;i&&i.dss.forEach((function(t){v.z(o,t,(function(t){}))}));var a=function(t,e){var r="added"===t?i.getUserByClientId(e.client):i.getUserByDeletedId(e);return{user:r,type:t,color:x(n.colorMapping,n.colors,r)}},c=v.B(r.type,new v.g(e.ds,t.sv)).map((function(n){return!n._item.deleted||w(n._item,t)||w(n._item,e)?_(n,r.prosemirrorView.state.schema,new Map,t,e,a):null})).filter((function(t){return null!==t})),u=r.prosemirrorView.state.tr.replace(0,r.prosemirrorView.state.doc.content.size,new s.d(new s.a(c),0,0));r.prosemirrorView.dispatch(u)}),d.b)}))}},{key:"_typeChanged",value:function(t,e){var n=this,r=d.b.getState(this.prosemirrorView.state);0!==t.length&&null==r.snapshot&&null==r.prevSnapshot?this.mux((function(){var t=function(t,e){return n.mapping.delete(e)};v.z(e,e.deleteSet,(function(t){return t.constructor===v.e&&n.mapping.delete(t.content.type)})),e.changed.forEach(t),e.changedParentTypes.forEach(t);var r=n.type.toArray().map((function(t){return E(t,n.prosemirrorView.state.schema,n.mapping)})).filter((function(t){return null!==t})),o=n.prosemirrorView.state.tr.replace(0,n.prosemirrorView.state.doc.content.size,new s.d(new s.a(r),0,0));!function(t,e,n){if(null!==e&&null!==e.anchor&&null!==e.head){var r=Object(y.b)(n.doc,n.type,e.anchor,n.mapping),o=Object(y.b)(n.doc,n.type,e.head,n.mapping);null!==r&&null!==o&&(t=t.setSelection(a.e.create(t.doc,r,o)))}}(o,n.beforeTransactionSelection,n),o=o.setMeta(d.b,{isChangeOrigin:!0}),null!==n.beforeTransactionSelection&&n._isLocalCursorInView()&&o.scrollIntoView(),n.prosemirrorView.dispatch(o)})):this.renderSnapshot(r.snapshot,r.prevSnapshot)}},{key:"_prosemirrorChanged",value:function(t){var e=this;this.mux((function(){e.doc.transact((function(){B(e.doc,e.type,t,e.mapping),e.beforeTransactionSelection=O(e,e.prosemirrorView.state)}),d.b)}))}},{key:"destroy",value:function(){this.type.unobserveDeep(this._observeFunction)}}]),t}(),E=function(t,e,n,r,o,i){var s=n.get(t);if(void 0===s){if(t instanceof v.j)return _(t,e,n,r,o,i);throw p.b()}return s},_=function(t,e,n,r,o,i){var s=[],a=function(t){if(t.constructor===v.j){var a=E(t,e,n,r,o,i);null!==a&&s.push(a)}else{var c=M(t,e,n,r,o,i);null!==c&&c.forEach((function(t){null!==t&&s.push(t)}))}};void 0===r||void 0===o?t.toArray().forEach(a):v.B(t,new v.g(o.ds,r.sv)).forEach(a);try{var c=t.getAttributes(r);void 0!==r&&(w(t._item,r)?w(t._item,o)||(c.ychange=i?i("added",t._item.id):{type:"added"}):c.ychange=i?i("removed",t._item.id):{type:"removed"});var u=e.node(t.nodeName,c,s);return n.set(t,u),u}catch(l){return t.doc.transact((function(e){t._item.delete(e)}),d.b),n.delete(t),null}},M=function(t,e,n,r,o,i){var s=[],a=t.toDelta(r,o,i);try{for(var c=0;c<a.length;c++){var u=a[c],l=[];for(var f in u.attributes)l.push(e.mark(f,u.attributes[f]));s.push(e.text(u.insert,l))}}catch(h){return t.doc.transact((function(e){t._item.delete(e)}),d.b),null}return s},T=function(t,e){var n=new v.j(t.type.name);for(var r in t.attrs){var o=t.attrs[r];null!==o&&"ychange"!==r&&n.setAttribute(r,o)}return n.insert(0,I(t).map((function(t){return N(t,e)}))),e.set(n,t),n},N=function(t,e){return t instanceof Array?function(t,e){var n=new v.l,r=t.map((function(t){return{insert:t.text,attributes:F(t.marks)}}));return n.applyDelta(r),e.set(n,t),n}(t,e):T(t,e)},A=function t(e,n){for(var r=Object.keys(e).filter((function(t){return null!==e[t]})),o=r.length===Object.keys(n).filter((function(t){return null!==n[t]})).length,i=0;i<r.length&&o;i++){var s=r[i],a=e[s],c=n[s];o="ychange"===s||a===c||"object"===typeof a&&"object"===typeof c&&t(a,c)}return o},I=function(t){for(var e=t.content.content,n=[],r=0;r<e.length;r++){var o=e[r];if(o.isText){for(var i=[],s=e[r];r<e.length&&s.isText;s=e[++r])i.push(s);r--,n.push(i)}else n.push(o)}return n},j=function(t,e){var n=t.toDelta();return n.length===e.length&&n.every((function(t,n){return t.insert===e[n].text&&u.c(t.attributes||{}).length===e[n].marks.length&&e[n].marks.every((function(e){return A(t.attributes[e.type.name]||{},e.attrs)}))}))},D=function t(e,n){if(e instanceof v.j&&!(n instanceof Array)&&L(e,n)){var r=I(n);return e._length===r.length&&A(e.getAttributes(),n.attrs)&&e.toArray().every((function(e,n){return t(e,r[n])}))}return e instanceof v.l&&n instanceof Array&&j(e,n)},R=function(t,e){return t===e||t instanceof Array&&e instanceof Array&&t.length===e.length&&t.every((function(t,n){return e[n]===t}))},P=function(t,e,n){for(var r=t.toArray(),o=I(e),i=o.length,s=r.length,a=c.g(s,i),u=0,l=0,f=!1;u<a;u++){var h=r[u],p=o[u];if(R(n.get(h),p))f=!0;else if(!D(h,p))break}for(;u+l<a;l++){var d=r[s-l-1],v=o[i-l-1];if(R(n.get(d),v))f=!0;else if(!D(d,v))break}return{equalityFactor:u+l,foundMappedChild:f}},z=function(t,e,n){n.set(t,e);var r=function(t){for(var e="",n=t._start,r={};null!==n;)n.deleted||(n.countable&&n.content instanceof v.b?e+=n.content.str:n.content instanceof v.a&&(r[n.content.key]=null)),n=n.right;return{str:e,nAttrs:r}}(t),o=r.nAttrs,i=r.str,s=e.map((function(t){return{insert:t.text,attributes:Object.assign({},o,F(t.marks))}})),a=h(i,s.map((function(t){return t.insert})).join("")),c=a.insert,u=a.remove,l=a.index;t.delete(l,u),t.insert(l,c),t.applyDelta(s.map((function(t){return{retain:t.insert.length,attributes:t.attributes}})))},F=function(t){var e={};return t.forEach((function(t){"ychange"!==t.type.name&&(e[t.type.name]=t.attrs)})),e},B=function t(e,n,r,o){if(n instanceof v.j&&n.nodeName!==r.type.name)throw new Error("node name mismatch!");if(o.set(n,r),n instanceof v.j){var i=n.getAttributes(),s=r.attrs;for(var a in s)null!==s[a]?i[a]!==s[a]&&"ychange"!==a&&n.setAttribute(a,s[a]):n.removeAttribute(a);for(var u in i)void 0===s[u]&&n.removeAttribute(u)}for(var l=I(r),f=l.length,h=n.toArray(),p=h.length,y=c.g(f,p),m=0,g=0;m<y;m++){var b=h[m],w=l[m];if(!R(o.get(b),w)){if(!D(b,w))break;o.set(b,w)}}for(;g+m+1<y;g++){var k=h[p-g-1],x=l[f-g-1];if(!R(o.get(k),x)){if(!D(k,x))break;o.set(k,x)}}e.transact((function(){for(;p-m-g>0&&f-m-g>0;){var r=h[m],i=l[m],s=h[p-g-1],a=l[f-g-1];if(r instanceof v.l&&i instanceof Array)j(r,i)||z(r,i,o),m+=1;else{var c=r instanceof v.j&&L(r,i),u=s instanceof v.j&&L(s,a);if(c&&u){var d=P(r,i,o),y=P(s,a,o);d.foundMappedChild&&!y.foundMappedChild?u=!1:!d.foundMappedChild&&y.foundMappedChild||d.equalityFactor<y.equalityFactor?c=!1:u=!1}c?(t(e,r,i,o),m+=1):u?(t(e,s,a,o),g+=1):(n.delete(m,1),n.insert(m,[N(i,o)]),m+=1)}}var b=p-m-g;if(b>0&&n.delete(m,b),m+g<f){for(var w=[],k=m;k<f-g;k++)w.push(N(l[k],o));n.insert(m,w)}}),d.b)},L=function(t,e){return!(e instanceof Array)&&t.nodeName===e.type.name}},function(t,e,n){t.exports=function(t){"use strict";var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function n(t,e){var n=t[0],r=t[1],o=t[2],i=t[3];r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&o|~r&i)+e[0]-680876936|0)<<7|n>>>25)+r|0)&r|~n&o)+e[1]-389564586|0)<<12|i>>>20)+n|0)&n|~i&r)+e[2]+606105819|0)<<17|o>>>15)+i|0)&i|~o&n)+e[3]-1044525330|0)<<22|r>>>10)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&o|~r&i)+e[4]-176418897|0)<<7|n>>>25)+r|0)&r|~n&o)+e[5]+1200080426|0)<<12|i>>>20)+n|0)&n|~i&r)+e[6]-1473231341|0)<<17|o>>>15)+i|0)&i|~o&n)+e[7]-45705983|0)<<22|r>>>10)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&o|~r&i)+e[8]+1770035416|0)<<7|n>>>25)+r|0)&r|~n&o)+e[9]-1958414417|0)<<12|i>>>20)+n|0)&n|~i&r)+e[10]-42063|0)<<17|o>>>15)+i|0)&i|~o&n)+e[11]-1990404162|0)<<22|r>>>10)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&o|~r&i)+e[12]+1804603682|0)<<7|n>>>25)+r|0)&r|~n&o)+e[13]-40341101|0)<<12|i>>>20)+n|0)&n|~i&r)+e[14]-1502002290|0)<<17|o>>>15)+i|0)&i|~o&n)+e[15]+1236535329|0)<<22|r>>>10)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&i|o&~i)+e[1]-165796510|0)<<5|n>>>27)+r|0)&o|r&~o)+e[6]-1069501632|0)<<9|i>>>23)+n|0)&r|n&~r)+e[11]+643717713|0)<<14|o>>>18)+i|0)&n|i&~n)+e[0]-373897302|0)<<20|r>>>12)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&i|o&~i)+e[5]-701558691|0)<<5|n>>>27)+r|0)&o|r&~o)+e[10]+38016083|0)<<9|i>>>23)+n|0)&r|n&~r)+e[15]-660478335|0)<<14|o>>>18)+i|0)&n|i&~n)+e[4]-405537848|0)<<20|r>>>12)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&i|o&~i)+e[9]+568446438|0)<<5|n>>>27)+r|0)&o|r&~o)+e[14]-1019803690|0)<<9|i>>>23)+n|0)&r|n&~r)+e[3]-187363961|0)<<14|o>>>18)+i|0)&n|i&~n)+e[8]+1163531501|0)<<20|r>>>12)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&i|o&~i)+e[13]-1444681467|0)<<5|n>>>27)+r|0)&o|r&~o)+e[2]-51403784|0)<<9|i>>>23)+n|0)&r|n&~r)+e[7]+1735328473|0)<<14|o>>>18)+i|0)&n|i&~n)+e[12]-1926607734|0)<<20|r>>>12)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r^o^i)+e[5]-378558|0)<<4|n>>>28)+r|0)^r^o)+e[8]-2022574463|0)<<11|i>>>21)+n|0)^n^r)+e[11]+1839030562|0)<<16|o>>>16)+i|0)^i^n)+e[14]-35309556|0)<<23|r>>>9)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r^o^i)+e[1]-1530992060|0)<<4|n>>>28)+r|0)^r^o)+e[4]+1272893353|0)<<11|i>>>21)+n|0)^n^r)+e[7]-155497632|0)<<16|o>>>16)+i|0)^i^n)+e[10]-1094730640|0)<<23|r>>>9)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r^o^i)+e[13]+681279174|0)<<4|n>>>28)+r|0)^r^o)+e[0]-358537222|0)<<11|i>>>21)+n|0)^n^r)+e[3]-722521979|0)<<16|o>>>16)+i|0)^i^n)+e[6]+76029189|0)<<23|r>>>9)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r^o^i)+e[9]-640364487|0)<<4|n>>>28)+r|0)^r^o)+e[12]-421815835|0)<<11|i>>>21)+n|0)^n^r)+e[15]+530742520|0)<<16|o>>>16)+i|0)^i^n)+e[2]-995338651|0)<<23|r>>>9)+o|0,r=((r+=((i=((i+=(r^((n=((n+=(o^(r|~i))+e[0]-198630844|0)<<6|n>>>26)+r|0)|~o))+e[7]+1126891415|0)<<10|i>>>22)+n|0)^((o=((o+=(n^(i|~r))+e[14]-1416354905|0)<<15|o>>>17)+i|0)|~n))+e[5]-57434055|0)<<21|r>>>11)+o|0,r=((r+=((i=((i+=(r^((n=((n+=(o^(r|~i))+e[12]+1700485571|0)<<6|n>>>26)+r|0)|~o))+e[3]-1894986606|0)<<10|i>>>22)+n|0)^((o=((o+=(n^(i|~r))+e[10]-1051523|0)<<15|o>>>17)+i|0)|~n))+e[1]-2054922799|0)<<21|r>>>11)+o|0,r=((r+=((i=((i+=(r^((n=((n+=(o^(r|~i))+e[8]+1873313359|0)<<6|n>>>26)+r|0)|~o))+e[15]-30611744|0)<<10|i>>>22)+n|0)^((o=((o+=(n^(i|~r))+e[6]-1560198380|0)<<15|o>>>17)+i|0)|~n))+e[13]+1309151649|0)<<21|r>>>11)+o|0,r=((r+=((i=((i+=(r^((n=((n+=(o^(r|~i))+e[4]-145523070|0)<<6|n>>>26)+r|0)|~o))+e[11]-1120210379|0)<<10|i>>>22)+n|0)^((o=((o+=(n^(i|~r))+e[2]+718787259|0)<<15|o>>>17)+i|0)|~n))+e[9]-343485551|0)<<21|r>>>11)+o|0,t[0]=n+t[0]|0,t[1]=r+t[1]|0,t[2]=o+t[2]|0,t[3]=i+t[3]|0}function r(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}function o(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24);return n}function i(t){var e,o,i,s,a,c,u=t.length,l=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=u;e+=64)n(l,r(t.substring(e-64,e)));for(o=(t=t.substring(e-64)).length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<o;e+=1)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(n(l,i),e=0;e<16;e+=1)i[e]=0;return s=(s=8*u).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(s[2],16),c=parseInt(s[1],16)||0,i[14]=a,i[15]=c,n(l,i),l}function s(t){var e,r,i,s,a,c,u=t.length,l=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=u;e+=64)n(l,o(t.subarray(e-64,e)));for(r=(t=e-64<u?t.subarray(e-64):new Uint8Array(0)).length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<r;e+=1)i[e>>2]|=t[e]<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(n(l,i),e=0;e<16;e+=1)i[e]=0;return s=(s=8*u).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(s[2],16),c=parseInt(s[1],16)||0,i[14]=a,i[15]=c,n(l,i),l}function a(t){var n,r="";for(n=0;n<4;n+=1)r+=e[t>>8*n+4&15]+e[t>>8*n&15];return r}function c(t){var e;for(e=0;e<t.length;e+=1)t[e]=a(t[e]);return t.join("")}function u(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function l(t,e){var n,r=t.length,o=new ArrayBuffer(r),i=new Uint8Array(o);for(n=0;n<r;n+=1)i[n]=t.charCodeAt(n);return e?i:o}function f(t){return String.fromCharCode.apply(null,new Uint8Array(t))}function h(t,e,n){var r=new Uint8Array(t.byteLength+e.byteLength);return r.set(new Uint8Array(t)),r.set(new Uint8Array(e),t.byteLength),n?r:r.buffer}function p(t){var e,n=[],r=t.length;for(e=0;e<r-1;e+=2)n.push(parseInt(t.substr(e,2),16));return String.fromCharCode.apply(String,n)}function d(){this.reset()}return c(i("hello")),"undefined"===typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function e(t,e){return(t=0|t||0)<0?Math.max(t+e,0):Math.min(t,e)}ArrayBuffer.prototype.slice=function(n,r){var o,i,s,a,c=this.byteLength,u=e(n,c),l=c;return r!==t&&(l=e(r,c)),u>l?new ArrayBuffer(0):(o=l-u,i=new ArrayBuffer(o),s=new Uint8Array(i),a=new Uint8Array(this,u,o),s.set(a),i)}}(),d.prototype.append=function(t){return this.appendBinary(u(t)),this},d.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var e,o=this._buff.length;for(e=64;e<=o;e+=64)n(this._hash,r(this._buff.substring(e-64,e)));return this._buff=this._buff.substring(e-64),this},d.prototype.end=function(t){var e,n,r=this._buff,o=r.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<o;e+=1)i[e>>2]|=r.charCodeAt(e)<<(e%4<<3);return this._finish(i,o),n=c(this._hash),t&&(n=p(n)),this.reset(),n},d.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},d.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},d.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},d.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},d.prototype._finish=function(t,e){var r,o,i,s=e;if(t[s>>2]|=128<<(s%4<<3),s>55)for(n(this._hash,t),s=0;s<16;s+=1)t[s]=0;r=(r=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(r[2],16),i=parseInt(r[1],16)||0,t[14]=o,t[15]=i,n(this._hash,t)},d.hash=function(t,e){return d.hashBinary(u(t),e)},d.hashBinary=function(t,e){var n=c(i(t));return e?p(n):n},d.ArrayBuffer=function(){this.reset()},d.ArrayBuffer.prototype.append=function(t){var e,r=h(this._buff.buffer,t,!0),i=r.length;for(this._length+=t.byteLength,e=64;e<=i;e+=64)n(this._hash,o(r.subarray(e-64,e)));return this._buff=e-64<i?new Uint8Array(r.buffer.slice(e-64)):new Uint8Array(0),this},d.ArrayBuffer.prototype.end=function(t){var e,n,r=this._buff,o=r.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<o;e+=1)i[e>>2]|=r[e]<<(e%4<<3);return this._finish(i,o),n=c(this._hash),t&&(n=p(n)),this.reset(),n},d.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},d.ArrayBuffer.prototype.getState=function(){var t=d.prototype.getState.call(this);return t.buff=f(t.buff),t},d.ArrayBuffer.prototype.setState=function(t){return t.buff=l(t.buff,!0),d.prototype.setState.call(this,t)},d.ArrayBuffer.prototype.destroy=d.prototype.destroy,d.ArrayBuffer.prototype._finish=d.prototype._finish,d.ArrayBuffer.hash=function(t,e){var n=c(s(new Uint8Array(t)));return e?p(n):n},d}()},function(t,e,n){"use strict";var r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function s(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(o){return!1}}()?Object.assign:function(t,e){for(var n,a,c=s(t),u=1;u<arguments.length;u++){for(var l in n=Object(arguments[u]))o.call(n,l)&&(c[l]=n[l]);if(r){a=r(n);for(var f=0;f<a.length;f++)i.call(n,a[f])&&(c[a[f]]=n[a[f]])}}return c}},function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"===typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var c,u=[],l=!1,f=-1;function h(){l&&c&&(l=!1,c.length?u=c.concat(u):f=-1,u.length&&p())}function p(){if(!l){var t=a(h);l=!0;for(var e=u.length;e;){for(c=u,u=[];++f<e;)c&&c[f].run();f=-1,e=u.length}c=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function v(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new d(t,e)),1!==u.length||l||a(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,n){"use strict";t.exports=n(133)},function(t,e,n){"use strict";(function(t,r){var o,i=n(82);o="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof t?t:r;var s=Object(i.a)(o);e.a=s}).call(this,n(39),n(101)(t))},function(t,e,n){"use strict";(function(t){function r(t){i.length||(o(),!0),i[i.length]=t}n.d(e,"a",(function(){return r}));var o,i=[],s=0;function a(){for(;s<i.length;){var t=s;if(s+=1,i[t].call(),s>1024){for(var e=0,n=i.length-s;e<n;e++)i[e]=i[e+s];i.length-=s,s=0}}i.length=0,s=0,!1}var c="undefined"!==typeof t?t:self,u=c.MutationObserver||c.WebKitMutationObserver;function l(t){return function(){var e=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(e),clearInterval(n),t()}}}o="function"===typeof u?function(t){var e=1,n=new u(t),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){e=-e,r.data=e}}(a):l(a),r.requestFlush=o,r.makeRequestCallFromTimer=l}).call(this,n(39))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(t){return void 0===t?null:t}},function(t,e){var n="undefined"===typeof performance?null:performance,r="undefined"===typeof crypto?null:crypto,o=null!==r?function(t){var e=new ArrayBuffer(t),n=new Uint8Array(e);return r.getRandomValues(n),e}:function(t){for(var e=new ArrayBuffer(t),n=new Uint8Array(e),r=0;r<t;r++)n[r]=Math.ceil(4294967295*Math.random()>>>0);return e};e.performance=n,e.cryptoRandomBuffer=o},function(t,e,n){"use strict";(function(t){var r,o,i=n(38),s=n.n(i),a=n(90),c=n(68),u=n.n(c),l=n(77),f=n.n(l),h=n(55),p=n.n(h),d=n(37),v=n.n(d),y=n(29),m=n.n(y);function g(t){return"$"+t}function b(t){return t.substring(1)}function w(){this._store={}}function k(t){if(this._store=new w,t&&Array.isArray(t))for(var e=0,n=t.length;e<n;e++)this.add(t[e])}function x(t){if(t instanceof ArrayBuffer)return function(t){if("function"===typeof t.slice)return t.slice(0);var e=new ArrayBuffer(t.byteLength),n=new Uint8Array(e),r=new Uint8Array(t);return n.set(r),e}(t);var e=t.size,n=t.type;return"function"===typeof t.slice?t.slice(0,e,n):t.webkitSlice(0,e,n)}w.prototype.get=function(t){var e=g(t);return this._store[e]},w.prototype.set=function(t,e){var n=g(t);return this._store[n]=e,!0},w.prototype.has=function(t){return g(t)in this._store},w.prototype.delete=function(t){var e=g(t),n=e in this._store;return delete this._store[e],n},w.prototype.forEach=function(t){for(var e=Object.keys(this._store),n=0,r=e.length;n<r;n++){var o=e[n];t(this._store[o],o=b(o))}},Object.defineProperty(w.prototype,"size",{get:function(){return Object.keys(this._store).length}}),k.prototype.add=function(t){return this._store.set(t,!0)},k.prototype.has=function(t){return this._store.has(t)},k.prototype.forEach=function(t){this._store.forEach((function(e,n){t(n)}))},Object.defineProperty(k.prototype,"size",{get:function(){return this._store.size}}),!function(){if("undefined"===typeof Symbol||"undefined"===typeof Map||"undefined"===typeof Set)return!1;var t=Object.getOwnPropertyDescriptor(Map,Symbol.species);return t&&"get"in t&&Map[Symbol.species]===Map}()?(r=k,o=w):(r=Set,o=Map);var S=Function.prototype.toString,O=S.call(Object);function C(t){var e,n,r;if(!t||"object"!==typeof t)return t;if(Array.isArray(t)){for(e=[],n=0,r=t.length;n<r;n++)e[n]=C(t[n]);return e}if(t instanceof Date)return t.toISOString();if(function(t){return"undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer||"undefined"!==typeof Blob&&t instanceof Blob}(t))return x(t);if(!function(t){var e=Object.getPrototypeOf(t);if(null===e)return!0;var n=e.constructor;return"function"==typeof n&&n instanceof n&&S.call(n)==O}(t))return t;for(n in e={},t)if(Object.prototype.hasOwnProperty.call(t,n)){var o=C(t[n]);"undefined"!==typeof o&&(e[n]=o)}return e}function E(t){var e=!1;return p()((function(n){if(e)throw new Error("once called more than once");e=!0,t.apply(this,n)}))}function _(t){return p()((function(e){e=C(e);var n=this,r="function"===typeof e[e.length-1]&&e.pop(),o=new Promise((function(r,o){var i;try{var s=E((function(t,e){t?o(t):r(e)}));e.push(s),(i=t.apply(n,e))&&"function"===typeof i.then&&r(i)}catch(a){o(a)}}));return r&&o.then((function(t){r(null,t)}),r),o}))}function M(t,e){return _(p()((function(n){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var r=this;return function(t,e,n){if(t.constructor.listeners("debug").length){for(var r=["api",t.name,e],o=0;o<n.length-1;o++)r.push(n[o]);t.constructor.emit("debug",r);var i=n[n.length-1];n[n.length-1]=function(n,r){var o=["api",t.name,e];o=o.concat(n?["error",n]:["success",r]),t.constructor.emit("debug",o),i(n,r)}}}(r,t,n),this.taskqueue.isReady?e.apply(this,n):new Promise((function(e,o){r.taskqueue.addTask((function(i){i?o(i):e(r[t].apply(r,n))}))}))})))}function T(t,e){for(var n={},r=0,o=e.length;r<o;r++){var i=e[r];i in t&&(n[i]=t[i])}return n}var N;function A(t){return t}function I(t){return[{ok:t}]}function j(t,e,n){var r=e.docs,i=new o;r.forEach((function(t){i.has(t.id)?i.get(t.id).push(t):i.set(t.id,[t])}));var s=i.size,a=0,c=new Array(s);function u(){++a===s&&function(){var t=[];c.forEach((function(e){e.docs.forEach((function(n){t.push({id:e.id,docs:[n]})}))})),n(null,{results:t})}()}var l=[];i.forEach((function(t,e){l.push(e)}));var f=0;function h(){if(!(f>=l.length)){var n=Math.min(f+6,l.length),r=l.slice(f,n);!function(n,r){n.forEach((function(n,o){var s=r+o,a=i.get(n),l=T(a[0],["atts_since","attachments"]);l.open_revs=a.map((function(t){return t.rev})),l.open_revs=l.open_revs.filter(A);var f=A;0===l.open_revs.length&&(delete l.open_revs,f=I),["revs","attachments","binary","ajax","latest"].forEach((function(t){t in e&&(l[t]=e[t])})),t.get(n,l,(function(t,e){var r,o,i;r=t?[{error:t}]:f(e),o=n,i=r,c[s]={id:o,docs:i},u(),h()}))}))}(r,f),f+=r.length}}h()}try{localStorage.setItem("_pouch_check_localstorage",1),N=!!localStorage.getItem("_pouch_check_localstorage")}catch(br){N=!1}function D(){return N}function R(){m.a.call(this),this._listeners={},function(t){D()&&addEventListener("storage",(function(e){t.emit(e.key)}))}(this)}function P(t){if("undefined"!==typeof console&&"function"===typeof console[t]){var e=Array.prototype.slice.call(arguments,1);console[t].apply(console,e)}}function z(t){var e=0;return t||(e=2e3),function(t,e){var n=6e5;return t=parseInt(t,10)||0,(e=parseInt(e,10))!==e||e<=t?e=(t||1)<<1:e+=1,e>n&&(t=3e5,e=n),~~((e-t)*Math.random()+t)}(t,e)}function F(t,e){P("info","The above "+t+" is totally normal. "+e)}v()(R,m.a),R.prototype.addListener=function(t,e,n,r){if(!this._listeners[e]){var o=this,i=!1;this._listeners[e]=a,this.on(t,a)}function a(){if(o._listeners[e])if(i)i="waiting";else{i=!0;var t=T(r,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);n.changes(t).on("change",(function(t){t.seq>r.since&&!r.cancelled&&(r.since=t.seq,r.onChange(t))})).on("complete",(function(){"waiting"===i&&s()(a),i=!1})).on("error",(function(){i=!1}))}}},R.prototype.removeListener=function(t,e){e in this._listeners&&(m.a.prototype.removeListener.call(this,t,this._listeners[e]),delete this._listeners[e])},R.prototype.notifyLocalWindows=function(t){D()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},R.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)};var B="function"===typeof Object.assign?Object.assign:function(t){for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e};function L(t,e,n){Error.call(this,n),this.status=t,this.name=e,this.message=n,this.error=!0}v()(L,Error),L.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};new L(401,"unauthorized","Name or password is incorrect.");var $=new L(400,"bad_request","Missing JSON list of 'docs'"),q=new L(404,"not_found","missing"),J=new L(409,"conflict","Document update conflict"),U=new L(400,"bad_request","_id field must contain a string"),V=new L(412,"missing_id","_id is required for puts"),W=new L(400,"bad_request","Only reserved document ids may start with underscore."),H=(new L(412,"precondition_failed","Database not open"),new L(500,"unknown_error","Database encountered an unknown error")),K=new L(500,"badarg","Some query argument is invalid"),Y=(new L(400,"invalid_request","Request was invalid"),new L(400,"query_parse_error","Some query parameter is invalid")),G=new L(500,"doc_validation","Bad special document member"),Q=new L(400,"bad_request","Something wrong with the request"),X=new L(400,"bad_request","Document must be a JSON object"),Z=(new L(404,"not_found","Database not found"),new L(500,"indexed_db_went_bad","unknown")),tt=(new L(500,"web_sql_went_bad","unknown"),new L(500,"levelDB_went_went_bad","unknown"),new L(403,"forbidden","Forbidden by design doc validate_doc_update function"),new L(400,"bad_request","Invalid rev format")),et=(new L(412,"file_exists","The database could not be created, the file already exists."),new L(412,"missing_stub","A pre-existing attachment stub wasn't found"));new L(413,"invalid_url","Provided URL is invalid");function nt(t,e){function n(e){for(var n=Object.getOwnPropertyNames(t),r=0,o=n.length;r<o;r++)"function"!==typeof t[n[r]]&&(this[n[r]]=t[n[r]]);void 0!==e&&(this.reason=e)}return n.prototype=L.prototype,new n(e)}function rt(t){if("object"!==typeof t){var e=t;(t=H).data=e}return"error"in t&&"conflict"===t.error&&(t.name="conflict",t.status=409),"name"in t||(t.name=t.error||"unknown"),"status"in t||(t.status=500),"message"in t||(t.message=t.message||t.reason),t}function ot(t){var e={},n=t.filter&&"function"===typeof t.filter;return e.query=t.query_params,function(r){r.doc||(r.doc={});var o=n&&function(t,e,n){try{return!t(e,n)}catch(o){var r="Filter function threw: "+o.toString();return nt(Q,r)}}(t.filter,r.doc,e);if("object"===typeof o)return o;if(o)return!1;if(t.include_docs){if(!t.attachments)for(var i in r.doc._attachments)r.doc._attachments.hasOwnProperty(i)&&(r.doc._attachments[i].stub=!0)}else delete r.doc;return!0}}function it(t){for(var e=[],n=0,r=t.length;n<r;n++)e=e.concat(t[n]);return e}function st(t){var e;if(t?"string"!==typeof t?e=nt(U):/^_/.test(t)&&!/^_(design|local)/.test(t)&&(e=nt(W)):e=nt(V),e)throw e}function at(t){return"boolean"===typeof t._remote?t._remote:"function"===typeof t.type&&(P("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===t.type())}function ct(t){if(!t)return null;var e=t.split("/");return 2===e.length?e:1===e.length?[t,t]:null}function ut(t){var e=ct(t);return e?e.join("/"):null}var lt=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],ft="queryKey",ht=/(?:^|&)([^&=]*)=?([^&]*)/g,pt=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;function dt(t){for(var e=pt.exec(t),n={},r=14;r--;){var o=lt[r],i=e[r]||"",s=-1!==["user","password"].indexOf(o);n[o]=s?decodeURIComponent(i):i}return n[ft]={},n[lt[12]].replace(ht,(function(t,e,r){e&&(n[ft][e]=r)})),n}function vt(t,e){var n=[],r=[];for(var o in e)e.hasOwnProperty(o)&&(n.push(o),r.push(e[o]));return n.push(t),Function.apply(null,n).apply(null,r)}function yt(t,e,n){return new Promise((function(r,o){t.get(e,(function(i,s){if(i){if(404!==i.status)return o(i);s={}}var a=s._rev,c=n(s);if(!c)return r({updated:!1,rev:a});c._id=e,c._rev=a,r(function(t,e,n){return t.put(e).then((function(t){return{updated:!0,rev:t.rev}}),(function(r){if(409!==r.status)throw r;return yt(t,e._id,n)}))}(t,c,n))}))}))}var mt=function(t){return atob(t)},gt=function(t){return btoa(t)};function bt(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(br){if("TypeError"!==br.name)throw br;for(var n=new("undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof MSBlobBuilder?MSBlobBuilder:"undefined"!==typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<t.length;r+=1)n.append(t[r]);return n.getBlob(e.type)}}function wt(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),o=0;o<e;o++)r[o]=t.charCodeAt(o);return n}function kt(t,e){return bt([wt(t)],{type:e})}function xt(t,e){return kt(mt(t),e)}function St(t,e){var n=new FileReader,r="function"===typeof n.readAsBinaryString;n.onloadend=function(t){var n=t.target.result||"";if(r)return e(n);e(function(t){for(var e="",n=new Uint8Array(t),r=n.byteLength,o=0;o<r;o++)e+=String.fromCharCode(n[o]);return e}(n))},r?n.readAsBinaryString(t):n.readAsArrayBuffer(t)}function Ot(t,e){St(t,(function(t){e(t)}))}function Ct(t,e){Ot(t,(function(t){e(gt(t))}))}var Et=self.setImmediate||self.setTimeout;function _t(t,e,n,r,o){(n>0||r<e.size)&&(e=function(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.slice(e,n)}(e,n,r)),function(t,e){var n=new FileReader;n.onloadend=function(t){var n=t.target.result||new ArrayBuffer(0);e(n)},n.readAsArrayBuffer(t)}(e,(function(e){t.append(e),o()}))}function Mt(t,e,n,r,o){(n>0||r<e.length)&&(e=e.substring(n,r)),t.appendBinary(e),o()}function Tt(t,e){var n="string"===typeof t,r=n?t.length:t.size,o=Math.min(32768,r),i=Math.ceil(r/o),s=0,a=n?new u.a:new u.a.ArrayBuffer,c=n?Mt:_t;function l(){Et(h)}function f(){var t=function(t){return gt(t)}(a.end(!0));e(t),a.destroy()}function h(){var e=s*o,n=e+o;s++,c(a,t,e,n,s<i?l:f)}h()}function Nt(t){return u.a.hash(t)}function At(t,e){var n=C(t);return e?(delete n._rev_tree,Nt(JSON.stringify(n))):Object(a.a)().replace(/-/g,"").toLowerCase()}var It=a.a;function jt(t){for(var e,n,r,o,i=t.rev_tree.slice();o=i.pop();){var s=o.ids,a=s[2],c=o.pos;if(a.length)for(var u=0,l=a.length;u<l;u++)i.push({pos:c+1,ids:a[u]});else{var f=!!s[1].deleted,h=s[0];e&&!(r!==f?r:n!==c?n<c:e<h)||(e=h,n=c,r=f)}}return n+"-"+e}function Dt(t,e){for(var n,r=t.slice();n=r.pop();)for(var o=n.pos,i=n.ids,s=i[2],a=e(0===s.length,o,i[0],n.ctx,i[1]),c=0,u=s.length;c<u;c++)r.push({pos:o+1,ids:s[c],ctx:a})}function Rt(t,e){return t.pos-e.pos}function Pt(t){var e=[];Dt(t,(function(t,n,r,o,i){t&&e.push({rev:n+"-"+r,pos:n,opts:i})})),e.sort(Rt).reverse();for(var n=0,r=e.length;n<r;n++)delete e[n].pos;return e}function zt(t){for(var e=jt(t),n=Pt(t.rev_tree),r=[],o=0,i=n.length;o<i;o++){var s=n[o];s.rev===e||s.opts.deleted||r.push(s.rev)}return r}function Ft(t){for(var e,n=[],r=t.slice();e=r.pop();){var o=e.pos,i=e.ids,s=i[0],a=i[1],c=i[2],u=0===c.length,l=e.history?e.history.slice():[];l.push({id:s,opts:a}),u&&n.push({pos:o+1-l.length,ids:l});for(var f=0,h=c.length;f<h;f++)r.push({pos:o+1,ids:c[f],history:l})}return n.reverse()}function Bt(t,e){return t.pos-e.pos}function Lt(t,e,n){var r=function(t,e,n){for(var r,o=0,i=t.length;o<i;)n(t[r=o+i>>>1],e)<0?o=r+1:i=r;return o}(t,e,n);t.splice(r,0,e)}function $t(t,e){for(var n,r,o=e,i=t.length;o<i;o++){var s=t[o],a=[s.id,s.opts,[]];r?(r[2].push(a),r=a):n=r=a}return n}function qt(t,e){return t[0]<e[0]?-1:1}function Jt(t,e){for(var n=[{tree1:t,tree2:e}],r=!1;n.length>0;){var o=n.pop(),i=o.tree1,s=o.tree2;(i[1].status||s[1].status)&&(i[1].status="available"===i[1].status||"available"===s[1].status?"available":"missing");for(var a=0;a<s[2].length;a++)if(i[2][0]){for(var c=!1,u=0;u<i[2].length;u++)i[2][u][0]===s[2][a][0]&&(n.push({tree1:i[2][u],tree2:s[2][a]}),c=!0);c||(r="new_branch",Lt(i[2],s[2][a],qt))}else r="new_leaf",i[2][0]=s[2][a]}return{conflicts:r,tree:t}}function Ut(t,e,n){var r,o=[],i=!1,s=!1;if(!t.length)return{tree:[e],conflicts:"new_leaf"};for(var a=0,c=t.length;a<c;a++){var u=t[a];if(u.pos===e.pos&&u.ids[0]===e.ids[0])r=Jt(u.ids,e.ids),o.push({pos:u.pos,ids:r.tree}),i=i||r.conflicts,s=!0;else if(!0!==n){var l=u.pos<e.pos?u:e,f=u.pos<e.pos?e:u,h=f.pos-l.pos,p=[],d=[];for(d.push({ids:l.ids,diff:h,parent:null,parentIdx:null});d.length>0;){var v=d.pop();if(0!==v.diff)for(var y=v.ids[2],m=0,g=y.length;m<g;m++)d.push({ids:y[m],diff:v.diff-1,parent:v.ids,parentIdx:m});else v.ids[0]===f.ids[0]&&p.push(v)}var b=p[0];b?(r=Jt(b.ids,f.ids),b.parent[2][b.parentIdx]=r.tree,o.push({pos:l.pos,ids:l.ids}),i=i||r.conflicts,s=!0):o.push(u)}else o.push(u)}return s||o.push(e),o.sort(Bt),{tree:o,conflicts:i||"internal_node"}}function Vt(t,e,n){var r=Ut(t,e),o=function(t,e){for(var n,r,o=Ft(t),i=0,s=o.length;i<s;i++){var a,c=o[i],u=c.ids;if(u.length>e){n||(n={});var l=u.length-e;a={pos:c.pos+l,ids:$t(u,l)};for(var f=0;f<l;f++){var h=c.pos+f+"-"+u[f].id;n[h]=!0}}else a={pos:c.pos,ids:$t(u,0)};r=r?Ut(r,a,!0).tree:[a]}return n&&Dt(r,(function(t,e,r){delete n[e+"-"+r]})),{tree:r,revs:n?Object.keys(n):[]}}(r.tree,n);return{tree:o.tree,stemmedRevs:o.revs,conflicts:r.conflicts}}function Wt(t){return t.ids}function Ht(t,e){e||(e=jt(t));for(var n,r=e.substring(e.indexOf("-")+1),o=t.rev_tree.map(Wt);n=o.pop();){if(n[0]===r)return!!n[1].deleted;o=o.concat(n[2])}}function Kt(t){return/^_local/.test(t)}function Yt(t,e,n){m.a.call(this);var r=this;this.db=t;var o=(e=e?C(e):{}).complete=E((function(e,n){var o,s;e?(s="error",("listenerCount"in(o=r)?o.listenerCount(s):m.a.listenerCount(o,s))>0&&r.emit("error",e)):r.emit("complete",n),r.removeAllListeners(),t.removeListener("destroyed",i)}));function i(){r.cancel()}n&&(r.on("complete",(function(t){n(null,t)})),r.on("error",n)),t.once("destroyed",i),e.onChange=function(t,e,n){r.isCancelled||function(t,e,n,r){try{t.emit("change",e,n,r)}catch(br){P("error",'Error in .on("change", function):',br)}}(r,t,e,n)};var s=new Promise((function(t,n){e.complete=function(e,r){e?n(e):t(r)}}));r.once("cancel",(function(){t.removeListener("destroyed",i),e.complete(null,{status:"cancelled"})})),this.then=s.then.bind(s),this.catch=s.catch.bind(s),this.then((function(t){o(null,t)}),o),t.taskqueue.isReady?r.validateChanges(e):t.taskqueue.addTask((function(t){t?e.complete(t):r.isCancelled?r.emit("cancel"):r.validateChanges(e)}))}function Gt(t,e,n){var r=[{rev:t._rev}];"all_docs"===n.style&&(r=Pt(e.rev_tree).map((function(t){return{rev:t.rev}})));var o={id:e.id,changes:r,doc:t};return Ht(e,t._rev)&&(o.deleted=!0),n.conflicts&&(o.doc._conflicts=zt(e),o.doc._conflicts.length||delete o.doc._conflicts),o}function Qt(t,e){return t<e?-1:t>e?1:0}function Xt(t,e){return function(n,r){n||r[0]&&r[0].error?((n=n||r[0]).docId=e,t(n)):t(null,r.length?r[0]:r)}}function Zt(t,e){var n=Qt(t._id,e._id);return 0!==n?n:Qt(t._revisions?t._revisions.start:0,e._revisions?e._revisions.start:0)}function te(t){var e=t._compactionQueue[0],n=e.opts,r=e.callback;t.get("_local/compaction").catch((function(){return!1})).then((function(e){e&&e.last_seq&&(n.last_seq=e.last_seq),t._compact(n,(function(e,n){e?r(e):r(null,n),s()((function(){t._compactionQueue.shift(),t._compactionQueue.length&&te(t)}))}))}))}function ee(){for(var t in m.a.call(this),ee.prototype)"function"===typeof this[t]&&(this[t]=this[t].bind(this))}function ne(){this.isReady=!1,this.failed=!1,this.queue=[]}function re(t,e){if(!(this instanceof re))return new re(t,e);var n=this;if(e=e||{},t&&"object"===typeof t&&(t=(e=t).name,delete e.name),void 0===e.deterministic_revs&&(e.deterministic_revs=!0),this.__opts=e=C(e),n.auto_compaction=e.auto_compaction,n.prefix=re.prefix,"string"!==typeof t)throw new Error("Missing/invalid DB name");var r=function(t,e){var n=t.match(/([a-z-]*):\/\/(.*)/);if(n)return{name:/https?/.test(n[1])?n[1]+"://"+n[2]:n[2],adapter:n[1]};var r=re.adapters,o=re.preferredAdapters,i=re.prefix,s=e.adapter;if(!s)for(var a=0;a<o.length&&"idb"===(s=o[a])&&"websql"in r&&D()&&localStorage["_pouch__websqldb_"+i+t];++a)P("log",'PouchDB is downgrading "'+t+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');var c=r[s];return{name:c&&"use_prefix"in c&&!c.use_prefix?t:i+t,adapter:s}}((e.prefix||"")+t,e);if(e.name=r.name,e.adapter=e.adapter||r.adapter,n.name=t,n._adapter=e.adapter,re.emit("debug",["adapter","Picked adapter: ",e.adapter]),!re.adapters[e.adapter]||!re.adapters[e.adapter].valid())throw new Error("Invalid Adapter: "+e.adapter);ee.call(n),n.taskqueue=new ne,n.adapter=e.adapter,re.adapters[e.adapter].call(n,e,(function(t){if(t)return n.taskqueue.fail(t);!function(t){function e(e){t.removeListener("closed",n),e||t.constructor.emit("destroyed",t.name)}function n(){t.removeListener("destroyed",e),t.constructor.emit("unref",t)}t.once("destroyed",e),t.once("closed",n),t.constructor.emit("ref",t)}(n),n.emit("created",n),re.emit("created",n.name),n.taskqueue.ready(n)}))}v()(Yt,m.a),Yt.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},Yt.prototype.validateChanges=function(t){var e=t.complete,n=this;re._changesFilterPlugin?re._changesFilterPlugin.validate(t,(function(r){if(r)return e(r);n.doChanges(t)})):n.doChanges(t)},Yt.prototype.doChanges=function(t){var e=this,n=t.complete;if("live"in(t=C(t))&&!("continuous"in t)&&(t.continuous=t.live),t.processChange=Gt,"latest"===t.since&&(t.since="now"),t.since||(t.since=0),"now"!==t.since){if(re._changesFilterPlugin){if(re._changesFilterPlugin.normalize(t),re._changesFilterPlugin.shouldFilter(this,t))return re._changesFilterPlugin.filter(this,t)}else["doc_ids","filter","selector","view"].forEach((function(e){e in t&&P("warn",'The "'+e+'" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.')}));"descending"in t||(t.descending=!1),t.limit=0===t.limit?1:t.limit,t.complete=n;var r=this.db._changes(t);if(r&&"function"===typeof r.cancel){var o=e.cancel;e.cancel=p()((function(t){r.cancel(),o.apply(this,t)}))}}else this.db.info().then((function(r){e.isCancelled?n(null,{status:"cancelled"}):(t.since=r.update_seq,e.doChanges(t))}),n)},v()(ee,m.a),ee.prototype.post=M("post",(function(t,e,n){if("function"===typeof e&&(n=e,e={}),"object"!==typeof t||Array.isArray(t))return n(nt(X));this.bulkDocs({docs:[t]},e,Xt(n,t._id))})),ee.prototype.put=M("put",(function(t,e,n){if("function"===typeof e&&(n=e,e={}),"object"!==typeof t||Array.isArray(t))return n(nt(X));if(st(t._id),Kt(t._id)&&"function"===typeof this._putLocal)return t._deleted?this._removeLocal(t,n):this._putLocal(t,n);var r=this;function o(n){"function"===typeof r._put&&!1!==e.new_edits?r._put(t,e,n):r.bulkDocs({docs:[t]},e,Xt(n,t._id))}e.force&&t._rev?(!function(){var n=t._rev.split("-"),r=n[1],o=parseInt(n[0],10)+1,i=At();t._revisions={start:o,ids:[i,r]},t._rev=o+"-"+i,e.new_edits=!1}(),o((function(e){var r=e?null:{ok:!0,id:t._id,rev:t._rev};n(e,r)}))):o(n)})),ee.prototype.putAttachment=M("putAttachment",(function(t,e,n,r,o){var i=this;function s(t){var n="_rev"in t?parseInt(t._rev,10):0;return t._attachments=t._attachments||{},t._attachments[e]={content_type:o,data:r,revpos:++n},i.put(t)}return"function"===typeof o&&(o=r,r=n,n=null),"undefined"===typeof o&&(o=r,r=n,n=null),o||P("warn","Attachment",e,"on document",t,"is missing content_type"),i.get(t).then((function(t){if(t._rev!==n)throw nt(J);return s(t)}),(function(e){if(e.reason===q.message)return s({_id:t});throw e}))})),ee.prototype.removeAttachment=M("removeAttachment",(function(t,e,n,r){var o=this;o.get(t,(function(t,i){if(t)r(t);else if(i._rev===n){if(!i._attachments)return r();delete i._attachments[e],0===Object.keys(i._attachments).length&&delete i._attachments,o.put(i,r)}else r(nt(J))}))})),ee.prototype.remove=M("remove",(function(t,e,n,r){var o;"string"===typeof e?(o={_id:t,_rev:e},"function"===typeof n&&(r=n,n={})):(o=t,"function"===typeof e?(r=e,n={}):(r=n,n=e)),(n=n||{}).was_delete=!0;var i={_id:o._id,_rev:o._rev||n.rev,_deleted:!0};if(Kt(i._id)&&"function"===typeof this._removeLocal)return this._removeLocal(o,r);this.bulkDocs({docs:[i]},n,Xt(r,i._id))})),ee.prototype.revsDiff=M("revsDiff",(function(t,e,n){"function"===typeof e&&(n=e,e={});var r=Object.keys(t);if(!r.length)return n(null,{});var i=0,s=new o;function a(t,e){s.has(t)||s.set(t,{missing:[]}),s.get(t).missing.push(e)}r.map((function(e){this._getRevisionTree(e,(function(o,c){if(o&&404===o.status&&"missing"===o.message)s.set(e,{missing:t[e]});else{if(o)return n(o);!function(e,n){var r=t[e].slice(0);Dt(n,(function(t,n,o,i,s){var c=n+"-"+o,u=r.indexOf(c);-1!==u&&(r.splice(u,1),"available"!==s.status&&a(e,c))})),r.forEach((function(t){a(e,t)}))}(e,c)}if(++i===r.length){var u={};return s.forEach((function(t,e){u[e]=t})),n(null,u)}}))}),this)})),ee.prototype.bulkGet=M("bulkGet",(function(t,e){j(this,t,e)})),ee.prototype.compactDocument=M("compactDocument",(function(t,e,n){var r=this;this._getRevisionTree(t,(function(o,i){if(o)return n(o);var s=function(t){var e={},n=[];return Dt(t,(function(t,r,o,i){var s=r+"-"+o;return t&&(e[s]=0),void 0!==i&&n.push({from:i,to:s}),s})),n.reverse(),n.forEach((function(t){void 0===e[t.from]?e[t.from]=1+e[t.to]:e[t.from]=Math.min(e[t.from],1+e[t.to])})),e}(i),a=[],c=[];Object.keys(s).forEach((function(t){s[t]>e&&a.push(t)})),Dt(i,(function(t,e,n,r,o){var i=e+"-"+n;"available"===o.status&&-1!==a.indexOf(i)&&c.push(i)})),r._doCompaction(t,c,n)}))})),ee.prototype.compact=M("compact",(function(t,e){"function"===typeof t&&(e=t,t={});var n=this;t=t||{},n._compactionQueue=n._compactionQueue||[],n._compactionQueue.push({opts:t,callback:e}),1===n._compactionQueue.length&&te(n)})),ee.prototype._compact=function(t,e){var n=this,r={return_docs:!1,last_seq:t.last_seq||0},o=[];n.changes(r).on("change",(function(t){o.push(n.compactDocument(t.id,0))})).on("complete",(function(t){var r=t.last_seq;Promise.all(o).then((function(){return yt(n,"_local/compaction",(function(t){return(!t.last_seq||t.last_seq<r)&&(t.last_seq=r,t)}))})).then((function(){e(null,{ok:!0})})).catch(e)})).on("error",e)},ee.prototype.get=M("get",(function(t,e,n){if("function"===typeof e&&(n=e,e={}),"string"!==typeof t)return n(nt(U));if(Kt(t)&&"function"===typeof this._getLocal)return this._getLocal(t,n);var r=[],o=this;function i(){var i=[],s=r.length;if(!s)return n(null,i);r.forEach((function(r){o.get(t,{rev:r,revs:e.revs,latest:e.latest,attachments:e.attachments,binary:e.binary},(function(t,e){if(t)i.push({missing:r});else{for(var o,a=0,c=i.length;a<c;a++)if(i[a].ok&&i[a].ok._rev===e._rev){o=!0;break}o||i.push({ok:e})}--s||n(null,i)}))}))}if(!e.open_revs)return this._get(t,e,(function(r,i){if(r)return r.docId=t,n(r);var s=i.doc,a=i.metadata,c=i.ctx;if(e.conflicts){var u=zt(a);u.length&&(s._conflicts=u)}if(Ht(a,s._rev)&&(s._deleted=!0),e.revs||e.revs_info){for(var l=s._rev.split("-"),f=parseInt(l[0],10),h=l[1],p=Ft(a.rev_tree),d=null,v=0;v<p.length;v++){var y=p[v],m=y.ids.map((function(t){return t.id})).indexOf(h);(m===f-1||!d&&-1!==m)&&(d=y)}if(!d)return(r=new Error("invalid rev tree")).docId=t,n(r);var g=d.ids.map((function(t){return t.id})).indexOf(s._rev.split("-")[1])+1,b=d.ids.length-g;if(d.ids.splice(g,b),d.ids.reverse(),e.revs&&(s._revisions={start:d.pos+d.ids.length-1,ids:d.ids.map((function(t){return t.id}))}),e.revs_info){var w=d.pos+d.ids.length;s._revs_info=d.ids.map((function(t){return{rev:--w+"-"+t.id,status:t.opts.status}}))}}if(e.attachments&&s._attachments){var k=s._attachments,x=Object.keys(k).length;if(0===x)return n(null,s);Object.keys(k).forEach((function(t){this._getAttachment(s._id,t,k[t],{rev:s._rev,binary:e.binary,ctx:c},(function(e,r){var o=s._attachments[t];o.data=r,delete o.stub,delete o.length,--x||n(null,s)}))}),o)}else{if(s._attachments)for(var S in s._attachments)s._attachments.hasOwnProperty(S)&&(s._attachments[S].stub=!0);n(null,s)}}));if("all"===e.open_revs)this._getRevisionTree(t,(function(t,e){if(t)return n(t);r=Pt(e).map((function(t){return t.rev})),i()}));else{if(!Array.isArray(e.open_revs))return n(nt(H,"function_clause"));r=e.open_revs;for(var s=0;s<r.length;s++){var a=r[s];if("string"!==typeof a||!/^\d+-/.test(a))return n(nt(tt))}i()}})),ee.prototype.getAttachment=M("getAttachment",(function(t,e,n,r){var o=this;n instanceof Function&&(r=n,n={}),this._get(t,n,(function(i,s){return i?r(i):s.doc._attachments&&s.doc._attachments[e]?(n.ctx=s.ctx,n.binary=!0,void o._getAttachment(t,e,s.doc._attachments[e],n,r)):r(nt(q))}))})),ee.prototype.allDocs=M("allDocs",(function(t,e){if("function"===typeof t&&(e=t,t={}),t.skip="undefined"!==typeof t.skip?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys"in t){if(!Array.isArray(t.keys))return e(new TypeError("options.keys must be an array"));var n=["startkey","endkey","key"].filter((function(e){return e in t}))[0];if(n)return void e(nt(Y,"Query parameter `"+n+"` is not compatible with multi-get"));if(!at(this)&&(function(t){var e="limit"in t?t.keys.slice(t.skip,t.limit+t.skip):t.skip>0?t.keys.slice(t.skip):t.keys;t.keys=e,t.skip=0,delete t.limit,t.descending&&(e.reverse(),t.descending=!1)}(t),0===t.keys.length))return this._allDocs({limit:0},e)}return this._allDocs(t,e)})),ee.prototype.changes=function(t,e){return"function"===typeof t&&(e=t,t={}),(t=t||{}).return_docs="return_docs"in t?t.return_docs:!t.live,new Yt(this,t,e)},ee.prototype.close=M("close",(function(t){return this._closed=!0,this.emit("closed"),this._close(t)})),ee.prototype.info=M("info",(function(t){var e=this;this._info((function(n,r){if(n)return t(n);r.db_name=r.db_name||e.name,r.auto_compaction=!(!e.auto_compaction||at(e)),r.adapter=e.adapter,t(null,r)}))})),ee.prototype.id=M("id",(function(t){return this._id(t)})),ee.prototype.type=function(){return"function"===typeof this._type?this._type():this.adapter},ee.prototype.bulkDocs=M("bulkDocs",(function(t,e,n){if("function"===typeof e&&(n=e,e={}),e=e||{},Array.isArray(t)&&(t={docs:t}),!t||!t.docs||!Array.isArray(t.docs))return n(nt($));for(var r=0;r<t.docs.length;++r)if("object"!==typeof t.docs[r]||Array.isArray(t.docs[r]))return n(nt(X));var o;if(t.docs.forEach((function(t){t._attachments&&Object.keys(t._attachments).forEach((function(e){o=o||function(t){return"_"===t.charAt(0)&&t+" is not a valid attachment name, attachment names cannot start with '_'"}(e),t._attachments[e].content_type||P("warn","Attachment",e,"on document",t._id,"is missing content_type")}))})),o)return n(nt(Q,o));"new_edits"in e||(e.new_edits=!("new_edits"in t)||t.new_edits);var i=this;e.new_edits||at(i)||t.docs.sort(Zt),function(t){for(var e=0;e<t.length;e++){var n=t[e];if(n._deleted)delete n._attachments;else if(n._attachments)for(var r=Object.keys(n._attachments),o=0;o<r.length;o++){var i=r[o];n._attachments[i]=T(n._attachments[i],["data","digest","content_type","length","revpos","stub"])}}}(t.docs);var s=t.docs.map((function(t){return t._id}));return this._bulkDocs(t,e,(function(t,r){if(t)return n(t);if(e.new_edits||(r=r.filter((function(t){return t.error}))),!at(i))for(var o=0,a=r.length;o<a;o++)r[o].id=r[o].id||s[o];n(null,r)}))})),ee.prototype.registerDependentDatabase=M("registerDependentDatabase",(function(t,e){var n=new this.constructor(t,this.__opts);yt(this,"_local/_pouch_dependentDbs",(function(e){return e.dependentDbs=e.dependentDbs||{},!e.dependentDbs[t]&&(e.dependentDbs[t]=!0,e)})).then((function(){e(null,{db:n})})).catch(e)})),ee.prototype.destroy=M("destroy",(function(t,e){"function"===typeof t&&(e=t,t={});var n=this,r=!("use_prefix"in n)||n.use_prefix;function o(){n._destroy(t,(function(t,r){if(t)return e(t);n._destroyed=!0,n.emit("destroyed"),e(null,r||{ok:!0})}))}if(at(n))return o();n.get("_local/_pouch_dependentDbs",(function(t,i){if(t)return 404!==t.status?e(t):o();var s=i.dependentDbs,a=n.constructor,c=Object.keys(s).map((function(t){var e=r?t.replace(new RegExp("^"+a.prefix),""):t;return new a(e,n.__opts).destroy()}));Promise.all(c).then(o,e)}))})),ne.prototype.execute=function(){var t;if(this.failed)for(;t=this.queue.shift();)t(this.failed);else for(;t=this.queue.shift();)t()},ne.prototype.fail=function(t){this.failed=t,this.execute()},ne.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},ne.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},v()(re,ee);var oe="undefined"!==typeof AbortController?AbortController:function(){return{abort:function(){}}},ie=fetch,se=Headers;re.adapters={},re.preferredAdapters=[],re.prefix="_pouch_";var ae=new m.a;!function(t){Object.keys(m.a.prototype).forEach((function(e){"function"===typeof m.a.prototype[e]&&(t[e]=ae[e].bind(ae))}));var e=t._destructionListeners=new o;t.on("ref",(function(t){e.has(t.name)||e.set(t.name,[]),e.get(t.name).push(t)})),t.on("unref",(function(t){if(e.has(t.name)){var n=e.get(t.name),r=n.indexOf(t);r<0||(n.splice(r,1),n.length>1?e.set(t.name,n):e.delete(t.name))}})),t.on("destroyed",(function(t){if(e.has(t)){var n=e.get(t);e.delete(t),n.forEach((function(t){t.emit("destroyed",!0)}))}}))}(re),re.adapter=function(t,e,n){e.valid()&&(re.adapters[t]=e,n&&re.preferredAdapters.push(t))},re.plugin=function(t){if("function"===typeof t)t(re);else{if("object"!==typeof t||0===Object.keys(t).length)throw new Error('Invalid plugin: got "'+t+'", expected an object or a function');Object.keys(t).forEach((function(e){re.prototype[e]=t[e]}))}return this.__defaults&&(re.__defaults=B({},this.__defaults)),re},re.defaults=function(t){function e(t,n){if(!(this instanceof e))return new e(t,n);n=n||{},t&&"object"===typeof t&&(t=(n=t).name,delete n.name),n=B({},e.__defaults,n),re.call(this,t,n)}return v()(e,re),e.preferredAdapters=re.preferredAdapters.slice(),Object.keys(re).forEach((function(t){t in e||(e[t]=re[t])})),e.__defaults=B({},this.__defaults,t),e},re.fetch=function(t,e){return ie(t,e)};function ce(t,e){for(var n=t,r=0,o=e.length;r<o;r++){if(!(n=n[e[r]]))break}return n}function ue(t){for(var e=[],n="",r=0,o=t.length;r<o;r++){var i=t[r];"."===i?r>0&&"\\"===t[r-1]?n=n.substring(0,n.length-1)+".":(e.push(n),n=""):n+=i}return e.push(n),e}var le=["$or","$nor","$not"];function fe(t){return le.indexOf(t)>-1}function he(t){return Object.keys(t)[0]}function pe(t){var e={};return t.forEach((function(t){Object.keys(t).forEach((function(n){var r=t[n];if("object"!==typeof r&&(r={$eq:r}),fe(n))e[n]=r instanceof Array?r.map((function(t){return pe([t])})):pe([r]);else{var o=e[n]=e[n]||{};Object.keys(r).forEach((function(t){var e=r[t];return"$gt"===t||"$gte"===t?function(t,e,n){if("undefined"!==typeof n.$eq)return;"undefined"!==typeof n.$gte?"$gte"===t?e>n.$gte&&(n.$gte=e):e>=n.$gte&&(delete n.$gte,n.$gt=e):"undefined"!==typeof n.$gt?"$gte"===t?e>n.$gt&&(delete n.$gt,n.$gte=e):e>n.$gt&&(n.$gt=e):n[t]=e}(t,e,o):"$lt"===t||"$lte"===t?function(t,e,n){if("undefined"!==typeof n.$eq)return;"undefined"!==typeof n.$lte?"$lte"===t?e<n.$lte&&(n.$lte=e):e<=n.$lte&&(delete n.$lte,n.$lt=e):"undefined"!==typeof n.$lt?"$lte"===t?e<n.$lt&&(delete n.$lt,n.$lte=e):e<n.$lt&&(n.$lt=e):n[t]=e}(t,e,o):"$ne"===t?function(t,e){"$ne"in e?e.$ne.push(t):e.$ne=[t]}(e,o):"$eq"===t?function(t,e){delete e.$gt,delete e.$gte,delete e.$lt,delete e.$lte,delete e.$ne,e.$eq=t}(e,o):void(o[t]=e)}))}}))})),e}function de(t){for(var e in t){if(Array.isArray(t))for(var n in t)t[n].$and&&(t[n]=pe(t[n].$and));var r=t[e];"object"===typeof r&&de(r)}return t}function ve(t,e){for(var n in t){"$and"===n&&(e=!0);var r=t[n];"object"===typeof r&&(e=ve(r,e))}return e}function ye(t){var e=C(t),n=!1;ve(e,!1)&&("$and"in(e=de(e))&&(e=pe(e.$and)),n=!0),["$or","$nor"].forEach((function(t){t in e&&e[t].forEach((function(t){for(var e=Object.keys(t),n=0;n<e.length;n++){var r=e[n],o=t[r];"object"===typeof o&&null!==o||(t[r]={$eq:o})}}))})),"$not"in e&&(e.$not=pe([e.$not]));for(var r=Object.keys(e),o=0;o<r.length;o++){var i=r[o],s=e[i];"object"!==typeof s||null===s?s={$eq:s}:"$ne"in s&&!n&&(s.$ne=[s.$ne]),e[i]=s}return e}var me=-324;function ge(t,e){if(t===e)return 0;t=be(t),e=be(e);var n=Oe(t),r=Oe(e);if(n-r!==0)return n-r;switch(typeof t){case"number":return t-e;case"boolean":return t<e?-1:1;case"string":return function(t,e){return t===e?0:t>e?1:-1}(t,e)}return Array.isArray(t)?function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var o=ge(t[r],e[r]);if(0!==o)return o}return t.length===e.length?0:t.length>e.length?1:-1}(t,e):function(t,e){for(var n=Object.keys(t),r=Object.keys(e),o=Math.min(n.length,r.length),i=0;i<o;i++){var s=ge(n[i],r[i]);if(0!==s)return s;if(0!==(s=ge(t[n[i]],e[r[i]])))return s}return n.length===r.length?0:n.length>r.length?1:-1}(t,e)}function be(t){switch(typeof t){case"undefined":return null;case"number":return t===1/0||t===-1/0||isNaN(t)?null:t;case"object":var e=t;if(Array.isArray(t)){var n=t.length;t=new Array(n);for(var r=0;r<n;r++)t[r]=be(e[r])}else{if(t instanceof Date)return t.toJSON();if(null!==t)for(var o in t={},e)if(e.hasOwnProperty(o)){var i=e[o];"undefined"!==typeof i&&(t[o]=be(i))}}}return t}function we(t){if(null!==t)switch(typeof t){case"boolean":return t?1:0;case"number":return function(t){if(0===t)return"1";var e=t.toExponential().split(/e\+?/),n=parseInt(e[1],10),r=t<0,o=r?"0":"2",i=(s=((r?-n:n)-me).toString(),a="0",c=3,function(t,e,n){for(var r="",o=n-t.length;r.length<o;)r+=e;return r}(s,a,c)+s);var s,a,c;o+=""+i;var u=Math.abs(parseFloat(e[0]));r&&(u=10-u);var l=u.toFixed(20);return l=l.replace(/\.?0+$/,""),o+=""+l}(t);case"string":return t.replace(/\u0002/g,"\x02\x02").replace(/\u0001/g,"\x01\x02").replace(/\u0000/g,"\x01\x01");case"object":var e=Array.isArray(t),n=e?t:Object.keys(t),r=-1,o=n.length,i="";if(e)for(;++r<o;)i+=ke(n[r]);else for(;++r<o;){var s=n[r];i+=ke(s)+ke(t[s])}return i}return""}function ke(t){return Oe(t=be(t))+""+we(t)+"\0"}function xe(t,e){var n,r=e;if("1"===t[e])n=0,e++;else{var o="0"===t[e];e++;var i="",s=t.substring(e,e+3),a=parseInt(s,10)+me;for(o&&(a=-a),e+=3;;){var c=t[e];if("\0"===c)break;i+=c,e++}n=1===(i=i.split(".")).length?parseInt(i,10):parseFloat(i[0]+"."+i[1]),o&&(n-=10),0!==a&&(n=parseFloat(n+"e"+a))}return{num:n,length:e-r}}function Se(t,e){var n=t.pop();if(e.length){var r=e[e.length-1];n===r.element&&(e.pop(),r=e[e.length-1]);var o=r.element,i=r.index;if(Array.isArray(o))o.push(n);else if(i===t.length-2){o[t.pop()]=n}else t.push(n)}}function Oe(t){var e=["boolean","number","string","object"].indexOf(typeof t);return~e?null===t?1:Array.isArray(t)?5:e<3?e+2:e+3:Array.isArray(t)?5:void 0}function Ce(t,e,n){if(t=t.filter((function(t){return Ee(t.doc,e.selector,n)})),e.sort){var r=function(t){function e(e){return t.map((function(t){var n=ue(he(t));return ce(e,n)}))}return function(t,n){var r,o,i=ge(e(t.doc),e(n.doc));return 0!==i?i:(r=t.doc._id)<(o=n.doc._id)?-1:r>o?1:0}}(e.sort);t=t.sort(r),"string"!==typeof e.sort[0]&&"desc"===(o=e.sort[0])[he(o)]&&(t=t.reverse())}var o;if("limit"in e||"skip"in e){var i=e.skip||0,s=("limit"in e?e.limit:t.length)+i;t=t.slice(i,s)}return t}function Ee(t,e,n){return n.every((function(n){var r=e[n],o=ue(n),i=ce(t,o);return fe(n)?function(t,e,n){if("$or"===t)return e.some((function(t){return Ee(n,t,Object.keys(t))}));if("$not"===t)return!Ee(n,e,Object.keys(e));return!e.find((function(t){return Ee(n,t,Object.keys(t))}))}(n,r,t):_e(r,t,o,i)}))}function _e(t,e,n,r){return!t||("object"===typeof t?Object.keys(t).every((function(o){var i=t[o];return function(t,e,n,r,o){if(!Ae[t])throw new Error('unknown operator "'+t+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return Ae[t](e,n,r,o)}(o,e,i,n,r)})):t===r)}function Me(t){return"undefined"!==typeof t&&null!==t}function Te(t){return"undefined"!==typeof t}function Ne(t,e){return e.some((function(e){return t instanceof Array?t.indexOf(e)>-1:t===e}))}var Ae={$elemMatch:function(t,e,n,r){return!!Array.isArray(r)&&(0!==r.length&&("object"===typeof r[0]?r.some((function(t){return Ee(t,e,Object.keys(e))})):r.some((function(r){return _e(e,t,n,r)}))))},$allMatch:function(t,e,n,r){return!!Array.isArray(r)&&(0!==r.length&&("object"===typeof r[0]?r.every((function(t){return Ee(t,e,Object.keys(e))})):r.every((function(r){return _e(e,t,n,r)}))))},$eq:function(t,e,n,r){return Te(r)&&0===ge(r,e)},$gte:function(t,e,n,r){return Te(r)&&ge(r,e)>=0},$gt:function(t,e,n,r){return Te(r)&&ge(r,e)>0},$lte:function(t,e,n,r){return Te(r)&&ge(r,e)<=0},$lt:function(t,e,n,r){return Te(r)&&ge(r,e)<0},$exists:function(t,e,n,r){return e?Te(r):!Te(r)},$mod:function(t,e,n,r){return Me(r)&&function(t,e){var n=e[0],r=e[1];if(0===n)throw new Error("Bad divisor, cannot divide by zero");if(parseInt(n,10)!==n)throw new Error("Divisor is not an integer");if(parseInt(r,10)!==r)throw new Error("Modulus is not an integer");return parseInt(t,10)===t&&t%n===r}(r,e)},$ne:function(t,e,n,r){return e.every((function(t){return 0!==ge(r,t)}))},$in:function(t,e,n,r){return Me(r)&&Ne(r,e)},$nin:function(t,e,n,r){return Me(r)&&!Ne(r,e)},$size:function(t,e,n,r){return Me(r)&&function(t,e){return t.length===e}(r,e)},$all:function(t,e,n,r){return Array.isArray(r)&&function(t,e){return e.every((function(e){return t.indexOf(e)>-1}))}(r,e)},$regex:function(t,e,n,r){return Me(r)&&function(t,e){return new RegExp(e).test(t)}(r,e)},$type:function(t,e,n,r){return function(t,e){switch(e){case"null":return null===t;case"boolean":return"boolean"===typeof t;case"number":return"number"===typeof t;case"string":return"string"===typeof t;case"array":return t instanceof Array;case"object":return"[object Object]"==={}.toString.call(t)}throw new Error(e+" not supported as a type.Please use one of object, string, array, number, boolean or null.")}(r,e)}};function Ie(t,e){if(t.selector&&t.filter&&"_selector"!==t.filter){var n="string"===typeof t.filter?t.filter:"function";return e(new Error('selector invalid for filter "'+n+'"'))}e()}function je(t){t.view&&!t.filter&&(t.filter="_view"),t.selector&&!t.filter&&(t.filter="_selector"),t.filter&&"string"===typeof t.filter&&("_view"===t.filter?t.view=ut(t.view):t.filter=ut(t.filter))}function De(t,e){return e.filter&&"string"===typeof e.filter&&!e.doc_ids&&!at(t.db)}function Re(t,e){var n=e.complete;if("_view"===e.filter){if(!e.view||"string"!==typeof e.view){var r=nt(Q,"`view` filter parameter not found or invalid.");return n(r)}var o=ct(e.view);t.db.get("_design/"+o[0],(function(r,i){if(t.isCancelled)return n(null,{status:"cancelled"});if(r)return n(rt(r));var s=i&&i.views&&i.views[o[1]]&&i.views[o[1]].map;if(!s)return n(nt(q,i.views?"missing json key: "+o[1]:"missing json key: views"));e.filter=vt(["return function(doc) {",'  "use strict";',"  var emitted = false;","  var emit = function (a, b) {","    emitted = true;","  };","  var view = "+s+";","  view(doc);","  if (emitted) {","    return true;","  }","};"].join("\n"),{}),t.doChanges(e)}))}else if(e.selector)e.filter=function(t){return function(t,e){if("object"!==typeof e)throw new Error("Selector error: expected a JSON object");var n=Ce([{doc:t}],{selector:e=ye(e)},Object.keys(e));return n&&1===n.length}(t,e.selector)},t.doChanges(e);else{var i=ct(e.filter);t.db.get("_design/"+i[0],(function(r,o){if(t.isCancelled)return n(null,{status:"cancelled"});if(r)return n(rt(r));var s=o&&o.filters&&o.filters[i[1]];if(!s)return n(nt(q,o&&o.filters?"missing json key: "+i[1]:"missing json key: filters"));e.filter=vt('"use strict";\nreturn '+s+";",{}),t.doChanges(e)}))}}function Pe(t){return t.reduce((function(t,e){return t[e]=!0,t}),{})}re.plugin((function(t){t._changesFilterPlugin={validate:Ie,normalize:je,shouldFilter:De,filter:Re}})),re.version="7.2.2";var ze=Pe(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),Fe=Pe(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);function Be(t){if(!/^\d+-/.test(t))return nt(tt);var e=t.indexOf("-"),n=t.substring(0,e),r=t.substring(e+1);return{prefix:parseInt(n,10),id:r}}function Le(t,e,n){var r,o,i;n||(n={deterministic_revs:!0});var s={status:"available"};if(t._deleted&&(s.deleted=!0),e)if(t._id||(t._id=It()),o=At(t,n.deterministic_revs),t._rev){if((i=Be(t._rev)).error)return i;t._rev_tree=[{pos:i.prefix,ids:[i.id,{status:"missing"},[[o,s,[]]]]}],r=i.prefix+1}else t._rev_tree=[{pos:1,ids:[o,s,[]]}],r=1;else if(t._revisions&&(t._rev_tree=function(t,e){for(var n=t.start-t.ids.length+1,r=t.ids,o=[r[0],e,[]],i=1,s=r.length;i<s;i++)o=[r[i],{status:"missing"},[o]];return[{pos:n,ids:o}]}(t._revisions,s),r=t._revisions.start,o=t._revisions.ids[0]),!t._rev_tree){if((i=Be(t._rev)).error)return i;r=i.prefix,o=i.id,t._rev_tree=[{pos:r,ids:[o,s,[]]}]}st(t._id),t._rev=r+"-"+o;var a={metadata:{},data:{}};for(var c in t)if(Object.prototype.hasOwnProperty.call(t,c)){var u="_"===c[0];if(u&&!ze[c]){var l=nt(G,c);throw l.message=G.message+": "+c,l}u&&!Fe[c]?a.metadata[c.slice(1)]=t[c]:a.data[c]=t[c]}return a}function $e(t,e,n){var r=function(t){try{return mt(t)}catch(br){return{error:nt(K,"Attachment is not a valid base64 string")}}}(t.data);if(r.error)return n(r.error);t.length=r.length,t.data="blob"===e?kt(r,t.content_type):"base64"===e?gt(r):r,Tt(r,(function(e){t.digest="md5-"+e,n()}))}function qe(t,e,n){if(t.stub)return n();"string"===typeof t.data?$e(t,e,n):function(t,e,n){Tt(t.data,(function(r){t.digest="md5-"+r,t.length=t.data.size||t.data.length||0,"binary"===e?Ot(t.data,(function(e){t.data=e,n()})):"base64"===e?Ct(t.data,(function(e){t.data=e,n()})):n()}))}(t,e,n)}function Je(t,e,n,r,o,i,s,a){if(function(t,e){for(var n,r=t.slice(),o=e.split("-"),i=parseInt(o[0],10),s=o[1];n=r.pop();){if(n.pos===i&&n.ids[0]===s)return!0;for(var a=n.ids[2],c=0,u=a.length;c<u;c++)r.push({pos:n.pos+1,ids:a[c]})}return!1}(e.rev_tree,n.metadata.rev)&&!a)return r[o]=n,i();var c=e.winningRev||jt(e),u="deleted"in e?e.deleted:Ht(e,c),l="deleted"in n.metadata?n.metadata.deleted:Ht(n.metadata),f=/^1-/.test(n.metadata.rev);if(u&&!l&&a&&f){var h=n.data;h._rev=c,h._id=n.metadata.id,n=Le(h,a)}var p=Vt(e.rev_tree,n.metadata.rev_tree[0],t);if(a&&(u&&l&&"new_leaf"!==p.conflicts||!u&&"new_leaf"!==p.conflicts||u&&!l&&"new_branch"===p.conflicts)){var d=nt(J);return r[o]=d,i()}var v=n.metadata.rev;n.metadata.rev_tree=p.tree,n.stemmedRevs=p.stemmedRevs||[],e.rev_map&&(n.metadata.rev_map=e.rev_map);var y=jt(n.metadata),m=Ht(n.metadata,y),g=u===m?0:u<m?-1:1;s(n,y,m,v===y?m:Ht(n.metadata,v),!0,g,o,i)}function Ue(t,e,n,r,i,s,a,c,u){t=t||1e3;var l=c.new_edits,f=new o,h=0,p=e.length;function d(){++h===p&&u&&u()}e.forEach((function(t,e){if(t._id&&Kt(t._id)){var r=t._deleted?"_removeLocal":"_putLocal";n[r](t,{ctx:i},(function(t,n){s[e]=t||n,d()}))}else{var o=t.metadata.id;f.has(o)?(p--,f.get(o).push([t,e])):f.set(o,[[t,e]])}})),f.forEach((function(e,n){var o=0;function i(){++o<e.length?u():d()}function u(){var u=e[o],f=u[0],h=u[1];if(r.has(n))Je(t,r.get(n),f,s,h,i,a,l);else{var p=Vt([],f.metadata.rev_tree[0],t);f.metadata.rev_tree=p.tree,f.stemmedRevs=p.stemmedRevs||[],function(t,e,n){var r=jt(t.metadata),o=Ht(t.metadata,r);if("was_delete"in c&&o)return s[e]=nt(q,"deleted"),n();if(l&&function(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}(t)){var i=nt(J);return s[e]=i,n()}a(t,r,o,o,!1,o?0:1,e,n)}(f,h,i)}}u()}))}var Ve="document-store",We="by-sequence",He="attach-store",Ke="attach-seq-store",Ye="meta-store",Ge="local-store",Qe="detect-blob-support";function Xe(t){try{return JSON.stringify(t)}catch(br){return f.a.stringify(t)}}function Ze(t){return function(e){var n="unknown_error";e.target&&e.target.error&&(n=e.target.error.name||e.target.error.message),t(nt(Z,n,e.type))}}function tn(t,e,n){return{data:Xe(t),winningRev:e,deletedOrLocal:n?"1":"0",seq:t.seq,id:t.id}}function en(t){if(!t)return null;var e=function(t){try{return JSON.parse(t)}catch(br){return f.a.parse(t)}}(t.data);return e.winningRev=t.winningRev,e.deleted="1"===t.deletedOrLocal,e.seq=t.seq,e}function nn(t){if(!t)return t;var e=t._doc_id_rev.lastIndexOf(":");return t._id=t._doc_id_rev.substring(0,e-1),t._rev=t._doc_id_rev.substring(e+1),delete t._doc_id_rev,t}function rn(t,e,n,r){n?r(t?"string"!==typeof t?t:xt(t,e):bt([""],{type:e})):t?"string"!==typeof t?St(t,(function(t){r(gt(t))})):r(t):r("")}function on(t,e,n,r){var o=Object.keys(t._attachments||{});if(!o.length)return r&&r();var i=0;function s(){++i===o.length&&r&&r()}o.forEach((function(r){e.attachments&&e.include_docs?function(t,e){var r=t._attachments[e],o=r.digest;n.objectStore(He).get(o).onsuccess=function(t){r.body=t.target.result.body,s()}}(t,r):(t._attachments[r].stub=!0,s())}))}function sn(t,e){return Promise.all(t.map((function(t){if(t.doc&&t.doc._attachments){var n=Object.keys(t.doc._attachments);return Promise.all(n.map((function(n){var r=t.doc._attachments[n];if("body"in r){var o=r.body,i=r.content_type;return new Promise((function(s){rn(o,i,e,(function(e){t.doc._attachments[n]=B(T(r,["digest","content_type"]),{data:e}),s()}))}))}})))}})))}function an(t,e,n){var r=[],o=n.objectStore(We),i=n.objectStore(He),s=n.objectStore(Ke),a=t.length;function c(){--a||function(){if(!r.length)return;r.forEach((function(t){s.index("digestSeq").count(IDBKeyRange.bound(t+"::",t+"::\uffff",!1,!1)).onsuccess=function(e){e.target.result||i.delete(t)}}))}()}t.forEach((function(t){var n=o.index("_doc_id_rev"),i=e+"::"+t;n.getKey(i).onsuccess=function(t){var e=t.target.result;if("number"!==typeof e)return c();o.delete(e),s.index("seq").openCursor(IDBKeyRange.only(e)).onsuccess=function(t){var e=t.target.result;if(e){var n=e.value.digestSeq.split("::")[0];r.push(n),s.delete(e.primaryKey),e.continue()}else c()}}}))}function cn(t,e,n){try{return{txn:t.transaction(e,n)}}catch(r){return{error:r}}}var un=new R;function ln(t,e,n,r,i,s){for(var a,c,u,l,f,h,p,d,v=e.docs,y=0,m=v.length;y<m;y++){var g=v[y];g._id&&Kt(g._id)||(g=v[y]=Le(g,n.new_edits,t)).error&&!p&&(p=g)}if(p)return s(p);var b=!1,w=0,k=new Array(v.length),x=new o,S=!1,O=r._meta.blobSupport?"blob":"base64";function C(){b=!0,E()}function E(){d&&b&&(d.docCount+=w,h.put(d))}function _(){S||(un.notify(r._meta.name),s(null,k))}function M(t,e,n,r,o,i,s,a){t.metadata.winningRev=e,t.metadata.deleted=n;var c=t.data;if(c._id=t.metadata.id,c._rev=t.metadata.rev,r&&(c._deleted=!0),c._attachments&&Object.keys(c._attachments).length)return function(t,e,n,r,o,i){var s=t.data,a=0,c=Object.keys(s._attachments);function u(){a===c.length&&T(t,e,n,r,o,i)}function f(){a++,u()}c.forEach((function(n){var r=t.data._attachments[n];if(r.stub)a++,u();else{var o=r.data;delete r.data,r.revpos=parseInt(e,10),function(t,e,n){l.count(t).onsuccess=function(r){if(r.target.result)return n();var o={digest:t,body:e};l.put(o).onsuccess=n}}(r.digest,o,f)}}))}(t,e,n,o,s,a);w+=i,E(),T(t,e,n,o,s,a)}function T(t,e,n,o,i,s){var l=t.data,h=t.metadata;function p(i){var s=t.stemmedRevs||[];o&&r.auto_compaction&&(s=s.concat(function(t){var e=[];return Dt(t.rev_tree,(function(t,n,r,o,i){"available"!==i.status||t||(e.push(n+"-"+r),i.status="missing")})),e}(t.metadata))),s&&s.length&&an(s,t.metadata.id,a),h.seq=i.target.result;var u=tn(h,e,n);c.put(u).onsuccess=d}function d(){k[i]={ok:!0,id:h.id,rev:h.rev},x.set(t.metadata.id,t.metadata),function(t,e,n){var r=0,o=Object.keys(t.data._attachments||{});if(!o.length)return n();function i(){++r===o.length&&n()}function s(n){var r=t.data._attachments[n].digest,o=f.put({seq:e,digestSeq:r+"::"+e});o.onsuccess=i,o.onerror=function(t){t.preventDefault(),t.stopPropagation(),i()}}for(var a=0;a<o.length;a++)s(o[a])}(t,h.seq,s)}l._doc_id_rev=h.id+"::"+h.rev,delete l._id,delete l._rev;var v=u.put(l);v.onsuccess=p,v.onerror=function(t){t.preventDefault(),t.stopPropagation(),u.index("_doc_id_rev").getKey(l._doc_id_rev).onsuccess=function(t){u.put(l,t.target.result).onsuccess=p}}}!function(t,e,n){if(!t.length)return n();var r,o=0;function i(){o++,t.length===o&&(r?n(r):n())}t.forEach((function(t){var n=t.data&&t.data._attachments?Object.keys(t.data._attachments):[],o=0;if(!n.length)return i();function s(t){r=t,++o===n.length&&i()}for(var a in t.data._attachments)t.data._attachments.hasOwnProperty(a)&&qe(t.data._attachments[a],e,s)}))}(v,O,(function(e){if(e)return s(e);!function(){var e=cn(i,[Ve,We,He,Ge,Ke,Ye],"readwrite");if(e.error)return s(e.error);(a=e.txn).onabort=Ze(s),a.ontimeout=Ze(s),a.oncomplete=_,c=a.objectStore(Ve),u=a.objectStore(We),l=a.objectStore(He),f=a.objectStore(Ke),(h=a.objectStore(Ye)).get(Ye).onsuccess=function(t){d=t.target.result,E()},function(t){var e=[];if(v.forEach((function(t){t.data&&t.data._attachments&&Object.keys(t.data._attachments).forEach((function(n){var r=t.data._attachments[n];r.stub&&e.push(r.digest)}))})),!e.length)return t();var n,r=0;function o(){++r===e.length&&t(n)}e.forEach((function(t){!function(t,e){l.get(t).onsuccess=function(n){if(n.target.result)e();else{var r=nt(et,"unknown stub attachment with digest "+t);r.status=412,e(r)}}}(t,(function(t){t&&!n&&(n=t),o()}))}))}((function(e){if(e)return S=!0,s(e);!function(){if(!v.length)return;var e=0;function o(){++e===v.length&&Ue(t.revs_limit,v,r,x,a,k,M,n,C)}function i(t){var e=en(t.target.result);e&&x.set(e.id,e),o()}for(var s=0,u=v.length;s<u;s++){var l=v[s];if(l._id&&Kt(l._id))o();else c.get(l.metadata.id).onsuccess=i}}()}))}()}))}function fn(t,e,n,r,o){var i,s,a;function c(t){s=t.target.result,i&&o(i,s,a)}function u(t){i=t.target.result,s&&o(i,s,a)}function l(t){var e=t.target.result;if(!e)return o();o([e.key],[e.value],e)}-1===r&&(r=1e3),"function"===typeof t.getAll&&"function"===typeof t.getAllKeys&&r>1&&!n?(a={continue:function(){if(!i.length)return o();var n,a=i[i.length-1];if(e&&e.upper)try{n=IDBKeyRange.bound(a,e.upper,!0,e.upperOpen)}catch(br){if("DataError"===br.name&&0===br.code)return o()}else n=IDBKeyRange.lowerBound(a,!0);e=n,i=null,s=null,t.getAll(e,r).onsuccess=c,t.getAllKeys(e,r).onsuccess=u}},t.getAll(e,r).onsuccess=c,t.getAllKeys(e,r).onsuccess=u):n?t.openCursor(e,"prev").onsuccess=l:t.openCursor(e).onsuccess=l}function hn(t,e,n){var r,o,i="startkey"in t&&t.startkey,s="endkey"in t&&t.endkey,a="key"in t&&t.key,c="keys"in t&&t.keys,u=t.skip||0,l="number"===typeof t.limit?t.limit:-1,f=!1!==t.inclusive_end;if(!c&&(o=(r=function(t,e,n,r,o){try{if(t&&e)return o?IDBKeyRange.bound(e,t,!n,!1):IDBKeyRange.bound(t,e,!1,!n);if(t)return o?IDBKeyRange.upperBound(t):IDBKeyRange.lowerBound(t);if(e)return o?IDBKeyRange.lowerBound(e,!n):IDBKeyRange.upperBound(e,!n);if(r)return IDBKeyRange.only(r)}catch(br){return{error:br}}return null}(i,s,f,a,t.descending))&&r.error)&&("DataError"!==o.name||0!==o.code))return n(nt(Z,o.name,o.message));var h=[Ve,We,Ye];t.attachments&&h.push(He);var p=cn(e,h,"readonly");if(p.error)return n(p.error);var d=p.txn;d.oncomplete=function(){t.attachments?sn(k,t.binary).then(C):C()},d.onabort=Ze(n);var v,y,m=d.objectStore(Ve),g=d.objectStore(We),b=d.objectStore(Ye),w=g.index("_doc_id_rev"),k=[];function x(e,n){var r={id:n.id,key:n.id,value:{rev:e}};n.deleted?c&&(k.push(r),r.value.deleted=!0,r.doc=null):u--<=0&&(k.push(r),t.include_docs&&function(e,n,r){var o=e.id+"::"+r;w.get(o).onsuccess=function(r){if(n.doc=nn(r.target.result)||{},t.conflicts){var o=zt(e);o.length&&(n.doc._conflicts=o)}on(n.doc,t,d)}}(n,r,e))}function S(t){for(var e=0,n=t.length;e<n&&k.length!==l;e++){var r=t[e];if(r.error&&c)k.push(r);else{var o=en(r);x(o.winningRev,o)}}}function O(t,e,n){n&&(S(e),k.length<l&&n.continue())}function C(){var e={total_rows:v,offset:t.skip,rows:k};t.update_seq&&void 0!==y&&(e.update_seq=y),n(null,e)}return b.get(Ye).onsuccess=function(t){v=t.target.result.docCount},t.update_seq&&function(t,e){function n(t){var n=t.target.result,r=void 0;return n&&n.key&&(r=n.key),e({target:{result:[r]}})}t.openCursor(null,"prev").onsuccess=n}(g,(function(t){t.target.result&&t.target.result.length>0&&(y=t.target.result[0])})),o||0===l?void 0:c?function(t,e,n){var r=new Array(t.length),o=0;t.forEach((function(i,s){e.get(i).onsuccess=function(e){e.target.result?r[s]=e.target.result:r[s]={key:i,error:"not_found"},++o===t.length&&n(t,r,{})}}))}(t.keys,m,O):-1===l?function(t,e,n){if("function"!==typeof t.getAll){var r=[];t.openCursor(e).onsuccess=function(t){var e=t.target.result;e?(r.push(e.value),e.continue()):n({target:{result:r}})}}else t.getAll(e).onsuccess=n}(m,r,(function(e){var n=e.target.result;t.descending&&(n=n.reverse()),S(n)})):void fn(m,r,t.descending,l+u,O)}var pn=!1,dn=[];function vn(){!pn&&dn.length&&(pn=!0,dn.shift()())}function yn(t,e,n,i){if((t=C(t)).continuous){var s=n+":"+It();return un.addListener(n,s,e,t),un.notify(n),{cancel:function(){un.removeListener(n,s)}}}var a=t.doc_ids&&new r(t.doc_ids);t.since=t.since||0;var c=t.since,u="limit"in t?t.limit:-1;0===u&&(u=1);var l,f,h,p,d=[],v=0,y=ot(t),m=new o;function g(t,e,n,r){if(n.seq!==e)return r();if(n.winningRev===t._rev)return r(n,t);var o=t._id+"::"+n.winningRev;p.get(o).onsuccess=function(t){r(n,nn(t.target.result))}}function b(){t.complete(null,{results:d,last_seq:c})}var w=[Ve,We];t.attachments&&w.push(He);var k=cn(i,w,"readonly");if(k.error)return t.complete(k.error);(l=k.txn).onabort=Ze(t.complete),l.oncomplete=function(){!t.continuous&&t.attachments?sn(d).then(b):b()},f=l.objectStore(We),h=l.objectStore(Ve),p=f.index("_doc_id_rev"),fn(f,t.since&&!t.descending?IDBKeyRange.lowerBound(t.since,!0):null,t.descending,u,(function(e,n,r){if(r&&e.length){var o=new Array(e.length),i=new Array(e.length),s=0;n.forEach((function(n,c){!function(t,e,n){if(a&&!a.has(t._id))return n();var r=m.get(t._id);if(r)return g(t,e,r,n);h.get(t._id).onsuccess=function(o){r=en(o.target.result),m.set(t._id,r),g(t,e,r,n)}}(nn(n),e[c],(function(n,a){i[c]=n,o[c]=a,++s===e.length&&function(){for(var e=[],n=0,s=o.length;n<s&&v!==u;n++){var a=o[n];if(a){var c=i[n];e.push(f(c,a))}}Promise.all(e).then((function(e){for(var n=0,r=e.length;n<r;n++)e[n]&&t.onChange(e[n])})).catch(t.complete),v!==u&&r.continue()}()}))}))}function f(e,n){var r=t.processChange(n,e,t);c=r.seq=e.seq;var o=y(r);return"object"===typeof o?Promise.reject(o):o?(v++,t.return_docs&&d.push(r),t.attachments&&t.include_docs?new Promise((function(e){on(n,t,l,(function(){sn([r],t.binary).then((function(){e(r)}))}))})):Promise.resolve(r)):Promise.resolve()}}))}var mn,gn=new o,bn=new o;function wn(t,e){var n=this;!function(t,e,n){dn.push((function(){t((function(t,r){!function(t,e,n,r){try{t(e,n)}catch(e){r.emit("error",e)}}(e,t,r,n),pn=!1,s()((function(){vn()}))}))})),vn()}((function(e){!function(t,e,n){var r=e.name,o=null;function i(t){var e=t.createObjectStore(Ve,{keyPath:"id"});t.createObjectStore(We,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),t.createObjectStore(He,{keyPath:"digest"}),t.createObjectStore(Ye,{keyPath:"id",autoIncrement:!1}),t.createObjectStore(Qe),e.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),t.createObjectStore(Ge,{keyPath:"_id"});var n=t.createObjectStore(Ke,{autoIncrement:!0});n.createIndex("seq","seq"),n.createIndex("digestSeq","digestSeq",{unique:!0})}function a(t,e){var n=t.objectStore(Ve);n.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),n.openCursor().onsuccess=function(t){var r=t.target.result;if(r){var o=r.value,i=Ht(o);o.deletedOrLocal=i?"1":"0",n.put(o),r.continue()}else e()}}function c(t){t.createObjectStore(Ge,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function u(t,e){var n=t.objectStore(Ge),r=t.objectStore(Ve),o=t.objectStore(We);r.openCursor().onsuccess=function(t){var i=t.target.result;if(i){var s=i.value,a=s.id,c=Kt(a),u=jt(s);if(c){var l=a+"::"+u,f=a+"::",h=a+"::~",p=o.index("_doc_id_rev"),d=IDBKeyRange.bound(f,h,!1,!1),v=p.openCursor(d);v.onsuccess=function(t){if(v=t.target.result){var e=v.value;e._doc_id_rev===l&&n.put(e),o.delete(v.primaryKey),v.continue()}else r.delete(i.primaryKey),i.continue()}}else i.continue()}else e&&e()}}function l(t){var e=t.createObjectStore(Ke,{autoIncrement:!0});e.createIndex("seq","seq"),e.createIndex("digestSeq","digestSeq",{unique:!0})}function f(t,e){var n=t.objectStore(We),r=t.objectStore(He),o=t.objectStore(Ke);r.count().onsuccess=function(t){if(!t.target.result)return e();n.openCursor().onsuccess=function(t){var n=t.target.result;if(!n)return e();for(var r=n.value,i=n.primaryKey,s=Object.keys(r._attachments||{}),a={},c=0;c<s.length;c++){a[r._attachments[s[c]].digest]=!0}var u=Object.keys(a);for(c=0;c<u.length;c++){var l=u[c];o.put({seq:i,digestSeq:l+"::"+i})}n.continue()}}}function h(t){function e(t){return t.data?en(t):(t.deleted="1"===t.deletedOrLocal,t)}var n=t.objectStore(We),r=t.objectStore(Ve);r.openCursor().onsuccess=function(t){var o=t.target.result;if(o){var i=e(o.value);if(i.winningRev=i.winningRev||jt(i),i.seq)return a();s()}function s(){var t=i.id+"::",e=i.id+"::\uffff",r=n.index("_doc_id_rev").openCursor(IDBKeyRange.bound(t,e)),o=0;r.onsuccess=function(t){var e=t.target.result;if(!e)return i.seq=o,a();var n=e.primaryKey;n>o&&(o=n),e.continue()}}function a(){var t=tn(i,i.winningRev,i.deleted);r.put(t).onsuccess=function(){o.continue()}}}}t._meta=null,t._remote=!1,t.type=function(){return"idb"},t._id=_((function(e){e(null,t._meta.instanceId)})),t._bulkDocs=function(n,r,i){ln(e,n,r,t,o,i)},t._get=function(t,e,n){var r,i,s,a=e.ctx;if(!a){var c=cn(o,[Ve,We,He],"readonly");if(c.error)return n(c.error);a=c.txn}function u(){n(s,{doc:r,metadata:i,ctx:a})}a.objectStore(Ve).get(t).onsuccess=function(t){if(!(i=en(t.target.result)))return s=nt(q,"missing"),u();var n;if(e.rev)n=e.latest?function(t,e){for(var n,r=e.rev_tree.slice();n=r.pop();){var o=n.pos,i=n.ids,s=i[0],a=i[1],c=i[2],u=0===c.length,l=n.history?n.history.slice():[];if(l.push({id:s,pos:o,opts:a}),u)for(var f=0,h=l.length;f<h;f++){var p=l[f];if(p.pos+"-"+p.id===t)return o+"-"+s}for(var d=0,v=c.length;d<v;d++)r.push({pos:o+1,ids:c[d],history:l})}throw new Error("Unable to resolve latest revision for id "+e.id+", rev "+t)}(e.rev,i):e.rev;else if(n=i.winningRev,Ht(i))return s=nt(q,"deleted"),u();var o=a.objectStore(We),c=i.id+"::"+n;o.index("_doc_id_rev").get(c).onsuccess=function(t){if((r=t.target.result)&&(r=nn(r)),!r)return s=nt(q,"missing"),u();u()}}},t._getAttachment=function(t,e,n,r,i){var s;if(r.ctx)s=r.ctx;else{var a=cn(o,[Ve,We,He],"readonly");if(a.error)return i(a.error);s=a.txn}var c=n.digest,u=n.content_type;s.objectStore(He).get(c).onsuccess=function(t){rn(t.target.result.body,u,r.binary,(function(t){i(null,t)}))}},t._info=function(e){var n,r,i=cn(o,[Ye,We],"readonly");if(i.error)return e(i.error);var s=i.txn;s.objectStore(Ye).get(Ye).onsuccess=function(t){r=t.target.result.docCount},s.objectStore(We).openCursor(null,"prev").onsuccess=function(t){var e=t.target.result;n=e?e.key:0},s.oncomplete=function(){e(null,{doc_count:r,update_seq:n,idb_attachment_format:t._meta.blobSupport?"binary":"base64"})}},t._allDocs=function(t,e){hn(t,o,e)},t._changes=function(e){return yn(e,t,r,o)},t._close=function(t){o.close(),gn.delete(r),t()},t._getRevisionTree=function(t,e){var n=cn(o,[Ve],"readonly");if(n.error)return e(n.error);n.txn.objectStore(Ve).get(t).onsuccess=function(t){var n=en(t.target.result);n?e(null,n.rev_tree):e(nt(q))}},t._doCompaction=function(t,e,n){var r=cn(o,[Ve,We,He,Ke],"readwrite");if(r.error)return n(r.error);var i=r.txn;i.objectStore(Ve).get(t).onsuccess=function(n){var r=en(n.target.result);Dt(r.rev_tree,(function(t,n,r,o,i){var s=n+"-"+r;-1!==e.indexOf(s)&&(i.status="missing")})),an(e,t,i);var o=r.winningRev,s=r.deleted;i.objectStore(Ve).put(tn(r,o,s))},i.onabort=Ze(n),i.oncomplete=function(){n()}},t._getLocal=function(t,e){var n=cn(o,[Ge],"readonly");if(n.error)return e(n.error);var r=n.txn.objectStore(Ge).get(t);r.onerror=Ze(e),r.onsuccess=function(t){var n=t.target.result;n?(delete n._doc_id_rev,e(null,n)):e(nt(q))}},t._putLocal=function(t,e,n){"function"===typeof e&&(n=e,e={}),delete t._revisions;var r=t._rev,i=t._id;t._rev=r?"0-"+(parseInt(r.split("-")[1],10)+1):"0-1";var s,a=e.ctx;if(!a){var c=cn(o,[Ge],"readwrite");if(c.error)return n(c.error);(a=c.txn).onerror=Ze(n),a.oncomplete=function(){s&&n(null,s)}}var u,l=a.objectStore(Ge);r?(u=l.get(i)).onsuccess=function(o){var i=o.target.result;i&&i._rev===r?l.put(t).onsuccess=function(){s={ok:!0,id:t._id,rev:t._rev},e.ctx&&n(null,s)}:n(nt(J))}:((u=l.add(t)).onerror=function(t){n(nt(J)),t.preventDefault(),t.stopPropagation()},u.onsuccess=function(){s={ok:!0,id:t._id,rev:t._rev},e.ctx&&n(null,s)})},t._removeLocal=function(t,e,n){"function"===typeof e&&(n=e,e={});var r,i=e.ctx;if(!i){var s=cn(o,[Ge],"readwrite");if(s.error)return n(s.error);(i=s.txn).oncomplete=function(){r&&n(null,r)}}var a=t._id,c=i.objectStore(Ge),u=c.get(a);u.onerror=Ze(n),u.onsuccess=function(o){var i=o.target.result;i&&i._rev===t._rev?(c.delete(a),r={ok:!0,id:a,rev:"0-0"},e.ctx&&n(null,r)):n(nt(q))}},t._destroy=function(t,e){un.removeAllListeners(r);var n=bn.get(r);n&&n.result&&(n.result.close(),gn.delete(r));var o=indexedDB.deleteDatabase(r);o.onsuccess=function(){bn.delete(r),D()&&r in localStorage&&delete localStorage[r],e(null,{ok:!0})},o.onerror=Ze(e)};var p=gn.get(r);if(p)return o=p.idb,t._meta=p.global,s()((function(){n(null,t)}));var d=indexedDB.open(r,5);bn.set(r,d),d.onupgradeneeded=function(t){var e=t.target.result;if(t.oldVersion<1)return i(e);var n=t.currentTarget.transaction;t.oldVersion<3&&c(e),t.oldVersion<4&&l(e);var r=[a,u,f,h],o=t.oldVersion;function s(){var t=r[o-1];o++,t&&t(n,s)}s()},d.onsuccess=function(e){(o=e.target.result).onversionchange=function(){o.close(),gn.delete(r)},o.onabort=function(t){P("error","Database has a global failure",t.target.error),o.close(),gn.delete(r)};var i,s,a,c,u=o.transaction([Ye,Qe,Ve],"readwrite"),l=!1;function f(){"undefined"!==typeof a&&l&&(t._meta={name:r,instanceId:c,blobSupport:a},gn.set(r,{idb:o,global:t._meta}),n(null,t))}function h(){if("undefined"!==typeof s&&"undefined"!==typeof i){var t=r+"_id";t in i?c=i[t]:i[t]=c=It(),i.docCount=s,u.objectStore(Ye).put(i)}}u.objectStore(Ye).get(Ye).onsuccess=function(t){i=t.target.result||{id:Ye},h()},function(t,e){t.objectStore(Ve).index("deletedOrLocal").count(IDBKeyRange.only("0")).onsuccess=function(t){e(t.target.result)}}(u,(function(t){s=t,h()})),mn||(mn=function(t){return new Promise((function(e){var n=bt([""]),r=t.objectStore(Qe).put(n,"key");r.onsuccess=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);e(n||!t||parseInt(t[1],10)>=43)},r.onerror=t.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)}})).catch((function(){return!1}))}(u)),mn.then((function(t){a=t,f()})),u.oncomplete=function(){l=!0,f()},u.onabort=Ze(n)},d.onerror=function(t){var e=t.target.error&&t.target.error.message;e?-1!==e.indexOf("stored database is a higher version")&&(e=new Error('This DB was created with the newer "indexeddb" adapter, but you are trying to open it with the older "idb" adapter')):e="Failed to open indexedDB, are you in private browsing mode?",P("error",e),n(nt(Z,e))}}(n,t,e)}),e,n.constructor)}wn.valid=function(){try{return"undefined"!==typeof indexedDB&&"undefined"!==typeof IDBKeyRange}catch(br){return!1}};var kn=5e3,xn={};function Sn(t){var e=t.doc||t.ok,n=e&&e._attachments;n&&Object.keys(n).forEach((function(t){var e=n[t];e.data=xt(e.data,e.content_type)}))}function On(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function Cn(t){return t._attachments&&Object.keys(t._attachments)?Promise.all(Object.keys(t._attachments).map((function(e){var n=t._attachments[e];if(n.data&&"string"!==typeof n.data)return new Promise((function(t){Ct(n.data,t)})).then((function(t){n.data=t}))}))):Promise.resolve()}function En(t,e){if(function(t){if(!t.prefix)return!1;var e=dt(t.prefix).protocol;return"http"===e||"https"===e}(e)){var n=e.name.substr(e.prefix.length);t=e.prefix.replace(/\/?$/,"/")+encodeURIComponent(n)}var r=dt(t);(r.user||r.password)&&(r.auth={username:r.user,password:r.password});var o=r.path.replace(/(^\/|\/$)/g,"").split("/");return r.db=o.pop(),-1===r.db.indexOf("%")&&(r.db=encodeURIComponent(r.db)),r.path=o.join("/"),r}function _n(t,e){return Mn(t,t.db+"/"+e)}function Mn(t,e){var n=t.path?"/":"";return t.protocol+"://"+t.host+(t.port?":"+t.port:"")+"/"+t.path+n+e}function Tn(t){return"?"+Object.keys(t).map((function(e){return e+"="+encodeURIComponent(t[e])})).join("&")}function Nn(e,n){var r=this,o=En(e.name,e),i=_n(o,"");e=C(e);var a,c=function(t,n){if((n=n||{}).headers=n.headers||new se,n.credentials="include",e.auth||o.auth){var r=e.auth||o.auth,i=r.username+":"+r.password,s=gt(unescape(encodeURIComponent(i)));n.headers.set("Authorization","Basic "+s)}var a=e.headers||{};return Object.keys(a).forEach((function(t){n.headers.append(t,a[t])})),function(t){var e="undefined"!==typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",n=-1!==e.indexOf("msie"),r=-1!==e.indexOf("trident"),o=-1!==e.indexOf("edge"),i=!("method"in t)||"GET"===t.method;return(n||r||o)&&i}(n)&&(t+=(-1===t.indexOf("?")?"?":"&")+"_nonce="+Date.now()),(e.fetch||ie)(t,n)};function u(t,e){return M(t,p()((function(t){f().then((function(){return e.apply(this,t)})).catch((function(e){t.pop()(e)}))}))).bind(r)}function l(t,e,n){var r={};return(e=e||{}).headers=e.headers||new se,e.headers.get("Content-Type")||e.headers.set("Content-Type","application/json"),e.headers.get("Accept")||e.headers.set("Accept","application/json"),c(t,e).then((function(t){return r.ok=t.ok,r.status=t.status,t.json()})).then((function(t){if(r.data=t,!r.ok){r.data.status=r.status;var e=rt(r.data);if(n)return n(e);throw e}if(Array.isArray(r.data)&&(r.data=r.data.map((function(t){return t.error||t.missing?rt(t):t}))),!n)return r;n(null,r.data)}))}function f(){return e.skip_setup?Promise.resolve():a||((a=l(i).catch((function(t){return t&&t.status&&404===t.status?(F(404,"PouchDB is just detecting if the remote exists."),l(i,{method:"PUT"})):Promise.reject(t)})).catch((function(t){return!(!t||!t.status||412!==t.status)||Promise.reject(t)}))).catch((function(){a=null})),a)}function h(t){return t.split("/").map(encodeURIComponent).join("/")}s()((function(){n(null,r)})),r._remote=!0,r.type=function(){return"http"},r.id=u("id",(function(t){c(Mn(o,"")).then((function(t){return t.json()})).catch((function(){return{}})).then((function(e){var n=e&&e.uuid?e.uuid+o.db:_n(o,"");t(null,n)}))})),r.compact=u("compact",(function(t,e){"function"===typeof t&&(e=t,t={}),t=C(t),l(_n(o,"_compact"),{method:"POST"}).then((function(){!function n(){r.info((function(r,o){o&&!o.compact_running?e(null,{ok:!0}):setTimeout(n,t.interval||200)}))}()}))})),r.bulkGet=M("bulkGet",(function(t,e){var n=this;function r(e){var n={};t.revs&&(n.revs=!0),t.attachments&&(n.attachments=!0),t.latest&&(n.latest=!0),l(_n(o,"_bulk_get"+Tn(n)),{method:"POST",body:JSON.stringify({docs:t.docs})}).then((function(n){t.attachments&&t.binary&&n.data.results.forEach((function(t){t.docs.forEach(Sn)})),e(null,n.data)})).catch(e)}function i(){var r=Math.ceil(t.docs.length/50),o=0,i=new Array(r);function s(t){return function(n,s){i[t]=s.results,++o===r&&e(null,{results:it(i)})}}for(var a=0;a<r;a++){var c=T(t,["revs","attachments","binary","latest"]);c.docs=t.docs.slice(50*a,Math.min(t.docs.length,50*(a+1))),j(n,c,s(a))}}var s=Mn(o,""),a=xn[s];"boolean"!==typeof a?r((function(t,n){t?(xn[s]=!1,F(t.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),i()):(xn[s]=!0,e(null,n))})):a?r(e):i()})),r._info=function(t){f().then((function(){return c(_n(o,""))})).then((function(t){return t.json()})).then((function(e){e.host=_n(o,""),t(null,e)})).catch(t)},r.fetch=function(t,e){return f().then((function(){var n="/"===t.substring(0,1)?Mn(o,t.substring(1)):_n(o,t);return c(n,e)}))},r.get=u("get",(function(t,e,n){"function"===typeof e&&(n=e,e={});var r={};function i(t){var n=t._attachments,r=n&&Object.keys(n);if(n&&r.length)return function(t,e){return new Promise((function(n,r){var o,i=0,s=0,a=0,c=t.length;function u(){++a===c?o?r(o):n():h()}function l(){i--,u()}function f(t){i--,o=o||t,u()}function h(){for(;i<e&&s<c;)i++,t[s++]().then(l,f)}h()}))}(r.map((function(r){return function(){return function(r){var i=n[r],s=On(t._id)+"/"+h(r)+"?rev="+t._rev;return c(_n(o,s)).then((function(t){return"buffer"in t?t.buffer():t.blob()})).then((function(t){if(e.binary){var n=Object.getOwnPropertyDescriptor(t.__proto__,"type");return n&&!n.set||(t.type=i.content_type),t}return new Promise((function(e){Ct(t,e)}))})).then((function(t){delete i.stub,delete i.length,i.data=t}))}(r)}})),5)}(e=C(e)).revs&&(r.revs=!0),e.revs_info&&(r.revs_info=!0),e.latest&&(r.latest=!0),e.open_revs&&("all"!==e.open_revs&&(e.open_revs=JSON.stringify(e.open_revs)),r.open_revs=e.open_revs),e.rev&&(r.rev=e.rev),e.conflicts&&(r.conflicts=e.conflicts),e.update_seq&&(r.update_seq=e.update_seq),t=On(t),l(_n(o,t+Tn(r))).then((function(t){return Promise.resolve().then((function(){if(e.attachments)return n=t.data,Array.isArray(n)?Promise.all(n.map((function(t){if(t.ok)return i(t.ok)}))):i(n);var n})).then((function(){n(null,t.data)}))})).catch((function(e){e.docId=t,n(e)}))})),r.remove=u("remove",(function(t,e,n,r){var i;"string"===typeof e?(i={_id:t,_rev:e},"function"===typeof n&&(r=n,n={})):(i=t,"function"===typeof e?(r=e,n={}):(r=n,n=e));var s=i._rev||n.rev;l(_n(o,On(i._id))+"?rev="+s,{method:"DELETE"},r).catch(r)})),r.getAttachment=u("getAttachment",(function(e,n,r,i){"function"===typeof r&&(i=r,r={});var s,a=r.rev?"?rev="+r.rev:"",u=_n(o,On(e))+"/"+h(n)+a;c(u,{method:"GET"}).then((function(e){if(s=e.headers.get("content-type"),e.ok)return"undefined"===typeof t||t.browser||"function"!==typeof e.buffer?e.blob():e.buffer();throw e})).then((function(e){"undefined"===typeof t||t.browser||(e.type=s),i(null,e)})).catch((function(t){i(t)}))})),r.removeAttachment=u("removeAttachment",(function(t,e,n,r){l(_n(o,On(t)+"/"+h(e))+"?rev="+n,{method:"DELETE"},r).catch(r)})),r.putAttachment=u("putAttachment",(function(t,e,n,r,i,s){"function"===typeof i&&(s=i,i=r,r=n,n=null);var a=On(t)+"/"+h(e),c=_n(o,a);if(n&&(c+="?rev="+n),"string"===typeof r){var u;try{u=mt(r)}catch(f){return s(nt(K,"Attachment is not a valid base64 string"))}r=u?kt(u,i):""}l(c,{headers:new se({"Content-Type":i}),method:"PUT",body:r},s).catch(s)})),r._bulkDocs=function(t,e,n){t.new_edits=e.new_edits,f().then((function(){return Promise.all(t.docs.map(Cn))})).then((function(){return l(_n(o,"_bulk_docs"),{method:"POST",body:JSON.stringify(t)},n)})).catch(n)},r._put=function(t,e,n){f().then((function(){return Cn(t)})).then((function(){return l(_n(o,On(t._id)),{method:"PUT",body:JSON.stringify(t)})})).then((function(t){n(null,t.data)})).catch((function(e){e.docId=t&&t._id,n(e)}))},r.allDocs=u("allDocs",(function(t,e){"function"===typeof t&&(e=t,t={});var n,r={},i="GET";(t=C(t)).conflicts&&(r.conflicts=!0),t.update_seq&&(r.update_seq=!0),t.descending&&(r.descending=!0),t.include_docs&&(r.include_docs=!0),t.attachments&&(r.attachments=!0),t.key&&(r.key=JSON.stringify(t.key)),t.start_key&&(t.startkey=t.start_key),t.startkey&&(r.startkey=JSON.stringify(t.startkey)),t.end_key&&(t.endkey=t.end_key),t.endkey&&(r.endkey=JSON.stringify(t.endkey)),"undefined"!==typeof t.inclusive_end&&(r.inclusive_end=!!t.inclusive_end),"undefined"!==typeof t.limit&&(r.limit=t.limit),"undefined"!==typeof t.skip&&(r.skip=t.skip);var s=Tn(r);"undefined"!==typeof t.keys&&(i="POST",n={keys:t.keys}),l(_n(o,"_all_docs"+s),{method:i,body:JSON.stringify(n)}).then((function(n){t.include_docs&&t.attachments&&t.binary&&n.data.rows.forEach(Sn),e(null,n.data)})).catch(e)})),r._changes=function(t){var e="batch_size"in t?t.batch_size:25;(t=C(t)).continuous&&!("heartbeat"in t)&&(t.heartbeat=1e4);var n="timeout"in t?t.timeout:3e4;"timeout"in t&&t.timeout&&n-t.timeout<kn&&(n=t.timeout+kn),"heartbeat"in t&&t.heartbeat&&n-t.heartbeat<kn&&(n=t.heartbeat+kn);var r={};"timeout"in t&&t.timeout&&(r.timeout=t.timeout);var i="undefined"!==typeof t.limit&&t.limit,a=i;if(t.style&&(r.style=t.style),(t.include_docs||t.filter&&"function"===typeof t.filter)&&(r.include_docs=!0),t.attachments&&(r.attachments=!0),t.continuous&&(r.feed="longpoll"),t.seq_interval&&(r.seq_interval=t.seq_interval),t.conflicts&&(r.conflicts=!0),t.descending&&(r.descending=!0),t.update_seq&&(r.update_seq=!0),"heartbeat"in t&&t.heartbeat&&(r.heartbeat=t.heartbeat),t.filter&&"string"===typeof t.filter&&(r.filter=t.filter),t.view&&"string"===typeof t.view&&(r.filter="_view",r.view=t.view),t.query_params&&"object"===typeof t.query_params)for(var c in t.query_params)t.query_params.hasOwnProperty(c)&&(r[c]=t.query_params[c]);var u,h="GET";t.doc_ids?(r.filter="_doc_ids",h="POST",u={doc_ids:t.doc_ids}):t.selector&&(r.filter="_selector",h="POST",u={selector:t.selector});var p,d=new oe,v=function(n,s){if(!t.aborted){r.since=n,"object"===typeof r.since&&(r.since=JSON.stringify(r.since)),t.descending?i&&(r.limit=a):r.limit=!i||a>e?e:a;var c=_n(o,"_changes"+Tn(r)),v={signal:d.signal,method:h,body:JSON.stringify(u)};p=n,t.aborted||f().then((function(){return l(c,v,s)})).catch(s)}},y={results:[]};return v(t.since||0,(function n(r,o){if(!t.aborted){var c=0;if(o&&o.results){c=o.results.length,y.last_seq=o.last_seq;var u=null,l=null;"number"===typeof o.pending&&(u=o.pending),"string"!==typeof y.last_seq&&"number"!==typeof y.last_seq||(l=y.last_seq);t.query_params,o.results=o.results.filter((function(e){a--;var n=ot(t)(e);return n&&(t.include_docs&&t.attachments&&t.binary&&Sn(e),t.return_docs&&y.results.push(e),t.onChange(e,u,l)),n}))}else if(r)return t.aborted=!0,void t.complete(r);o&&o.last_seq&&(p=o.last_seq);var f=i&&a<=0||o&&c<e||t.descending;(!t.continuous||i&&a<=0)&&f?t.complete(null,y):s()((function(){v(p,n)}))}})),{cancel:function(){t.aborted=!0,d.abort()}}},r.revsDiff=u("revsDiff",(function(t,e,n){"function"===typeof e&&(n=e,e={}),l(_n(o,"_revs_diff"),{method:"POST",body:JSON.stringify(t)},n).catch(n)})),r._close=function(t){t()},r._destroy=function(t,e){l(_n(o,""),{method:"DELETE"}).then((function(t){e(null,t)})).catch((function(t){404===t.status?e(null,{ok:!0}):e(t)}))}}function An(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,An)}catch(br){}}function In(t){this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,In)}catch(br){}}function jn(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,jn)}catch(br){}}function Dn(t,e){return e&&t.then((function(t){s()((function(){e(null,t)}))}),(function(t){s()((function(){e(t)}))})),t}function Rn(t,e){return function(){var n=arguments,r=this;return t.add((function(){return e.apply(r,n)}))}}function Pn(t){var e=new r(t),n=new Array(e.size),o=-1;return e.forEach((function(t){n[++o]=t})),n}function zn(t){var e=new Array(t.size),n=-1;return t.forEach((function(t,r){e[++n]=r})),e}function Fn(t){return new jn("builtin "+t+" function requires map values to be numbers or number arrays")}function Bn(t){for(var e=0,n=0,r=t.length;n<r;n++){var o=t[n];if("number"!==typeof o){if(!Array.isArray(o))throw Fn("_sum");e="number"===typeof e?[e]:e;for(var i=0,s=o.length;i<s;i++){var a=o[i];if("number"!==typeof a)throw Fn("_sum");"undefined"===typeof e[i]?e.push(a):e[i]+=a}}else"number"===typeof e?e+=o:e[0]+=o}return e}Nn.valid=function(){return!0},v()(An,Error),v()(In,Error),v()(jn,Error);var Ln=P.bind(null,"log"),$n=Array.isArray,qn=JSON.parse;function Jn(t,e){return vt("return ("+t.replace(/;\s*$/,"")+");",{emit:e,sum:Bn,log:Ln,isArray:$n,toJSON:qn})}function Un(){this.promise=new Promise((function(t){t()}))}function Vn(t){if(!t)return"undefined";switch(typeof t){case"function":case"string":return t.toString();default:return JSON.stringify(t)}}function Wn(t,e,n,r,o,i){var s,a=function(t,e){return Vn(t)+Vn(e)+"undefined"}(n,r);if(!o&&(s=t._cachedViews=t._cachedViews||{})[a])return s[a];var c=t.info().then((function(c){var u=c.db_name+"-mrview-"+(o?"temp":Nt(a));return yt(t,"_local/"+i,(function(t){t.views=t.views||{};var n=e;-1===n.indexOf("/")&&(n=e+"/"+e);var r=t.views[n]=t.views[n]||{};if(!r[u])return r[u]=!0,t})).then((function(){return t.registerDependentDatabase(u).then((function(e){var o=e.db;o.auto_compaction=!0;var i={name:u,db:o,sourceDB:t,adapter:t.adapter,mapFun:n,reduceFun:r};return i.db.get("_local/lastSeq").catch((function(t){if(404!==t.status)throw t})).then((function(t){return i.seq=t?t.seq:0,s&&i.db.once("destroyed",(function(){delete s[a]})),i}))}))}))}));return s&&(s[a]=c),c}Un.prototype.add=function(t){return this.promise=this.promise.catch((function(){})).then((function(){return t()})),this.promise},Un.prototype.finish=function(){return this.promise};var Hn={},Kn=new Un;function Yn(t){return-1===t.indexOf("/")?[t,t]:t.split("/")}function Gn(t,e){try{t.emit("error",e)}catch(n){P("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),P("error",e)}}var Qn=function(t,e){return Bn(e)},Xn=function(t,e){return e.length},Zn=function(t,e){return{sum:Bn(e),min:Math.min.apply(null,e),max:Math.max.apply(null,e),count:e.length,sumsqr:function(t){for(var e=0,n=0,r=t.length;n<r;n++){var o=t[n];e+=o*o}return e}(e)}};var tr=function(t,e,n,i){function a(t,e,n){try{e(n)}catch(br){Gn(t,br)}}function c(t,e,n,r,o){try{return{output:e(n,r,o)}}catch(br){return Gn(t,br),{error:br}}}function u(t,e){var n=ge(t.key,e.key);return 0!==n?n:ge(t.value,e.value)}function l(t,e,n){return n=n||0,"number"===typeof e?t.slice(n,e+n):n>0?t.slice(n):t}function f(t){var e=t.value;return e&&"object"===typeof e&&e._id||t.id}function h(t){return function(e){return t.include_docs&&t.attachments&&t.binary&&function(t){t.rows.forEach((function(t){var e=t.doc&&t.doc._attachments;e&&Object.keys(e).forEach((function(t){var n=e[t];e[t].data=xt(n.data,n.content_type)}))}))}(e),e}}function d(t,e,n,r){var o=e[t];"undefined"!==typeof o&&(r&&(o=encodeURIComponent(JSON.stringify(o))),n.push(t+"="+o))}function v(t){if("undefined"!==typeof t){var e=Number(t);return isNaN(e)||e!==parseInt(t,10)?t:e}}function y(t,e){var n=t.descending?"endkey":"startkey",r=t.descending?"startkey":"endkey";if("undefined"!==typeof t[n]&&"undefined"!==typeof t[r]&&ge(t[n],t[r])>0)throw new An("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(e.reduce&&!1!==t.reduce){if(t.include_docs)throw new An("{include_docs:true} is invalid for reduce");if(t.keys&&t.keys.length>1&&!t.group&&!t.group_level)throw new An("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach((function(e){var n=function(t){if(t){if("number"!==typeof t)return new An('Invalid value for integer: "'+t+'"');if(t<0)return new An('Invalid value for positive integer: "'+t+'"')}}(t[e]);if(n)throw n}))}function m(t){return function(e){if(404===e.status)return t;throw e}}function g(t,e,n){var o="_local/doc_"+t,i={_id:o,keys:[]},s=n.get(t),a=s[0];return(function(t){return 1===t.length&&/^1-/.test(t[0].rev)}(s[1])?Promise.resolve(i):e.db.get(o).catch(m(i))).then((function(t){return function(t){return t.keys.length?e.db.allDocs({keys:t.keys,include_docs:!0}):Promise.resolve({rows:[]})}(t).then((function(e){return function(t,e){for(var n=[],o=new r,i=0,s=e.rows.length;i<s;i++){var c=e.rows[i].doc;if(c&&(n.push(c),o.add(c._id),c._deleted=!a.has(c._id),!c._deleted)){var u=a.get(c._id);"value"in u&&(c.value=u.value)}}var l=zn(a);return l.forEach((function(t){if(!o.has(t)){var e={_id:t},r=a.get(t);"value"in r&&(e.value=r.value),n.push(e)}})),t.keys=Pn(l.concat(t.keys)),n.push(t),n}(t,e)}))}))}function b(t){var e="string"===typeof t?t:t.name,n=Hn[e];return n||(n=Hn[e]=new Un),n}function w(t){return Rn(b(t),(function(){return function(t){var n,r;function i(t,e){var o={id:r._id,key:be(t)};"undefined"!==typeof e&&null!==e&&(o.value=be(e)),n.push(o)}var s=e(t.mapFun,i),c=t.seq||0;function l(e,n){return function(){return function(t,e,n){var r="_local/lastSeq";return t.db.get(r).catch(m({_id:r,seq:0})).then((function(r){var o=zn(e);return Promise.all(o.map((function(n){return g(n,t,e)}))).then((function(e){var o=it(e);return r.seq=n,o.push(r),t.db.bulkDocs({docs:o})}))}))}(t,e,n)}}var f=new Un;function h(){return t.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:c,limit:50}).then(p)}function p(t){var e=t.results;if(e.length){var n=d(e);if(f.add(l(n,c)),!(e.length<50))return h()}}function d(e){for(var i=new o,l=0,f=e.length;l<f;l++){var h=e[l];if("_"!==h.doc._id[0]){n=[],(r=h.doc)._deleted||a(t.sourceDB,s,r),n.sort(u);var p=v(n);i.set(h.doc._id,[p,h.changes])}c=h.seq}return i}function v(t){for(var e,n=new o,r=0,i=t.length;r<i;r++){var s=t[r],a=[s.key,s.id];r>0&&0===ge(s.key,e)&&a.push(r),n.set(ke(a),s),e=s.key}return n}return h().then((function(){return f.finish()})).then((function(){t.seq=c}))}(t)}))()}function k(t,e){return Rn(b(t),(function(){return function(t,e){var r,i=t.reduceFun&&!1!==e.reduce,s=e.skip||0;"undefined"===typeof e.keys||e.keys.length||(e.limit=0,delete e.keys);function a(e){return e.include_docs=!0,t.db.allDocs(e).then((function(t){return r=t.total_rows,t.rows.map((function(t){if("value"in t.doc&&"object"===typeof t.doc.value&&null!==t.doc.value){var e=Object.keys(t.doc.value).sort(),n=["id","key","value"];if(!(e<n||e>n))return t.doc.value}var r=function(t){for(var e=[],n=[],r=0;;){var o=t[r++];if("\0"!==o)switch(o){case"1":e.push(null);break;case"2":e.push("1"===t[r]),r++;break;case"3":var i=xe(t,r);e.push(i.num),r+=i.length;break;case"4":for(var s="";;){var a=t[r];if("\0"===a)break;s+=a,r++}s=s.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"\x01").replace(/\u0002\u0002/g,"\x02"),e.push(s);break;case"5":var c={element:[],index:e.length};e.push(c.element),n.push(c);break;case"6":var u={element:{},index:e.length};e.push(u.element),n.push(u);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+o)}else{if(1===e.length)return e.pop();Se(e,n)}}}(t.doc._id);return{key:r[0],id:r[1],value:"value"in t.doc?t.doc.value:null}}))}))}function u(a){var u;if(u=i?function(t,e,r){0===r.group_level&&delete r.group_level;var o=r.group||r.group_level,i=n(t.reduceFun),s=[],a=isNaN(r.group_level)?Number.POSITIVE_INFINITY:r.group_level;e.forEach((function(t){var e=s[s.length-1],n=o?t.key:null;if(o&&Array.isArray(n)&&(n=n.slice(0,a)),e&&0===ge(e.groupKey,n))return e.keys.push([t.key,t.id]),void e.values.push(t.value);s.push({keys:[[t.key,t.id]],values:[t.value],groupKey:n})})),e=[];for(var u=0,f=s.length;u<f;u++){var h=s[u],p=c(t.sourceDB,i,h.keys,h.values,!1);if(p.error&&p.error instanceof jn)throw p.error;e.push({value:p.error?null:p.output,key:h.groupKey})}return{rows:l(e,r.limit,r.skip)}}(t,a,e):{total_rows:r,offset:s,rows:a},e.update_seq&&(u.update_seq=t.seq),e.include_docs){var h=Pn(a.map(f));return t.sourceDB.allDocs({keys:h,include_docs:!0,conflicts:e.conflicts,attachments:e.attachments,binary:e.binary}).then((function(t){var e=new o;return t.rows.forEach((function(t){e.set(t.id,t.doc)})),a.forEach((function(t){var n=f(t),r=e.get(n);r&&(t.doc=r)})),u}))}return u}if("undefined"!==typeof e.keys){var h=e.keys.map((function(t){var n={startkey:ke([t]),endkey:ke([t,{}])};return e.update_seq&&(n.update_seq=!0),a(n)}));return Promise.all(h).then(it).then(u)}var p,d,v={descending:e.descending};if(e.update_seq&&(v.update_seq=!0),"start_key"in e&&(p=e.start_key),"startkey"in e&&(p=e.startkey),"end_key"in e&&(d=e.end_key),"endkey"in e&&(d=e.endkey),"undefined"!==typeof p&&(v.startkey=e.descending?ke([p,{}]):ke([p])),"undefined"!==typeof d){var y=!1!==e.inclusive_end;e.descending&&(y=!y),v.endkey=ke(y?[d,{}]:[d])}if("undefined"!==typeof e.key){var m=ke([e.key]),g=ke([e.key,{}]);v.descending?(v.endkey=m,v.startkey=g):(v.startkey=m,v.endkey=g)}return i||("number"===typeof e.limit&&(v.limit=e.limit),v.skip=s),a(v).then(u)}(t,e)}))()}function x(e,n,r){if("function"===typeof e._query)return function(t,e,n){return new Promise((function(r,o){t._query(e,n,(function(t,e){if(t)return o(t);r(e)}))}))}(e,n,r);if(at(e))return function(t,e,n){var r,o,i,s=[],a="GET";if(d("reduce",n,s),d("include_docs",n,s),d("attachments",n,s),d("limit",n,s),d("descending",n,s),d("group",n,s),d("group_level",n,s),d("skip",n,s),d("stale",n,s),d("conflicts",n,s),d("startkey",n,s,!0),d("start_key",n,s,!0),d("endkey",n,s,!0),d("end_key",n,s,!0),d("inclusive_end",n,s),d("key",n,s,!0),d("update_seq",n,s),s=""===(s=s.join("&"))?"":"?"+s,"undefined"!==typeof n.keys){var c="keys="+encodeURIComponent(JSON.stringify(n.keys));c.length+s.length+1<=2e3?s+=("?"===s[0]?"&":"?")+c:(a="POST","string"===typeof e?r={keys:n.keys}:e.keys=n.keys)}if("string"===typeof e){var u=Yn(e);return t.fetch("_design/"+u[0]+"/_view/"+u[1]+s,{headers:new se({"Content-Type":"application/json"}),method:a,body:JSON.stringify(r)}).then((function(t){return o=t.ok,i=t.status,t.json()})).then((function(t){if(!o)throw t.status=i,rt(t);return t.rows.forEach((function(t){if(t.value&&t.value.error&&"builtin_reduce_error"===t.value.error)throw new Error(t.reason)})),t})).then(h(n))}return r=r||{},Object.keys(e).forEach((function(t){Array.isArray(e[t])?r[t]=e[t]:r[t]=e[t].toString()})),t.fetch("_temp_view"+s,{headers:new se({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(r)}).then((function(t){return o=t.ok,i=t.status,t.json()})).then((function(t){if(!o)throw t.status=i,rt(t);return t})).then(h(n))}(e,n,r);if("string"!==typeof n)return y(r,n),Kn.add((function(){return Wn(e,"temp_view/temp_view",n.map,n.reduce,!0,t).then((function(t){return e=w(t).then((function(){return k(t,r)})),n=function(){return t.db.destroy()},e.then((function(t){return n().then((function(){return t}))}),(function(t){return n().then((function(){throw t}))}));var e,n}))})),Kn.finish();var o=n,a=Yn(o),c=a[0],u=a[1];return e.get("_design/"+c).then((function(n){var a=n.views&&n.views[u];if(!a)throw new In("ddoc "+n._id+" has no view named "+u);return i(n,u),y(r,a),Wn(e,o,a.map,a.reduce,!1,t).then((function(t){return"ok"===r.stale||"update_after"===r.stale?("update_after"===r.stale&&s()((function(){w(t)})),k(t,r)):w(t).then((function(){return k(t,r)}))}))}))}var S;return{query:function(t,e,n){var r=this;"function"===typeof e&&(n=e,e={}),e=e?function(t){return t.group_level=v(t.group_level),t.limit=v(t.limit),t.skip=v(t.skip),t}(e):{},"function"===typeof t&&(t={map:t});var o=Promise.resolve().then((function(){return x(r,t,e)}));return Dn(o,n),o},viewCleanup:(S=function(){var e=this;return"function"===typeof e._viewCleanup?function(t){return new Promise((function(e,n){t._viewCleanup((function(t,r){if(t)return n(t);e(r)}))}))}(e):at(e)?function(t){return t.fetch("_view_cleanup",{headers:new se({"Content-Type":"application/json"}),method:"POST"}).then((function(t){return t.json()}))}(e):function(e){return e.get("_local/"+t).then((function(t){var n=new o;Object.keys(t.views).forEach((function(t){var e=Yn(t),o="_design/"+e[0],i=e[1],s=n.get(o);s||(s=new r,n.set(o,s)),s.add(i)}));var i={keys:zn(n),include_docs:!0};return e.allDocs(i).then((function(r){var o={};r.rows.forEach((function(e){var r=e.key.substring(8);n.get(e.key).forEach((function(n){var i=r+"/"+n;t.views[i]||(i=n);var s=Object.keys(t.views[i]),a=e.doc&&e.doc.views&&e.doc.views[n];s.forEach((function(t){o[t]=o[t]||a}))}))}));var i=Object.keys(o).filter((function(t){return!o[t]})).map((function(t){return Rn(b(t),(function(){return new e.constructor(t,e.__opts).destroy()}))()}));return Promise.all(i).then((function(){return{ok:!0}}))}))}),m({ok:!0}))}(e)},p()((function(t){var e=t.pop(),n=S.apply(this,t);return"function"===typeof e&&Dn(n,e),n})))}}("mrviews",(function(t,e){if("function"===typeof t&&2===t.length){var n=t;return function(t){return n(t,e)}}return Jn(t.toString(),e)}),(function(t){var e=t.toString(),n=function(t){if(/^_sum/.test(t))return Qn;if(/^_count/.test(t))return Xn;if(/^_stats/.test(t))return Zn;if(/^_/.test(t))throw new Error(t+" is not a supported reduce function.")}(e);return n||Jn(e)}),(function(t,e){var n=t.views&&t.views[e];if("string"!==typeof n.map)throw new In("ddoc "+t._id+" has no string view named "+e+", instead found object of type: "+typeof n.map)}));var er={query:function(t,e,n){return tr.query.call(this,t,e,n)},viewCleanup:function(t){return tr.viewCleanup.call(this,t)}};function nr(t){return/^1-/.test(t)}function rr(t,e){var n=Object.keys(e._attachments);return Promise.all(n.map((function(n){return t.getAttachment(e._id,n,{rev:e._rev})})))}function or(t,e,n,r){n=C(n);var o=[],i=!0;function s(e){return t.allDocs({keys:e,include_docs:!0,conflicts:!0}).then((function(t){if(r.cancelled)throw new Error("cancelled");t.rows.forEach((function(t){var e;t.deleted||!t.doc||!nr(t.value.rev)||(e=t.doc,e._attachments&&Object.keys(e._attachments).length>0)||function(t){return t._conflicts&&t._conflicts.length>0}(t.doc)||(t.doc._conflicts&&delete t.doc._conflicts,o.push(t.doc),delete n[t.id])}))}))}return Promise.resolve().then((function(){var t=Object.keys(n).filter((function(t){var e=n[t].missing;return 1===e.length&&nr(e[0])}));if(t.length>0)return s(t)})).then((function(){var s=function(t){var e=[];return Object.keys(t).forEach((function(n){t[n].missing.forEach((function(t){e.push({id:n,rev:t})}))})),{docs:e,revs:!0,latest:!0}}(n);if(s.docs.length)return t.bulkGet(s).then((function(n){if(r.cancelled)throw new Error("cancelled");return Promise.all(n.results.map((function(n){return Promise.all(n.docs.map((function(n){var r=n.ok;return n.error&&(i=!1),r&&r._attachments?function(t,e,n){var r=at(e)&&!at(t),o=Object.keys(n._attachments);return r?t.get(n._id).then((function(r){return Promise.all(o.map((function(o){return function(t,e,n){return!t._attachments||!t._attachments[n]||t._attachments[n].digest!==e._attachments[n].digest}(r,n,o)?e.getAttachment(n._id,o):t.getAttachment(r._id,o)})))})).catch((function(t){if(404!==t.status)throw t;return rr(e,n)})):rr(e,n)}(e,t,r).then((function(t){var e=Object.keys(r._attachments);return t.forEach((function(t,n){var o=r._attachments[e[n]];delete o.stub,delete o.length,o.data=t})),r})):r})))}))).then((function(t){o=o.concat(it(t).filter(Boolean))}))}))})).then((function(){return{ok:i,docs:o}}))}var ir="pouchdb";function sr(t,e,n,r,o){return t.get(e).catch((function(n){if(404===n.status)return"http"!==t.adapter&&"https"!==t.adapter||F(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:r,_id:e,history:[],replicator:ir,version:1};throw n})).then((function(i){if(!o.cancelled&&i.last_seq!==n)return i.history=(i.history||[]).filter((function(t){return t.session_id!==r})),i.history.unshift({last_seq:n,session_id:r}),i.history=i.history.slice(0,5),i.version=1,i.replicator=ir,i.session_id=r,i.last_seq=n,t.put(i).catch((function(i){if(409===i.status)return sr(t,e,n,r,o);throw i}))}))}function ar(t,e,n,r,o){this.src=t,this.target=e,this.id=n,this.returnValue=r,this.opts=o||{}}ar.prototype.writeCheckpoint=function(t,e){var n=this;return this.updateTarget(t,e).then((function(){return n.updateSource(t,e)}))},ar.prototype.updateTarget=function(t,e){return this.opts.writeTargetCheckpoint?sr(this.target,this.id,t,e,this.returnValue):Promise.resolve(!0)},ar.prototype.updateSource=function(t,e){if(this.opts.writeSourceCheckpoint){var n=this;return sr(this.src,this.id,t,e,this.returnValue).catch((function(t){if(fr(t))return n.opts.writeSourceCheckpoint=!1,!0;throw t}))}return Promise.resolve(!0)};var cr={undefined:function(t,e){return 0===ge(t.last_seq,e.last_seq)?e.last_seq:0},1:function(t,e){return function(t,e){if(t.session_id===e.session_id)return{last_seq:t.last_seq,history:t.history};return ur(t.history,e.history)}(e,t).last_seq}};function ur(t,e){var n=t[0],r=t.slice(1),o=e[0],i=e.slice(1);return n&&0!==e.length?lr(n.session_id,e)?{last_seq:n.last_seq,history:t}:lr(o.session_id,r)?{last_seq:o.last_seq,history:i}:ur(r,i):{last_seq:0,history:[]}}function lr(t,e){var n=e[0],r=e.slice(1);return!(!t||0===e.length)&&(t===n.session_id||lr(t,r))}function fr(t){return"number"===typeof t.status&&4===Math.floor(t.status/100)}ar.prototype.getCheckpoint=function(){var t=this;return t.opts&&t.opts.writeSourceCheckpoint&&!t.opts.writeTargetCheckpoint?t.src.get(t.id).then((function(t){return t.last_seq||0})).catch((function(t){if(404!==t.status)throw t;return 0})):t.target.get(t.id).then((function(e){return t.opts&&t.opts.writeTargetCheckpoint&&!t.opts.writeSourceCheckpoint?e.last_seq||0:t.src.get(t.id).then((function(t){return e.version!==t.version?0:(n=e.version?e.version.toString():"undefined")in cr?cr[n](e,t):0;var n}),(function(n){if(404===n.status&&e.last_seq)return t.src.put({_id:t.id,last_seq:0}).then((function(){return 0}),(function(n){return fr(n)?(t.opts.writeSourceCheckpoint=!1,e.last_seq):0}));throw n}))})).catch((function(t){if(404!==t.status)throw t;return 0}))};function hr(t,e,n){var r=n.doc_ids?n.doc_ids.sort(ge):"",o=n.filter?n.filter.toString():"",i="",s="",a="";return n.selector&&(a=JSON.stringify(n.selector)),n.filter&&n.query_params&&(i=JSON.stringify(function(t){return Object.keys(t).sort(ge).reduce((function(e,n){return e[n]=t[n],e}),{})}(n.query_params))),n.filter&&"_view"===n.filter&&(s=n.view.toString()),Promise.all([t.id(),e.id()]).then((function(t){var e=t[0]+t[1]+o+s+i+r+a;return new Promise((function(t){Tt(e,t)}))})).then((function(t){return"_local/"+(t=t.replace(/\//g,".").replace(/\+/g,"_"))}))}function pr(t,e,n,r,o){var i,a,c,u=[],l={seq:0,changes:[],docs:[]},f=!1,h=!1,p=!1,d=0,v=n.continuous||n.live||!1,y=n.batch_size||100,m=n.batches_limit||10,g=!1,b=n.doc_ids,w=n.selector,k=[],x=It();o=o||{ok:!0,start_time:(new Date).toISOString(),docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var S={};function O(){return c?Promise.resolve():hr(t,e,n).then((function(o){a=o;var i={};i=!1===n.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!1}:"source"===n.checkpoint?{writeSourceCheckpoint:!0,writeTargetCheckpoint:!1}:"target"===n.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!0}:{writeSourceCheckpoint:!0,writeTargetCheckpoint:!0},c=new ar(t,e,a,r,i)}))}function E(){if(k=[],0!==i.docs.length){var t=i.docs,s={timeout:n.timeout};return e.bulkDocs({docs:t,new_edits:!1},s).then((function(e){if(r.cancelled)throw I(),new Error("cancelled");var n=Object.create(null);e.forEach((function(t){t.error&&(n[t.id]=t)}));var i=Object.keys(n).length;o.doc_write_failures+=i,o.docs_written+=t.length-i,t.forEach((function(t){var e=n[t._id];if(e){o.errors.push(e);var i=(e.name||"").toLowerCase();if("unauthorized"!==i&&"forbidden"!==i)throw e;r.emit("denied",C(e))}else k.push(t)}))}),(function(e){throw o.doc_write_failures+=t.length,e}))}}function _(){if(i.error)throw new Error("There was a problem getting docs.");o.last_seq=d=i.seq;var t=C(o);return k.length&&(t.docs=k,"number"===typeof i.pending&&(t.pending=i.pending,delete i.pending),r.emit("change",t)),f=!0,c.writeCheckpoint(i.seq,x).then((function(){if(f=!1,r.cancelled)throw I(),new Error("cancelled");i=void 0,P()})).catch((function(t){throw B(t),t}))}function M(){return or(t,e,i.diffs,r).then((function(t){i.error=!t.ok,t.docs.forEach((function(t){delete i.diffs[t._id],o.docs_read++,i.docs.push(t)}))}))}function T(){r.cancelled||i||(0!==u.length?(i=u.shift(),function(){var t={};return i.changes.forEach((function(e){"_user/"!==e.id&&(t[e.id]=e.changes.map((function(t){return t.rev})))})),e.revsDiff(t).then((function(t){if(r.cancelled)throw I(),new Error("cancelled");i.diffs=t}))}().then(M).then(E).then(_).then(T).catch((function(t){A("batch processing terminated with error",t)}))):N(!0))}function N(t){0!==l.changes.length?(t||h||l.changes.length>=y)&&(u.push(l),l={seq:0,changes:[],docs:[]},"pending"!==r.state&&"stopped"!==r.state||(r.state="active",r.emit("active")),T()):0!==u.length||i||((v&&S.live||h)&&(r.state="pending",r.emit("paused")),h&&I())}function A(t,e){p||(e.message||(e.message=t),o.ok=!1,o.status="aborting",u=[],l={seq:0,changes:[],docs:[]},I(e))}function I(i){if(!p&&(!r.cancelled||(o.status="cancelled",!f)))if(o.status=o.status||"complete",o.end_time=(new Date).toISOString(),o.last_seq=d,p=!0,i){(i=nt(i)).result=o;var s=(i.name||"").toLowerCase();"unauthorized"===s||"forbidden"===s?(r.emit("error",i),r.removeAllListeners()):function(t,e,n,r){if(!1===t.retry)return e.emit("error",n),void e.removeAllListeners();if("function"!==typeof t.back_off_function&&(t.back_off_function=z),e.emit("requestError",n),"active"===e.state||"pending"===e.state){e.emit("paused",n),e.state="stopped";var o=function(){t.current_back_off=0};e.once("paused",(function(){e.removeListener("active",o)})),e.once("active",o)}t.current_back_off=t.current_back_off||0,t.current_back_off=t.back_off_function(t.current_back_off),setTimeout(r,t.current_back_off)}(n,r,i,(function(){pr(t,e,n,r)}))}else r.emit("complete",o),r.removeAllListeners()}function j(t,e,o){if(r.cancelled)return I();"number"===typeof e&&(l.pending=e),ot(n)(t)&&(l.seq=t.seq||o,l.changes.push(t),s()((function(){N(0===u.length&&S.live)})))}function D(t){if(g=!1,r.cancelled)return I();if(t.results.length>0)S.since=t.results[t.results.length-1].seq,P(),N(!0);else{var e=function(){v?(S.live=!0,P()):h=!0,N(!0)};i||0!==t.results.length?e():(f=!0,c.writeCheckpoint(t.last_seq,x).then((function(){f=!1,o.last_seq=d=t.last_seq,e()})).catch(B))}}function R(t){if(g=!1,r.cancelled)return I();A("changes rejected",t)}function P(){if(!g&&!h&&u.length<m){g=!0,r._changes&&(r.removeListener("cancel",r._abortChanges),r._changes.cancel()),r.once("cancel",o);var e=t.changes(S).on("change",j);e.then(i,i),e.then(D).catch(R),n.retry&&(r._changes=e,r._abortChanges=o)}function o(){e.cancel()}function i(){r.removeListener("cancel",o)}}function F(){O().then((function(){if(!r.cancelled)return c.getCheckpoint().then((function(t){S={since:d=t,limit:y,batch_size:y,style:"all_docs",doc_ids:b,selector:w,return_docs:!0},n.filter&&("string"!==typeof n.filter?S.include_docs=!0:S.filter=n.filter),"heartbeat"in n&&(S.heartbeat=n.heartbeat),"timeout"in n&&(S.timeout=n.timeout),n.query_params&&(S.query_params=n.query_params),n.view&&(S.view=n.view),P()}));I()})).catch((function(t){A("getCheckpoint rejected with ",t)}))}function B(t){f=!1,A("writeCheckpoint completed with error",t)}r.ready(t,e),r.cancelled?I():(r._addedListeners||(r.once("cancel",I),"function"===typeof n.complete&&(r.once("error",n.complete),r.once("complete",(function(t){n.complete(null,t)}))),r._addedListeners=!0),"undefined"===typeof n.since?F():O().then((function(){return f=!0,c.writeCheckpoint(n.since,x)})).then((function(){f=!1,r.cancelled?I():(d=n.since,F())})).catch(B))}function dr(){m.a.call(this),this.cancelled=!1,this.state="pending";var t=this,e=new Promise((function(e,n){t.once("complete",e),t.once("error",n)}));t.then=function(t,n){return e.then(t,n)},t.catch=function(t){return e.catch(t)},t.catch((function(){}))}function vr(t,e){var n=e.PouchConstructor;return"string"===typeof t?new n(t,e):t}function yr(t,e,n,r){if("function"===typeof n&&(r=n,n={}),"undefined"===typeof n&&(n={}),n.doc_ids&&!Array.isArray(n.doc_ids))throw nt(Q,"`doc_ids` filter parameter is not a list.");n.complete=r,(n=C(n)).continuous=n.continuous||n.live,n.retry="retry"in n&&n.retry,n.PouchConstructor=n.PouchConstructor||this;var o=new dr(n);return pr(vr(t,n),vr(e,n),n,o),o}function mr(t,e,n,r){return"function"===typeof n&&(r=n,n={}),"undefined"===typeof n&&(n={}),(n=C(n)).PouchConstructor=n.PouchConstructor||this,new gr(t=vr(t,n),e=vr(e,n),n,r)}function gr(t,e,n,r){var o=this;this.canceled=!1;var i=n.push?B({},n,n.push):n,s=n.pull?B({},n,n.pull):n;function a(t){o.emit("change",{direction:"pull",change:t})}function c(t){o.emit("change",{direction:"push",change:t})}function u(t){o.emit("denied",{direction:"push",doc:t})}function l(t){o.emit("denied",{direction:"pull",doc:t})}function f(){o.pushPaused=!0,o.pullPaused&&o.emit("paused")}function h(){o.pullPaused=!0,o.pushPaused&&o.emit("paused")}function p(){o.pushPaused=!1,o.pullPaused&&o.emit("active",{direction:"push"})}function d(){o.pullPaused=!1,o.pushPaused&&o.emit("active",{direction:"pull"})}this.push=yr(t,e,i),this.pull=yr(e,t,s),this.pushPaused=!0,this.pullPaused=!0;var v={};function y(t){return function(e,n){("change"===e&&(n===a||n===c)||"denied"===e&&(n===l||n===u)||"paused"===e&&(n===h||n===f)||"active"===e&&(n===d||n===p))&&(e in v||(v[e]={}),v[e][t]=!0,2===Object.keys(v[e]).length&&o.removeAllListeners(e))}}function m(t,e,n){-1==t.listeners(e).indexOf(n)&&t.on(e,n)}n.live&&(this.push.on("complete",o.pull.cancel.bind(o.pull)),this.pull.on("complete",o.push.cancel.bind(o.push))),this.on("newListener",(function(t){"change"===t?(m(o.pull,"change",a),m(o.push,"change",c)):"denied"===t?(m(o.pull,"denied",l),m(o.push,"denied",u)):"active"===t?(m(o.pull,"active",d),m(o.push,"active",p)):"paused"===t&&(m(o.pull,"paused",h),m(o.push,"paused",f))})),this.on("removeListener",(function(t){"change"===t?(o.pull.removeListener("change",a),o.push.removeListener("change",c)):"denied"===t?(o.pull.removeListener("denied",l),o.push.removeListener("denied",u)):"active"===t?(o.pull.removeListener("active",d),o.push.removeListener("active",p)):"paused"===t&&(o.pull.removeListener("paused",h),o.push.removeListener("paused",f))})),this.pull.on("removeListener",y("pull")),this.push.on("removeListener",y("push"));var g=Promise.all([this.push,this.pull]).then((function(t){var e={push:t[0],pull:t[1]};return o.emit("complete",e),r&&r(null,e),o.removeAllListeners(),e}),(function(t){if(o.cancel(),r?r(t):o.emit("error",t),o.removeAllListeners(),r)throw t}));this.then=function(t,e){return g.then(t,e)},this.catch=function(t){return g.catch(t)}}v()(dr,m.a),dr.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},dr.prototype.ready=function(t,e){var n=this;function r(){n.cancel()}n._readyCalled||(n._readyCalled=!0,t.once("destroyed",r),e.once("destroyed",r),n.once("complete",(function(){t.removeListener("destroyed",r),e.removeListener("destroyed",r)})))},v()(gr,m.a),gr.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},re.plugin((function(t){t.adapter("idb",wn,!0)})).plugin((function(t){t.adapter("http",Nn,!1),t.adapter("https",Nn,!1)})).plugin(er).plugin((function(t){t.replicate=yr,t.sync=mr,Object.defineProperty(t.prototype,"replicate",{get:function(){var t=this;return"undefined"===typeof this.replicateMethods&&(this.replicateMethods={from:function(e,n,r){return t.constructor.replicate(e,t,n,r)},to:function(e,n,r){return t.constructor.replicate(t,e,n,r)}}),this.replicateMethods}}),t.prototype.sync=function(t,e,n){return this.constructor.sync(this,t,e,n)}})),e.a=re}).call(this,n(70))},function(t,e,n){"use strict";function r(t,e,n){var r=n[n.length-1];t===r.element&&(n.pop(),r=n[n.length-1]);var o=r.element,i=r.index;if(Array.isArray(o))o.push(t);else if(i===e.length-2){o[e.pop()]=t}else e.push(t)}e.stringify=function(t){var e=[];e.push({obj:t});for(var n,r,o,i,s,a,c,u,l,f,h="";n=e.pop();)if(r=n.obj,h+=n.prefix||"",o=n.val||"")h+=o;else if("object"!==typeof r)h+="undefined"===typeof r?null:JSON.stringify(r);else if(null===r)h+="null";else if(Array.isArray(r)){for(e.push({val:"]"}),i=r.length-1;i>=0;i--)s=0===i?"":",",e.push({obj:r[i],prefix:s});e.push({val:"["})}else{for(c in a=[],r)r.hasOwnProperty(c)&&a.push(c);for(e.push({val:"}"}),i=a.length-1;i>=0;i--)l=r[u=a[i]],f=i>0?",":"",f+=JSON.stringify(u)+":",e.push({obj:l,prefix:f});e.push({val:"{"})}return h},e.parse=function(t){for(var e,n,o,i,s,a,c,u,l,f=[],h=[],p=0;;)if("}"!==(e=t[p++])&&"]"!==e&&"undefined"!==typeof e)switch(e){case" ":case"\t":case"\n":case":":case",":break;case"n":p+=3,r(null,f,h);break;case"t":p+=3,r(!0,f,h);break;case"f":p+=4,r(!1,f,h);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(n="",p--;;){if(o=t[p++],!/[\d\.\-e\+]/.test(o)){p--;break}n+=o}r(parseFloat(n),f,h);break;case'"':for(i="",s=void 0,a=0;'"'!==(c=t[p++])||"\\"===s&&a%2===1;)i+=c,"\\"===(s=c)?a++:a=0;r(JSON.parse('"'+i+'"'),f,h);break;case"[":u={element:[],index:f.length},f.push(u.element),h.push(u);break;case"{":l={element:{},index:f.length},f.push(l.element),h.push(l);break;default:throw new Error("unexpectedly reached end of input: "+e)}else{if(1===f.length)return f.pop();r(f.pop(),f,h)}}},function(t,e,n){"use strict";var r=n(71),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function c(t){return r.isMemo(t)?s:a[t.$$typeof]||o}a[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[r.Memo]=s;var u=Object.defineProperty,l=Object.getOwnPropertyNames,f=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,d=Object.prototype;t.exports=function t(e,n,r){if("string"!==typeof n){if(d){var o=p(n);o&&o!==d&&t(e,o,r)}var s=l(n);f&&(s=s.concat(f(n)));for(var a=c(e),v=c(n),y=0;y<s.length;++y){var m=s[y];if(!i[m]&&(!r||!r[m])&&(!v||!v[m])&&(!a||!a[m])){var g=h(n,m);try{u(e,m,g)}catch(b){}}}}return e}},function(t,e,n){"use strict";(function(n){function r(t){return"object"!==typeof t||"toString"in t?t:Object.prototype.toString.call(t).slice(8,-1)}Object.defineProperty(e,"__esModule",{value:!0});var o="object"===typeof n&&!0;function i(t,e){if(!t){if(o)throw new Error("Invariant failed");throw new Error(e())}}e.invariant=i;var s=Object.prototype.hasOwnProperty,a=Array.prototype.splice,c=Object.prototype.toString;function u(t){return c.call(t).slice(8,-1)}var l=Object.assign||function(t,e){return f(e).forEach((function(n){s.call(e,n)&&(t[n]=e[n])})),t},f="function"===typeof Object.getOwnPropertySymbols?function(t){return Object.keys(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.keys(t)};function h(t){return Array.isArray(t)?l(t.constructor(t.length),t):"Map"===u(t)?new Map(t):"Set"===u(t)?new Set(t):t&&"object"===typeof t?l(Object.create(Object.getPrototypeOf(t)),t):t}var p=function(){function t(){this.commands=l({},d),this.update=this.update.bind(this),this.update.extend=this.extend=this.extend.bind(this),this.update.isEquals=function(t,e){return t===e},this.update.newContext=function(){return(new t).update}}return Object.defineProperty(t.prototype,"isEquals",{get:function(){return this.update.isEquals},set:function(t){this.update.isEquals=t},enumerable:!0,configurable:!0}),t.prototype.extend=function(t,e){this.commands[t]=e},t.prototype.update=function(t,e){var n=this,r="function"===typeof e?{$apply:e}:e;Array.isArray(t)&&Array.isArray(r)||i(!Array.isArray(r),(function(){return"update(): You provided an invalid spec to update(). The spec may not contain an array except as the value of $set, $push, $unshift, $splice or any custom command allowing an array value."})),i("object"===typeof r&&null!==r,(function(){return"update(): You provided an invalid spec to update(). The spec and every included key path must be plain objects containing one of the following commands: "+Object.keys(n.commands).join(", ")+"."}));var o=t;return f(r).forEach((function(e){if(s.call(n.commands,e)){var i=t===o;o=n.commands[e](r[e],o,r,t),i&&n.isEquals(o,t)&&(o=t)}else{var a="Map"===u(t)?n.update(t.get(e),r[e]):n.update(t[e],r[e]),c="Map"===u(o)?o.get(e):o[e];n.isEquals(a,c)&&("undefined"!==typeof a||s.call(t,e))||(o===t&&(o=h(t)),"Map"===u(o)?o.set(e,a):o[e]=a)}})),o},t}();e.Context=p;var d={$push:function(t,e,n){return y(e,n,"$push"),t.length?e.concat(t):e},$unshift:function(t,e,n){return y(e,n,"$unshift"),t.length?t.concat(e):e},$splice:function(t,e,n,o){return function(t,e){i(Array.isArray(t),(function(){return"Expected $splice target to be an array; got "+r(t)})),g(e.$splice)}(e,n),t.forEach((function(t){g(t),e===o&&t.length&&(e=h(o)),a.apply(e,t)})),e},$set:function(t,e,n){return function(t){i(1===Object.keys(t).length,(function(){return"Cannot have more than one key in an object with $set"}))}(n),t},$toggle:function(t,e){m(t,"$toggle");var n=t.length?h(e):e;return t.forEach((function(t){n[t]=!e[t]})),n},$unset:function(t,e,n,r){return m(t,"$unset"),t.forEach((function(t){Object.hasOwnProperty.call(e,t)&&(e===r&&(e=h(r)),delete e[t])})),e},$add:function(t,e,n,r){return b(e,"$add"),m(t,"$add"),"Map"===u(e)?t.forEach((function(t){var n=t[0],o=t[1];e===r&&e.get(n)!==o&&(e=h(r)),e.set(n,o)})):t.forEach((function(t){e!==r||e.has(t)||(e=h(r)),e.add(t)})),e},$remove:function(t,e,n,r){return b(e,"$remove"),m(t,"$remove"),t.forEach((function(t){e===r&&e.has(t)&&(e=h(r)),e.delete(t)})),e},$merge:function(t,e,n,o){var s,a;return s=e,i((a=t)&&"object"===typeof a,(function(){return"update(): $merge expects a spec of type 'object'; got "+r(a)})),i(s&&"object"===typeof s,(function(){return"update(): $merge expects a target of type 'object'; got "+r(s)})),f(t).forEach((function(n){t[n]!==e[n]&&(e===o&&(e=h(o)),e[n]=t[n])})),e},$apply:function(t,e){var n;return i("function"===typeof(n=t),(function(){return"update(): expected spec of $apply to be a function; got "+r(n)+"."})),t(e)}},v=new p;function y(t,e,n){i(Array.isArray(t),(function(){return"update(): expected target of "+r(n)+" to be an array; got "+r(t)+"."})),m(e[n],n)}function m(t,e){i(Array.isArray(t),(function(){return"update(): expected spec of "+r(e)+" to be an array; got "+r(t)+". Did you forget to wrap your parameter in an array?"}))}function g(t){i(Array.isArray(t),(function(){return"update(): expected spec of $splice to be an array of arrays; got "+r(t)+". Did you forget to wrap your parameters in an array?"}))}function b(t,e){var n=u(t);i("Map"===n||"Set"===n,(function(){return"update(): "+r(e)+" expects a target of type Set or Map; got "+r(n)}))}e.isEquals=v.update.isEquals,e.extend=v.extend,e.default=v.update,e.default.default=t.exports=l(e.default,e)}).call(this,n(70))},function(t,e,n){var r=n(109),o=n(110);t.exports=function(t,e){return!e||"object"!==r(e)&&"function"!==typeof e?o(t):e}},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}},function(t,e,n){"use strict";function r(t){var e,n=t.Symbol;return"function"===typeof n?n.observable?e=n.observable:(e=n("observable"),n.observable=e):e="@@observable",e}n.d(e,"a",(function(){return r}))},function(t,e,n){(function(e){var r=n(107),o=n(108),i=n(80),s=n(111),a=n(113),c=n(116);t.exports=function(){var t=Math.floor,n=Math.abs,u=Math.pow;return function(){function t(e,n,r){function o(s,a){if(!n[s]){if(!e[s]){if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[s]={exports:{}};e[s][0].call(u.exports,(function(t){return o(e[s][1][t]||t)}),u,u.exports,t,e,n,r)}return n[s].exports}for(var i=!1,s=0;s<r.length;s++)o(r[s]);return o}return t}()({1:[function(t,e,n){"use strict";function r(t){var e=t.length;if(0<e%4)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function o(t,e,n){return 3*(e+n)/4-n}function i(t){var e,n,i=r(t),s=i[0],a=i[1],c=new f(o(t,s,a)),u=0,h=0<a?s-4:s;for(n=0;n<h;n+=4)e=l[t.charCodeAt(n)]<<18|l[t.charCodeAt(n+1)]<<12|l[t.charCodeAt(n+2)]<<6|l[t.charCodeAt(n+3)],c[u++]=255&e>>16,c[u++]=255&e>>8,c[u++]=255&e;return 2===a&&(e=l[t.charCodeAt(n)]<<2|l[t.charCodeAt(n+1)]>>4,c[u++]=255&e),1===a&&(e=l[t.charCodeAt(n)]<<10|l[t.charCodeAt(n+1)]<<4|l[t.charCodeAt(n+2)]>>2,c[u++]=255&e>>8,c[u++]=255&e),c}function s(t){return u[63&t>>18]+u[63&t>>12]+u[63&t>>6]+u[63&t]}function a(t,e,n){for(var r,o=[],i=e;i<n;i+=3)r=(16711680&t[i]<<16)+(65280&t[i+1]<<8)+(255&t[i+2]),o.push(s(r));return o.join("")}function c(t){for(var e,n=t.length,r=n%3,o=[],i=16383,s=0,c=n-r;s<c;s+=i)o.push(a(t,s,s+i>c?c:s+i));return 1===r?(e=t[n-1],o.push(u[e>>2]+u[63&e<<4]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],o.push(u[e>>10]+u[63&e>>4]+u[63&e<<2]+"=")),o.join("")}n.byteLength=function(t){var e=r(t),n=e[0],o=e[1];return 3*(n+o)/4-o},n.toByteArray=i,n.fromByteArray=c;for(var u=[],l=[],f="undefined"==typeof Uint8Array?Array:Uint8Array,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,d=h.length;p<d;++p)u[p]=h[p],l[h.charCodeAt(p)]=p;l[45]=62,l[95]=63},{}],2:[function(){},{}],3:[function(t,e,n){(function(){(function(){"use strict";var e=String.fromCharCode,r=Math.min;function o(t){if(2147483647<t)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return e.__proto__=i.prototype,e}function i(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return l(t)}return s(t,e,n)}function s(t,e,n){if("string"==typeof t)return f(t,e);if(ArrayBuffer.isView(t))return h(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(W(t,ArrayBuffer)||t&&W(t.buffer,ArrayBuffer))return p(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return i.from(r,e,n);var o=d(t);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return i.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function a(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(0>t)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function c(t,e,n){return a(t),0>=t||void 0===e?o(t):"string"==typeof n?o(t).fill(e,n):o(t).fill(e)}function l(t){return a(t),o(0>t?0:0|v(t))}function f(t,e){if(("string"!=typeof e||""===e)&&(e="utf8"),!i.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var n=0|y(t,e),r=o(n),s=r.write(t,e);return s!==n&&(r=r.slice(0,s)),r}function h(t){for(var e=0>t.length?0:0|v(t.length),n=o(e),r=0;r<e;r+=1)n[r]=255&t[r];return n}function p(t,e,n){if(0>e||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return(r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n)).__proto__=i.prototype,r}function d(t){if(i.isBuffer(t)){var e=0|v(t.length),n=o(e);return 0===n.length||t.copy(n,0,0,e),n}return void 0===t.length?"Buffer"===t.type&&Array.isArray(t.data)?h(t.data):void 0:"number"!=typeof t.length||H(t.length)?o(0):h(t)}function v(t){if(t>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|t}function y(t,e){if(i.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||W(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,r=2<arguments.length&&!0===arguments[2];if(!r&&0===n)return 0;for(var o=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return $(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return U(t).length;default:if(o)return r?-1:$(t).length;e=(""+e).toLowerCase(),o=!0}}function m(t,e,n){var r=!1;if((void 0===e||0>e)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),0>=n)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return I(this,e,n);case"utf8":case"utf-8":return M(this,e,n);case"ascii":return N(this,e,n);case"latin1":case"binary":return A(this,e,n);case"base64":return _(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function g(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function b(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:-2147483648>n&&(n=-2147483648),H(n=+n)&&(n=o?0:t.length-1),0>n&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(0>n){if(!o)return-1;n=0}if("string"==typeof e&&(e=i.from(e,r)),i.isBuffer(e))return 0===e.length?-1:w(t,e,n,r,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):w(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function w(t,e,n,r,o){function i(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}var s,a=1,c=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=(r+"").toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(2>t.length||2>e.length)return-1;a=2,c/=2,u/=2,n/=2}if(o){var l=-1;for(s=n;s<c;s++)if(i(t,s)!==i(e,-1===l?0:s-l))-1!==l&&(s-=s-l),l=-1;else if(-1===l&&(l=s),s-l+1===u)return l*a}else for(n+u>c&&(n=c-u),s=n;0<=s;s--){for(var f=!0,h=0;h<u;h++)if(i(t,s+h)!==i(e,h)){f=!1;break}if(f)return s}return-1}function k(t,e,n,r){n=+n||0;var o=t.length-n;r?(r=+r)>o&&(r=o):r=o;var i=e.length;r>i/2&&(r=i/2);for(var s,a=0;a<r;++a){if(H(s=parseInt(e.substr(2*a,2),16)))return a;t[n+a]=s}return a}function x(t,e,n,r){return V($(e,t.length-n),t,n,r)}function S(t,e,n,r){return V(q(e),t,n,r)}function O(t,e,n,r){return S(t,e,n,r)}function C(t,e,n,r){return V(U(e),t,n,r)}function E(t,e,n,r){return V(J(e,t.length-n),t,n,r)}function _(t,e,n){return 0===e&&n===t.length?K.fromByteArray(t):K.fromByteArray(t.slice(e,n))}function M(t,e,n){n=r(t.length,n);for(var o=[],i=e;i<n;){var s,a,c,u,l=t[i],f=null,h=239<l?4:223<l?3:191<l?2:1;i+h<=n&&(1===h?128>l&&(f=l):2===h?128==(192&(s=t[i+1]))&&127<(u=(31&l)<<6|63&s)&&(f=u):3===h?(s=t[i+1],a=t[i+2],128==(192&s)&&128==(192&a)&&2047<(u=(15&l)<<12|(63&s)<<6|63&a)&&(55296>u||57343<u)&&(f=u)):4===h&&(s=t[i+1],a=t[i+2],c=t[i+3],128==(192&s)&&128==(192&a)&&128==(192&c)&&65535<(u=(15&l)<<18|(63&s)<<12|(63&a)<<6|63&c)&&1114112>u&&(f=u))),null===f?(f=65533,h=1):65535<f&&(f-=65536,o.push(55296|1023&f>>>10),f=56320|1023&f),o.push(f),i+=h}return T(o)}function T(t){var n=t.length;if(n<=4096)return e.apply(String,t);for(var r="",o=0;o<n;)r+=e.apply(String,t.slice(o,o+=4096));return r}function N(t,n,o){var i="";o=r(t.length,o);for(var s=n;s<o;++s)i+=e(127&t[s]);return i}function A(t,n,o){var i="";o=r(t.length,o);for(var s=n;s<o;++s)i+=e(t[s]);return i}function I(t,e,n){var r=t.length;(!e||0>e)&&(e=0),(!n||0>n||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=L(t[i]);return o}function j(t,n,r){for(var o=t.slice(n,r),i="",s=0;s<o.length;s+=2)i+=e(o[s]+256*o[s+1]);return i}function D(t,e,n){if(0!=t%1||0>t)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function R(t,e,n,r,o,s){if(!i.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<s)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function P(t,e,n,r){if(n+r>t.length)throw new RangeError("Index out of range");if(0>n)throw new RangeError("Index out of range")}function z(t,e,n,r,o){return e=+e,n>>>=0,o||P(t,e,n,4,34028234663852886e22,-34028234663852886e22),Y.write(t,e,n,r,23,4),n+4}function F(t,e,n,r,o){return e=+e,n>>>=0,o||P(t,e,n,8,17976931348623157e292,-17976931348623157e292),Y.write(t,e,n,r,52,8),n+8}function B(t){if(2>(t=(t=t.split("=")[0]).trim().replace(G,"")).length)return"";for(;0!=t.length%4;)t+="=";return t}function L(t){return 16>t?"0"+t.toString(16):t.toString(16)}function $(t,e){e=e||1/0;for(var n,r=t.length,o=null,i=[],s=0;s<r;++s){if(55295<(n=t.charCodeAt(s))&&57344>n){if(!o){if(56319<n){-1<(e-=3)&&i.push(239,191,189);continue}if(s+1===r){-1<(e-=3)&&i.push(239,191,189);continue}o=n;continue}if(56320>n){-1<(e-=3)&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&-1<(e-=3)&&i.push(239,191,189);if(o=null,128>n){if(0>(e-=1))break;i.push(n)}else if(2048>n){if(0>(e-=2))break;i.push(192|n>>6,128|63&n)}else if(65536>n){if(0>(e-=3))break;i.push(224|n>>12,128|63&n>>6,128|63&n)}else{if(!(1114112>n))throw new Error("Invalid code point");if(0>(e-=4))break;i.push(240|n>>18,128|63&n>>12,128|63&n>>6,128|63&n)}}return i}function q(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function J(t,e){for(var n,r,o,i=[],s=0;s<t.length&&!(0>(e-=2));++s)r=(n=t.charCodeAt(s))>>8,o=n%256,i.push(o),i.push(r);return i}function U(t){return K.toByteArray(B(t))}function V(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}function W(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function H(t){return t!==t}var K=t("base64-js"),Y=t("ieee754");n.Buffer=i,n.SlowBuffer=function(t){return+t!=t&&(t=0),i.alloc(+t)},n.INSPECT_MAX_BYTES=50,n.kMaxLength=2147483647,i.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(o){return!1}}(),i.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(i.prototype,"parent",{enumerable:!0,get:function(){return i.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(i.prototype,"offset",{enumerable:!0,get:function(){return i.isBuffer(this)?this.byteOffset:void 0}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),i.poolSize=8192,i.from=function(t,e,n){return s(t,e,n)},i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,i.alloc=function(t,e,n){return c(t,e,n)},i.allocUnsafe=function(t){return l(t)},i.allocUnsafeSlow=function(t){return l(t)},i.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==i.prototype},i.compare=function(t,e){if(W(t,Uint8Array)&&(t=i.from(t,t.offset,t.byteLength)),W(e,Uint8Array)&&(e=i.from(e,e.offset,e.byteLength)),!i.isBuffer(t)||!i.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var n=t.length,o=e.length,s=0,a=r(n,o);s<a;++s)if(t[s]!==e[s]){n=t[s],o=e[s];break}return n<o?-1:o<n?1:0},i.isEncoding=function(t){switch((t+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return i.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=i.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var s=t[n];if(W(s,Uint8Array)&&(s=i.from(s)),!i.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,o),o+=s.length}return r},i.byteLength=y,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var t=this.length;if(0!=t%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},i.prototype.swap32=function(){var t=this.length;if(0!=t%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},i.prototype.swap64=function(){var t=this.length;if(0!=t%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},i.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?M(this,0,t):m.apply(this,arguments)},i.prototype.toLocaleString=i.prototype.toString,i.prototype.equals=function(t){if(!i.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===i.compare(this,t)},i.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},i.prototype.compare=function(t,e,n,o,s){if(W(t,Uint8Array)&&(t=i.from(t,t.offset,t.byteLength)),!i.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===o&&(o=0),void 0===s&&(s=this.length),0>e||n>t.length||0>o||s>this.length)throw new RangeError("out of range index");if(o>=s&&e>=n)return 0;if(o>=s)return-1;if(e>=n)return 1;if(this===t)return 0;for(var a=(s>>>=0)-(o>>>=0),c=(n>>>=0)-(e>>>=0),u=r(a,c),l=this.slice(o,s),f=t.slice(e,n),h=0;h<u;++h)if(l[h]!==f[h]){a=l[h],c=f[h];break}return a<c?-1:c<a?1:0},i.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},i.prototype.indexOf=function(t,e,n){return b(this,t,e,n,!0)},i.prototype.lastIndexOf=function(t,e,n){return b(this,t,e,n,!1)},i.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),0<t.length&&(0>n||0>e)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return k(this,t,e,n);case"utf8":case"utf-8":return x(this,t,e,n);case"ascii":return S(this,t,e,n);case"latin1":case"binary":return O(this,t,e,n);case"base64":return C(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},i.prototype.slice=function(t,e){var n=this.length;0>(t=~~t)?0>(t+=n)&&(t=0):t>n&&(t=n),0>(e=void 0===e?n:~~e)?0>(e+=n)&&(e=0):e>n&&(e=n),e<t&&(e=t);var r=this.subarray(t,e);return r.__proto__=i.prototype,r},i.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||D(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},i.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||D(t,e,this.length);for(var r=this[t+--e],o=1;0<e&&(o*=256);)r+=this[t+--e]*o;return r},i.prototype.readUInt8=function(t,e){return t>>>=0,e||D(t,1,this.length),this[t]},i.prototype.readUInt16LE=function(t,e){return t>>>=0,e||D(t,2,this.length),this[t]|this[t+1]<<8},i.prototype.readUInt16BE=function(t,e){return t>>>=0,e||D(t,2,this.length),this[t]<<8|this[t+1]},i.prototype.readUInt32LE=function(t,e){return t>>>=0,e||D(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},i.prototype.readUInt32BE=function(t,e){return t>>>=0,e||D(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},i.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||D(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r>=(o*=128)&&(r-=u(2,8*e)),r},i.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||D(t,e,this.length);for(var r=e,o=1,i=this[t+--r];0<r&&(o*=256);)i+=this[t+--r]*o;return i>=(o*=128)&&(i-=u(2,8*e)),i},i.prototype.readInt8=function(t,e){return t>>>=0,e||D(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},i.prototype.readInt16LE=function(t,e){t>>>=0,e||D(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt16BE=function(t,e){t>>>=0,e||D(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt32LE=function(t,e){return t>>>=0,e||D(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},i.prototype.readInt32BE=function(t,e){return t>>>=0,e||D(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},i.prototype.readFloatLE=function(t,e){return t>>>=0,e||D(t,4,this.length),Y.read(this,t,!0,23,4)},i.prototype.readFloatBE=function(t,e){return t>>>=0,e||D(t,4,this.length),Y.read(this,t,!1,23,4)},i.prototype.readDoubleLE=function(t,e){return t>>>=0,e||D(t,8,this.length),Y.read(this,t,!0,52,8)},i.prototype.readDoubleBE=function(t,e){return t>>>=0,e||D(t,8,this.length),Y.read(this,t,!1,52,8)},i.prototype.writeUIntLE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||R(this,t,e,n,u(2,8*n)-1,0);var o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=255&t/o;return e+n},i.prototype.writeUIntBE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||R(this,t,e,n,u(2,8*n)-1,0);var o=n-1,i=1;for(this[e+o]=255&t;0<=--o&&(i*=256);)this[e+o]=255&t/i;return e+n},i.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,1,255,0),this[e]=255&t,e+1},i.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},i.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},i.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},i.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},i.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var o=u(2,8*n-1);R(this,t,e,n,o-1,-o)}var i=0,s=1,a=0;for(this[e]=255&t;++i<n&&(s*=256);)0>t&&0===a&&0!==this[e+i-1]&&(a=1),this[e+i]=255&(t/s>>0)-a;return e+n},i.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var o=u(2,8*n-1);R(this,t,e,n,o-1,-o)}var i=n-1,s=1,a=0;for(this[e+i]=255&t;0<=--i&&(s*=256);)0>t&&0===a&&0!==this[e+i+1]&&(a=1),this[e+i]=255&(t/s>>0)-a;return e+n},i.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,1,127,-128),0>t&&(t=255+t+1),this[e]=255&t,e+1},i.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},i.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},i.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},i.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},i.prototype.writeFloatLE=function(t,e,n){return z(this,t,e,!0,n)},i.prototype.writeFloatBE=function(t,e,n){return z(this,t,e,!1,n)},i.prototype.writeDoubleLE=function(t,e,n){return F(this,t,e,!0,n)},i.prototype.writeDoubleBE=function(t,e,n){return F(this,t,e,!1,n)},i.prototype.copy=function(t,e,n,r){if(!i.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),0<r&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(0>e)throw new RangeError("targetStart out of bounds");if(0>n||n>=this.length)throw new RangeError("Index out of range");if(0>r)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o=r-n;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,n,r);else if(this===t&&n<e&&e<r)for(var s=o-1;0<=s;--s)t[s+e]=this[s+n];else Uint8Array.prototype.set.call(t,this.subarray(n,r),e);return o},i.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!i.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){var o=t.charCodeAt(0);("utf8"===r&&128>o||"latin1"===r)&&(t=o)}}else"number"==typeof t&&(t&=255);if(0>e||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var a=i.isBuffer(t)?t:i.from(t,r),c=a.length;if(0===c)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<n-e;++s)this[s+e]=a[s%c]}return this};var G=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,t("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(t,e){"use strict";function n(t){console&&console.warn&&console.warn(t)}function r(){r.init.call(this)}function o(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function i(t){return void 0===t._maxListeners?r.defaultMaxListeners:t._maxListeners}function s(t,e,r,s){var a,c,u;if(o(r),void 0===(c=t._events)?(c=t._events=Object.create(null),t._eventsCount=0):(void 0!==c.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),c=t._events),u=c[e]),void 0===u)u=c[e]=r,++t._eventsCount;else if("function"==typeof u?u=c[e]=s?[r,u]:[u,r]:s?u.unshift(r):u.push(r),0<(a=i(t))&&u.length>a&&!u.warned){u.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=u.length,n(l)}return t}function a(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},o=a.bind(r);return o.listener=n,r.wrapFn=o,o}function u(t,e,n){var r=t._events;if(void 0===r)return[];var o=r[e];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?p(o):f(o,o.length)}function l(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(t,e){for(var n=Array(e),r=0;r<e;++r)n[r]=t[r];return n}function h(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function p(t){for(var e=Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}var d,v="object"==typeof Reflect?Reflect:null,y=v&&"function"==typeof v.apply?v.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};d=v&&"function"==typeof v.ownKeys?v.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var m=Number.isNaN||function(t){return t!==t};e.exports=r,e.exports.once=function(t,e){return new Promise((function(n,r){function o(){void 0!==i&&t.removeListener("error",i),n([].slice.call(arguments))}var i;"error"!==e&&(i=function(n){t.removeListener(e,o),r(n)},t.once("error",i)),t.once(e,o)}))},r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var g=10;Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return g},set:function(t){if("number"!=typeof t||0>t||m(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");g=t}}),r.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(t){if("number"!=typeof t||0>t||m(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},r.prototype.getMaxListeners=function(){return i(this)},r.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var i;if(0<e.length&&(i=e[0]),i instanceof Error)throw i;var s=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw s.context=i,s}var a=o[t];if(void 0===a)return!1;if("function"==typeof a)y(a,this,e);else{var c=a.length,u=f(a,c);for(n=0;n<c;++n)y(u[n],this,e)}return!0},r.prototype.addListener=function(t,e){return s(this,t,e,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(t,e){return s(this,t,e,!0)},r.prototype.once=function(t,e){return o(e),this.on(t,c(this,t,e)),this},r.prototype.prependOnceListener=function(t,e){return o(e),this.prependListener(t,c(this,t,e)),this},r.prototype.removeListener=function(t,e){var n,r,i,s,a;if(o(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,s=n.length-1;0<=s;s--)if(n[s]===e||n[s].listener===e){a=n[s].listener,i=s;break}if(0>i)return this;0===i?n.shift():h(n,i),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,a||e)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"===(o=i[r])||this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;0<=r;r--)this.removeListener(t,e[r]);return this},r.prototype.listeners=function(t){return u(this,t,!0)},r.prototype.rawListeners=function(t){return u(this,t,!1)},r.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):l.call(t,e)},r.prototype.listenerCount=l,r.prototype.eventNames=function(){return 0<this._eventsCount?d(this._events):[]}},{}],5:[function(t,e,n){(function(r){(function(){function o(){var t;try{t=n.storage.getItem("debug")}catch(t){}return!t&&"undefined"!=typeof r&&"env"in r&&(t=r.env.DEBUG),t}n.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),this.useColors){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"===t||(r++,"%c"===t&&(o=r))})),t.splice(o,0,n)}},n.save=function(t){try{t?n.storage.setItem("debug",t):n.storage.removeItem("debug")}catch(t){}},n.load=o,n.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},n.storage=function(){try{return localStorage}catch(t){}}(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],n.log=console.debug||console.log||function(){},e.exports=t("./common")(n),e.exports.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(this)}).call(this,t("_process"))},{"./common":6,_process:12}],6:[function(t,e){e.exports=function(e){function r(t){function e(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];if(e.enabled){var s=e,a=+new Date,c=a-(n||a);s.diff=c,s.prev=n,s.curr=a,n=a,o[0]=r.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var u=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,(function(t,e){if("%%"===t)return t;u++;var n=r.formatters[e];if("function"==typeof n){var i=o[u];t=n.call(s,i),o.splice(u,1),u--}return t})),r.formatArgs.call(s,o),(s.log||r.log).apply(s,o)}}var n;return e.namespace=t,e.enabled=r.enabled(t),e.useColors=r.useColors(),e.color=r.selectColor(t),e.destroy=o,e.extend=i,"function"==typeof r.init&&r.init(e),r.instances.push(e),e}function o(){var t=r.instances.indexOf(this);return-1!==t&&(r.instances.splice(t,1),!0)}function i(t,e){var n=r(this.namespace+("undefined"==typeof e?":":e)+t);return n.log=this.log,n}function s(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return r.debug=r,r.default=r,r.coerce=function(t){return t instanceof Error?t.stack||t.message:t},r.disable=function(){var t=[].concat(c(r.names.map(s)),c(r.skips.map(s).map((function(t){return"-"+t})))).join(",");return r.enable(""),t},r.enable=function(t){var e;r.save(t),r.names=[],r.skips=[];var n=("string"==typeof t?t:"").split(/[\s,]+/),o=n.length;for(e=0;e<o;e++)n[e]&&("-"===(t=n[e].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+t.substr(1)+"$")):r.names.push(new RegExp("^"+t+"$")));for(e=0;e<r.instances.length;e++){var i=r.instances[e];i.enabled=r.enabled(i.namespace)}},r.enabled=function(t){if("*"===t[t.length-1])return!0;var e,n;for(e=0,n=r.skips.length;e<n;e++)if(r.skips[e].test(t))return!1;for(e=0,n=r.names.length;e<n;e++)if(r.names[e].test(t))return!0;return!1},r.humanize=t("ms"),Object.keys(e).forEach((function(t){r[t]=e[t]})),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=function(t){for(var e=0,o=0;o<t.length;o++)e=(e<<5)-e+t.charCodeAt(o),e|=0;return r.colors[n(e)%r.colors.length]},r.enable(r.load()),r}},{ms:11}],7:[function(t,e){"use strict";function n(t,e){for(var n in e)Object.defineProperty(t,n,{value:e[n],enumerable:!0,configurable:!0});return t}e.exports=function(t,e,r){if(!t||"string"==typeof t)throw new TypeError("Please pass an Error to err-code");r||(r={}),"object"==typeof e&&(r=e,e=void 0),null!=e&&(r.code=e);try{return n(t,r)}catch(e){r.message=t.message,r.stack=t.stack;var o=function(){};return o.prototype=Object.create(Object.getPrototypeOf(t)),n(new o,r)}}},{}],8:[function(t,e){e.exports=function(){if("undefined"==typeof window)return null;var t={RTCPeerConnection:window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate};return t.RTCPeerConnection?t:null}},{}],9:[function(e,r,o){o.read=function(t,e,n,r,o){var i,s,a=8*o-r-1,c=(1<<a)-1,l=c>>1,f=-7,h=n?o-1:0,p=n?-1:1,d=t[e+h];for(h+=p,i=d&(1<<-f)-1,d>>=-f,f+=a;0<f;i=256*i+t[e+h],h+=p,f-=8);for(s=i&(1<<-f)-1,i>>=-f,f+=r;0<f;s=256*s+t[e+h],h+=p,f-=8);if(0===i)i=1-l;else{if(i===c)return s?NaN:1/0*(d?-1:1);s+=u(2,r),i-=l}return(d?-1:1)*s*u(2,i-r)},o.write=function(e,r,o,i,s,a){var c,l,f,h=Math.LN2,p=Math.log,d=8*a-s-1,v=(1<<d)-1,y=v>>1,m=23===s?u(2,-24)-u(2,-77):0,g=i?0:a-1,b=i?1:-1,w=0>r||0===r&&0>1/r?1:0;for(r=n(r),isNaN(r)||r===1/0?(l=isNaN(r)?1:0,c=v):(c=t(p(r)/h),1>r*(f=u(2,-c))&&(c--,f*=2),2<=(r+=1<=c+y?m/f:m*u(2,1-y))*f&&(c++,f/=2),c+y>=v?(l=0,c=v):1<=c+y?(l=(r*f-1)*u(2,s),c+=y):(l=r*u(2,y-1)*u(2,s),c=0));8<=s;e[o+g]=255&l,g+=b,l/=256,s-=8);for(c=c<<s|l,d+=s;0<d;e[o+g]=255&c,g+=b,c/=256,d-=8);e[o+g-b]|=128*w}},{}],10:[function(t,e){e.exports="function"==typeof Object.create?function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}},{}],11:[function(t,e){var r=Math.round;function o(t){if(!(100<(t+="").length)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();return"years"===r||"year"===r||"yrs"===r||"yr"===r||"y"===r?315576e5*n:"weeks"===r||"week"===r||"w"===r?6048e5*n:"days"===r||"day"===r||"d"===r?864e5*n:"hours"===r||"hour"===r||"hrs"===r||"hr"===r||"h"===r?36e5*n:"minutes"===r||"minute"===r||"mins"===r||"min"===r||"m"===r?6e4*n:"seconds"===r||"second"===r||"secs"===r||"sec"===r||"s"===r?1e3*n:"milliseconds"===r||"millisecond"===r||"msecs"===r||"msec"===r||"ms"===r?n:void 0}}}function i(t){var e=n(t);return 864e5<=e?r(t/864e5)+"d":36e5<=e?r(t/36e5)+"h":6e4<=e?r(t/6e4)+"m":1e3<=e?r(t/1e3)+"s":t+"ms"}function s(t){var e=n(t);return 864e5<=e?a(t,e,864e5,"day"):36e5<=e?a(t,e,36e5,"hour"):6e4<=e?a(t,e,6e4,"minute"):1e3<=e?a(t,e,1e3,"second"):t+" ms"}function a(t,e,n,o){return r(t/n)+" "+o+(e>=1.5*n?"s":"")}e.exports=function(t,e){e=e||{};var n=typeof t;if("string"==n&&0<t.length)return o(t);if("number"===n&&isFinite(t))return e.long?s(t):i(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},{}],12:[function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(l===setTimeout)return setTimeout(t,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(n){try{return l.call(null,t,0)}catch(n){return l.call(this,t,0)}}}function i(t){if(f===clearTimeout)return clearTimeout(t);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{return f(t)}catch(n){try{return f.call(null,t)}catch(n){return f.call(this,t)}}}function s(){v&&p&&(v=!1,p.length?d=p.concat(d):y=-1,d.length&&a())}function a(){if(!v){var t=o(s);v=!0;for(var e=d.length;e;){for(p=d,d=[];++y<e;)p&&p[y].run();y=-1,e=d.length}p=null,v=!1,i(t)}}function c(t,e){this.fun=t,this.array=e}function u(){}var l,f,h=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(e){f=r}}();var p,d=[],v=!1,y=-1;h.nextTick=function(t){var e=Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];d.push(new c(t,e)),1!==d.length||v||o(a)},c.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=u,h.addListener=u,h.once=u,h.off=u,h.removeListener=u,h.removeAllListeners=u,h.emit=u,h.prependListener=u,h.prependOnceListener=u,h.listeners=function(){return[]},h.binding=function(){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},{}],13:[function(t,e){var n;e.exports="function"==typeof queueMicrotask?queueMicrotask.bind(globalThis):function(t){return(n||(n=Promise.resolve())).then(t).catch((function(t){return setTimeout((function(){throw t}),0)}))}},{}],14:[function(t,n){(function(e,r){(function(){"use strict";var o=t("safe-buffer").Buffer,i=r.crypto||r.msCrypto;n.exports=i&&i.getRandomValues?function(t,n){if(t>4294967295)throw new RangeError("requested too many random bytes");var r=o.allocUnsafe(t);if(0<t)if(65536<t)for(var s=0;s<t;s+=65536)i.getRandomValues(r.slice(s,s+65536));else i.getRandomValues(r);return"function"==typeof n?e.nextTick((function(){n(null,r)})):r}:function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this)}).call(this,t("_process"),"undefined"==typeof e?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:e)},{_process:12,"safe-buffer":30}],15:[function(t,e){"use strict";function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function r(t,e,r){function o(t,n,r){return"string"==typeof e?e:e(t,n,r)}r||(r=Error);var i=function(t){function e(e,n,r){return t.call(this,o(e,n,r))||this}return n(e,t),e}(r);i.prototype.name=r.name,i.prototype.code=t,c[t]=i}function o(t,e){if(Array.isArray(t)){var n=t.length;return t=t.map((function(t){return t+""})),2<n?"one of ".concat(e," ").concat(t.slice(0,n-1).join(", "),", or ")+t[n-1]:2===n?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}return"of ".concat(e," ").concat(t+"")}function i(t,e,n){return t.substr(!n||0>n?0:+n,e.length)===e}function s(t,e,n){return(void 0===n||n>t.length)&&(n=t.length),t.substring(n-e.length,n)===e}function a(t,e,n){return"number"!=typeof n&&(n=0),!(n+e.length>t.length)&&-1!==t.indexOf(e,n)}var c={};r("ERR_INVALID_OPT_VALUE",(function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'}),TypeError),r("ERR_INVALID_ARG_TYPE",(function(t,e,n){var r,c;if("string"==typeof e&&i(e,"not ")?(r="must not be",e=e.replace(/^not /,"")):r="must be",s(t," argument"))c="The ".concat(t," ").concat(r," ").concat(o(e,"type"));else{var u=a(t,".")?"property":"argument";c='The "'.concat(t,'" ').concat(u," ").concat(r," ").concat(o(e,"type"))}return c+=". Received type ".concat(typeof n)}),TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",(function(t){return"The "+t+" method is not implemented"})),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",(function(t){return"Cannot call "+t+" after a stream was destroyed"})),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",(function(t){return"Unknown encoding: "+t}),TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=c},{}],16:[function(t,e){(function(n){(function(){"use strict";function r(t){return this instanceof r?(a.call(this,t),c.call(this,t),this.allowHalfOpen=!0,void(t&&(!1===t.readable&&(this.readable=!1),!1===t.writable&&(this.writable=!1),!1===t.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",o))))):new r(t)}function o(){this._writableState.ended||n.nextTick(i,this)}function i(t){t.end()}var s=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};e.exports=r;var a=t("./_stream_readable"),c=t("./_stream_writable");t("inherits")(r,a);for(var u,l=s(c.prototype),f=0;f<l.length;f++)u=l[f],r.prototype[u]||(r.prototype[u]=c.prototype[u]);Object.defineProperty(r.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(r.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(r.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(r.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=t,this._writableState.destroyed=t)}})}).call(this)}).call(this,t("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(t,e){"use strict";function n(t){return this instanceof n?void r.call(this,t):new n(t)}e.exports=n;var r=t("./_stream_transform");t("inherits")(n,r),n.prototype._transform=function(t,e,n){n(null,t)}},{"./_stream_transform":19,inherits:10}],18:[function(t,n){(function(e,r){(function(){"use strict";function o(t){return j.from(t)}function i(t){return j.isBuffer(t)||t instanceof D}function s(t,e,n){return"function"==typeof t.prependListener?t.prependListener(e,n):void(t._events&&t._events[e]?Array.isArray(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n))}function a(e,n,r){T=T||t("./_stream_duplex"),e=e||{},"boolean"!=typeof r&&(r=n instanceof T),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=$(this,e,"readableHighWaterMark",r),this.buffer=new B,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(!P&&(P=t("string_decoder/").StringDecoder),this.decoder=new P(e.encoding),this.encoding=e.encoding)}function c(e){if(T=T||t("./_stream_duplex"),!(this instanceof c))return new c(e);var n=this instanceof T;this._readableState=new a(e,this,n),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),I.call(this)}function u(t,e,n,r,i){N("readableAddChunk",e);var s,a=t._readableState;if(null===e)a.reading=!1,d(t,a);else if(i||(s=f(a,e)),s)H(t,s);else if(a.objectMode||e&&0<e.length)if("string"==typeof e||a.objectMode||Object.getPrototypeOf(e)===j.prototype||(e=o(e)),r)a.endEmitted?H(t,new W):l(t,a,e,!0);else if(a.ended)H(t,new U);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!n?(e=a.decoder.write(e),a.objectMode||0!==e.length?l(t,a,e,!1):m(t,a)):l(t,a,e,!1)}else r||(a.reading=!1,m(t,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function l(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(e.awaitDrain=0,t.emit("data",n)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&v(t)),m(t,e)}function f(t,e){var n;return i(e)||"string"==typeof e||void 0===e||t.objectMode||(n=new J("chunk",["string","Buffer","Uint8Array"],e)),n}function h(t){return 1073741824<=t?t=1073741824:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function p(t,e){return 0>=t||0===e.length&&e.ended?0:e.objectMode?1:t===t?(t>e.highWaterMark&&(e.highWaterMark=h(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0)):e.flowing&&e.length?e.buffer.head.data.length:e.length}function d(t,e){if(N("onEofChunk"),!e.ended){if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,e.sync?v(t):(e.needReadable=!1,!e.emittedReadable&&(e.emittedReadable=!0,y(t)))}}function v(t){var n=t._readableState;N("emitReadable",n.needReadable,n.emittedReadable),n.needReadable=!1,n.emittedReadable||(N("emitReadable",n.flowing),n.emittedReadable=!0,e.nextTick(y,t))}function y(t){var e=t._readableState;N("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,O(t)}function m(t,n){n.readingMore||(n.readingMore=!0,e.nextTick(g,t,n))}function g(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&0===e.length);){var n=e.length;if(N("maybeReadMore read 0"),t.read(0),n===e.length)break}e.readingMore=!1}function b(t){return function(){var e=t._readableState;N("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&A(t,"data")&&(e.flowing=!0,O(t))}}function w(t){var e=t._readableState;e.readableListening=0<t.listenerCount("readable"),e.resumeScheduled&&!e.paused?e.flowing=!0:0<t.listenerCount("data")&&t.resume()}function k(t){N("readable nexttick read 0"),t.read(0)}function x(t,n){n.resumeScheduled||(n.resumeScheduled=!0,e.nextTick(S,t,n))}function S(t,e){N("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),O(t),e.flowing&&!e.reading&&t.read(0)}function O(t){var e=t._readableState;for(N("flow",e.flowing);e.flowing&&null!==t.read(););}function C(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.first():e.buffer.concat(e.length),e.buffer.clear()):n=e.buffer.consume(t,e.decoder),n);var n}function E(t){var n=t._readableState;N("endReadable",n.endEmitted),n.endEmitted||(n.ended=!0,e.nextTick(_,n,t))}function _(t,e){if(N("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&0===t.length&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var n=e._writableState;(!n||n.autoDestroy&&n.finished)&&e.destroy()}}function M(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}var T;n.exports=c,c.ReadableState=a,t("events").EventEmitter;var N,A=function(t,e){return t.listeners(e).length},I=t("./internal/streams/stream"),j=t("buffer").Buffer,D=r.Uint8Array||function(){},R=t("util");N=R&&R.debuglog?R.debuglog("stream"):function(){};var P,z,F,B=t("./internal/streams/buffer_list"),L=t("./internal/streams/destroy"),$=t("./internal/streams/state").getHighWaterMark,q=t("../errors").codes,J=q.ERR_INVALID_ARG_TYPE,U=q.ERR_STREAM_PUSH_AFTER_EOF,V=q.ERR_METHOD_NOT_IMPLEMENTED,W=q.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;t("inherits")(c,I);var H=L.errorOrDestroy,K=["error","close","destroy","pause","resume"];Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),c.prototype.destroy=L.destroy,c.prototype._undestroy=L.undestroy,c.prototype._destroy=function(t,e){e(t)},c.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=j.from(t,e),e=""),n=!0),u(this,t,e,!1,n)},c.prototype.unshift=function(t){return u(this,t,null,!0,!1)},c.prototype.isPaused=function(){return!1===this._readableState.flowing},c.prototype.setEncoding=function(e){P||(P=t("string_decoder/").StringDecoder);var n=new P(e);this._readableState.decoder=n,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,o="";null!==r;)o+=n.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==o&&this._readableState.buffer.push(o),this._readableState.length=o.length,this},c.prototype.read=function(t){N("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&((0===e.highWaterMark?0<e.length:e.length>=e.highWaterMark)||e.ended))return N("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?E(this):v(this),null;if(0===(t=p(t,e))&&e.ended)return 0===e.length&&E(this),null;var r,o=e.needReadable;return N("need readable",o),(0===e.length||e.length-t<e.highWaterMark)&&N("length less than watermark",o=!0),e.ended||e.reading?N("reading or ended",o=!1):o&&(N("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,!e.reading&&(t=p(n,e))),null===(r=0<t?C(t,e):null)?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),0===e.length&&(!e.ended&&(e.needReadable=!0),n!==t&&e.ended&&E(this)),null!==r&&this.emit("data",r),r},c.prototype._read=function(){H(this,new V("_read()"))},c.prototype.pipe=function(t,n){function r(t,e){N("onunpipe"),t===h&&e&&!1===e.hasUnpiped&&(e.hasUnpiped=!0,i())}function o(){N("onend"),t.end()}function i(){N("cleanup"),t.removeListener("close",u),t.removeListener("finish",l),t.removeListener("drain",v),t.removeListener("error",c),t.removeListener("unpipe",r),h.removeListener("end",o),h.removeListener("end",f),h.removeListener("data",a),y=!0,p.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&v()}function a(e){N("ondata");var n=t.write(e);N("dest.write",n),!1===n&&((1===p.pipesCount&&p.pipes===t||1<p.pipesCount&&-1!==M(p.pipes,t))&&!y&&(N("false write response, pause",p.awaitDrain),p.awaitDrain++),h.pause())}function c(e){N("onerror",e),f(),t.removeListener("error",c),0===A(t,"error")&&H(t,e)}function u(){t.removeListener("finish",l),f()}function l(){N("onfinish"),t.removeListener("close",u),f()}function f(){N("unpipe"),h.unpipe(t)}var h=this,p=this._readableState;switch(p.pipesCount){case 0:p.pipes=t;break;case 1:p.pipes=[p.pipes,t];break;default:p.pipes.push(t)}p.pipesCount+=1,N("pipe count=%d opts=%j",p.pipesCount,n);var d=n&&!1===n.end||t===e.stdout||t===e.stderr?f:o;p.endEmitted?e.nextTick(d):h.once("end",d),t.on("unpipe",r);var v=b(h);t.on("drain",v);var y=!1;return h.on("data",a),s(t,"error",c),t.once("close",u),t.once("finish",l),t.emit("pipe",h),p.flowing||(N("pipe resume"),h.resume()),t},c.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n)),this;if(!t){var r=e.pipes,o=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var i=0;i<o;i++)r[i].emit("unpipe",this,{hasUnpiped:!1});return this}var s=M(e.pipes,t);return-1===s||(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n)),this},c.prototype.on=function(t,n){var r=I.prototype.on.call(this,t,n),o=this._readableState;return"data"===t?(o.readableListening=0<this.listenerCount("readable"),!1!==o.flowing&&this.resume()):"readable"==t&&!o.endEmitted&&!o.readableListening&&(o.readableListening=o.needReadable=!0,o.flowing=!1,o.emittedReadable=!1,N("on readable",o.length,o.reading),o.length?v(this):!o.reading&&e.nextTick(k,this)),r},c.prototype.addListener=c.prototype.on,c.prototype.removeListener=function(t,n){var r=I.prototype.removeListener.call(this,t,n);return"readable"===t&&e.nextTick(w,this),r},c.prototype.removeAllListeners=function(t){var n=I.prototype.removeAllListeners.apply(this,arguments);return("readable"===t||void 0===t)&&e.nextTick(w,this),n},c.prototype.resume=function(){var t=this._readableState;return t.flowing||(N("resume"),t.flowing=!t.readableListening,x(this,t)),t.paused=!1,this},c.prototype.pause=function(){return N("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(N("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},c.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var o in t.on("end",(function(){if(N("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(o){N("wrapped data"),n.decoder&&(o=n.decoder.write(o)),(!n.objectMode||null!==o&&void 0!==o)&&(n.objectMode||o&&o.length)&&(e.push(o)||(r=!0,t.pause()))})),t)void 0===this[o]&&"function"==typeof t[o]&&(this[o]=function(e){return function(){return t[e].apply(t,arguments)}}(o));for(var i=0;i<K.length;i++)t.on(K[i],this.emit.bind(this,K[i]));return this._read=function(e){N("wrapped _read",e),r&&(r=!1,t.resume())},this},"function"==typeof Symbol&&(c.prototype[Symbol.asyncIterator]=function(){return void 0===z&&(z=t("./internal/streams/async_iterator")),z(this)}),Object.defineProperty(c.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(c.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(c.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}}),c._fromList=C,Object.defineProperty(c.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(c.from=function(e,n){return void 0===F&&(F=t("./internal/streams/from")),F(c,e,n)})}).call(this)}).call(this,t("_process"),"undefined"==typeof e?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:e)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:4,inherits:10,"string_decoder/":31,util:2}],19:[function(t,e){"use strict";function n(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new c);n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}function r(t){return this instanceof r?(f.call(this,t),this._transformState={afterTransform:n.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),void this.on("prefinish",o)):new r(t)}function o(){var t=this;"function"!=typeof this._flush||this._readableState.destroyed?i(this,null,null):this._flush((function(e,n){i(t,e,n)}))}function i(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new l;if(t._transformState.transforming)throw new u;return t.push(null)}e.exports=r;var s=t("../errors").codes,a=s.ERR_METHOD_NOT_IMPLEMENTED,c=s.ERR_MULTIPLE_CALLBACK,u=s.ERR_TRANSFORM_ALREADY_TRANSFORMING,l=s.ERR_TRANSFORM_WITH_LENGTH_0,f=t("./_stream_duplex");t("inherits")(r,f),r.prototype.push=function(t,e){return this._transformState.needTransform=!1,f.prototype.push.call(this,t,e)},r.prototype._transform=function(t,e,n){n(new a("_transform()"))},r.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var o=this._readableState;(r.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},r.prototype._read=function(){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},r.prototype._destroy=function(t,e){f.prototype._destroy.call(this,t,(function(t){e(t)}))}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(t,n){(function(e,r){(function(){"use strict";function o(t){var e=this;this.next=null,this.entry=null,this.finish=function(){E(e,t)}}function i(t){return A.from(t)}function s(t){return A.isBuffer(t)||t instanceof I}function a(){}function c(e,n,r){_=_||t("./_stream_duplex"),e=e||{},"boolean"!=typeof r&&(r=n instanceof _),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=D(this,e,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=!1===e.decodeStrings;this.decodeStrings=!i,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){m(n,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function u(e){var n=this instanceof(_=_||t("./_stream_duplex"));return n||M.call(u,this)?(this._writableState=new c(e,this,n),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),void N.call(this)):new u(e)}function l(t,n){var r=new q;U(t,r),e.nextTick(n,r)}function f(t,n,r,o){var i;return null===r?i=new $:"string"!=typeof r&&!n.objectMode&&(i=new P("chunk",["string","Buffer"],r)),!i||(U(t,i),e.nextTick(o,i),!1)}function h(t,e,n){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=A.from(e,n)),e}function p(t,e,n,r,o,i){if(!n){var s=h(e,r,o);r!==s&&(n=!0,o="buffer",r=s)}var a=e.objectMode?1:r.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:o,isBuf:n,callback:i,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else d(t,e,!1,a,r,o,i);return c}function d(t,e,n,r,o,i,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new L("write")):n?t._writev(o,e.onwrite):t._write(o,i,e.onwrite),e.sync=!1}function v(t,n,r,o,i){--n.pendingcb,r?(e.nextTick(i,o),e.nextTick(O,t,n),t._writableState.errorEmitted=!0,U(t,o)):(i(o),t._writableState.errorEmitted=!0,U(t,o),O(t,n))}function y(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function m(t,n){var r=t._writableState,o=r.sync,i=r.writecb;if("function"!=typeof i)throw new F;if(y(r),n)v(t,r,o,n,i);else{var s=k(r)||t.destroyed;s||r.corked||r.bufferProcessing||!r.bufferedRequest||w(t,r),o?e.nextTick(g,t,r,s,i):g(t,r,s,i)}}function g(t,e,n,r){n||b(t,e),e.pendingcb--,r(),O(t,e)}function b(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function w(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=Array(r),s=e.corkedRequestsFree;s.entry=n;for(var a=0,c=!0;n;)i[a]=n,n.isBuf||(c=!1),n=n.next,a+=1;i.allBuffers=c,d(t,e,!0,e.length,i,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new o(e),e.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,l=n.encoding,f=n.callback;if(d(t,e,!1,e.objectMode?1:u.length,u,l,f),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function k(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function x(t,e){t._final((function(n){e.pendingcb--,n&&U(t,n),e.prefinished=!0,t.emit("prefinish"),O(t,e)}))}function S(t,n){n.prefinished||n.finalCalled||("function"!=typeof t._final||n.destroyed?(n.prefinished=!0,t.emit("prefinish")):(n.pendingcb++,n.finalCalled=!0,e.nextTick(x,t,n)))}function O(t,e){var n=k(e);if(n&&(S(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var r=t._readableState;(!r||r.autoDestroy&&r.endEmitted)&&t.destroy()}return n}function C(t,n,r){n.ending=!0,O(t,n),r&&(n.finished?e.nextTick(r):t.once("finish",r)),n.ended=!0,t.writable=!1}function E(t,e,n){var r=t.entry;for(t.entry=null;r;){var o=r.callback;e.pendingcb--,o(n),r=r.next}e.corkedRequestsFree.next=t}var _;n.exports=u,u.WritableState=c;var M,T={deprecate:t("util-deprecate")},N=t("./internal/streams/stream"),A=t("buffer").Buffer,I=r.Uint8Array||function(){},j=t("./internal/streams/destroy"),D=t("./internal/streams/state").getHighWaterMark,R=t("../errors").codes,P=R.ERR_INVALID_ARG_TYPE,z=R.ERR_METHOD_NOT_IMPLEMENTED,F=R.ERR_MULTIPLE_CALLBACK,B=R.ERR_STREAM_CANNOT_PIPE,L=R.ERR_STREAM_DESTROYED,$=R.ERR_STREAM_NULL_VALUES,q=R.ERR_STREAM_WRITE_AFTER_END,J=R.ERR_UNKNOWN_ENCODING,U=j.errorOrDestroy;t("inherits")(u,N),c.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(c.prototype,"buffer",{get:T.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(M=Function.prototype[Symbol.hasInstance],Object.defineProperty(u,Symbol.hasInstance,{value:function(t){return!!M.call(this,t)||!(this!==u)&&t&&t._writableState instanceof c}})):M=function(t){return t instanceof this},u.prototype.pipe=function(){U(this,new B)},u.prototype.write=function(t,e,n){var r=this._writableState,o=!1,c=!r.objectMode&&s(t);return c&&!A.isBuffer(t)&&(t=i(t)),"function"==typeof e&&(n=e,e=null),c?e="buffer":!e&&(e=r.defaultEncoding),"function"!=typeof n&&(n=a),r.ending?l(this,n):(c||f(this,r,t,n))&&(r.pendingcb++,o=p(this,r,c,t,e,n)),o},u.prototype.cork=function(){this._writableState.corked++},u.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&w(this,t))},u.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())))throw new J(t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),u.prototype._write=function(t,e,n){n(new z("_write()"))},u.prototype._writev=null,u.prototype.end=function(t,e,n){var r=this._writableState;return"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!==t&&void 0!==t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||C(this,r,n),this},Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),u.prototype.destroy=j.destroy,u.prototype._undestroy=j.undestroy,u.prototype._destroy=function(t,e){e(t)}}).call(this)}).call(this,t("_process"),"undefined"==typeof e?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:e)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(t,e){(function(n){(function(){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){return{value:t,done:e}}function i(t){var e=t[l];if(null!==e){var n=t[y].read();null!==n&&(t[d]=null,t[l]=null,t[f]=null,e(o(n,!1)))}}function s(t){n.nextTick(i,t)}function a(t,e){return function(n,r){t.then((function(){return e[p]?void n(o(void 0,!0)):void e[v](n,r)}),r)}}var c,u=t("./end-of-stream"),l=Symbol("lastResolve"),f=Symbol("lastReject"),h=Symbol("error"),p=Symbol("ended"),d=Symbol("lastPromise"),v=Symbol("handlePromise"),y=Symbol("stream"),m=Object.getPrototypeOf((function(){})),g=Object.setPrototypeOf((c={get stream(){return this[y]},next:function(){var t=this,e=this[h];if(null!==e)return Promise.reject(e);if(this[p])return Promise.resolve(o(void 0,!0));if(this[y].destroyed)return new Promise((function(e,r){n.nextTick((function(){t[h]?r(t[h]):e(o(void 0,!0))}))}));var r,i=this[d];if(i)r=new Promise(a(i,this));else{var s=this[y].read();if(null!==s)return Promise.resolve(o(s,!1));r=new Promise(this[v])}return this[d]=r,r}},r(c,Symbol.asyncIterator,(function(){return this})),r(c,"return",(function(){var t=this;return new Promise((function(e,n){t[y].destroy(null,(function(t){return t?void n(t):void e(o(void 0,!0))}))}))})),c),m);e.exports=function(t){var e,n=Object.create(g,(r(e={},y,{value:t,writable:!0}),r(e,l,{value:null,writable:!0}),r(e,f,{value:null,writable:!0}),r(e,h,{value:null,writable:!0}),r(e,p,{value:t._readableState.endEmitted,writable:!0}),r(e,v,{value:function(t,e){var r=n[y].read();r?(n[d]=null,n[l]=null,n[f]=null,t(o(r,!1))):(n[l]=t,n[f]=e)},writable:!0}),e));return n[d]=null,u(t,(function(t){if(t&&"ERR_STREAM_PREMATURE_CLOSE"!==t.code){var e=n[f];return null!==e&&(n[d]=null,n[l]=null,n[f]=null,e(t)),void(n[h]=t)}var r=n[l];null!==r&&(n[d]=null,n[l]=null,n[f]=null,r(o(void 0,!0))),n[p]=!0})),t.on("readable",s.bind(null,n)),n}}).call(this)}).call(this,t("_process"))},{"./end-of-stream":24,_process:12}],22:[function(t,e){"use strict";function n(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function r(t){for(var e,r=1;r<arguments.length;r++)e=null==arguments[r]?{}:arguments[r],r%2?n(Object(e),!0).forEach((function(n){o(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):n(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}));return t}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n,r=0;r<e.length;r++)(n=e[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}function a(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}function c(t,e,n){u.prototype.copy.call(t,e,n)}var u=t("buffer").Buffer,l=t("util").inspect,f=l&&l.custom||"inspect";e.exports=function(){function t(){i(this,t),this.head=null,this.tail=null,this.length=0}return a(t,[{key:"push",value:function(t){var e={data:t,next:null};0<this.length?this.tail.next=e:this.head=e,this.tail=e,++this.length}},{key:"unshift",value:function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}},{key:"shift",value:function(){if(0!==this.length){var t=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n}},{key:"concat",value:function(t){if(0===this.length)return u.alloc(0);for(var e=u.allocUnsafe(t>>>0),n=this.head,r=0;n;)c(n.data,e,r),r+=n.data.length,n=n.next;return e}},{key:"consume",value:function(t,e){var n;return t<this.head.data.length?(n=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):n=t===this.head.data.length?this.shift():e?this._getString(t):this._getBuffer(t),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var e=this.head,n=1,r=e.data;for(t-=r.length;e=e.next;){var o=e.data,i=t>o.length?o.length:t;if(r+=i===o.length?o:o.slice(0,t),0===(t-=i)){i===o.length?(++n,this.head=e.next?e.next:this.tail=null):(this.head=e,e.data=o.slice(i));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(t){var e=u.allocUnsafe(t),n=this.head,r=1;for(n.data.copy(e),t-=n.data.length;n=n.next;){var o=n.data,i=t>o.length?o.length:t;if(o.copy(e,e.length-t,0,i),0===(t-=i)){i===o.length?(++r,this.head=n.next?n.next:this.tail=null):(this.head=n,n.data=o.slice(i));break}++r}return this.length-=r,e}},{key:f,value:function(t,e){return l(this,r({},e,{depth:0,customInspect:!1}))}}]),t}()},{buffer:3,util:2}],23:[function(t,e){(function(t){(function(){"use strict";function n(t,e){o(t,e),r(t)}function r(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function o(t,e){t.emit("error",e)}e.exports={destroy:function(e,i){var s=this,a=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return a||c?(i?i(e):e&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,t.nextTick(o,this,e)):t.nextTick(o,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!i&&e?s._writableState?s._writableState.errorEmitted?t.nextTick(r,s):(s._writableState.errorEmitted=!0,t.nextTick(n,s,e)):t.nextTick(n,s,e):i?(t.nextTick(r,s),i(e)):t.nextTick(r,s)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(t,e){var n=t._readableState,r=t._writableState;n&&n.autoDestroy||r&&r.autoDestroy?t.destroy(e):t.emit("error",e)}}}).call(this)}).call(this,t("_process"))},{_process:12}],24:[function(t,e){"use strict";function n(t){var e=!1;return function(){if(!e){e=!0;for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];t.apply(this,r)}}}function r(){}function o(t){return t.setHeader&&"function"==typeof t.abort}function i(t,e,a){if("function"==typeof e)return i(t,null,e);e||(e={}),a=n(a||r);var c=e.readable||!1!==e.readable&&t.readable,u=e.writable||!1!==e.writable&&t.writable,l=function(){t.writable||h()},f=t._writableState&&t._writableState.finished,h=function(){u=!1,f=!0,c||a.call(t)},p=t._readableState&&t._readableState.endEmitted,d=function(){c=!1,p=!0,u||a.call(t)},v=function(e){a.call(t,e)},y=function(){var e;return c&&!p?(t._readableState&&t._readableState.ended||(e=new s),a.call(t,e)):u&&!f?(t._writableState&&t._writableState.ended||(e=new s),a.call(t,e)):void 0},m=function(){t.req.on("finish",h)};return o(t)?(t.on("complete",h),t.on("abort",y),t.req?m():t.on("request",m)):u&&!t._writableState&&(t.on("end",l),t.on("close",l)),t.on("end",d),t.on("finish",h),!1!==e.error&&t.on("error",v),t.on("close",y),function(){t.removeListener("complete",h),t.removeListener("abort",y),t.removeListener("request",m),t.req&&t.req.removeListener("finish",h),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",h),t.removeListener("end",d),t.removeListener("error",v),t.removeListener("close",y)}}var s=t("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;e.exports=i},{"../../../errors":15}],25:[function(t,e){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(t,e){"use strict";function n(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}function r(t){if(t)throw t}function o(t){return t.setHeader&&"function"==typeof t.abort}function i(e,r,i,s){s=n(s);var a=!1;e.on("close",(function(){a=!0})),void 0===u&&(u=t("./end-of-stream")),u(e,{readable:r,writable:i},(function(t){return t?s(t):(a=!0,void s())}));var c=!1;return function(t){if(!a)return c?void 0:(c=!0,o(e)?e.abort():"function"==typeof e.destroy?e.destroy():void s(t||new h("pipe")))}}function s(t){t()}function a(t,e){return t.pipe(e)}function c(t){return t.length&&"function"==typeof t[t.length-1]?t.pop():r}var u,l=t("../../../errors").codes,f=l.ERR_MISSING_ARGS,h=l.ERR_STREAM_DESTROYED;e.exports=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=c(e);if(Array.isArray(e[0])&&(e=e[0]),2>e.length)throw new f("streams");var o,u=e.map((function(t,n){var a=n<e.length-1;return i(t,a,0<n,(function(t){o||(o=t),t&&u.forEach(s),a||(u.forEach(s),r(o))}))}));return e.reduce(a)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(e,n){"use strict";function r(t,e,n){return null==t.highWaterMark?e?t[n]:null:t.highWaterMark}var o=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;n.exports={getHighWaterMark:function(e,n,i,s){var a=r(n,s,i);if(null!=a){if(!isFinite(a)||t(a)!==a||0>a)throw new o(s?i:"highWaterMark",a);return t(a)}return e.objectMode?16:16384}}},{"../../../errors":15}],28:[function(t,e){e.exports=t("events").EventEmitter},{events:4}],29:[function(t,e,n){(n=e.exports=t("./lib/_stream_readable.js")).Stream=n,n.Readable=n,n.Writable=t("./lib/_stream_writable.js"),n.Duplex=t("./lib/_stream_duplex.js"),n.Transform=t("./lib/_stream_transform.js"),n.PassThrough=t("./lib/_stream_passthrough.js"),n.finished=t("./lib/internal/streams/end-of-stream.js"),n.pipeline=t("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(t,e,n){function r(t,e){for(var n in t)e[n]=t[n]}function o(t,e,n){return s(t,e,n)}var i=t("buffer"),s=i.Buffer;s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?e.exports=i:(r(i,n),n.Buffer=o),o.prototype=Object.create(s.prototype),r(s,o),o.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return s(t,e,n)},o.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=s(t);return void 0===e?r.fill(0):"string"==typeof n?r.fill(e,n):r.fill(e),r},o.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return s(t)},o.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i.SlowBuffer(t)}},{buffer:3}],31:[function(t,e,n){"use strict";function r(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function o(t){var e=r(t);if("string"!=typeof e&&(y.isEncoding===m||!m(t)))throw new Error("Unknown encoding: "+t);return e||t}function i(t){var e;switch(this.encoding=o(t),this.encoding){case"utf16le":this.text=l,this.end=f,e=4;break;case"utf8":this.fillLast=u,e=4;break;case"base64":this.text=h,this.end=p,e=3;break;default:return this.write=d,void(this.end=v)}this.lastNeed=0,this.lastTotal=0,this.lastChar=y.allocUnsafe(e)}function s(t){return 127>=t?0:6==t>>5?2:14==t>>4?3:30==t>>3?4:2==t>>6?-1:-2}function a(t,e,n){var r=e.length-1;if(r<n)return 0;var o=s(e[r]);return 0<=o?(0<o&&(t.lastNeed=o-1),o):--r<n||-2===o?0:0<=(o=s(e[r]))?(0<o&&(t.lastNeed=o-2),o):--r<n||-2===o?0:0<=(o=s(e[r]))?(0<o&&(2===o?o=0:t.lastNeed=o-3),o):0}function c(t,e){if(128!=(192&e[0]))return t.lastNeed=0,"\ufffd";if(1<t.lastNeed&&1<e.length){if(128!=(192&e[1]))return t.lastNeed=1,"\ufffd";if(2<t.lastNeed&&2<e.length&&128!=(192&e[2]))return t.lastNeed=2,"\ufffd"}}function u(t){var e=this.lastTotal-this.lastNeed,n=c(this,t,e);return void 0===n?this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length)):n}function l(t,e){if(0==(t.length-e)%2){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(55296<=r&&56319>=r)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function f(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function h(t,e){var n=(t.length-e)%3;return 0==n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1==n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function p(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function d(t){return t.toString(this.encoding)}function v(t){return t&&t.length?this.write(t):""}var y=t("safe-buffer").Buffer,m=y.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};n.StringDecoder=i,i.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},i.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\ufffd":e},i.prototype.text=function(t,e){var n=a(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},i.prototype.fillLast=function(t){return this.lastNeed<=t.length?(t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),void(this.lastNeed-=t.length))}},{"safe-buffer":30}],32:[function(t,n){(function(t){(function(){function e(e){try{if(!t.localStorage)return!1}catch(t){return!1}var n=t.localStorage[e];return null!=n&&"true"===(n+"").toLowerCase()}n.exports=function(t,n){function r(){if(!o){if(e("throwDeprecation"))throw new Error(n);e("traceDeprecation")?console.trace(n):console.warn(n),o=!0}return t.apply(this,arguments)}if(e("noDeprecation"))return t;var o=!1;return r}}).call(this)}).call(this,"undefined"==typeof e?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:e)},{}],"/":[function(t,e){function n(t){return t.replace(/a=ice-options:trickle\s\n/g,"")}function c(t){console.warn(t)}var u=t("debug")("simple-peer"),l=t("get-browser-rtc"),f=t("randombytes"),h=t("readable-stream"),p=t("queue-microtask"),d=t("err-code"),v=t("buffer").Buffer,y=65536,m=function(t){"use strict";s(m,t);var h=a(m);function m(t){var e;if(r(this,m),t=Object.assign({allowHalfOpen:!1},t),(e=h.call(this,t))._id=f(4).toString("hex").slice(0,7),e._debug("new peer %o",t),e.channelName=t.initiator?t.channelName||f(20).toString("hex"):null,e.initiator=t.initiator||!1,e.channelConfig=t.channelConfig||m.channelConfig,e.channelNegotiated=e.channelConfig.negotiated,e.config=Object.assign({},m.config,t.config),e.offerOptions=t.offerOptions||{},e.answerOptions=t.answerOptions||{},e.sdpTransform=t.sdpTransform||function(t){return t},e.streams=t.streams||(t.stream?[t.stream]:[]),e.trickle=void 0===t.trickle||t.trickle,e.allowHalfTrickle=void 0!==t.allowHalfTrickle&&t.allowHalfTrickle,e.iceCompleteTimeout=t.iceCompleteTimeout||5e3,e.destroyed=!1,e.destroying=!1,e._connected=!1,e.remoteAddress=void 0,e.remoteFamily=void 0,e.remotePort=void 0,e.localAddress=void 0,e.localFamily=void 0,e.localPort=void 0,e._wrtc=t.wrtc&&"object"==typeof t.wrtc?t.wrtc:l(),!e._wrtc)throw"undefined"==typeof window?d(new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),"ERR_WEBRTC_SUPPORT"):d(new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");e._pcReady=!1,e._channelReady=!1,e._iceComplete=!1,e._iceCompleteTimer=null,e._channel=null,e._pendingCandidates=[],e._isNegotiating=!1,e._firstNegotiation=!0,e._batchedNegotiation=!1,e._queuedNegotiation=!1,e._sendersAwaitingStable=[],e._senderMap=new Map,e._closingInterval=null,e._remoteTracks=[],e._remoteStreams=[],e._chunk=null,e._cb=null,e._interval=null;try{e._pc=new e._wrtc.RTCPeerConnection(e.config)}catch(t){return i(e,void p((function(){return e.destroy(d(t,"ERR_PC_CONSTRUCTOR"))})))}return e._isReactNativeWebrtc="number"==typeof e._pc._peerConnectionId,e._pc.oniceconnectionstatechange=function(){e._onIceStateChange()},e._pc.onicegatheringstatechange=function(){e._onIceStateChange()},e._pc.onconnectionstatechange=function(){e._onConnectionStateChange()},e._pc.onsignalingstatechange=function(){e._onSignalingStateChange()},e._pc.onicecandidate=function(t){e._onIceCandidate(t)},e.initiator||e.channelNegotiated?e._setupData({channel:e._pc.createDataChannel(e.channelName,e.channelConfig)}):e._pc.ondatachannel=function(t){e._setupData(t)},e.streams&&e.streams.forEach((function(t){e.addStream(t)})),e._pc.ontrack=function(t){e._onTrack(t)},e._debug("initial negotiation"),e._needsNegotiation(),e._onFinishBound=function(){e._onFinish()},e.once("finish",e._onFinishBound),i(e)}return o(m,[{key:"address",value:function(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}},{key:"signal",value:function(t){var n=this;if(this.destroyed)throw d(new Error("cannot signal after peer is destroyed"),"ERR_SIGNALING");if("string"==typeof t)try{t=JSON.parse(t)}catch(e){t={}}this._debug("signal()"),t.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),t.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(t.transceiverRequest.kind,t.transceiverRequest.init)),t.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(t.candidate):this._pendingCandidates.push(t.candidate)),t.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(t)).then((function(){n.destroyed||(n._pendingCandidates.forEach((function(t){n._addIceCandidate(t)})),n._pendingCandidates=[],"offer"===n._pc.remoteDescription.type&&n._createAnswer())})).catch((function(t){n.destroy(d(t,"ERR_SET_REMOTE_DESCRIPTION"))})),t.sdp||t.candidate||t.renegotiate||t.transceiverRequest||this.destroy(d(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}},{key:"_addIceCandidate",value:function(t){var e=this,n=new this._wrtc.RTCIceCandidate(t);this._pc.addIceCandidate(n).catch((function(t){!n.address||n.address.endsWith(".local")?c("Ignoring unsupported ICE candidate."):e.destroy(d(t,"ERR_ADD_ICE_CANDIDATE"))}))}},{key:"send",value:function(t){this._channel.send(t)}},{key:"addTransceiver",value:function(t,e){if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(t,e),this._needsNegotiation()}catch(t){this.destroy(d(t,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:t,init:e}})}},{key:"addStream",value:function(t){var e=this;this._debug("addStream()"),t.getTracks().forEach((function(n){e.addTrack(n,t)}))}},{key:"addTrack",value:function(t,e){this._debug("addTrack()");var n=this._senderMap.get(t)||new Map,r=n.get(e);if(r)throw r.removed?d(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):d(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED");r=this._pc.addTrack(t,e),n.set(e,r),this._senderMap.set(t,n),this._needsNegotiation()}},{key:"replaceTrack",value:function(t,e,n){this._debug("replaceTrack()");var r=this._senderMap.get(t),o=r?r.get(n):null;if(!o)throw d(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");e&&this._senderMap.set(e,r),null==o.replaceTrack?this.destroy(d(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):o.replaceTrack(e)}},{key:"removeTrack",value:function(t,e){this._debug("removeSender()");var n=this._senderMap.get(t),r=n?n.get(e):null;if(!r)throw d(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{r.removed=!0,this._pc.removeTrack(r)}catch(t){"NS_ERROR_UNEXPECTED"===t.name?this._sendersAwaitingStable.push(r):this.destroy(d(t,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}},{key:"removeStream",value:function(t){var e=this;this._debug("removeSenders()"),t.getTracks().forEach((function(n){e.removeTrack(n,t)}))}},{key:"_needsNegotiation",value:function(){var t=this;this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,p((function(){t._batchedNegotiation=!1,t.initiator||!t._firstNegotiation?(t._debug("starting batched negotiation"),t.negotiate()):t._debug("non-initiator initial negotiation request discarded"),t._firstNegotiation=!1})))}},{key:"negotiate",value:function(){var t=this;this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout((function(){t._createOffer()}),0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}},{key:"destroy",value:function(t){this._destroy(t,(function(){}))}},{key:"_destroy",value:function(t,e){var n=this;this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",t&&(t.message||t)),p((function(){if(n.destroyed=!0,n.destroying=!1,n._debug("destroy (error: %s)",t&&(t.message||t)),n.readable=n.writable=!1,n._readableState.ended||n.push(null),n._writableState.finished||n.end(),n._connected=!1,n._pcReady=!1,n._channelReady=!1,n._remoteTracks=null,n._remoteStreams=null,n._senderMap=null,clearInterval(n._closingInterval),n._closingInterval=null,clearInterval(n._interval),n._interval=null,n._chunk=null,n._cb=null,n._onFinishBound&&n.removeListener("finish",n._onFinishBound),n._onFinishBound=null,n._channel){try{n._channel.close()}catch(t){}n._channel.onmessage=null,n._channel.onopen=null,n._channel.onclose=null,n._channel.onerror=null}if(n._pc){try{n._pc.close()}catch(t){}n._pc.oniceconnectionstatechange=null,n._pc.onicegatheringstatechange=null,n._pc.onsignalingstatechange=null,n._pc.onicecandidate=null,n._pc.ontrack=null,n._pc.ondatachannel=null}n._pc=null,n._channel=null,t&&n.emit("error",t),n.emit("close"),e()})))}},{key:"_setupData",value:function(t){var e=this;if(!t.channel)return this.destroy(d(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=t.channel,this._channel.binaryType="arraybuffer","number"==typeof this._channel.bufferedAmountLowThreshold&&(this._channel.bufferedAmountLowThreshold=y),this.channelName=this._channel.label,this._channel.onmessage=function(t){e._onChannelMessage(t)},this._channel.onbufferedamountlow=function(){e._onChannelBufferedAmountLow()},this._channel.onopen=function(){e._onChannelOpen()},this._channel.onclose=function(){e._onChannelClose()},this._channel.onerror=function(t){e.destroy(d(t,"ERR_DATA_CHANNEL"))};var n=!1;this._closingInterval=setInterval((function(){e._channel&&"closing"===e._channel.readyState?(n&&e._onChannelClose(),n=!0):n=!1}),5e3)}},{key:"_read",value:function(){}},{key:"_write",value:function(t,e,n){if(this.destroyed)return n(d(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(t)}catch(t){return this.destroy(d(t,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>y?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=n):n(null)}else this._debug("write before connect"),this._chunk=t,this._cb=n}},{key:"_onFinish",value:function(){var t=this;if(!this.destroyed){var e=function(){setTimeout((function(){return t.destroy()}),1e3)};this._connected?e():this.once("connect",e)}}},{key:"_startIceCompleteTimeout",value:function(){var t=this;this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout((function(){t._iceComplete||(t._iceComplete=!0,t._debug("iceComplete timeout completed"),t.emit("iceTimeout"),t.emit("_iceComplete"))}),this.iceCompleteTimeout))}},{key:"_createOffer",value:function(){var t=this;this.destroyed||this._pc.createOffer(this.offerOptions).then((function(e){if(!t.destroyed){t.trickle||t.allowHalfTrickle||(e.sdp=n(e.sdp)),e.sdp=t.sdpTransform(e.sdp);var r=function(){if(!t.destroyed){var n=t._pc.localDescription||e;t._debug("signal"),t.emit("signal",{type:n.type,sdp:n.sdp})}};t._pc.setLocalDescription(e).then((function(){t._debug("createOffer success"),t.destroyed||(t.trickle||t._iceComplete?r():t.once("_iceComplete",r))})).catch((function(e){t.destroy(d(e,"ERR_SET_LOCAL_DESCRIPTION"))}))}})).catch((function(e){t.destroy(d(e,"ERR_CREATE_OFFER"))}))}},{key:"_requestMissingTransceivers",value:function(){var t=this;this._pc.getTransceivers&&this._pc.getTransceivers().forEach((function(e){e.mid||!e.sender.track||e.requested||(e.requested=!0,t.addTransceiver(e.sender.track.kind))}))}},{key:"_createAnswer",value:function(){var t=this;this.destroyed||this._pc.createAnswer(this.answerOptions).then((function(e){if(!t.destroyed){t.trickle||t.allowHalfTrickle||(e.sdp=n(e.sdp)),e.sdp=t.sdpTransform(e.sdp);var r=function(){if(!t.destroyed){var n=t._pc.localDescription||e;t._debug("signal"),t.emit("signal",{type:n.type,sdp:n.sdp}),t.initiator||t._requestMissingTransceivers()}};t._pc.setLocalDescription(e).then((function(){t.destroyed||(t.trickle||t._iceComplete?r():t.once("_iceComplete",r))})).catch((function(e){t.destroy(d(e,"ERR_SET_LOCAL_DESCRIPTION"))}))}})).catch((function(e){t.destroy(d(e,"ERR_CREATE_ANSWER"))}))}},{key:"_onConnectionStateChange",value:function(){this.destroyed||"failed"===this._pc.connectionState&&this.destroy(d(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}},{key:"_onIceStateChange",value:function(){if(!this.destroyed){var t=this._pc.iceConnectionState,e=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",t,e),this.emit("iceStateChange",t,e),("connected"===t||"completed"===t)&&(this._pcReady=!0,this._maybeReady()),"failed"===t&&this.destroy(d(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),"closed"===t&&this.destroy(d(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}}},{key:"getStats",value:function(t){var e=this,n=function(t){return"[object Array]"===Object.prototype.toString.call(t.values)&&t.values.forEach((function(e){Object.assign(t,e)})),t};0===this._pc.getStats.length||this._isReactNativeWebrtc?this._pc.getStats().then((function(e){var r=[];e.forEach((function(t){r.push(n(t))})),t(null,r)}),(function(e){return t(e)})):0<this._pc.getStats.length?this._pc.getStats((function(r){if(!e.destroyed){var o=[];r.result().forEach((function(t){var e={};t.names().forEach((function(n){e[n]=t.stat(n)})),e.id=t.id,e.type=t.type,e.timestamp=t.timestamp,o.push(n(e))})),t(null,o)}}),(function(e){return t(e)})):t(null,[])}},{key:"_maybeReady",value:function(){var t=this;this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),!this._connected&&!this._connecting&&this._pcReady&&this._channelReady&&(this._connecting=!0,function e(){t.destroyed||t.getStats((function(n,r){if(!t.destroyed){n&&(r=[]);var o={},i={},s={},a=!1;r.forEach((function(t){("remotecandidate"===t.type||"remote-candidate"===t.type)&&(o[t.id]=t),("localcandidate"===t.type||"local-candidate"===t.type)&&(i[t.id]=t),("candidatepair"===t.type||"candidate-pair"===t.type)&&(s[t.id]=t)}));var c=function(e){a=!0;var n=i[e.localCandidateId];n&&(n.ip||n.address)?(t.localAddress=n.ip||n.address,t.localPort=+n.port):n&&n.ipAddress?(t.localAddress=n.ipAddress,t.localPort=+n.portNumber):"string"==typeof e.googLocalAddress&&(n=e.googLocalAddress.split(":"),t.localAddress=n[0],t.localPort=+n[1]),t.localAddress&&(t.localFamily=t.localAddress.includes(":")?"IPv6":"IPv4");var r=o[e.remoteCandidateId];r&&(r.ip||r.address)?(t.remoteAddress=r.ip||r.address,t.remotePort=+r.port):r&&r.ipAddress?(t.remoteAddress=r.ipAddress,t.remotePort=+r.portNumber):"string"==typeof e.googRemoteAddress&&(r=e.googRemoteAddress.split(":"),t.remoteAddress=r[0],t.remotePort=+r[1]),t.remoteAddress&&(t.remoteFamily=t.remoteAddress.includes(":")?"IPv6":"IPv4"),t._debug("connect local: %s:%s remote: %s:%s",t.localAddress,t.localPort,t.remoteAddress,t.remotePort)};if(r.forEach((function(t){"transport"===t.type&&t.selectedCandidatePairId&&c(s[t.selectedCandidatePairId]),("googCandidatePair"===t.type&&"true"===t.googActiveConnection||("candidatepair"===t.type||"candidate-pair"===t.type)&&t.selected)&&c(t)})),a||Object.keys(s).length&&!Object.keys(i).length){if(t._connecting=!1,t._connected=!0,t._chunk){try{t.send(t._chunk)}catch(e){return t.destroy(d(e,"ERR_DATA_CHANNEL"))}t._chunk=null,t._debug('sent chunk from "write before connect"');var u=t._cb;t._cb=null,u(null)}"number"!=typeof t._channel.bufferedAmountLowThreshold&&(t._interval=setInterval((function(){return t._onInterval()}),150),t._interval.unref&&t._interval.unref()),t._debug("connect"),t.emit("connect")}else setTimeout(e,100)}}))}())}},{key:"_onInterval",value:function(){this._cb&&this._channel&&!(this._channel.bufferedAmount>y)&&this._onChannelBufferedAmountLow()}},{key:"_onSignalingStateChange",value:function(){var t=this;this.destroyed||("stable"===this._pc.signalingState&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach((function(e){t._pc.removeTrack(e),t._queuedNegotiation=!0})),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}},{key:"_onIceCandidate",value:function(t){this.destroyed||(t.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:t.candidate.candidate,sdpMLineIndex:t.candidate.sdpMLineIndex,sdpMid:t.candidate.sdpMid}}):!t.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),t.candidate&&this._startIceCompleteTimeout())}},{key:"_onChannelMessage",value:function(t){if(!this.destroyed){var e=t.data;e instanceof ArrayBuffer&&(e=v.from(e)),this.push(e)}}},{key:"_onChannelBufferedAmountLow",value:function(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);var t=this._cb;this._cb=null,t(null)}}},{key:"_onChannelOpen",value:function(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}},{key:"_onChannelClose",value:function(){this.destroyed||(this._debug("on channel close"),this.destroy())}},{key:"_onTrack",value:function(t){var e=this;this.destroyed||t.streams.forEach((function(n){e._debug("on track"),e.emit("track",t.track,n),e._remoteTracks.push({track:t.track,stream:n}),e._remoteStreams.some((function(t){return t.id===n.id}))||(e._remoteStreams.push(n),p((function(){e._debug("on stream"),e.emit("stream",n)})))}))}},{key:"_debug",value:function(){var t=[].slice.call(arguments);t[0]="["+this._id+"] "+t[0],u.apply(null,t)}},{key:"bufferSize",get:function(){return this._channel&&this._channel.bufferedAmount||0}},{key:"connected",get:function(){return this._connected&&"open"===this._channel.readyState}}]),m}(h.Duplex);m.WEBRTC_SUPPORT=!!l(),m.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},m.channelConfig={},e.exports=m},{buffer:3,debug:5,"err-code":7,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")}()}).call(this,n(39))},function(t,e,n){"use strict";var r=n(128);function o(t,e,n){return"string"!==typeof e?r.reject(new Error("doc id is required")):t.get(e).catch((function(t){if(404!==t.status)throw t;return{}})).then((function(r){var i=r._rev,s=n(r);return s?(s._id=e,s._rev=i,function(t,e,n){return t.put(e).then((function(t){return{updated:!0,rev:t.rev,id:e._id}}),(function(r){if(409!==r.status)throw r;return o(t,e._id,n)}))}(t,s,n)):{updated:!1,rev:i,id:e}}))}e.upsert=function(t,e,n){var r=o(this,t,e);if("function"!==typeof n)return r;r.then((function(t){n(null,t)}),n)},e.putIfNotExists=function(t,e,n){"string"!==typeof t&&(n=e,t=(e=t)._id);var r=o(this,t,(function(t){return!t._rev&&e}));if("function"!==typeof n)return r;r.then((function(t){n(null,t)}),n)},"undefined"!==typeof window&&window.PouchDB&&window.PouchDB.plugin(e)},function(t,e,n){"use strict";var r=n(129);function o(){}var i={},s=["REJECTED"],a=["FULFILLED"],c=["PENDING"];function u(t){if("function"!==typeof t)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,t!==o&&p(this,t)}function l(t,e,n){this.promise=t,"function"===typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"===typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function f(t,e,n){r((function(){var r;try{r=e(n)}catch(o){return i.reject(t,o)}r===t?i.reject(t,new TypeError("Cannot resolve promise with itself")):i.resolve(t,r)}))}function h(t){var e=t&&t.then;if(t&&("object"===typeof t||"function"===typeof t)&&"function"===typeof e)return function(){e.apply(t,arguments)}}function p(t,e){var n=!1;function r(e){n||(n=!0,i.reject(t,e))}function o(e){n||(n=!0,i.resolve(t,e))}var s=d((function(){e(o,r)}));"error"===s.status&&r(s.value)}function d(t,e){var n={};try{n.value=t(e),n.status="success"}catch(r){n.status="error",n.value=r}return n}t.exports=u,u.prototype.catch=function(t){return this.then(null,t)},u.prototype.then=function(t,e){if("function"!==typeof t&&this.state===a||"function"!==typeof e&&this.state===s)return this;var n=new this.constructor(o);this.state!==c?f(n,this.state===a?t:e,this.outcome):this.queue.push(new l(n,t,e));return n},l.prototype.callFulfilled=function(t){i.resolve(this.promise,t)},l.prototype.otherCallFulfilled=function(t){f(this.promise,this.onFulfilled,t)},l.prototype.callRejected=function(t){i.reject(this.promise,t)},l.prototype.otherCallRejected=function(t){f(this.promise,this.onRejected,t)},i.resolve=function(t,e){var n=d(h,e);if("error"===n.status)return i.reject(t,n.value);var r=n.value;if(r)p(t,r);else{t.state=a,t.outcome=e;for(var o=-1,s=t.queue.length;++o<s;)t.queue[o].callFulfilled(e)}return t},i.reject=function(t,e){t.state=s,t.outcome=e;for(var n=-1,r=t.queue.length;++n<r;)t.queue[n].callRejected(e);return t},u.resolve=function(t){if(t instanceof this)return t;return i.resolve(new this(o),t)},u.reject=function(t){var e=new this(o);return i.reject(e,t)},u.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);var s=new Array(n),a=0,c=-1,u=new this(o);for(;++c<n;)l(t[c],c);return u;function l(t,o){e.resolve(t).then((function(t){s[o]=t,++a!==n||r||(r=!0,i.resolve(u,s))}),(function(t){r||(r=!0,i.reject(u,t))}))}},u.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);var s=-1,a=new this(o);for(;++s<n;)c=t[s],e.resolve(c).then((function(t){r||(r=!0,i.resolve(a,t))}),(function(t){r||(r=!0,i.reject(a,t))}));var c;return a}},function(t,e,n){"use strict";n.d(e,"a",(function(){return vm}));var r=n(54),o=200,i=function(){};i.prototype.append=function(t){return t.length?(t=i.from(t),!this.length&&t||t.length<o&&this.leafAppend(t)||this.length<o&&t.leafPrepend(this)||this.appendInner(t)):this},i.prototype.prepend=function(t){return t.length?i.from(t).append(this):this},i.prototype.appendInner=function(t){return new a(this,t)},i.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.length),t>=e?i.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,e))},i.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)},i.prototype.forEach=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length),e<=n?this.forEachInner(t,e,n,0):this.forEachInvertedInner(t,e,n,0)},i.prototype.map=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length);var r=[];return this.forEach((function(e,n){return r.push(t(e,n))}),e,n),r},i.from=function(t){return t instanceof i?t:t&&t.length?new s(t):i.empty};var s=function(t){function e(e){t.call(this),this.values=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(t,n){return 0==t&&n==this.length?this:new e(this.values.slice(t,n))},e.prototype.getInner=function(t){return this.values[t]},e.prototype.forEachInner=function(t,e,n,r){for(var o=e;o<n;o++)if(!1===t(this.values[o],r+o))return!1},e.prototype.forEachInvertedInner=function(t,e,n,r){for(var o=e-1;o>=n;o--)if(!1===t(this.values[o],r+o))return!1},e.prototype.leafAppend=function(t){if(this.length+t.length<=o)return new e(this.values.concat(t.flatten()))},e.prototype.leafPrepend=function(t){if(this.length+t.length<=o)return new e(t.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(i);i.empty=new s([]);var a=function(t){function e(e,n){t.call(this),this.left=e,this.right=n,this.length=e.length+n.length,this.depth=Math.max(e.depth,n.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(t){return t<this.left.length?this.left.get(t):this.right.get(t-this.left.length)},e.prototype.forEachInner=function(t,e,n,r){var o=this.left.length;return!(e<o&&!1===this.left.forEachInner(t,e,Math.min(n,o),r))&&(!(n>o&&!1===this.right.forEachInner(t,Math.max(e-o,0),Math.min(this.length,n)-o,r+o))&&void 0)},e.prototype.forEachInvertedInner=function(t,e,n,r){var o=this.left.length;return!(e>o&&!1===this.right.forEachInvertedInner(t,e-o,Math.max(n,o)-o,r+o))&&(!(n<o&&!1===this.left.forEachInvertedInner(t,Math.min(e,o),n,r))&&void 0)},e.prototype.sliceInner=function(t,e){if(0==t&&e==this.length)return this;var n=this.left.length;return e<=n?this.left.slice(t,e):t>=n?this.right.slice(t-n,e-n):this.left.slice(t,n).append(this.right.slice(0,e-n))},e.prototype.leafAppend=function(t){var n=this.right.leafAppend(t);if(n)return new e(this.left,n)},e.prototype.leafPrepend=function(t){var n=this.left.leafPrepend(t);if(n)return new e(n,this.right)},e.prototype.appendInner=function(t){return this.left.depth>=Math.max(this.right.depth,t.depth)+1?new e(this.left,new e(this.right,t)):new e(this,t)},e}(i),c=i,u=n(4),l=n(12);function f(t,e,n){for(var r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;var o=t.child(r),i=e.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(var s=0;o.text[s]==i.text[s];s++)n++;return n}if(o.content.size||i.content.size){var a=f(o.content,i.content,n+1);if(null!=a)return a}n+=o.nodeSize}else n+=o.nodeSize}}function h(t,e,n,r){for(var o=t.childCount,i=e.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};var s=t.child(--o),a=e.child(--i),c=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){for(var u=0,l=Math.min(s.text.length,a.text.length);u<l&&s.text[s.text.length-u-1]==a.text[a.text.length-u-1];)u++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){var f=h(s.content,a.content,n-1,r-1);if(f)return f}n-=c,r-=c}else n-=c,r-=c}}var p=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},d={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};p.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var u=s+1;a.nodesBetween(Math.max(0,t-u),Math.min(a.content.size,e-u),n,r+u)}s=c}},p.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},p.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},p.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new p(r,this.size+t.size)},p.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var o=0,i=0;i<e;o++){var s=this.content[o],a=i+s.nodeSize;a>t&&((i<t||a>e)&&(s=s.isText?s.cut(Math.max(0,t-i),Math.min(s.text.length,e-i)):s.cut(Math.max(0,t-i-1),Math.min(s.content.size,e-i-1))),n.push(s),r+=s.nodeSize),i=a}return new p(n,r)},p.prototype.cutByIndex=function(t,e){return t==e?p.empty:0==t&&e==this.content.length?this:new p(this.content.slice(t,e))},p.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new p(r,o)},p.prototype.addToStart=function(t){return new p([t].concat(this.content),this.size+t.nodeSize)},p.prototype.addToEnd=function(t){return new p(this.content.concat(t),this.size+t.nodeSize)},p.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},d.firstChild.get=function(){return this.content.length?this.content[0]:null},d.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},d.childCount.get=function(){return this.content.length},p.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},p.prototype.maybeChild=function(t){return this.content[t]},p.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},p.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),f(this,t,e)},p.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),h(this,t,e,n)},p.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return y(0,t);if(t==this.size)return y(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?y(n+1,o):y(n,r);r=o}},p.prototype.toString=function(){return"<"+this.toStringInner()+">"},p.prototype.toStringInner=function(){return this.content.join(", ")},p.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},p.fromJSON=function(t,e){if(!e)return p.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new p(e.map(t.nodeFromJSON))},p.fromArray=function(t){if(!t.length)return p.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new p(e||t,n)},p.from=function(t){if(!t)return p.empty;if(t instanceof p)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new p([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(p.prototype,d);var v={index:0,offset:0};function y(t,e){return v.index=t,v.offset=e,v}function m(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!m(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e)||!m(t[o],e[o]))return!1;for(var i in e)if(!(i in t))return!1}return!0}p.empty=new p([],0);var g=function(t,e){this.type=t,this.attrs=e};function b(t){var e=Error.call(this,t);return e.__proto__=b.prototype,e}g.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},g.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},g.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},g.prototype.eq=function(t){return this==t||this.type==t.type&&m(this.attrs,t.attrs)},g.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},g.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},g.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},g.setFrom=function(t){if(!t||0==t.length)return g.none;if(t instanceof g)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},g.none=[],b.prototype=Object.create(Error.prototype),b.prototype.constructor=b,b.prototype.name="ReplaceError";var w=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},k={size:{configurable:!0}};function x(t,e,n){var r=t.findIndex(e),o=r.index,i=r.offset,s=t.maybeChild(o),a=t.findIndex(n),c=a.index,u=a.offset;if(i==e||s.isText){if(u!=n&&!t.child(c).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return t.replaceChild(o,s.copy(x(s.content,e-i-1,n-i-1)))}function S(t,e,n,r){var o=t.findIndex(e),i=o.index,s=o.offset,a=t.maybeChild(i);if(s==e||a.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));var c=S(a.content,e-s-1,n);return c&&t.replaceChild(i,a.copy(c))}function O(t,e,n){if(n.openStart>t.depth)throw new b("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new b("Inconsistent open depths");return C(t,e,n,0)}function C(t,e,n,r){var o=t.index(r),i=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){var s=C(t,e,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){var a=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(p.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(n,t);return N(i,A(t,a.start,a.end,e,r))}var c=t.parent,u=c.content;return N(c,u.cut(0,t.parentOffset).append(n.content).append(u.cut(e.parentOffset)))}return N(i,I(t,e,r))}function E(t,e){if(!e.type.compatibleContent(t.type))throw new b("Cannot join "+e.type.name+" onto "+t.type.name)}function _(t,e,n){var r=t.node(n);return E(r,e.node(n)),r}function M(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function T(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(M(t.nodeAfter,r),i++));for(var a=i;a<s;a++)M(o.child(a),r);e&&e.depth==n&&e.textOffset&&M(e.nodeBefore,r)}function N(t,e){if(!t.type.validContent(e))throw new b("Invalid content for node "+t.type.name);return t.copy(e)}function A(t,e,n,r,o){var i=t.depth>o&&_(t,e,o+1),s=r.depth>o&&_(n,r,o+1),a=[];return T(null,t,o,a),i&&s&&e.index(o)==n.index(o)?(E(i,s),M(N(i,A(t,e,n,r,o+1)),a)):(i&&M(N(i,I(t,e,o+1)),a),T(e,n,o,a),s&&M(N(s,I(n,r,o+1)),a)),T(r,null,o,a),new p(a)}function I(t,e,n){var r=[];(T(null,t,n,r),t.depth>n)&&M(N(_(t,e,n+1),I(t,e,n+1)),r);return T(e,null,n,r),new p(r)}k.size.get=function(){return this.content.size-this.openStart-this.openEnd},w.prototype.insertAt=function(t,e){var n=S(this.content,t+this.openStart,e,null);return n&&new w(n,this.openStart,this.openEnd)},w.prototype.removeBetween=function(t,e){return new w(x(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},w.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},w.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},w.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},w.fromJSON=function(t,e){if(!e)return w.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new w(p.fromJSON(t,e.content),n,r)},w.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new w(t,n,r)},Object.defineProperties(w.prototype,k),w.empty=new w(p.empty,0,0);var j=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},D={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};j.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},D.parent.get=function(){return this.node(this.depth)},D.doc.get=function(){return this.node(0)},j.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},j.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},j.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},j.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},j.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},j.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},j.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},D.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},D.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},D.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},j.prototype.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,o=0;o<t;o++)r+=n.child(o).nodeSize;return r},j.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return g.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},j.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},j.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},j.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new F(this,t,n)},j.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},j.prototype.max=function(t){return t.pos>this.pos?t:this},j.prototype.min=function(t){return t.pos<this.pos?t:this},j.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},j.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,u=o-c;if(n.push(i,a,r+c),!u)break;if((i=i.child(a)).isText)break;o=u-1,r+=c+1}return new j(e,n,o)},j.resolveCached=function(t,e){for(var n=0;n<R.length;n++){var r=R[n];if(r.pos==e&&r.doc==t)return r}var o=R[P]=j.resolve(t,e);return P=(P+1)%z,o},Object.defineProperties(j.prototype,D);var R=[],P=0,z=12,F=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},B={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};B.start.get=function(){return this.$from.before(this.depth+1)},B.end.get=function(){return this.$to.after(this.depth+1)},B.parent.get=function(){return this.$from.node(this.depth)},B.startIndex.get=function(){return this.$from.index(this.depth)},B.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(F.prototype,B);var L=Object.create(null),$=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||p.empty,this.marks=r||g.none},q={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};q.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},q.childCount.get=function(){return this.content.childCount},$.prototype.child=function(t){return this.content.child(t)},$.prototype.maybeChild=function(t){return this.content.maybeChild(t)},$.prototype.forEach=function(t){this.content.forEach(t)},$.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},$.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},q.textContent.get=function(){return this.textBetween(0,this.content.size,"")},$.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},q.firstChild.get=function(){return this.content.firstChild},q.lastChild.get=function(){return this.content.lastChild},$.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},$.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},$.prototype.hasMarkup=function(t,e,n){return this.type==t&&m(this.attrs,e||t.defaultAttrs||L)&&g.sameSet(this.marks,n||g.none)},$.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},$.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},$.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},$.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return w.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new w(a,r.depth-i,o.depth-i)},$.prototype.replace=function(t,e,n){return O(this.resolve(t),this.resolve(e),n)},$.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},$.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},$.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},$.prototype.resolve=function(t){return j.resolveCached(this,t)},$.prototype.resolveNoCache=function(t){return j.resolve(this,t)},$.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},q.isBlock.get=function(){return this.type.isBlock},q.isTextblock.get=function(){return this.type.isTextblock},q.inlineContent.get=function(){return this.type.inlineContent},q.isInline.get=function(){return this.type.isInline},q.isText.get=function(){return this.type.isText},q.isLeaf.get=function(){return this.type.isLeaf},q.isAtom.get=function(){return this.type.isAtom},$.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),U(this.marks,t)},$.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},$.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=p.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,e);if(!s||!s.validEnd)return!1;for(var a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0},$.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},$.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},$.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},$.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},$.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=p.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties($.prototype,q);var J=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):U(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}($);function U(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var V=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},W={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};V.parse=function(t,e){var n=new H(t,e);if(null==n.next)return V.empty;var r=Y(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return n(et(t,0));function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];et(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new V(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(tt);i.next.push(o[s],e[a.join(",")]||n(a))}return i}}(function(t){var e=[[]];return o(i(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}function i(t,e){if("choice"==t.type)return t.exprs.reduce((function(t,n){return t.concat(i(n,e))}),[]);if("seq"==t.type)for(var s=0;;s++){var a=i(t.exprs[s],e);if(s==t.exprs.length-1)return a;o(a,e=n())}else{if("star"==t.type){var c=n();return r(e,c),o(i(t.expr,c),c),[r(c)]}if("plus"==t.type){var u=n();return o(i(t.expr,e),u),o(i(t.expr,u),u),[r(u)]}if("opt"==t.type)return[r(e)].concat(i(t.expr,e));if("range"==t.type){for(var l=e,f=0;f<t.min;f++){var h=n();o(i(t.expr,l),h),l=h}if(-1==t.max)o(i(t.expr,l),l);else for(var p=t.min;p<t.max;p++){var d=n();r(l,d),o(i(t.expr,l),d),l=d}return[r(l)]}if("name"==t.type)return[r(e,null,t.value)]}}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],u=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(u)&&r.push(u)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},V.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},V.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},W.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},W.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},V.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},V.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,s){var a=i.matchFragment(t,n);if(a&&(!e||a.validEnd))return p.from(s.map((function(t){return t.createAndFill()})));for(var c=0;c<i.next.length;c+=2){var u=i.next[c],l=i.next[c+1];if(!u.isText&&!u.hasRequiredAttrs()&&-1==r.indexOf(l)){r.push(l);var f=o(l,s.concat(u));if(f)return f}}}(this,[])},V.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},V.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},W.edgeCount.get=function(){return this.next.length>>1},V.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},V.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(V.prototype,W),V.empty=new V(!0);var H=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},K={next:{configurable:!0}};function Y(t){var e=[];do{e.push(G(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function G(t){var e=[];do{e.push(Q(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function Q(t){for(var e=function(t){if(t.eat("(")){var e=Y(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=Z(t,e)}return e}function X(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function Z(t,e){var n=X(t),r=n;return t.eat(",")&&(r="}"!=t.next?X(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function tt(t,e){return e-t}function et(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(tt)}function nt(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function rt(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function ot(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new at(t[n]);return e}K.next.get=function(){return this.tokens[this.pos]},H.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},H.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(H.prototype,K);var it=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=ot(n.attrs),this.defaultAttrs=nt(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},st={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};st.isInline.get=function(){return!this.isBlock},st.isTextblock.get=function(){return this.isBlock&&this.inlineContent},st.isLeaf.get=function(){return this.contentMatch==V.empty},st.isAtom.get=function(){return this.isLeaf||this.spec.atom},it.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},it.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},it.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:rt(this.attrs,t)},it.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new $(this,this.computeAttrs(t),p.from(e),g.setFrom(n))},it.prototype.createChecked=function(t,e,n){if(e=p.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new $(this,this.computeAttrs(t),e,g.setFrom(n))},it.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=p.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e).fillBefore(p.empty,!0);return o?new $(this,t,e.append(o),g.setFrom(n)):null},it.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},it.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},it.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},it.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:g.empty:t},it.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new it(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(it.prototype,st);var at=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},ct={isRequired:{configurable:!0}};ct.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(at.prototype,ct);var ut=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=ot(r.attrs),this.rank=e,this.excluded=null;var o=nt(this.attrs);this.instance=o&&new g(this,o)};ut.prototype.create=function(t){return!t&&this.instance?this.instance:new g(this,rt(this.attrs,t))},ut.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new ut(t,r++,e,o)})),n},ut.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},ut.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},ut.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var lt=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=l.a.from(t.nodes),this.spec.marks=l.a.from(t.marks),this.nodes=it.compile(this.spec.nodes,this),this.marks=ut.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],i=o.spec.content||"",s=o.spec.marks;o.contentMatch=n[i]||(n[i]=V.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==s?null:s?ft(this,s.split(" ")):""!=s&&o.inlineContent?null:[]}for(var a in this.marks){var c=this.marks[a],u=c.spec.excludes;c.excluded=null==u?[c]:""==u?[]:ft(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function ft(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}lt.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof it))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},lt.prototype.text=function(t,e){var n=this.nodes.text;return new J(n,n.defaultAttrs,t,g.setFrom(e))},lt.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},lt.prototype.nodeFromJSON=function(t){return $.fromJSON(this,t)},lt.prototype.markFromJSON=function(t){return g.fromJSON(this,t)},lt.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var ht=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)})),this.normalizeLists=!this.tags.some((function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)}))};ht.prototype.parse=function(t,e){void 0===e&&(e={});var n=new gt(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},ht.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new gt(this,e,!0);return n.addAll(t,null,e.from,e.to),w.maxOpen(n.finish())},ht.prototype.matchTag=function(t,e,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(wt(t,o.tag)&&(void 0===o.namespace||t.namespaceURI==o.namespace)&&(!o.context||e.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(t);if(!1===i)continue;o.attrs=i}return o}}},ht.prototype.matchStyle=function(t,e,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(t)||i.context&&!n.matchesContext(i.context)||i.style.length>t.length&&(61!=i.style.charCodeAt(t.length)||i.style.slice(t.length+1)!=e))){if(i.getAttrs){var s=i.getAttrs(e);if(!1===s)continue;i.attrs=s}return i}}},ht.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=kt(t)),t.mark=e}))};for(var o in t.marks)r(o);var i=function(e){var r=t.nodes[s].spec.parseDOM;r&&r.forEach((function(t){n(t=kt(t)),t.node=s}))};for(var s in t.nodes)i();return e},ht.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new ht(t,ht.schemaRules(t)))};var pt={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},dt={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},vt={ol:!0,ul:!0};function yt(t){return(t?1:0)|("full"===t?2:0)}var mt=function(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=g.none,this.pendingMarks=r,this.stashMarks=[]};mt.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(p.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},mt.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=p.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(p.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},mt.prototype.popFromStashMark=function(t){for(var e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]},mt.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):xt(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}};var gt=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,i=yt(e.preserveWhitespace)|(n?4:0);r=o?new mt(o.type,o.attrs,g.none,g.none,!0,e.topMatch||o.type.contentMatch,i):new mt(n?null:t.schema.topNodeType,null,g.none,g.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},bt={top:{configurable:!0},currentPos:{configurable:!0}};function wt(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function kt(t){var e={};for(var n in t)e[n]=t[n];return e}function xt(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var i=[];return function t(n){i.push(n);for(var r=0;r<n.edgeCount;r++){var o=n.edge(r),s=o.type,a=o.next;if(s==e)return!0;if(i.indexOf(a)<0&&t(a))return!0}}(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}bt.top.get=function(){return this.nodes[this.open]},gt.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},gt.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},gt.prototype.addElement=function(t,e){var n,r=t.nodeName.toLowerCase();vt.hasOwnProperty(r)&&this.parser.normalizeLists&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&vt.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var o=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(n=this.parser.matchTag(t,this,e));if(o?o.ignore:dt.hasOwnProperty(r))this.findInside(t);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(t=o.skip);var i,s=this.top,a=this.needsBlock;if(pt.hasOwnProperty(r))i=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),i&&this.sync(s),this.needsBlock=a}else this.addElementByRule(t,o,!1===o.consuming?n:null)},gt.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},gt.prototype.readStyles=function(t){var e=g.none;t:for(var n=0;n<t.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(t[n],t[n+1],this,r);if(!o)continue t;if(o.ignore)return null;if(e=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(e),!1!==o.consuming)break;r=o}return e},gt.prototype.addElementByRule=function(t,e,n){var r,o,i,s=this;e.node?(o=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(o.create(e.attrs))||this.leafFallback(t):r=this.enter(o,e.attrs,e.preserveWhitespace):(i=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(i));var a=this.top;if(o&&o.isLeaf)this.findInside(t);else if(n)this.addElement(t,n);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return s.insertNode(t)}));else{var c=e.contentElement;"string"==typeof c?c=t.querySelector(c):"function"==typeof c&&(c=c(t)),c||(c=t),this.findAround(t,c,!0),this.addAll(c,r)}r&&(this.sync(a),this.open--),i&&this.removePendingMark(i,a)},gt.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&pt.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},gt.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},gt.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},gt.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},gt.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:yt(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new mt(t,e,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},gt.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},gt.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},gt.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},bt.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},gt.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},gt.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},gt.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},gt.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},gt.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1);return function t(s,a){for(;s>=0;s--){var c=n[s];if(""==c){if(s==n.length-1||0==s)continue;for(;a>=i;a--)if(t(s-1,a))return!0;return!1}var u=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!u||u.name!=c&&-1==u.groups.indexOf(c))return!1;a--}return!0}(n.length-1,this.open)},gt.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},gt.prototype.addPendingMark=function(t){var e=function(t,e){for(var n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},gt.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(t)>-1)r.pendingMarks=t.removeFromSet(r.pendingMarks);else{r.activeMarks=t.removeFromSet(r.activeMarks);var o=r.popFromStashMark(t);o&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==e)break}},Object.defineProperties(gt.prototype,bt);var St=function(t,e){this.nodes=t||{},this.marks=e||{}};function Ot(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Ct(t){return t.document||window.document}St.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=Ct(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],u=r.serializeMark(c,t.isInline,e);u&&(i.push(c,o),o.appendChild(u.dom),o=u.contentDOM||u.dom)}}o.appendChild(r.serializeNode(t,e))})),n},St.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=St.renderSpec(Ct(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},St.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},St.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&St.renderSpec(Ct(n),r(t,e))},St.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var u in c=2,a)if(null!=a[u]){var l=u.indexOf(" ");l>0?s.setAttributeNS(u.slice(0,l),u.slice(l+1),a[u]):s.setAttribute(u,a[u])}for(var f=c;f<e.length;f++){var h=e[f];if(0===h){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var p=St.renderSpec(t,h,n),d=p.dom,v=p.contentDOM;if(s.appendChild(d),v){if(i)throw new RangeError("Multiple content holes");i=v}}return{dom:s,contentDOM:i}},St.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new St(this.nodesFromSchema(t),this.marksFromSchema(t)))},St.nodesFromSchema=function(t){var e=Ot(t.nodes);return e.text||(e.text=function(t){return t.text}),e},St.marksFromSchema=function(t){return Ot(t.marks)};var Et=Object.create(null),_t=function(t,e,n){this.ranges=n||[new Tt(t.min(e),t.max(e))],this.$anchor=t,this.$head=e},Mt={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};Mt.anchor.get=function(){return this.$anchor.pos},Mt.head.get=function(){return this.$head.pos},Mt.from.get=function(){return this.$from.pos},Mt.to.get=function(){return this.$to.pos},Mt.$from.get=function(){return this.ranges[0].$from},Mt.$to.get=function(){return this.ranges[0].$to},Mt.empty.get=function(){for(var t=this.ranges,e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0},_t.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},_t.prototype.replace=function(t,e){void 0===e&&(e=w.empty);for(var n=e.content.lastChild,r=null,o=0;o<e.openEnd;o++)r=n,n=n.lastChild;for(var i=t.steps.length,s=this.ranges,a=0;a<s.length;a++){var c=s[a],u=c.$from,l=c.$to,f=t.mapping.slice(i);t.replaceRange(f.map(u.pos),f.map(l.pos),a?w.empty:e),0==a&&zt(t,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}},_t.prototype.replaceWith=function(t,e){for(var n=t.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],s=i.$from,a=i.$to,c=t.mapping.slice(n),u=c.map(s.pos),l=c.map(a.pos);o?t.deleteRange(u,l):(t.replaceRangeWith(u,l,e),zt(t,n,e.isInline?-1:1))}},_t.findFrom=function(t,e,n){var r=t.parent.inlineContent?new Nt(t):Pt(t.node(0),t.parent,t.pos,t.index(),e,n);if(r)return r;for(var o=t.depth-1;o>=0;o--){var i=e<0?Pt(t.node(0),t.node(o),t.before(o+1),t.index(o),e,n):Pt(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,e,n);if(i)return i}},_t.near=function(t,e){return void 0===e&&(e=1),this.findFrom(t,e)||this.findFrom(t,-e)||new Dt(t.node(0))},_t.atStart=function(t){return Pt(t,t,0,0,1)||new Dt(t)},_t.atEnd=function(t){return Pt(t,t,t.content.size,t.childCount,-1)||new Dt(t)},_t.fromJSON=function(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=Et[e.type];if(!n)throw new RangeError("No selection type "+e.type+" defined");return n.fromJSON(t,e)},_t.jsonID=function(t,e){if(t in Et)throw new RangeError("Duplicate use of selection JSON ID "+t);return Et[t]=e,e.prototype.jsonID=t,e},_t.prototype.getBookmark=function(){return Nt.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(_t.prototype,Mt),_t.prototype.visible=!0;var Tt=function(t,e){this.$from=t,this.$to=e},Nt=function(t){function e(e,n){void 0===n&&(n=e),t.call(this,e,n)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},e.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));if(!o.parent.inlineContent)return t.near(o);var i=n.resolve(r.map(this.anchor));return new e(i.parent.inlineContent?i:o,o)},e.prototype.replace=function(e,n){if(void 0===n&&(n=w.empty),t.prototype.replace.call(this,e,n),n==w.empty){var r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head},e.prototype.getBookmark=function(){return new At(this.anchor,this.head)},e.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(n.anchor),t.resolve(n.head))},e.create=function(t,e,n){void 0===n&&(n=e);var r=t.resolve(e);return new this(r,n==e?r:t.resolve(n))},e.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=i>=0?1:-1),!r.parent.inlineContent){var s=t.findFrom(r,o,!0)||t.findFrom(r,-o,!0);if(!s)return t.near(r,o);r=s.$head}return n.parent.inlineContent||(0==i||(n=(t.findFrom(n,-o,!0)||t.findFrom(n,o,!0)).$anchor).pos<r.pos!=i<0)&&(n=r),new e(n,r)},Object.defineProperties(e.prototype,n),e}(_t);_t.jsonID("text",Nt);var At=function(t,e){this.anchor=t,this.head=e};At.prototype.map=function(t){return new At(t.map(this.anchor),t.map(this.head))},At.prototype.resolve=function(t){return Nt.between(t.resolve(this.anchor),t.resolve(this.head))};var It=function(t){function e(e){var n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);t.call(this,e,r),this.node=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(n,r){var o=r.mapResult(this.anchor),i=o.deleted,s=o.pos,a=n.resolve(s);return i?t.near(a):new e(a)},e.prototype.content=function(){return new w(p.from(this.node),0,0)},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor},e.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},e.prototype.getBookmark=function(){return new jt(this.anchor)},e.fromJSON=function(t,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(n.anchor))},e.create=function(t,e){return new this(t.resolve(e))},e.isSelectable=function(t){return!t.isText&&!1!==t.type.spec.selectable},e}(_t);It.prototype.visible=!1,_t.jsonID("node",It);var jt=function(t){this.anchor=t};jt.prototype.map=function(t){var e=t.mapResult(this.anchor),n=e.deleted,r=e.pos;return n?new At(r,r):new jt(r)},jt.prototype.resolve=function(t){var e=t.resolve(this.anchor),n=e.nodeAfter;return n&&It.isSelectable(n)?new It(e):_t.near(e)};var Dt=function(t){function e(e){t.call(this,e.resolve(0),e.resolve(e.content.size))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.replace=function(e,n){if(void 0===n&&(n=w.empty),n==w.empty){e.delete(0,e.doc.content.size);var r=t.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else t.prototype.replace.call(this,e,n)},e.prototype.toJSON=function(){return{type:"all"}},e.fromJSON=function(t){return new e(t)},e.prototype.map=function(t){return new e(t)},e.prototype.eq=function(t){return t instanceof e},e.prototype.getBookmark=function(){return Rt},e}(_t);_t.jsonID("all",Dt);var Rt={map:function(){return this},resolve:function(t){return new Dt(t)}};function Pt(t,e,n,r,o,i){if(e.inlineContent)return Nt.create(t,n);for(var s=r-(o>0?0:1);o>0?s<e.childCount:s>=0;s+=o){var a=e.child(s);if(a.isAtom){if(!i&&It.isSelectable(a))return It.create(t,n-(o<0?a.nodeSize:0))}else{var c=Pt(t,a,n+o,o<0?a.childCount:0,o,i);if(c)return c}n+=a.nodeSize*o}}function zt(t,e,n){var r=t.steps.length-1;if(!(r<e)){var o,i=t.steps[r];if(i instanceof u.c||i instanceof u.b)t.mapping.maps[r].forEach((function(t,e,n,r){null==o&&(o=r)})),t.setSelection(_t.near(t.doc.resolve(o),n))}}var Ft=function(t){function e(e){t.call(this,e.doc),this.time=Date.now(),this.curSelection=e.selection,this.curSelectionFor=0,this.storedMarks=e.storedMarks,this.updated=0,this.meta=Object.create(null)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},e.prototype.setSelection=function(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return(1&this.updated)>0},e.prototype.setStoredMarks=function(t){return this.storedMarks=t,this.updated|=2,this},e.prototype.ensureMarks=function(t){return g.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this},e.prototype.addStoredMark=function(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))},e.prototype.removeStoredMark=function(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(2&this.updated)>0},e.prototype.addStep=function(e,n){t.prototype.addStep.call(this,e,n),this.updated=-3&this.updated,this.storedMarks=null},e.prototype.setTime=function(t){return this.time=t,this},e.prototype.replaceSelection=function(t){return this.selection.replace(this,t),this},e.prototype.replaceSelectionWith=function(t,e){var n=this.selection;return!1!==e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||g.none))),n.replaceWith(this,t),this},e.prototype.deleteSelection=function(){return this.selection.replace(this),this},e.prototype.insertText=function(t,e,n){void 0===n&&(n=e);var r=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();if(!t)return this.deleteRange(e,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(e);o=n==e?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(e,n,r.text(t,o)),this.selection.empty||this.setSelection(_t.near(this.selection.$to)),this},e.prototype.setMeta=function(t,e){return this.meta["string"==typeof t?t:t.key]=e,this},e.prototype.getMeta=function(t){return this.meta["string"==typeof t?t:t.key]},n.isGeneric.get=function(){for(var t in this.meta)return!1;return!0},e.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(e.prototype,n),e}(u.d);function Bt(t,e){return e&&t?t.bind(e):t}var Lt=function(t,e,n){this.name=t,this.init=Bt(e.init,n),this.apply=Bt(e.apply,n)},$t=[new Lt("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new Lt("selection",{init:function(t,e){return t.selection||_t.atStart(e.doc)},apply:function(t){return t.selection}}),new Lt("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Lt("scrollToSelection",{init:function(){return 0},apply:function(t,e){return t.scrolledIntoView?e+1:e}})],qt=function(t,e){var n=this;this.schema=t,this.fields=$t.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),e&&e.forEach((function(t){if(n.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");n.plugins.push(t),n.pluginsByKey[t.key]=t,t.spec.state&&n.fields.push(new Lt(t.key,t.spec.state,t))}))},Jt=function(t){this.config=t},Ut={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};Ut.schema.get=function(){return this.config.schema},Ut.plugins.get=function(){return this.config.plugins},Jt.prototype.apply=function(t){return this.applyTransaction(t).state},Jt.prototype.filterTransaction=function(t,e){void 0===e&&(e=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=e){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,t,this))return!1}return!0},Jt.prototype.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var e=[t],n=this.applyInner(t),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var s=this.config.plugins[i];if(s.spec.appendTransaction){var a=r?r[i].n:0,c=r?r[i].state:this,u=a<e.length&&s.spec.appendTransaction.call(s,a?e.slice(a):e,c,n);if(u&&n.filterTransaction(u,i)){if(u.setMeta("appendedTransaction",t),!r){r=[];for(var l=0;l<this.config.plugins.length;l++)r.push(l<i?{state:n,n:e.length}:{state:this,n:0})}e.push(u),n=n.applyInner(u),o=!0}r&&(r[i]={state:n,n:e.length})}}if(!o)return{state:n,transactions:e}}},Jt.prototype.applyInner=function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var e=new Jt(this.config),n=this.config.fields,r=0;r<n.length;r++){var o=n[r];e[o.name]=o.apply(t,this[o.name],this,e)}for(var i=0;i<Vt.length;i++)Vt[i](this,t,e);return e},Ut.tr.get=function(){return new Ft(this)},Jt.create=function(t){for(var e=new qt(t.schema||t.doc.type.schema,t.plugins),n=new Jt(e),r=0;r<e.fields.length;r++)n[e.fields[r].name]=e.fields[r].init(t,n);return n},Jt.prototype.reconfigure=function(t){for(var e=new qt(t.schema||this.schema,t.plugins),n=e.fields,r=new Jt(e),o=0;o<n.length;o++){var i=n[o].name;r[i]=this.hasOwnProperty(i)?this[i]:n[o].init(t,r)}return r},Jt.prototype.toJSON=function(t){var e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map((function(t){return t.toJSON()}))),t&&"object"==typeof t)for(var n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=t[n],o=r.spec.state;o&&o.toJSON&&(e[n]=o.toJSON.call(r,this[r.key]))}return e},Jt.fromJSON=function(t,e,n){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var r=new qt(t.schema,t.plugins),o=new Jt(r);return r.fields.forEach((function(r){if("doc"==r.name)o.doc=$.fromJSON(t.schema,e.doc);else if("selection"==r.name)o.selection=_t.fromJSON(o.doc,e.selection);else if("storedMarks"==r.name)e.storedMarks&&(o.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(n)for(var i in n){var s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(e,i))return void(o[r.name]=a.fromJSON.call(s,t,e[i],o))}o[r.name]=r.init(t,o)}})),o},Jt.addApplyListener=function(t){Vt.push(t)},Jt.removeApplyListener=function(t){var e=Vt.indexOf(t);e>-1&&Vt.splice(e,1)},Object.defineProperties(Jt.prototype,Ut);var Vt=[];function Wt(t,e,n){for(var r in t){var o=t[r];o instanceof Function?o=o.bind(e):"handleDOMEvents"==r&&(o=Wt(o,e,{})),n[r]=o}return n}var Ht=function(t){this.props={},t.props&&Wt(t.props,this,this.props),this.spec=t,this.key=t.key?t.key.key:Yt("plugin")};Ht.prototype.getState=function(t){return t[this.key]};var Kt=Object.create(null);function Yt(t){return t in Kt?t+"$"+ ++Kt[t]:(Kt[t]=0,t+"$")}var Gt=function(t){void 0===t&&(t="key"),this.key=Yt(t)};Gt.prototype.get=function(t){return t.config.pluginsByKey[this.key]},Gt.prototype.getState=function(t){return t[this.key]};var Qt=function(t,e){this.items=t,this.eventCount=e};Qt.prototype.popEvent=function(t,e){var n=this;if(0==this.eventCount)return null;for(var r,o,i=this.items.length;;i--){if(this.items.get(i-1).selection){--i;break}}e&&(r=this.remapping(i,this.items.length),o=r.maps.length);var s,a,c=t.tr,u=[],l=[];return this.items.forEach((function(t,e){if(!t.step)return r||(r=n.remapping(i,e+1),o=r.maps.length),o--,void l.push(t);if(r){l.push(new Xt(t.map));var f,h=t.step.map(r.slice(o));h&&c.maybeStep(h).doc&&(f=c.mapping.maps[c.mapping.maps.length-1],u.push(new Xt(f,null,null,u.length+l.length))),o--,f&&r.appendMap(f,o)}else c.maybeStep(t.step);return t.selection?(s=r?t.selection.map(r.slice(o)):t.selection,a=new Qt(n.items.slice(0,i).append(l.reverse().concat(u)),n.eventCount-1),!1):void 0}),this.items.length,0),{remaining:a,transform:c,selection:s}},Qt.prototype.addTransform=function(t,e,n,r){for(var o=[],i=this.eventCount,s=this.items,a=!r&&s.length?s.get(s.length-1):null,c=0;c<t.steps.length;c++){var u,l=t.steps[c].invert(t.docs[c]),f=new Xt(t.mapping.maps[c],l,e);(u=a&&a.merge(f))&&(f=u,c?o.pop():s=s.slice(0,s.length-1)),o.push(f),e&&(i++,e=null),r||(a=f)}var h=i-n.depth;return h>te&&(s=function(t,e){var n;return t.forEach((function(t,r){if(t.selection&&0==e--)return n=r,!1})),t.slice(n)}(s,h),i-=h),new Qt(s.append(o),i)},Qt.prototype.remapping=function(t,e){var n=new u.a;return this.items.forEach((function(e,r){var o=null!=e.mirrorOffset&&r-e.mirrorOffset>=t?n.maps.length-e.mirrorOffset:null;n.appendMap(e.map,o)}),t,e),n},Qt.prototype.addMaps=function(t){return 0==this.eventCount?this:new Qt(this.items.append(t.map((function(t){return new Xt(t)}))),this.eventCount)},Qt.prototype.rebased=function(t,e){if(!this.eventCount)return this;var n=[],r=Math.max(0,this.items.length-e),o=t.mapping,i=t.steps.length,s=this.eventCount;this.items.forEach((function(t){t.selection&&s--}),r);var a=e;this.items.forEach((function(e){var r=o.getMirror(--a);if(null!=r){i=Math.min(i,r);var c=o.maps[r];if(e.step){var u=t.steps[r].invert(t.docs[r]),l=e.selection&&e.selection.map(o.slice(a+1,r));l&&s++,n.push(new Xt(c,u,l))}else n.push(new Xt(c))}}),r);for(var c=[],u=e;u<i;u++)c.push(new Xt(o.maps[u]));var l=this.items.slice(0,r).append(c).append(n),f=new Qt(l,s);return f.emptyItemCount()>500&&(f=f.compress(this.items.length-n.length)),f},Qt.prototype.emptyItemCount=function(){var t=0;return this.items.forEach((function(e){e.step||t++})),t},Qt.prototype.compress=function(t){void 0===t&&(t=this.items.length);var e=this.remapping(0,t),n=e.maps.length,r=[],o=0;return this.items.forEach((function(i,s){if(s>=t)r.push(i),i.selection&&o++;else if(i.step){var a=i.step.map(e.slice(n)),c=a&&a.getMap();if(n--,c&&e.appendMap(c,n),a){var u=i.selection&&i.selection.map(e.slice(n));u&&o++;var l,f=new Xt(c.invert(),a,u),h=r.length-1;(l=r.length&&r[h].merge(f))?r[h]=l:r.push(f)}}else i.map&&n--}),this.items.length,0),new Qt(c.from(r.reverse()),o)},Qt.empty=new Qt(c.empty,0);var Xt=function(t,e,n,r){this.map=t,this.step=e,this.selection=n,this.mirrorOffset=r};Xt.prototype.merge=function(t){if(this.step&&t.step&&!t.selection){var e=t.step.merge(this.step);if(e)return new Xt(e.getMap().invert(),e,this.selection)}};var Zt=function(t,e,n,r){this.done=t,this.undone=e,this.prevRanges=n,this.prevTime=r},te=20;function ee(t){var e=[];return t.forEach((function(t,n,r,o){return e.push(r,o)})),e}function ne(t,e){if(!t)return null;for(var n=[],r=0;r<t.length;r+=2){var o=e.map(t[r],1),i=e.map(t[r+1],-1);o<=i&&n.push(o,i)}return n}function re(t,e,n,r){var o=se(e),i=ae.get(e).spec.config,s=(r?t.undone:t.done).popEvent(e,o);if(s){var a=s.selection.resolve(s.transform.doc),c=(r?t.done:t.undone).addTransform(s.transform,e.selection.getBookmark(),i,o),u=new Zt(r?c:s.remaining,r?s.remaining:c,null,0);n(s.transform.setSelection(a).setMeta(ae,{redo:r,historyState:u}).scrollIntoView())}}var oe=!1,ie=null;function se(t){var e=t.plugins;if(ie!=e){oe=!1,ie=e;for(var n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){oe=!0;break}}return oe}var ae=new Gt("history"),ce=new Gt("closeHistory");function ue(t){return t={depth:t&&t.depth||100,newGroupDelay:t&&t.newGroupDelay||500},new Ht({key:ae,state:{init:function(){return new Zt(Qt.empty,Qt.empty,null,0)},apply:function(e,n,r){return function(t,e,n,r){var o,i=n.getMeta(ae);if(i)return i.historyState;n.getMeta(ce)&&(t=new Zt(t.done,t.undone,null,0));var s=n.getMeta("appendedTransaction");if(0==n.steps.length)return t;if(s&&s.getMeta(ae))return s.getMeta(ae).redo?new Zt(t.done.addTransform(n,null,r,se(e)),t.undone,ee(n.mapping.maps[n.steps.length-1]),t.prevTime):new Zt(t.done,t.undone.addTransform(n,null,r,se(e)),null,t.prevTime);if(!1===n.getMeta("addToHistory")||s&&!1===s.getMeta("addToHistory"))return(o=n.getMeta("rebased"))?new Zt(t.done.rebased(n,o),t.undone.rebased(n,o),ne(t.prevRanges,n.mapping),t.prevTime):new Zt(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),ne(t.prevRanges,n.mapping),t.prevTime);var a=0==t.prevTime||!s&&(t.prevTime<(n.time||0)-r.newGroupDelay||!function(t,e){if(!e)return!1;if(!t.docChanged)return!0;var n=!1;return t.mapping.maps[0].forEach((function(t,r){for(var o=0;o<e.length;o+=2)t<=e[o+1]&&r>=e[o]&&(n=!0)})),n}(n,t.prevRanges)),c=s?ne(t.prevRanges,n.mapping):ee(n.mapping.maps[n.steps.length-1]);return new Zt(t.done.addTransform(n,a?e.selection.getBookmark():null,r,se(e)),Qt.empty,c,n.time)}(n,r,e,t)}},config:t})}function le(t,e){var n=ae.getState(t);return!(!n||0==n.done.eventCount)&&(e&&re(n,t,e,!1),!0)}function fe(t,e){var n=ae.getState(t);return!(!n||0==n.undone.eventCount)&&(e&&re(n,t,e,!0),!0)}function he(t,e,n){for(var r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;var o=t.child(r),i=e.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(var s=0;o.text[s]==i.text[s];s++)n++;return n}if(o.content.size||i.content.size){var a=he(o.content,i.content,n+1);if(null!=a)return a}n+=o.nodeSize}else n+=o.nodeSize}}function pe(t,e,n,r){for(var o=t.childCount,i=e.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};var s=t.child(--o),a=e.child(--i),c=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){for(var u=0,l=Math.min(s.text.length,a.text.length);u<l&&s.text[s.text.length-u-1]==a.text[a.text.length-u-1];)u++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){var f=pe(s.content,a.content,n-1,r-1);if(f)return f}n-=c,r-=c}else n-=c,r-=c}}var de=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},ve={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};de.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var u=s+1;a.nodesBetween(Math.max(0,t-u),Math.min(a.content.size,e-u),n,r+u)}s=c}},de.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},de.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},de.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new de(r,this.size+t.size)},de.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var o=0,i=0;i<e;o++){var s=this.content[o],a=i+s.nodeSize;a>t&&((i<t||a>e)&&(s=s.isText?s.cut(Math.max(0,t-i),Math.min(s.text.length,e-i)):s.cut(Math.max(0,t-i-1),Math.min(s.content.size,e-i-1))),n.push(s),r+=s.nodeSize),i=a}return new de(n,r)},de.prototype.cutByIndex=function(t,e){return t==e?de.empty:0==t&&e==this.content.length?this:new de(this.content.slice(t,e))},de.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new de(r,o)},de.prototype.addToStart=function(t){return new de([t].concat(this.content),this.size+t.nodeSize)},de.prototype.addToEnd=function(t){return new de(this.content.concat(t),this.size+t.nodeSize)},de.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},ve.firstChild.get=function(){return this.content.length?this.content[0]:null},ve.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},ve.childCount.get=function(){return this.content.length},de.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},de.prototype.maybeChild=function(t){return this.content[t]},de.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},de.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),he(this,t,e)},de.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),pe(this,t,e,n)},de.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return me(0,t);if(t==this.size)return me(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?me(n+1,o):me(n,r);r=o}},de.prototype.toString=function(){return"<"+this.toStringInner()+">"},de.prototype.toStringInner=function(){return this.content.join(", ")},de.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},de.fromJSON=function(t,e){if(!e)return de.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new de(e.map(t.nodeFromJSON))},de.fromArray=function(t){if(!t.length)return de.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new de(e||t,n)},de.from=function(t){if(!t)return de.empty;if(t instanceof de)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new de([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(de.prototype,ve);var ye={index:0,offset:0};function me(t,e){return ye.index=t,ye.offset=e,ye}function ge(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!ge(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e)||!ge(t[o],e[o]))return!1;for(var i in e)if(!(i in t))return!1}return!0}de.empty=new de([],0);var be=function(t,e){this.type=t,this.attrs=e};function we(t){var e=Error.call(this,t);return e.__proto__=we.prototype,e}be.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},be.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},be.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},be.prototype.eq=function(t){return this==t||this.type==t.type&&ge(this.attrs,t.attrs)},be.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},be.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},be.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},be.setFrom=function(t){if(!t||0==t.length)return be.none;if(t instanceof be)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},be.none=[],we.prototype=Object.create(Error.prototype),we.prototype.constructor=we,we.prototype.name="ReplaceError";var ke=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},xe={size:{configurable:!0}};function Se(t,e,n){var r=t.findIndex(e),o=r.index,i=r.offset,s=t.maybeChild(o),a=t.findIndex(n),c=a.index,u=a.offset;if(i==e||s.isText){if(u!=n&&!t.child(c).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return t.replaceChild(o,s.copy(Se(s.content,e-i-1,n-i-1)))}function Oe(t,e,n,r){var o=t.findIndex(e),i=o.index,s=o.offset,a=t.maybeChild(i);if(s==e||a.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));var c=Oe(a.content,e-s-1,n);return c&&t.replaceChild(i,a.copy(c))}function Ce(t,e,n){if(n.openStart>t.depth)throw new we("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new we("Inconsistent open depths");return Ee(t,e,n,0)}function Ee(t,e,n,r){var o=t.index(r),i=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){var s=Ee(t,e,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){var a=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(de.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(n,t);return Ae(i,Ie(t,a.start,a.end,e,r))}var c=t.parent,u=c.content;return Ae(c,u.cut(0,t.parentOffset).append(n.content).append(u.cut(e.parentOffset)))}return Ae(i,je(t,e,r))}function _e(t,e){if(!e.type.compatibleContent(t.type))throw new we("Cannot join "+e.type.name+" onto "+t.type.name)}function Me(t,e,n){var r=t.node(n);return _e(r,e.node(n)),r}function Te(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Ne(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(Te(t.nodeAfter,r),i++));for(var a=i;a<s;a++)Te(o.child(a),r);e&&e.depth==n&&e.textOffset&&Te(e.nodeBefore,r)}function Ae(t,e){if(!t.type.validContent(e))throw new we("Invalid content for node "+t.type.name);return t.copy(e)}function Ie(t,e,n,r,o){var i=t.depth>o&&Me(t,e,o+1),s=r.depth>o&&Me(n,r,o+1),a=[];return Ne(null,t,o,a),i&&s&&e.index(o)==n.index(o)?(_e(i,s),Te(Ae(i,Ie(t,e,n,r,o+1)),a)):(i&&Te(Ae(i,je(t,e,o+1)),a),Ne(e,n,o,a),s&&Te(Ae(s,je(n,r,o+1)),a)),Ne(r,null,o,a),new de(a)}function je(t,e,n){var r=[];(Ne(null,t,n,r),t.depth>n)&&Te(Ae(Me(t,e,n+1),je(t,e,n+1)),r);return Ne(e,null,n,r),new de(r)}xe.size.get=function(){return this.content.size-this.openStart-this.openEnd},ke.prototype.insertAt=function(t,e){var n=Oe(this.content,t+this.openStart,e,null);return n&&new ke(n,this.openStart,this.openEnd)},ke.prototype.removeBetween=function(t,e){return new ke(Se(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},ke.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},ke.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},ke.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},ke.fromJSON=function(t,e){if(!e)return ke.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new ke(de.fromJSON(t,e.content),n,r)},ke.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new ke(t,n,r)},Object.defineProperties(ke.prototype,xe),ke.empty=new ke(de.empty,0,0);var De=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},Re={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};De.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},Re.parent.get=function(){return this.node(this.depth)},Re.doc.get=function(){return this.node(0)},De.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},De.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},De.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},De.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},De.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},De.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},De.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},Re.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},Re.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},Re.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},De.prototype.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,o=0;o<t;o++)r+=n.child(o).nodeSize;return r},De.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return be.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},De.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},De.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},De.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new Be(this,t,n)},De.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},De.prototype.max=function(t){return t.pos>this.pos?t:this},De.prototype.min=function(t){return t.pos<this.pos?t:this},De.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},De.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,u=o-c;if(n.push(i,a,r+c),!u)break;if((i=i.child(a)).isText)break;o=u-1,r+=c+1}return new De(e,n,o)},De.resolveCached=function(t,e){for(var n=0;n<Pe.length;n++){var r=Pe[n];if(r.pos==e&&r.doc==t)return r}var o=Pe[ze]=De.resolve(t,e);return ze=(ze+1)%Fe,o},Object.defineProperties(De.prototype,Re);var Pe=[],ze=0,Fe=12,Be=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},Le={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};Le.start.get=function(){return this.$from.before(this.depth+1)},Le.end.get=function(){return this.$to.after(this.depth+1)},Le.parent.get=function(){return this.$from.node(this.depth)},Le.startIndex.get=function(){return this.$from.index(this.depth)},Le.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(Be.prototype,Le);var $e=Object.create(null),qe=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||de.empty,this.marks=r||be.none},Je={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Je.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},Je.childCount.get=function(){return this.content.childCount},qe.prototype.child=function(t){return this.content.child(t)},qe.prototype.maybeChild=function(t){return this.content.maybeChild(t)},qe.prototype.forEach=function(t){this.content.forEach(t)},qe.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},qe.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},Je.textContent.get=function(){return this.textBetween(0,this.content.size,"")},qe.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},Je.firstChild.get=function(){return this.content.firstChild},Je.lastChild.get=function(){return this.content.lastChild},qe.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},qe.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},qe.prototype.hasMarkup=function(t,e,n){return this.type==t&&ge(this.attrs,e||t.defaultAttrs||$e)&&be.sameSet(this.marks,n||be.none)},qe.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},qe.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},qe.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},qe.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return ke.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new ke(a,r.depth-i,o.depth-i)},qe.prototype.replace=function(t,e,n){return Ce(this.resolve(t),this.resolve(e),n)},qe.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},qe.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},qe.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},qe.prototype.resolve=function(t){return De.resolveCached(this,t)},qe.prototype.resolveNoCache=function(t){return De.resolve(this,t)},qe.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},Je.isBlock.get=function(){return this.type.isBlock},Je.isTextblock.get=function(){return this.type.isTextblock},Je.inlineContent.get=function(){return this.type.inlineContent},Je.isInline.get=function(){return this.type.isInline},Je.isText.get=function(){return this.type.isText},Je.isLeaf.get=function(){return this.type.isLeaf},Je.isAtom.get=function(){return this.type.isAtom},qe.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),Ve(this.marks,t)},qe.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},qe.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=de.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,e);if(!s||!s.validEnd)return!1;for(var a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0},qe.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},qe.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},qe.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},qe.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},qe.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=de.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(qe.prototype,Je);var Ue=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Ve(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(qe);function Ve(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var We=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},He={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};We.parse=function(t,e){var n=new Ke(t,e);if(null==n.next)return We.empty;var r=Ge(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return n(nn(t,0));function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];nn(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new We(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(en);i.next.push(o[s],e[a.join(",")]||n(a))}return i}}(function(t){var e=[[]];return o(i(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}function i(t,e){if("choice"==t.type)return t.exprs.reduce((function(t,n){return t.concat(i(n,e))}),[]);if("seq"==t.type)for(var s=0;;s++){var a=i(t.exprs[s],e);if(s==t.exprs.length-1)return a;o(a,e=n())}else{if("star"==t.type){var c=n();return r(e,c),o(i(t.expr,c),c),[r(c)]}if("plus"==t.type){var u=n();return o(i(t.expr,e),u),o(i(t.expr,u),u),[r(u)]}if("opt"==t.type)return[r(e)].concat(i(t.expr,e));if("range"==t.type){for(var l=e,f=0;f<t.min;f++){var h=n();o(i(t.expr,l),h),l=h}if(-1==t.max)o(i(t.expr,l),l);else for(var p=t.min;p<t.max;p++){var d=n();r(l,d),o(i(t.expr,l),d),l=d}return[r(l)]}if("name"==t.type)return[r(e,null,t.value)]}}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],u=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(u)&&r.push(u)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},We.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},We.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},He.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},He.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},We.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},We.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,s){var a=i.matchFragment(t,n);if(a&&(!e||a.validEnd))return de.from(s.map((function(t){return t.createAndFill()})));for(var c=0;c<i.next.length;c+=2){var u=i.next[c],l=i.next[c+1];if(!u.isText&&!u.hasRequiredAttrs()&&-1==r.indexOf(l)){r.push(l);var f=o(l,s.concat(u));if(f)return f}}}(this,[])},We.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},We.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},He.edgeCount.get=function(){return this.next.length>>1},We.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},We.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(We.prototype,He),We.empty=new We(!0);var Ke=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},Ye={next:{configurable:!0}};function Ge(t){var e=[];do{e.push(Qe(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function Qe(t){var e=[];do{e.push(Xe(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function Xe(t){for(var e=function(t){if(t.eat("(")){var e=Ge(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=tn(t,e)}return e}function Ze(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function tn(t,e){var n=Ze(t),r=n;return t.eat(",")&&(r="}"!=t.next?Ze(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function en(t,e){return e-t}function nn(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(en)}function rn(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function on(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function sn(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new un(t[n]);return e}Ye.next.get=function(){return this.tokens[this.pos]},Ke.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},Ke.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(Ke.prototype,Ye);var an=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=sn(n.attrs),this.defaultAttrs=rn(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},cn={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};cn.isInline.get=function(){return!this.isBlock},cn.isTextblock.get=function(){return this.isBlock&&this.inlineContent},cn.isLeaf.get=function(){return this.contentMatch==We.empty},cn.isAtom.get=function(){return this.isLeaf||this.spec.atom},an.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},an.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},an.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:on(this.attrs,t)},an.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new qe(this,this.computeAttrs(t),de.from(e),be.setFrom(n))},an.prototype.createChecked=function(t,e,n){if(e=de.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new qe(this,this.computeAttrs(t),e,be.setFrom(n))},an.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=de.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e).fillBefore(de.empty,!0);return o?new qe(this,t,e.append(o),be.setFrom(n)):null},an.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},an.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},an.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},an.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:be.empty:t},an.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new an(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(an.prototype,cn);var un=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},ln={isRequired:{configurable:!0}};ln.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(un.prototype,ln);var fn=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=sn(r.attrs),this.rank=e,this.excluded=null;var o=rn(this.attrs);this.instance=o&&new be(this,o)};fn.prototype.create=function(t){return!t&&this.instance?this.instance:new be(this,on(this.attrs,t))},fn.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new fn(t,r++,e,o)})),n},fn.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},fn.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},fn.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var hn=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=l.a.from(t.nodes),this.spec.marks=l.a.from(t.marks),this.nodes=an.compile(this.spec.nodes,this),this.marks=fn.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],i=o.spec.content||"",s=o.spec.marks;o.contentMatch=n[i]||(n[i]=We.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==s?null:s?pn(this,s.split(" ")):""!=s&&o.inlineContent?null:[]}for(var a in this.marks){var c=this.marks[a],u=c.spec.excludes;c.excluded=null==u?[c]:""==u?[]:pn(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function pn(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}hn.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof an))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},hn.prototype.text=function(t,e){var n=this.nodes.text;return new Ue(n,n.defaultAttrs,t,be.setFrom(e))},hn.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},hn.prototype.nodeFromJSON=function(t){return qe.fromJSON(this,t)},hn.prototype.markFromJSON=function(t){return be.fromJSON(this,t)},hn.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var dn=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)})),this.normalizeLists=!this.tags.some((function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)}))};dn.prototype.parse=function(t,e){void 0===e&&(e={});var n=new wn(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},dn.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new wn(this,e,!0);return n.addAll(t,null,e.from,e.to),ke.maxOpen(n.finish())},dn.prototype.matchTag=function(t,e,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(xn(t,o.tag)&&(void 0===o.namespace||t.namespaceURI==o.namespace)&&(!o.context||e.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(t);if(!1===i)continue;o.attrs=i}return o}}},dn.prototype.matchStyle=function(t,e,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(t)||i.context&&!n.matchesContext(i.context)||i.style.length>t.length&&(61!=i.style.charCodeAt(t.length)||i.style.slice(t.length+1)!=e))){if(i.getAttrs){var s=i.getAttrs(e);if(!1===s)continue;i.attrs=s}return i}}},dn.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=Sn(t)),t.mark=e}))};for(var o in t.marks)r(o);var i=function(e){var r=t.nodes[s].spec.parseDOM;r&&r.forEach((function(t){n(t=Sn(t)),t.node=s}))};for(var s in t.nodes)i();return e},dn.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new dn(t,dn.schemaRules(t)))};var vn={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},yn={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},mn={ol:!0,ul:!0};function gn(t){return(t?1:0)|("full"===t?2:0)}var bn=function(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=be.none,this.pendingMarks=r,this.stashMarks=[]};bn.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(de.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},bn.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=de.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(de.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},bn.prototype.popFromStashMark=function(t){for(var e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]},bn.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):On(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}};var wn=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,i=gn(e.preserveWhitespace)|(n?4:0);r=o?new bn(o.type,o.attrs,be.none,be.none,!0,e.topMatch||o.type.contentMatch,i):new bn(n?null:t.schema.topNodeType,null,be.none,be.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},kn={top:{configurable:!0},currentPos:{configurable:!0}};function xn(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Sn(t){var e={};for(var n in t)e[n]=t[n];return e}function On(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var i=[];return function t(n){i.push(n);for(var r=0;r<n.edgeCount;r++){var o=n.edge(r),s=o.type,a=o.next;if(s==e)return!0;if(i.indexOf(a)<0&&t(a))return!0}}(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}kn.top.get=function(){return this.nodes[this.open]},wn.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},wn.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},wn.prototype.addElement=function(t,e){var n,r=t.nodeName.toLowerCase();mn.hasOwnProperty(r)&&this.parser.normalizeLists&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&mn.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var o=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(n=this.parser.matchTag(t,this,e));if(o?o.ignore:yn.hasOwnProperty(r))this.findInside(t);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(t=o.skip);var i,s=this.top,a=this.needsBlock;if(vn.hasOwnProperty(r))i=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),i&&this.sync(s),this.needsBlock=a}else this.addElementByRule(t,o,!1===o.consuming?n:null)},wn.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},wn.prototype.readStyles=function(t){var e=be.none;t:for(var n=0;n<t.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(t[n],t[n+1],this,r);if(!o)continue t;if(o.ignore)return null;if(e=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(e),!1!==o.consuming)break;r=o}return e},wn.prototype.addElementByRule=function(t,e,n){var r,o,i,s=this;e.node?(o=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(o.create(e.attrs))||this.leafFallback(t):r=this.enter(o,e.attrs,e.preserveWhitespace):(i=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(i));var a=this.top;if(o&&o.isLeaf)this.findInside(t);else if(n)this.addElement(t,n);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return s.insertNode(t)}));else{var c=e.contentElement;"string"==typeof c?c=t.querySelector(c):"function"==typeof c&&(c=c(t)),c||(c=t),this.findAround(t,c,!0),this.addAll(c,r)}r&&(this.sync(a),this.open--),i&&this.removePendingMark(i,a)},wn.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&vn.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},wn.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},wn.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},wn.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},wn.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:gn(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new bn(t,e,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},wn.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},wn.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},wn.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},kn.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},wn.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},wn.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},wn.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},wn.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},wn.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1);return function t(s,a){for(;s>=0;s--){var c=n[s];if(""==c){if(s==n.length-1||0==s)continue;for(;a>=i;a--)if(t(s-1,a))return!0;return!1}var u=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!u||u.name!=c&&-1==u.groups.indexOf(c))return!1;a--}return!0}(n.length-1,this.open)},wn.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},wn.prototype.addPendingMark=function(t){var e=function(t,e){for(var n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},wn.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(t)>-1)r.pendingMarks=t.removeFromSet(r.pendingMarks);else{r.activeMarks=t.removeFromSet(r.activeMarks);var o=r.popFromStashMark(t);o&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==e)break}},Object.defineProperties(wn.prototype,kn);var Cn=function(t,e){this.nodes=t||{},this.marks=e||{}};function En(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function _n(t){return t.document||window.document}Cn.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=_n(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],u=r.serializeMark(c,t.isInline,e);u&&(i.push(c,o),o.appendChild(u.dom),o=u.contentDOM||u.dom)}}o.appendChild(r.serializeNode(t,e))})),n},Cn.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=Cn.renderSpec(_n(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},Cn.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},Cn.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&Cn.renderSpec(_n(n),r(t,e))},Cn.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var u in c=2,a)if(null!=a[u]){var l=u.indexOf(" ");l>0?s.setAttributeNS(u.slice(0,l),u.slice(l+1),a[u]):s.setAttribute(u,a[u])}for(var f=c;f<e.length;f++){var h=e[f];if(0===h){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var p=Cn.renderSpec(t,h,n),d=p.dom,v=p.contentDOM;if(s.appendChild(d),v){if(i)throw new RangeError("Multiple content holes");i=v}}return{dom:s,contentDOM:i}},Cn.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new Cn(this.nodesFromSchema(t),this.marksFromSchema(t)))},Cn.nodesFromSchema=function(t){var e=En(t.nodes);return e.text||(e.text=function(t){return t.text}),e},Cn.marksFromSchema=function(t){return En(t.marks)};var Mn=Object.create(null),Tn=function(t,e,n){this.ranges=n||[new An(t.min(e),t.max(e))],this.$anchor=t,this.$head=e},Nn={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};Nn.anchor.get=function(){return this.$anchor.pos},Nn.head.get=function(){return this.$head.pos},Nn.from.get=function(){return this.$from.pos},Nn.to.get=function(){return this.$to.pos},Nn.$from.get=function(){return this.ranges[0].$from},Nn.$to.get=function(){return this.ranges[0].$to},Nn.empty.get=function(){for(var t=this.ranges,e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0},Tn.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},Tn.prototype.replace=function(t,e){void 0===e&&(e=ke.empty);for(var n=e.content.lastChild,r=null,o=0;o<e.openEnd;o++)r=n,n=n.lastChild;for(var i=t.steps.length,s=this.ranges,a=0;a<s.length;a++){var c=s[a],u=c.$from,l=c.$to,f=t.mapping.slice(i);t.replaceRange(f.map(u.pos),f.map(l.pos),a?ke.empty:e),0==a&&Bn(t,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}},Tn.prototype.replaceWith=function(t,e){for(var n=t.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],s=i.$from,a=i.$to,c=t.mapping.slice(n),u=c.map(s.pos),l=c.map(a.pos);o?t.deleteRange(u,l):(t.replaceRangeWith(u,l,e),Bn(t,n,e.isInline?-1:1))}},Tn.findFrom=function(t,e,n){var r=t.parent.inlineContent?new In(t):Fn(t.node(0),t.parent,t.pos,t.index(),e,n);if(r)return r;for(var o=t.depth-1;o>=0;o--){var i=e<0?Fn(t.node(0),t.node(o),t.before(o+1),t.index(o),e,n):Fn(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,e,n);if(i)return i}},Tn.near=function(t,e){return void 0===e&&(e=1),this.findFrom(t,e)||this.findFrom(t,-e)||new Pn(t.node(0))},Tn.atStart=function(t){return Fn(t,t,0,0,1)||new Pn(t)},Tn.atEnd=function(t){return Fn(t,t,t.content.size,t.childCount,-1)||new Pn(t)},Tn.fromJSON=function(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=Mn[e.type];if(!n)throw new RangeError("No selection type "+e.type+" defined");return n.fromJSON(t,e)},Tn.jsonID=function(t,e){if(t in Mn)throw new RangeError("Duplicate use of selection JSON ID "+t);return Mn[t]=e,e.prototype.jsonID=t,e},Tn.prototype.getBookmark=function(){return In.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(Tn.prototype,Nn),Tn.prototype.visible=!0;var An=function(t,e){this.$from=t,this.$to=e},In=function(t){function e(e,n){void 0===n&&(n=e),t.call(this,e,n)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},e.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));if(!o.parent.inlineContent)return t.near(o);var i=n.resolve(r.map(this.anchor));return new e(i.parent.inlineContent?i:o,o)},e.prototype.replace=function(e,n){if(void 0===n&&(n=ke.empty),t.prototype.replace.call(this,e,n),n==ke.empty){var r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head},e.prototype.getBookmark=function(){return new jn(this.anchor,this.head)},e.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(n.anchor),t.resolve(n.head))},e.create=function(t,e,n){void 0===n&&(n=e);var r=t.resolve(e);return new this(r,n==e?r:t.resolve(n))},e.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=i>=0?1:-1),!r.parent.inlineContent){var s=t.findFrom(r,o,!0)||t.findFrom(r,-o,!0);if(!s)return t.near(r,o);r=s.$head}return n.parent.inlineContent||(0==i||(n=(t.findFrom(n,-o,!0)||t.findFrom(n,o,!0)).$anchor).pos<r.pos!=i<0)&&(n=r),new e(n,r)},Object.defineProperties(e.prototype,n),e}(Tn);Tn.jsonID("text",In);var jn=function(t,e){this.anchor=t,this.head=e};jn.prototype.map=function(t){return new jn(t.map(this.anchor),t.map(this.head))},jn.prototype.resolve=function(t){return In.between(t.resolve(this.anchor),t.resolve(this.head))};var Dn=function(t){function e(e){var n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);t.call(this,e,r),this.node=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(n,r){var o=r.mapResult(this.anchor),i=o.deleted,s=o.pos,a=n.resolve(s);return i?t.near(a):new e(a)},e.prototype.content=function(){return new ke(de.from(this.node),0,0)},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor},e.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},e.prototype.getBookmark=function(){return new Rn(this.anchor)},e.fromJSON=function(t,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(n.anchor))},e.create=function(t,e){return new this(t.resolve(e))},e.isSelectable=function(t){return!t.isText&&!1!==t.type.spec.selectable},e}(Tn);Dn.prototype.visible=!1,Tn.jsonID("node",Dn);var Rn=function(t){this.anchor=t};Rn.prototype.map=function(t){var e=t.mapResult(this.anchor),n=e.deleted,r=e.pos;return n?new jn(r,r):new Rn(r)},Rn.prototype.resolve=function(t){var e=t.resolve(this.anchor),n=e.nodeAfter;return n&&Dn.isSelectable(n)?new Dn(e):Tn.near(e)};var Pn=function(t){function e(e){t.call(this,e.resolve(0),e.resolve(e.content.size))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.replace=function(e,n){if(void 0===n&&(n=ke.empty),n==ke.empty){e.delete(0,e.doc.content.size);var r=t.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else t.prototype.replace.call(this,e,n)},e.prototype.toJSON=function(){return{type:"all"}},e.fromJSON=function(t){return new e(t)},e.prototype.map=function(t){return new e(t)},e.prototype.eq=function(t){return t instanceof e},e.prototype.getBookmark=function(){return zn},e}(Tn);Tn.jsonID("all",Pn);var zn={map:function(){return this},resolve:function(t){return new Pn(t)}};function Fn(t,e,n,r,o,i){if(e.inlineContent)return In.create(t,n);for(var s=r-(o>0?0:1);o>0?s<e.childCount:s>=0;s+=o){var a=e.child(s);if(a.isAtom){if(!i&&Dn.isSelectable(a))return Dn.create(t,n-(o<0?a.nodeSize:0))}else{var c=Fn(t,a,n+o,o<0?a.childCount:0,o,i);if(c)return c}n+=a.nodeSize*o}}function Bn(t,e,n){var r=t.steps.length-1;if(!(r<e)){var o,i=t.steps[r];if(i instanceof u.c||i instanceof u.b)t.mapping.maps[r].forEach((function(t,e,n,r){null==o&&(o=r)})),t.setSelection(Tn.near(t.doc.resolve(o),n))}}var Ln=function(t){function e(e){t.call(this,e.doc),this.time=Date.now(),this.curSelection=e.selection,this.curSelectionFor=0,this.storedMarks=e.storedMarks,this.updated=0,this.meta=Object.create(null)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},e.prototype.setSelection=function(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return(1&this.updated)>0},e.prototype.setStoredMarks=function(t){return this.storedMarks=t,this.updated|=2,this},e.prototype.ensureMarks=function(t){return be.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this},e.prototype.addStoredMark=function(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))},e.prototype.removeStoredMark=function(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(2&this.updated)>0},e.prototype.addStep=function(e,n){t.prototype.addStep.call(this,e,n),this.updated=-3&this.updated,this.storedMarks=null},e.prototype.setTime=function(t){return this.time=t,this},e.prototype.replaceSelection=function(t){return this.selection.replace(this,t),this},e.prototype.replaceSelectionWith=function(t,e){var n=this.selection;return!1!==e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||be.none))),n.replaceWith(this,t),this},e.prototype.deleteSelection=function(){return this.selection.replace(this),this},e.prototype.insertText=function(t,e,n){void 0===n&&(n=e);var r=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();if(!t)return this.deleteRange(e,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(e);o=n==e?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(e,n,r.text(t,o)),this.selection.empty||this.setSelection(Tn.near(this.selection.$to)),this},e.prototype.setMeta=function(t,e){return this.meta["string"==typeof t?t:t.key]=e,this},e.prototype.getMeta=function(t){return this.meta["string"==typeof t?t:t.key]},n.isGeneric.get=function(){for(var t in this.meta)return!1;return!0},e.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(e.prototype,n),e}(u.d);function $n(t,e){return e&&t?t.bind(e):t}var qn=function(t,e,n){this.name=t,this.init=$n(e.init,n),this.apply=$n(e.apply,n)},Jn=[new qn("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new qn("selection",{init:function(t,e){return t.selection||Tn.atStart(e.doc)},apply:function(t){return t.selection}}),new qn("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new qn("scrollToSelection",{init:function(){return 0},apply:function(t,e){return t.scrolledIntoView?e+1:e}})],Un=function(t,e){var n=this;this.schema=t,this.fields=Jn.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),e&&e.forEach((function(t){if(n.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");n.plugins.push(t),n.pluginsByKey[t.key]=t,t.spec.state&&n.fields.push(new qn(t.key,t.spec.state,t))}))},Vn=function(t){this.config=t},Wn={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};Wn.schema.get=function(){return this.config.schema},Wn.plugins.get=function(){return this.config.plugins},Vn.prototype.apply=function(t){return this.applyTransaction(t).state},Vn.prototype.filterTransaction=function(t,e){void 0===e&&(e=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=e){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,t,this))return!1}return!0},Vn.prototype.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var e=[t],n=this.applyInner(t),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var s=this.config.plugins[i];if(s.spec.appendTransaction){var a=r?r[i].n:0,c=r?r[i].state:this,u=a<e.length&&s.spec.appendTransaction.call(s,a?e.slice(a):e,c,n);if(u&&n.filterTransaction(u,i)){if(u.setMeta("appendedTransaction",t),!r){r=[];for(var l=0;l<this.config.plugins.length;l++)r.push(l<i?{state:n,n:e.length}:{state:this,n:0})}e.push(u),n=n.applyInner(u),o=!0}r&&(r[i]={state:n,n:e.length})}}if(!o)return{state:n,transactions:e}}},Vn.prototype.applyInner=function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var e=new Vn(this.config),n=this.config.fields,r=0;r<n.length;r++){var o=n[r];e[o.name]=o.apply(t,this[o.name],this,e)}for(var i=0;i<Hn.length;i++)Hn[i](this,t,e);return e},Wn.tr.get=function(){return new Ln(this)},Vn.create=function(t){for(var e=new Un(t.schema||t.doc.type.schema,t.plugins),n=new Vn(e),r=0;r<e.fields.length;r++)n[e.fields[r].name]=e.fields[r].init(t,n);return n},Vn.prototype.reconfigure=function(t){for(var e=new Un(t.schema||this.schema,t.plugins),n=e.fields,r=new Vn(e),o=0;o<n.length;o++){var i=n[o].name;r[i]=this.hasOwnProperty(i)?this[i]:n[o].init(t,r)}return r},Vn.prototype.toJSON=function(t){var e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map((function(t){return t.toJSON()}))),t&&"object"==typeof t)for(var n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=t[n],o=r.spec.state;o&&o.toJSON&&(e[n]=o.toJSON.call(r,this[r.key]))}return e},Vn.fromJSON=function(t,e,n){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var r=new Un(t.schema,t.plugins),o=new Vn(r);return r.fields.forEach((function(r){if("doc"==r.name)o.doc=qe.fromJSON(t.schema,e.doc);else if("selection"==r.name)o.selection=Tn.fromJSON(o.doc,e.selection);else if("storedMarks"==r.name)e.storedMarks&&(o.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(n)for(var i in n){var s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(e,i))return void(o[r.name]=a.fromJSON.call(s,t,e[i],o))}o[r.name]=r.init(t,o)}})),o},Vn.addApplyListener=function(t){Hn.push(t)},Vn.removeApplyListener=function(t){var e=Hn.indexOf(t);e>-1&&Hn.splice(e,1)},Object.defineProperties(Vn.prototype,Wn);var Hn=[];function Kn(t,e,n){for(var r in t){var o=t[r];o instanceof Function?o=o.bind(e):"handleDOMEvents"==r&&(o=Kn(o,e,{})),n[r]=o}return n}(function(t){this.props={},t.props&&Kn(t.props,this,this.props),this.spec=t,this.key=t.key?t.key.key:Gn("plugin")}).prototype.getState=function(t){return t[this.key]};var Yn=Object.create(null);function Gn(t){return t in Yn?t+"$"+ ++Yn[t]:(Yn[t]=0,t+"$")}var Qn=function(t){void 0===t&&(t="key"),this.key=Gn(t)};function Xn(t,e){return!t.selection.empty&&(e&&e(t.tr.deleteSelection().scrollIntoView()),!0)}function Zn(t,e){for(;t;t="start"==e?t.firstChild:t.lastChild)if(t.isTextblock)return!0;return!1}function tr(t){if(!t.parent.type.spec.isolating)for(var e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function er(t){if(!t.parent.type.spec.isolating)for(var e=t.depth-1;e>=0;e--){var n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}function nr(t,e){var n,r=t.selection,o=r instanceof Dn;if(o){if(r.node.isTextblock||!Object(u.e)(t.doc,r.from))return!1;n=r.from}else if(null==(n=Object(u.i)(t.doc,r.from,-1)))return!1;if(e){var i=t.tr.join(n);o&&i.setSelection(Dn.create(i.doc,n-t.doc.resolve(n).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0}function rr(t,e){var n,r=t.selection;if(r instanceof Dn){if(r.node.isTextblock||!Object(u.e)(t.doc,r.to))return!1;n=r.to}else if(null==(n=Object(u.i)(t.doc,r.to,1)))return!1;return e&&e(t.tr.join(n).scrollIntoView()),!0}function or(t,e){var n=t.selection,r=n.$from,o=n.$to,i=r.blockRange(o),s=i&&Object(u.j)(i);return null!=s&&(e&&e(t.tr.lift(i,s).scrollIntoView()),!0)}function ir(t){for(var e=0;e<t.edgeCount;e++){var n=t.edge(e).type;if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function sr(t,e){var n=t.selection,r=n.$head,o=n.$anchor;if(!r.parent.type.spec.code||!r.sameParent(o))return!1;var i=r.node(-1),s=r.indexAfter(-1),a=ir(i.contentMatchAt(s));if(!i.canReplaceWith(s,s,a))return!1;if(e){var c=r.after(),u=t.tr.replaceWith(c,c,a.createAndFill());u.setSelection(Tn.near(u.doc.resolve(c),1)),e(u.scrollIntoView())}return!0}function ar(t,e){var n=t.selection,r=n.$from,o=n.$to;if(t.selection instanceof Dn&&t.selection.node.isBlock)return!(!r.parentOffset||!Object(u.f)(t.doc,r.pos))&&(e&&e(t.tr.split(r.pos).scrollIntoView()),!0);if(!r.parent.isBlock)return!1;if(e){var i=o.parentOffset==o.parent.content.size,s=t.tr;t.selection instanceof In&&s.deleteSelection();var a=0==r.depth?null:ir(r.node(-1).contentMatchAt(r.indexAfter(-1))),c=i&&a?[{type:a}]:null,l=Object(u.f)(s.doc,s.mapping.map(r.pos),1,c);c||l||!Object(u.f)(s.doc,s.mapping.map(r.pos),1,a&&[{type:a}])||(c=[{type:a}],l=!0),l&&(s.split(s.mapping.map(r.pos),1,c),i||r.parentOffset||r.parent.type==a||!r.node(-1).canReplace(r.index(-1),r.indexAfter(-1),de.from(a.create(),r.parent))||s.setNodeMarkup(s.mapping.map(r.before()),a)),e(s.scrollIntoView())}return!0}function cr(t,e){var n,r=t.selection,o=r.$from,i=r.to,s=o.sharedDepth(i);return 0!=s&&(n=o.before(s),e&&e(t.tr.setSelection(Dn.create(t.doc,n))),!0)}function ur(t,e,n){var r,o,i=e.nodeBefore,s=e.nodeAfter;if(i.type.spec.isolating||s.type.spec.isolating)return!1;if(function(t,e,n){var r=e.nodeBefore,o=e.nodeAfter,i=e.index();return!!(r&&o&&r.type.compatibleContent(o.type))&&(!r.content.size&&e.parent.canReplace(i-1,i)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!(!e.parent.canReplace(i,i+1)||!o.isTextblock&&!Object(u.e)(t.doc,e.pos))&&(n&&n(t.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0))}(t,e,n))return!0;if(e.parent.canReplace(e.index(),e.index()+1)&&(r=(o=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&o.matchType(r[0]||s.type).validEnd){if(n){for(var a=e.pos+s.nodeSize,c=de.empty,l=r.length-1;l>=0;l--)c=de.from(r[l].create(null,c));c=de.from(i.copy(c));var f=t.tr.step(new u.b(e.pos-1,a,e.pos,a,new ke(c,1,0),r.length,!0)),h=a+2*r.length;Object(u.e)(f.doc,h)&&f.join(h),n(f.scrollIntoView())}return!0}var p=Tn.findFrom(e,1),d=p&&p.$from.blockRange(p.$to),v=d&&Object(u.j)(d);return null!=v&&v>=e.depth&&(n&&n(t.tr.lift(d,v).scrollIntoView()),!0)}function lr(t,e){return function(n,r){var o=n.selection,i=o.$from,s=o.$to,a=i.blockRange(s),c=a&&Object(u.h)(a,t,e);return!!c&&(r&&r(n.tr.wrap(a,c).scrollIntoView()),!0)}}function fr(t,e){return function(n,r){var o=n.selection,i=o.from,s=o.to,a=!1;return n.doc.nodesBetween(i,s,(function(r,o){if(a)return!1;if(r.isTextblock&&!r.hasMarkup(t,e))if(r.type==t)a=!0;else{var i=n.doc.resolve(o),s=i.index();a=i.parent.canReplaceWith(s,s+1,t)}})),!!a&&(r&&r(n.tr.setBlockType(i,s,t,e).scrollIntoView()),!0)}}function hr(t,e){return function(n,r){var o=n.selection,i=o.empty,s=o.$cursor,a=o.ranges;if(i&&!s||!function(t,e,n){for(var r=function(r){var o=e[r],i=o.$from,s=o.$to,a=0==i.depth&&t.type.allowsMarkType(n);if(t.nodesBetween(i.pos,s.pos,(function(t){if(a)return!1;a=t.inlineContent&&t.type.allowsMarkType(n)})),a)return{v:!0}},o=0;o<e.length;o++){var i=r(o);if(i)return i.v}return!1}(n.doc,a,t))return!1;if(r)if(s)t.isInSet(n.storedMarks||s.marks())?r(n.tr.removeStoredMark(t)):r(n.tr.addStoredMark(t.create(e)));else{for(var c=!1,u=n.tr,l=0;!c&&l<a.length;l++){var f=a[l],h=f.$from,p=f.$to;c=n.doc.rangeHasMark(h.pos,p.pos,t)}for(var d=0;d<a.length;d++){var v=a[d],y=v.$from,m=v.$to;c?u.removeMark(y.pos,m.pos,t):u.addMark(y.pos,m.pos,t.create(e))}r(u.scrollIntoView())}return!0}}function pr(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return function(e,n,r){for(var o=0;o<t.length;o++)if(t[o](e,n,r))return!0;return!1}}Qn.prototype.get=function(t){return t.config.pluginsByKey[this.key]},Qn.prototype.getState=function(t){return t[this.key]};var dr=pr(Xn,(function(t,e,n){var r=t.selection.$cursor;if(!r||(n?!n.endOfTextblock("backward",t):r.parentOffset>0))return!1;var o=tr(r);if(!o){var i=r.blockRange(),s=i&&Object(u.j)(i);return null!=s&&(e&&e(t.tr.lift(i,s).scrollIntoView()),!0)}var a=o.nodeBefore;if(!a.type.spec.isolating&&ur(t,o,e))return!0;if(0==r.parent.content.size&&(Zn(a,"end")||Dn.isSelectable(a))){if(e){var c=t.tr.deleteRange(r.before(),r.after());c.setSelection(Zn(a,"end")?Tn.findFrom(c.doc.resolve(c.mapping.map(o.pos,-1)),-1):Dn.create(c.doc,o.pos-a.nodeSize)),e(c.scrollIntoView())}return!0}return!(!a.isAtom||o.depth!=r.depth-1)&&(e&&e(t.tr.delete(o.pos-a.nodeSize,o.pos).scrollIntoView()),!0)}),(function(t,e,n){var r=t.selection,o=r.$head,i=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):o.parentOffset>0)return!1;i=tr(o)}var s=i&&i.nodeBefore;return!(!s||!Dn.isSelectable(s))&&(e&&e(t.tr.setSelection(Dn.create(t.doc,i.pos-s.nodeSize)).scrollIntoView()),!0)})),vr=pr(Xn,(function(t,e,n){var r=t.selection.$cursor;if(!r||(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size))return!1;var o=er(r);if(!o)return!1;var i=o.nodeAfter;if(ur(t,o,e))return!0;if(0==r.parent.content.size&&(Zn(i,"start")||Dn.isSelectable(i))){if(e){var s=t.tr.deleteRange(r.before(),r.after());s.setSelection(Zn(i,"start")?Tn.findFrom(s.doc.resolve(s.mapping.map(o.pos)),1):Dn.create(s.doc,s.mapping.map(o.pos))),e(s.scrollIntoView())}return!0}return!(!i.isAtom||o.depth!=r.depth-1)&&(e&&e(t.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),!0)}),(function(t,e,n){var r=t.selection,o=r.$head,i=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):o.parentOffset<o.parent.content.size)return!1;i=er(o)}var s=i&&i.nodeAfter;return!(!s||!Dn.isSelectable(s))&&(e&&e(t.tr.setSelection(Dn.create(t.doc,i.pos)).scrollIntoView()),!0)})),yr={Enter:pr((function(t,e){var n=t.selection,r=n.$head,o=n.$anchor;return!(!r.parent.type.spec.code||!r.sameParent(o))&&(e&&e(t.tr.insertText("\n").scrollIntoView()),!0)}),(function(t,e){var n=t.selection,r=n.$from,o=n.$to;if(r.parent.inlineContent||o.parent.inlineContent)return!1;var i=ir(r.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){var s=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,a=t.tr.insert(s,i.createAndFill());a.setSelection(In.create(a.doc,s+1)),e(a.scrollIntoView())}return!0}),(function(t,e){var n=t.selection.$cursor;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){var r=n.before();if(Object(u.f)(t.doc,r))return e&&e(t.tr.split(r).scrollIntoView()),!0}var o=n.blockRange(),i=o&&Object(u.j)(o);return null!=i&&(e&&e(t.tr.lift(o,i).scrollIntoView()),!0)}),ar),"Mod-Enter":sr,Backspace:dr,"Mod-Backspace":dr,Delete:vr,"Mod-Delete":vr,"Mod-a":function(t,e){return e&&e(t.tr.setSelection(new Pn(t.doc))),!0}},mr={"Ctrl-h":yr.Backspace,"Alt-Backspace":yr["Mod-Backspace"],"Ctrl-d":yr.Delete,"Ctrl-Alt-Backspace":yr["Mod-Delete"],"Alt-Delete":yr["Mod-Delete"],"Alt-d":yr["Mod-Delete"]};for(var gr in yr)mr[gr]=yr[gr];var br=("undefined"!=typeof navigator?/Mac/.test(navigator.platform):"undefined"!=typeof os&&"darwin"==os.platform())?mr:yr;function wr(t,e,n){for(var r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;var o=t.child(r),i=e.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(var s=0;o.text[s]==i.text[s];s++)n++;return n}if(o.content.size||i.content.size){var a=wr(o.content,i.content,n+1);if(null!=a)return a}n+=o.nodeSize}else n+=o.nodeSize}}function kr(t,e,n,r){for(var o=t.childCount,i=e.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};var s=t.child(--o),a=e.child(--i),c=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){for(var u=0,l=Math.min(s.text.length,a.text.length);u<l&&s.text[s.text.length-u-1]==a.text[a.text.length-u-1];)u++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){var f=kr(s.content,a.content,n-1,r-1);if(f)return f}n-=c,r-=c}else n-=c,r-=c}}var xr=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},Sr={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};xr.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var u=s+1;a.nodesBetween(Math.max(0,t-u),Math.min(a.content.size,e-u),n,r+u)}s=c}},xr.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},xr.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},xr.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new xr(r,this.size+t.size)},xr.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var o=0,i=0;i<e;o++){var s=this.content[o],a=i+s.nodeSize;a>t&&((i<t||a>e)&&(s=s.isText?s.cut(Math.max(0,t-i),Math.min(s.text.length,e-i)):s.cut(Math.max(0,t-i-1),Math.min(s.content.size,e-i-1))),n.push(s),r+=s.nodeSize),i=a}return new xr(n,r)},xr.prototype.cutByIndex=function(t,e){return t==e?xr.empty:0==t&&e==this.content.length?this:new xr(this.content.slice(t,e))},xr.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new xr(r,o)},xr.prototype.addToStart=function(t){return new xr([t].concat(this.content),this.size+t.nodeSize)},xr.prototype.addToEnd=function(t){return new xr(this.content.concat(t),this.size+t.nodeSize)},xr.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},Sr.firstChild.get=function(){return this.content.length?this.content[0]:null},Sr.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},Sr.childCount.get=function(){return this.content.length},xr.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},xr.prototype.maybeChild=function(t){return this.content[t]},xr.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},xr.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),wr(this,t,e)},xr.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),kr(this,t,e,n)},xr.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return Cr(0,t);if(t==this.size)return Cr(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?Cr(n+1,o):Cr(n,r);r=o}},xr.prototype.toString=function(){return"<"+this.toStringInner()+">"},xr.prototype.toStringInner=function(){return this.content.join(", ")},xr.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},xr.fromJSON=function(t,e){if(!e)return xr.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new xr(e.map(t.nodeFromJSON))},xr.fromArray=function(t){if(!t.length)return xr.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new xr(e||t,n)},xr.from=function(t){if(!t)return xr.empty;if(t instanceof xr)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new xr([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(xr.prototype,Sr);var Or={index:0,offset:0};function Cr(t,e){return Or.index=t,Or.offset=e,Or}function Er(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!Er(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e)||!Er(t[o],e[o]))return!1;for(var i in e)if(!(i in t))return!1}return!0}xr.empty=new xr([],0);var _r=function(t,e){this.type=t,this.attrs=e};function Mr(t){var e=Error.call(this,t);return e.__proto__=Mr.prototype,e}_r.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},_r.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},_r.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},_r.prototype.eq=function(t){return this==t||this.type==t.type&&Er(this.attrs,t.attrs)},_r.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},_r.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},_r.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},_r.setFrom=function(t){if(!t||0==t.length)return _r.none;if(t instanceof _r)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},_r.none=[],Mr.prototype=Object.create(Error.prototype),Mr.prototype.constructor=Mr,Mr.prototype.name="ReplaceError";var Tr=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},Nr={size:{configurable:!0}};function Ar(t,e,n){var r=t.findIndex(e),o=r.index,i=r.offset,s=t.maybeChild(o),a=t.findIndex(n),c=a.index,u=a.offset;if(i==e||s.isText){if(u!=n&&!t.child(c).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return t.replaceChild(o,s.copy(Ar(s.content,e-i-1,n-i-1)))}function Ir(t,e,n,r){var o=t.findIndex(e),i=o.index,s=o.offset,a=t.maybeChild(i);if(s==e||a.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));var c=Ir(a.content,e-s-1,n);return c&&t.replaceChild(i,a.copy(c))}function jr(t,e,n){if(n.openStart>t.depth)throw new Mr("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Mr("Inconsistent open depths");return Dr(t,e,n,0)}function Dr(t,e,n,r){var o=t.index(r),i=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){var s=Dr(t,e,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){var a=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(xr.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(n,t);return Br(i,Lr(t,a.start,a.end,e,r))}var c=t.parent,u=c.content;return Br(c,u.cut(0,t.parentOffset).append(n.content).append(u.cut(e.parentOffset)))}return Br(i,$r(t,e,r))}function Rr(t,e){if(!e.type.compatibleContent(t.type))throw new Mr("Cannot join "+e.type.name+" onto "+t.type.name)}function Pr(t,e,n){var r=t.node(n);return Rr(r,e.node(n)),r}function zr(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Fr(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(zr(t.nodeAfter,r),i++));for(var a=i;a<s;a++)zr(o.child(a),r);e&&e.depth==n&&e.textOffset&&zr(e.nodeBefore,r)}function Br(t,e){if(!t.type.validContent(e))throw new Mr("Invalid content for node "+t.type.name);return t.copy(e)}function Lr(t,e,n,r,o){var i=t.depth>o&&Pr(t,e,o+1),s=r.depth>o&&Pr(n,r,o+1),a=[];return Fr(null,t,o,a),i&&s&&e.index(o)==n.index(o)?(Rr(i,s),zr(Br(i,Lr(t,e,n,r,o+1)),a)):(i&&zr(Br(i,$r(t,e,o+1)),a),Fr(e,n,o,a),s&&zr(Br(s,$r(n,r,o+1)),a)),Fr(r,null,o,a),new xr(a)}function $r(t,e,n){var r=[];(Fr(null,t,n,r),t.depth>n)&&zr(Br(Pr(t,e,n+1),$r(t,e,n+1)),r);return Fr(e,null,n,r),new xr(r)}Nr.size.get=function(){return this.content.size-this.openStart-this.openEnd},Tr.prototype.insertAt=function(t,e){var n=Ir(this.content,t+this.openStart,e,null);return n&&new Tr(n,this.openStart,this.openEnd)},Tr.prototype.removeBetween=function(t,e){return new Tr(Ar(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},Tr.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},Tr.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},Tr.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},Tr.fromJSON=function(t,e){if(!e)return Tr.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new Tr(xr.fromJSON(t,e.content),n,r)},Tr.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new Tr(t,n,r)},Object.defineProperties(Tr.prototype,Nr),Tr.empty=new Tr(xr.empty,0,0);var qr=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},Jr={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};qr.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},Jr.parent.get=function(){return this.node(this.depth)},Jr.doc.get=function(){return this.node(0)},qr.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},qr.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},qr.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},qr.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},qr.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},qr.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},qr.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},Jr.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},Jr.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},Jr.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},qr.prototype.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,o=0;o<t;o++)r+=n.child(o).nodeSize;return r},qr.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return _r.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},qr.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},qr.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},qr.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new Hr(this,t,n)},qr.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},qr.prototype.max=function(t){return t.pos>this.pos?t:this},qr.prototype.min=function(t){return t.pos<this.pos?t:this},qr.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},qr.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,u=o-c;if(n.push(i,a,r+c),!u)break;if((i=i.child(a)).isText)break;o=u-1,r+=c+1}return new qr(e,n,o)},qr.resolveCached=function(t,e){for(var n=0;n<Ur.length;n++){var r=Ur[n];if(r.pos==e&&r.doc==t)return r}var o=Ur[Vr]=qr.resolve(t,e);return Vr=(Vr+1)%Wr,o},Object.defineProperties(qr.prototype,Jr);var Ur=[],Vr=0,Wr=12,Hr=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},Kr={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};Kr.start.get=function(){return this.$from.before(this.depth+1)},Kr.end.get=function(){return this.$to.after(this.depth+1)},Kr.parent.get=function(){return this.$from.node(this.depth)},Kr.startIndex.get=function(){return this.$from.index(this.depth)},Kr.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(Hr.prototype,Kr);var Yr=Object.create(null),Gr=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||xr.empty,this.marks=r||_r.none},Qr={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Qr.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},Qr.childCount.get=function(){return this.content.childCount},Gr.prototype.child=function(t){return this.content.child(t)},Gr.prototype.maybeChild=function(t){return this.content.maybeChild(t)},Gr.prototype.forEach=function(t){this.content.forEach(t)},Gr.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},Gr.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},Qr.textContent.get=function(){return this.textBetween(0,this.content.size,"")},Gr.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},Qr.firstChild.get=function(){return this.content.firstChild},Qr.lastChild.get=function(){return this.content.lastChild},Gr.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},Gr.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},Gr.prototype.hasMarkup=function(t,e,n){return this.type==t&&Er(this.attrs,e||t.defaultAttrs||Yr)&&_r.sameSet(this.marks,n||_r.none)},Gr.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},Gr.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},Gr.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},Gr.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return Tr.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new Tr(a,r.depth-i,o.depth-i)},Gr.prototype.replace=function(t,e,n){return jr(this.resolve(t),this.resolve(e),n)},Gr.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},Gr.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},Gr.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},Gr.prototype.resolve=function(t){return qr.resolveCached(this,t)},Gr.prototype.resolveNoCache=function(t){return qr.resolve(this,t)},Gr.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},Qr.isBlock.get=function(){return this.type.isBlock},Qr.isTextblock.get=function(){return this.type.isTextblock},Qr.inlineContent.get=function(){return this.type.inlineContent},Qr.isInline.get=function(){return this.type.isInline},Qr.isText.get=function(){return this.type.isText},Qr.isLeaf.get=function(){return this.type.isLeaf},Qr.isAtom.get=function(){return this.type.isAtom},Gr.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),Zr(this.marks,t)},Gr.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},Gr.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=xr.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,e);if(!s||!s.validEnd)return!1;for(var a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0},Gr.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},Gr.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},Gr.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},Gr.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},Gr.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=xr.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(Gr.prototype,Qr);var Xr=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Zr(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(Gr);function Zr(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var to=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},eo={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};to.parse=function(t,e){var n=new no(t,e);if(null==n.next)return to.empty;var r=oo(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return n(lo(t,0));function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];lo(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new to(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(uo);i.next.push(o[s],e[a.join(",")]||n(a))}return i}}(function(t){var e=[[]];return o(i(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}function i(t,e){if("choice"==t.type)return t.exprs.reduce((function(t,n){return t.concat(i(n,e))}),[]);if("seq"==t.type)for(var s=0;;s++){var a=i(t.exprs[s],e);if(s==t.exprs.length-1)return a;o(a,e=n())}else{if("star"==t.type){var c=n();return r(e,c),o(i(t.expr,c),c),[r(c)]}if("plus"==t.type){var u=n();return o(i(t.expr,e),u),o(i(t.expr,u),u),[r(u)]}if("opt"==t.type)return[r(e)].concat(i(t.expr,e));if("range"==t.type){for(var l=e,f=0;f<t.min;f++){var h=n();o(i(t.expr,l),h),l=h}if(-1==t.max)o(i(t.expr,l),l);else for(var p=t.min;p<t.max;p++){var d=n();r(l,d),o(i(t.expr,l),d),l=d}return[r(l)]}if("name"==t.type)return[r(e,null,t.value)]}}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],u=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(u)&&r.push(u)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},to.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},to.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},eo.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},eo.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},to.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},to.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,s){var a=i.matchFragment(t,n);if(a&&(!e||a.validEnd))return xr.from(s.map((function(t){return t.createAndFill()})));for(var c=0;c<i.next.length;c+=2){var u=i.next[c],l=i.next[c+1];if(!u.isText&&!u.hasRequiredAttrs()&&-1==r.indexOf(l)){r.push(l);var f=o(l,s.concat(u));if(f)return f}}}(this,[])},to.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},to.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},eo.edgeCount.get=function(){return this.next.length>>1},to.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},to.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(to.prototype,eo),to.empty=new to(!0);var no=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},ro={next:{configurable:!0}};function oo(t){var e=[];do{e.push(io(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function io(t){var e=[];do{e.push(so(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function so(t){for(var e=function(t){if(t.eat("(")){var e=oo(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=co(t,e)}return e}function ao(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function co(t,e){var n=ao(t),r=n;return t.eat(",")&&(r="}"!=t.next?ao(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function uo(t,e){return e-t}function lo(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(uo)}function fo(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function ho(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function po(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new mo(t[n]);return e}ro.next.get=function(){return this.tokens[this.pos]},no.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},no.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(no.prototype,ro);var vo=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=po(n.attrs),this.defaultAttrs=fo(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},yo={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};yo.isInline.get=function(){return!this.isBlock},yo.isTextblock.get=function(){return this.isBlock&&this.inlineContent},yo.isLeaf.get=function(){return this.contentMatch==to.empty},yo.isAtom.get=function(){return this.isLeaf||this.spec.atom},vo.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},vo.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},vo.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:ho(this.attrs,t)},vo.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Gr(this,this.computeAttrs(t),xr.from(e),_r.setFrom(n))},vo.prototype.createChecked=function(t,e,n){if(e=xr.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new Gr(this,this.computeAttrs(t),e,_r.setFrom(n))},vo.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=xr.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e).fillBefore(xr.empty,!0);return o?new Gr(this,t,e.append(o),_r.setFrom(n)):null},vo.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},vo.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},vo.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},vo.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:_r.empty:t},vo.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new vo(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(vo.prototype,yo);var mo=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},go={isRequired:{configurable:!0}};go.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(mo.prototype,go);var bo=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=po(r.attrs),this.rank=e,this.excluded=null;var o=fo(this.attrs);this.instance=o&&new _r(this,o)};bo.prototype.create=function(t){return!t&&this.instance?this.instance:new _r(this,ho(this.attrs,t))},bo.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new bo(t,r++,e,o)})),n},bo.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},bo.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},bo.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var wo=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=l.a.from(t.nodes),this.spec.marks=l.a.from(t.marks),this.nodes=vo.compile(this.spec.nodes,this),this.marks=bo.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],i=o.spec.content||"",s=o.spec.marks;o.contentMatch=n[i]||(n[i]=to.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==s?null:s?ko(this,s.split(" ")):""!=s&&o.inlineContent?null:[]}for(var a in this.marks){var c=this.marks[a],u=c.spec.excludes;c.excluded=null==u?[c]:""==u?[]:ko(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function ko(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}wo.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof vo))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},wo.prototype.text=function(t,e){var n=this.nodes.text;return new Xr(n,n.defaultAttrs,t,_r.setFrom(e))},wo.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},wo.prototype.nodeFromJSON=function(t){return Gr.fromJSON(this,t)},wo.prototype.markFromJSON=function(t){return _r.fromJSON(this,t)},wo.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var xo=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)})),this.normalizeLists=!this.tags.some((function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)}))};xo.prototype.parse=function(t,e){void 0===e&&(e={});var n=new Mo(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},xo.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new Mo(this,e,!0);return n.addAll(t,null,e.from,e.to),Tr.maxOpen(n.finish())},xo.prototype.matchTag=function(t,e,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(No(t,o.tag)&&(void 0===o.namespace||t.namespaceURI==o.namespace)&&(!o.context||e.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(t);if(!1===i)continue;o.attrs=i}return o}}},xo.prototype.matchStyle=function(t,e,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(t)||i.context&&!n.matchesContext(i.context)||i.style.length>t.length&&(61!=i.style.charCodeAt(t.length)||i.style.slice(t.length+1)!=e))){if(i.getAttrs){var s=i.getAttrs(e);if(!1===s)continue;i.attrs=s}return i}}},xo.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=Ao(t)),t.mark=e}))};for(var o in t.marks)r(o);var i=function(e){var r=t.nodes[s].spec.parseDOM;r&&r.forEach((function(t){n(t=Ao(t)),t.node=s}))};for(var s in t.nodes)i();return e},xo.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new xo(t,xo.schemaRules(t)))};var So={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Oo={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Co={ol:!0,ul:!0};function Eo(t){return(t?1:0)|("full"===t?2:0)}var _o=function(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=_r.none,this.pendingMarks=r,this.stashMarks=[]};_o.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(xr.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},_o.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=xr.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(xr.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},_o.prototype.popFromStashMark=function(t){for(var e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]},_o.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):Io(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}};var Mo=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,i=Eo(e.preserveWhitespace)|(n?4:0);r=o?new _o(o.type,o.attrs,_r.none,_r.none,!0,e.topMatch||o.type.contentMatch,i):new _o(n?null:t.schema.topNodeType,null,_r.none,_r.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},To={top:{configurable:!0},currentPos:{configurable:!0}};function No(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Ao(t){var e={};for(var n in t)e[n]=t[n];return e}function Io(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var i=[];return function t(n){i.push(n);for(var r=0;r<n.edgeCount;r++){var o=n.edge(r),s=o.type,a=o.next;if(s==e)return!0;if(i.indexOf(a)<0&&t(a))return!0}}(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}To.top.get=function(){return this.nodes[this.open]},Mo.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},Mo.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},Mo.prototype.addElement=function(t,e){var n,r=t.nodeName.toLowerCase();Co.hasOwnProperty(r)&&this.parser.normalizeLists&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&Co.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var o=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(n=this.parser.matchTag(t,this,e));if(o?o.ignore:Oo.hasOwnProperty(r))this.findInside(t);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(t=o.skip);var i,s=this.top,a=this.needsBlock;if(So.hasOwnProperty(r))i=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),i&&this.sync(s),this.needsBlock=a}else this.addElementByRule(t,o,!1===o.consuming?n:null)},Mo.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},Mo.prototype.readStyles=function(t){var e=_r.none;t:for(var n=0;n<t.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(t[n],t[n+1],this,r);if(!o)continue t;if(o.ignore)return null;if(e=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(e),!1!==o.consuming)break;r=o}return e},Mo.prototype.addElementByRule=function(t,e,n){var r,o,i,s=this;e.node?(o=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(o.create(e.attrs))||this.leafFallback(t):r=this.enter(o,e.attrs,e.preserveWhitespace):(i=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(i));var a=this.top;if(o&&o.isLeaf)this.findInside(t);else if(n)this.addElement(t,n);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return s.insertNode(t)}));else{var c=e.contentElement;"string"==typeof c?c=t.querySelector(c):"function"==typeof c&&(c=c(t)),c||(c=t),this.findAround(t,c,!0),this.addAll(c,r)}r&&(this.sync(a),this.open--),i&&this.removePendingMark(i,a)},Mo.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&So.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},Mo.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},Mo.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},Mo.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},Mo.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:Eo(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new _o(t,e,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},Mo.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},Mo.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},Mo.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},To.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},Mo.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},Mo.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},Mo.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},Mo.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},Mo.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1);return function t(s,a){for(;s>=0;s--){var c=n[s];if(""==c){if(s==n.length-1||0==s)continue;for(;a>=i;a--)if(t(s-1,a))return!0;return!1}var u=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!u||u.name!=c&&-1==u.groups.indexOf(c))return!1;a--}return!0}(n.length-1,this.open)},Mo.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},Mo.prototype.addPendingMark=function(t){var e=function(t,e){for(var n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},Mo.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(t)>-1)r.pendingMarks=t.removeFromSet(r.pendingMarks);else{r.activeMarks=t.removeFromSet(r.activeMarks);var o=r.popFromStashMark(t);o&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==e)break}},Object.defineProperties(Mo.prototype,To);var jo=function(t,e){this.nodes=t||{},this.marks=e||{}};function Do(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Ro(t){return t.document||window.document}jo.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=Ro(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],u=r.serializeMark(c,t.isInline,e);u&&(i.push(c,o),o.appendChild(u.dom),o=u.contentDOM||u.dom)}}o.appendChild(r.serializeNode(t,e))})),n},jo.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=jo.renderSpec(Ro(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},jo.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},jo.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&jo.renderSpec(Ro(n),r(t,e))},jo.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var u in c=2,a)if(null!=a[u]){var l=u.indexOf(" ");l>0?s.setAttributeNS(u.slice(0,l),u.slice(l+1),a[u]):s.setAttribute(u,a[u])}for(var f=c;f<e.length;f++){var h=e[f];if(0===h){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var p=jo.renderSpec(t,h,n),d=p.dom,v=p.contentDOM;if(s.appendChild(d),v){if(i)throw new RangeError("Multiple content holes");i=v}}return{dom:s,contentDOM:i}},jo.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new jo(this.nodesFromSchema(t),this.marksFromSchema(t)))},jo.nodesFromSchema=function(t){var e=Do(t.nodes);return e.text||(e.text=function(t){return t.text}),e},jo.marksFromSchema=function(t){return Do(t.marks)};var Po=Object.create(null),zo=function(t,e,n){this.ranges=n||[new Bo(t.min(e),t.max(e))],this.$anchor=t,this.$head=e},Fo={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};Fo.anchor.get=function(){return this.$anchor.pos},Fo.head.get=function(){return this.$head.pos},Fo.from.get=function(){return this.$from.pos},Fo.to.get=function(){return this.$to.pos},Fo.$from.get=function(){return this.ranges[0].$from},Fo.$to.get=function(){return this.ranges[0].$to},Fo.empty.get=function(){for(var t=this.ranges,e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0},zo.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},zo.prototype.replace=function(t,e){void 0===e&&(e=Tr.empty);for(var n=e.content.lastChild,r=null,o=0;o<e.openEnd;o++)r=n,n=n.lastChild;for(var i=t.steps.length,s=this.ranges,a=0;a<s.length;a++){var c=s[a],u=c.$from,l=c.$to,f=t.mapping.slice(i);t.replaceRange(f.map(u.pos),f.map(l.pos),a?Tr.empty:e),0==a&&Ho(t,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}},zo.prototype.replaceWith=function(t,e){for(var n=t.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],s=i.$from,a=i.$to,c=t.mapping.slice(n),u=c.map(s.pos),l=c.map(a.pos);o?t.deleteRange(u,l):(t.replaceRangeWith(u,l,e),Ho(t,n,e.isInline?-1:1))}},zo.findFrom=function(t,e,n){var r=t.parent.inlineContent?new Lo(t):Wo(t.node(0),t.parent,t.pos,t.index(),e,n);if(r)return r;for(var o=t.depth-1;o>=0;o--){var i=e<0?Wo(t.node(0),t.node(o),t.before(o+1),t.index(o),e,n):Wo(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,e,n);if(i)return i}},zo.near=function(t,e){return void 0===e&&(e=1),this.findFrom(t,e)||this.findFrom(t,-e)||new Uo(t.node(0))},zo.atStart=function(t){return Wo(t,t,0,0,1)||new Uo(t)},zo.atEnd=function(t){return Wo(t,t,t.content.size,t.childCount,-1)||new Uo(t)},zo.fromJSON=function(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=Po[e.type];if(!n)throw new RangeError("No selection type "+e.type+" defined");return n.fromJSON(t,e)},zo.jsonID=function(t,e){if(t in Po)throw new RangeError("Duplicate use of selection JSON ID "+t);return Po[t]=e,e.prototype.jsonID=t,e},zo.prototype.getBookmark=function(){return Lo.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(zo.prototype,Fo),zo.prototype.visible=!0;var Bo=function(t,e){this.$from=t,this.$to=e},Lo=function(t){function e(e,n){void 0===n&&(n=e),t.call(this,e,n)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},e.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));if(!o.parent.inlineContent)return t.near(o);var i=n.resolve(r.map(this.anchor));return new e(i.parent.inlineContent?i:o,o)},e.prototype.replace=function(e,n){if(void 0===n&&(n=Tr.empty),t.prototype.replace.call(this,e,n),n==Tr.empty){var r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head},e.prototype.getBookmark=function(){return new $o(this.anchor,this.head)},e.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(n.anchor),t.resolve(n.head))},e.create=function(t,e,n){void 0===n&&(n=e);var r=t.resolve(e);return new this(r,n==e?r:t.resolve(n))},e.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=i>=0?1:-1),!r.parent.inlineContent){var s=t.findFrom(r,o,!0)||t.findFrom(r,-o,!0);if(!s)return t.near(r,o);r=s.$head}return n.parent.inlineContent||(0==i||(n=(t.findFrom(n,-o,!0)||t.findFrom(n,o,!0)).$anchor).pos<r.pos!=i<0)&&(n=r),new e(n,r)},Object.defineProperties(e.prototype,n),e}(zo);zo.jsonID("text",Lo);var $o=function(t,e){this.anchor=t,this.head=e};$o.prototype.map=function(t){return new $o(t.map(this.anchor),t.map(this.head))},$o.prototype.resolve=function(t){return Lo.between(t.resolve(this.anchor),t.resolve(this.head))};var qo=function(t){function e(e){var n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);t.call(this,e,r),this.node=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(n,r){var o=r.mapResult(this.anchor),i=o.deleted,s=o.pos,a=n.resolve(s);return i?t.near(a):new e(a)},e.prototype.content=function(){return new Tr(xr.from(this.node),0,0)},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor},e.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},e.prototype.getBookmark=function(){return new Jo(this.anchor)},e.fromJSON=function(t,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(n.anchor))},e.create=function(t,e){return new this(t.resolve(e))},e.isSelectable=function(t){return!t.isText&&!1!==t.type.spec.selectable},e}(zo);qo.prototype.visible=!1,zo.jsonID("node",qo);var Jo=function(t){this.anchor=t};Jo.prototype.map=function(t){var e=t.mapResult(this.anchor),n=e.deleted,r=e.pos;return n?new $o(r,r):new Jo(r)},Jo.prototype.resolve=function(t){var e=t.resolve(this.anchor),n=e.nodeAfter;return n&&qo.isSelectable(n)?new qo(e):zo.near(e)};var Uo=function(t){function e(e){t.call(this,e.resolve(0),e.resolve(e.content.size))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.replace=function(e,n){if(void 0===n&&(n=Tr.empty),n==Tr.empty){e.delete(0,e.doc.content.size);var r=t.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else t.prototype.replace.call(this,e,n)},e.prototype.toJSON=function(){return{type:"all"}},e.fromJSON=function(t){return new e(t)},e.prototype.map=function(t){return new e(t)},e.prototype.eq=function(t){return t instanceof e},e.prototype.getBookmark=function(){return Vo},e}(zo);zo.jsonID("all",Uo);var Vo={map:function(){return this},resolve:function(t){return new Uo(t)}};function Wo(t,e,n,r,o,i){if(e.inlineContent)return Lo.create(t,n);for(var s=r-(o>0?0:1);o>0?s<e.childCount:s>=0;s+=o){var a=e.child(s);if(a.isAtom){if(!i&&qo.isSelectable(a))return qo.create(t,n-(o<0?a.nodeSize:0))}else{var c=Wo(t,a,n+o,o<0?a.childCount:0,o,i);if(c)return c}n+=a.nodeSize*o}}function Ho(t,e,n){var r=t.steps.length-1;if(!(r<e)){var o,i=t.steps[r];if(i instanceof u.c||i instanceof u.b)t.mapping.maps[r].forEach((function(t,e,n,r){null==o&&(o=r)})),t.setSelection(zo.near(t.doc.resolve(o),n))}}var Ko=function(t){function e(e){t.call(this,e.doc),this.time=Date.now(),this.curSelection=e.selection,this.curSelectionFor=0,this.storedMarks=e.storedMarks,this.updated=0,this.meta=Object.create(null)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},e.prototype.setSelection=function(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return(1&this.updated)>0},e.prototype.setStoredMarks=function(t){return this.storedMarks=t,this.updated|=2,this},e.prototype.ensureMarks=function(t){return _r.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this},e.prototype.addStoredMark=function(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))},e.prototype.removeStoredMark=function(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(2&this.updated)>0},e.prototype.addStep=function(e,n){t.prototype.addStep.call(this,e,n),this.updated=-3&this.updated,this.storedMarks=null},e.prototype.setTime=function(t){return this.time=t,this},e.prototype.replaceSelection=function(t){return this.selection.replace(this,t),this},e.prototype.replaceSelectionWith=function(t,e){var n=this.selection;return!1!==e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||_r.none))),n.replaceWith(this,t),this},e.prototype.deleteSelection=function(){return this.selection.replace(this),this},e.prototype.insertText=function(t,e,n){void 0===n&&(n=e);var r=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();if(!t)return this.deleteRange(e,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(e);o=n==e?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(e,n,r.text(t,o)),this.selection.empty||this.setSelection(zo.near(this.selection.$to)),this},e.prototype.setMeta=function(t,e){return this.meta["string"==typeof t?t:t.key]=e,this},e.prototype.getMeta=function(t){return this.meta["string"==typeof t?t:t.key]},n.isGeneric.get=function(){for(var t in this.meta)return!1;return!0},e.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(e.prototype,n),e}(u.d);function Yo(t,e){return e&&t?t.bind(e):t}var Go=function(t,e,n){this.name=t,this.init=Yo(e.init,n),this.apply=Yo(e.apply,n)},Qo=[new Go("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new Go("selection",{init:function(t,e){return t.selection||zo.atStart(e.doc)},apply:function(t){return t.selection}}),new Go("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Go("scrollToSelection",{init:function(){return 0},apply:function(t,e){return t.scrolledIntoView?e+1:e}})],Xo=function(t,e){var n=this;this.schema=t,this.fields=Qo.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),e&&e.forEach((function(t){if(n.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");n.plugins.push(t),n.pluginsByKey[t.key]=t,t.spec.state&&n.fields.push(new Go(t.key,t.spec.state,t))}))},Zo=function(t){this.config=t},ti={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};ti.schema.get=function(){return this.config.schema},ti.plugins.get=function(){return this.config.plugins},Zo.prototype.apply=function(t){return this.applyTransaction(t).state},Zo.prototype.filterTransaction=function(t,e){void 0===e&&(e=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=e){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,t,this))return!1}return!0},Zo.prototype.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var e=[t],n=this.applyInner(t),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var s=this.config.plugins[i];if(s.spec.appendTransaction){var a=r?r[i].n:0,c=r?r[i].state:this,u=a<e.length&&s.spec.appendTransaction.call(s,a?e.slice(a):e,c,n);if(u&&n.filterTransaction(u,i)){if(u.setMeta("appendedTransaction",t),!r){r=[];for(var l=0;l<this.config.plugins.length;l++)r.push(l<i?{state:n,n:e.length}:{state:this,n:0})}e.push(u),n=n.applyInner(u),o=!0}r&&(r[i]={state:n,n:e.length})}}if(!o)return{state:n,transactions:e}}},Zo.prototype.applyInner=function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var e=new Zo(this.config),n=this.config.fields,r=0;r<n.length;r++){var o=n[r];e[o.name]=o.apply(t,this[o.name],this,e)}for(var i=0;i<ei.length;i++)ei[i](this,t,e);return e},ti.tr.get=function(){return new Ko(this)},Zo.create=function(t){for(var e=new Xo(t.schema||t.doc.type.schema,t.plugins),n=new Zo(e),r=0;r<e.fields.length;r++)n[e.fields[r].name]=e.fields[r].init(t,n);return n},Zo.prototype.reconfigure=function(t){for(var e=new Xo(t.schema||this.schema,t.plugins),n=e.fields,r=new Zo(e),o=0;o<n.length;o++){var i=n[o].name;r[i]=this.hasOwnProperty(i)?this[i]:n[o].init(t,r)}return r},Zo.prototype.toJSON=function(t){var e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map((function(t){return t.toJSON()}))),t&&"object"==typeof t)for(var n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=t[n],o=r.spec.state;o&&o.toJSON&&(e[n]=o.toJSON.call(r,this[r.key]))}return e},Zo.fromJSON=function(t,e,n){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var r=new Xo(t.schema,t.plugins),o=new Zo(r);return r.fields.forEach((function(r){if("doc"==r.name)o.doc=Gr.fromJSON(t.schema,e.doc);else if("selection"==r.name)o.selection=zo.fromJSON(o.doc,e.selection);else if("storedMarks"==r.name)e.storedMarks&&(o.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(n)for(var i in n){var s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(e,i))return void(o[r.name]=a.fromJSON.call(s,t,e[i],o))}o[r.name]=r.init(t,o)}})),o},Zo.addApplyListener=function(t){ei.push(t)},Zo.removeApplyListener=function(t){var e=ei.indexOf(t);e>-1&&ei.splice(e,1)},Object.defineProperties(Zo.prototype,ti);var ei=[];function ni(t,e,n){for(var r in t){var o=t[r];o instanceof Function?o=o.bind(e):"handleDOMEvents"==r&&(o=ni(o,e,{})),n[r]=o}return n}var ri=function(t){this.props={},t.props&&ni(t.props,this,this.props),this.spec=t,this.key=t.key?t.key.key:ii("plugin")};ri.prototype.getState=function(t){return t[this.key]};var oi=Object.create(null);function ii(t){return t in oi?t+"$"+ ++oi[t]:(oi[t]=0,t+"$")}var si=function(t){void 0===t&&(t="key"),this.key=ii(t)};function ai(t,e,n){for(var r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;var o=t.child(r),i=e.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(var s=0;o.text[s]==i.text[s];s++)n++;return n}if(o.content.size||i.content.size){var a=ai(o.content,i.content,n+1);if(null!=a)return a}n+=o.nodeSize}else n+=o.nodeSize}}function ci(t,e,n,r){for(var o=t.childCount,i=e.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};var s=t.child(--o),a=e.child(--i),c=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){for(var u=0,l=Math.min(s.text.length,a.text.length);u<l&&s.text[s.text.length-u-1]==a.text[a.text.length-u-1];)u++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){var f=ci(s.content,a.content,n-1,r-1);if(f)return f}n-=c,r-=c}else n-=c,r-=c}}si.prototype.get=function(t){return t.config.pluginsByKey[this.key]},si.prototype.getState=function(t){return t[this.key]};var ui=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},li={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};ui.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var u=s+1;a.nodesBetween(Math.max(0,t-u),Math.min(a.content.size,e-u),n,r+u)}s=c}},ui.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},ui.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},ui.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new ui(r,this.size+t.size)},ui.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var o=0,i=0;i<e;o++){var s=this.content[o],a=i+s.nodeSize;a>t&&((i<t||a>e)&&(s=s.isText?s.cut(Math.max(0,t-i),Math.min(s.text.length,e-i)):s.cut(Math.max(0,t-i-1),Math.min(s.content.size,e-i-1))),n.push(s),r+=s.nodeSize),i=a}return new ui(n,r)},ui.prototype.cutByIndex=function(t,e){return t==e?ui.empty:0==t&&e==this.content.length?this:new ui(this.content.slice(t,e))},ui.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new ui(r,o)},ui.prototype.addToStart=function(t){return new ui([t].concat(this.content),this.size+t.nodeSize)},ui.prototype.addToEnd=function(t){return new ui(this.content.concat(t),this.size+t.nodeSize)},ui.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},li.firstChild.get=function(){return this.content.length?this.content[0]:null},li.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},li.childCount.get=function(){return this.content.length},ui.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},ui.prototype.maybeChild=function(t){return this.content[t]},ui.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},ui.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),ai(this,t,e)},ui.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),ci(this,t,e,n)},ui.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return hi(0,t);if(t==this.size)return hi(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?hi(n+1,o):hi(n,r);r=o}},ui.prototype.toString=function(){return"<"+this.toStringInner()+">"},ui.prototype.toStringInner=function(){return this.content.join(", ")},ui.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},ui.fromJSON=function(t,e){if(!e)return ui.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new ui(e.map(t.nodeFromJSON))},ui.fromArray=function(t){if(!t.length)return ui.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new ui(e||t,n)},ui.from=function(t){if(!t)return ui.empty;if(t instanceof ui)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new ui([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(ui.prototype,li);var fi={index:0,offset:0};function hi(t,e){return fi.index=t,fi.offset=e,fi}function pi(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!pi(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e)||!pi(t[o],e[o]))return!1;for(var i in e)if(!(i in t))return!1}return!0}ui.empty=new ui([],0);var di=function(t,e){this.type=t,this.attrs=e};function vi(t){var e=Error.call(this,t);return e.__proto__=vi.prototype,e}di.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},di.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},di.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},di.prototype.eq=function(t){return this==t||this.type==t.type&&pi(this.attrs,t.attrs)},di.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},di.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},di.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},di.setFrom=function(t){if(!t||0==t.length)return di.none;if(t instanceof di)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},di.none=[],vi.prototype=Object.create(Error.prototype),vi.prototype.constructor=vi,vi.prototype.name="ReplaceError";var yi=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},mi={size:{configurable:!0}};function gi(t,e,n){var r=t.findIndex(e),o=r.index,i=r.offset,s=t.maybeChild(o),a=t.findIndex(n),c=a.index,u=a.offset;if(i==e||s.isText){if(u!=n&&!t.child(c).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return t.replaceChild(o,s.copy(gi(s.content,e-i-1,n-i-1)))}function bi(t,e,n,r){var o=t.findIndex(e),i=o.index,s=o.offset,a=t.maybeChild(i);if(s==e||a.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));var c=bi(a.content,e-s-1,n);return c&&t.replaceChild(i,a.copy(c))}function wi(t,e,n){if(n.openStart>t.depth)throw new vi("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new vi("Inconsistent open depths");return ki(t,e,n,0)}function ki(t,e,n,r){var o=t.index(r),i=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){var s=ki(t,e,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){var a=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(ui.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(n,t);return Ei(i,_i(t,a.start,a.end,e,r))}var c=t.parent,u=c.content;return Ei(c,u.cut(0,t.parentOffset).append(n.content).append(u.cut(e.parentOffset)))}return Ei(i,Mi(t,e,r))}function xi(t,e){if(!e.type.compatibleContent(t.type))throw new vi("Cannot join "+e.type.name+" onto "+t.type.name)}function Si(t,e,n){var r=t.node(n);return xi(r,e.node(n)),r}function Oi(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Ci(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(Oi(t.nodeAfter,r),i++));for(var a=i;a<s;a++)Oi(o.child(a),r);e&&e.depth==n&&e.textOffset&&Oi(e.nodeBefore,r)}function Ei(t,e){if(!t.type.validContent(e))throw new vi("Invalid content for node "+t.type.name);return t.copy(e)}function _i(t,e,n,r,o){var i=t.depth>o&&Si(t,e,o+1),s=r.depth>o&&Si(n,r,o+1),a=[];return Ci(null,t,o,a),i&&s&&e.index(o)==n.index(o)?(xi(i,s),Oi(Ei(i,_i(t,e,n,r,o+1)),a)):(i&&Oi(Ei(i,Mi(t,e,o+1)),a),Ci(e,n,o,a),s&&Oi(Ei(s,Mi(n,r,o+1)),a)),Ci(r,null,o,a),new ui(a)}function Mi(t,e,n){var r=[];(Ci(null,t,n,r),t.depth>n)&&Oi(Ei(Si(t,e,n+1),Mi(t,e,n+1)),r);return Ci(e,null,n,r),new ui(r)}mi.size.get=function(){return this.content.size-this.openStart-this.openEnd},yi.prototype.insertAt=function(t,e){var n=bi(this.content,t+this.openStart,e,null);return n&&new yi(n,this.openStart,this.openEnd)},yi.prototype.removeBetween=function(t,e){return new yi(gi(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},yi.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},yi.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},yi.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},yi.fromJSON=function(t,e){if(!e)return yi.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new yi(ui.fromJSON(t,e.content),n,r)},yi.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new yi(t,n,r)},Object.defineProperties(yi.prototype,mi),yi.empty=new yi(ui.empty,0,0);var Ti=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},Ni={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};Ti.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},Ni.parent.get=function(){return this.node(this.depth)},Ni.doc.get=function(){return this.node(0)},Ti.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},Ti.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},Ti.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},Ti.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},Ti.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},Ti.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},Ti.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},Ni.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},Ni.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},Ni.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},Ti.prototype.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,o=0;o<t;o++)r+=n.child(o).nodeSize;return r},Ti.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return di.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},Ti.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},Ti.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},Ti.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new Di(this,t,n)},Ti.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},Ti.prototype.max=function(t){return t.pos>this.pos?t:this},Ti.prototype.min=function(t){return t.pos<this.pos?t:this},Ti.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},Ti.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,u=o-c;if(n.push(i,a,r+c),!u)break;if((i=i.child(a)).isText)break;o=u-1,r+=c+1}return new Ti(e,n,o)},Ti.resolveCached=function(t,e){for(var n=0;n<Ai.length;n++){var r=Ai[n];if(r.pos==e&&r.doc==t)return r}var o=Ai[Ii]=Ti.resolve(t,e);return Ii=(Ii+1)%ji,o},Object.defineProperties(Ti.prototype,Ni);var Ai=[],Ii=0,ji=12,Di=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},Ri={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};Ri.start.get=function(){return this.$from.before(this.depth+1)},Ri.end.get=function(){return this.$to.after(this.depth+1)},Ri.parent.get=function(){return this.$from.node(this.depth)},Ri.startIndex.get=function(){return this.$from.index(this.depth)},Ri.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(Di.prototype,Ri);var Pi=Object.create(null),zi=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||ui.empty,this.marks=r||di.none},Fi={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Fi.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},Fi.childCount.get=function(){return this.content.childCount},zi.prototype.child=function(t){return this.content.child(t)},zi.prototype.maybeChild=function(t){return this.content.maybeChild(t)},zi.prototype.forEach=function(t){this.content.forEach(t)},zi.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},zi.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},Fi.textContent.get=function(){return this.textBetween(0,this.content.size,"")},zi.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},Fi.firstChild.get=function(){return this.content.firstChild},Fi.lastChild.get=function(){return this.content.lastChild},zi.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},zi.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},zi.prototype.hasMarkup=function(t,e,n){return this.type==t&&pi(this.attrs,e||t.defaultAttrs||Pi)&&di.sameSet(this.marks,n||di.none)},zi.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},zi.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},zi.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},zi.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return yi.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new yi(a,r.depth-i,o.depth-i)},zi.prototype.replace=function(t,e,n){return wi(this.resolve(t),this.resolve(e),n)},zi.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},zi.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},zi.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},zi.prototype.resolve=function(t){return Ti.resolveCached(this,t)},zi.prototype.resolveNoCache=function(t){return Ti.resolve(this,t)},zi.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},Fi.isBlock.get=function(){return this.type.isBlock},Fi.isTextblock.get=function(){return this.type.isTextblock},Fi.inlineContent.get=function(){return this.type.inlineContent},Fi.isInline.get=function(){return this.type.isInline},Fi.isText.get=function(){return this.type.isText},Fi.isLeaf.get=function(){return this.type.isLeaf},Fi.isAtom.get=function(){return this.type.isAtom},zi.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),Li(this.marks,t)},zi.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},zi.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=ui.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,e);if(!s||!s.validEnd)return!1;for(var a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0},zi.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},zi.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},zi.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},zi.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},zi.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=ui.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(zi.prototype,Fi);var Bi=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Li(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(zi);function Li(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var $i=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},qi={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};$i.parse=function(t,e){var n=new Ji(t,e);if(null==n.next)return $i.empty;var r=Vi(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return n(Qi(t,0));function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];Qi(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new $i(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(Gi);i.next.push(o[s],e[a.join(",")]||n(a))}return i}}(function(t){var e=[[]];return o(i(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}function i(t,e){if("choice"==t.type)return t.exprs.reduce((function(t,n){return t.concat(i(n,e))}),[]);if("seq"==t.type)for(var s=0;;s++){var a=i(t.exprs[s],e);if(s==t.exprs.length-1)return a;o(a,e=n())}else{if("star"==t.type){var c=n();return r(e,c),o(i(t.expr,c),c),[r(c)]}if("plus"==t.type){var u=n();return o(i(t.expr,e),u),o(i(t.expr,u),u),[r(u)]}if("opt"==t.type)return[r(e)].concat(i(t.expr,e));if("range"==t.type){for(var l=e,f=0;f<t.min;f++){var h=n();o(i(t.expr,l),h),l=h}if(-1==t.max)o(i(t.expr,l),l);else for(var p=t.min;p<t.max;p++){var d=n();r(l,d),o(i(t.expr,l),d),l=d}return[r(l)]}if("name"==t.type)return[r(e,null,t.value)]}}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],u=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(u)&&r.push(u)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},$i.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},$i.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},qi.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},qi.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},$i.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},$i.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,s){var a=i.matchFragment(t,n);if(a&&(!e||a.validEnd))return ui.from(s.map((function(t){return t.createAndFill()})));for(var c=0;c<i.next.length;c+=2){var u=i.next[c],l=i.next[c+1];if(!u.isText&&!u.hasRequiredAttrs()&&-1==r.indexOf(l)){r.push(l);var f=o(l,s.concat(u));if(f)return f}}}(this,[])},$i.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},$i.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},qi.edgeCount.get=function(){return this.next.length>>1},$i.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},$i.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties($i.prototype,qi),$i.empty=new $i(!0);var Ji=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},Ui={next:{configurable:!0}};function Vi(t){var e=[];do{e.push(Wi(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function Wi(t){var e=[];do{e.push(Hi(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function Hi(t){for(var e=function(t){if(t.eat("(")){var e=Vi(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=Yi(t,e)}return e}function Ki(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function Yi(t,e){var n=Ki(t),r=n;return t.eat(",")&&(r="}"!=t.next?Ki(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function Gi(t,e){return e-t}function Qi(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(Gi)}function Xi(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function Zi(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function ts(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new rs(t[n]);return e}Ui.next.get=function(){return this.tokens[this.pos]},Ji.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},Ji.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(Ji.prototype,Ui);var es=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=ts(n.attrs),this.defaultAttrs=Xi(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},ns={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};ns.isInline.get=function(){return!this.isBlock},ns.isTextblock.get=function(){return this.isBlock&&this.inlineContent},ns.isLeaf.get=function(){return this.contentMatch==$i.empty},ns.isAtom.get=function(){return this.isLeaf||this.spec.atom},es.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},es.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},es.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:Zi(this.attrs,t)},es.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new zi(this,this.computeAttrs(t),ui.from(e),di.setFrom(n))},es.prototype.createChecked=function(t,e,n){if(e=ui.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new zi(this,this.computeAttrs(t),e,di.setFrom(n))},es.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=ui.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e).fillBefore(ui.empty,!0);return o?new zi(this,t,e.append(o),di.setFrom(n)):null},es.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},es.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},es.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},es.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:di.empty:t},es.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new es(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(es.prototype,ns);var rs=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},is={isRequired:{configurable:!0}};is.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(rs.prototype,is);var ss=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=ts(r.attrs),this.rank=e,this.excluded=null;var o=Xi(this.attrs);this.instance=o&&new di(this,o)};ss.prototype.create=function(t){return!t&&this.instance?this.instance:new di(this,Zi(this.attrs,t))},ss.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new ss(t,r++,e,o)})),n},ss.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},ss.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},ss.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var as=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=l.a.from(t.nodes),this.spec.marks=l.a.from(t.marks),this.nodes=es.compile(this.spec.nodes,this),this.marks=ss.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],i=o.spec.content||"",s=o.spec.marks;o.contentMatch=n[i]||(n[i]=$i.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==s?null:s?cs(this,s.split(" ")):""!=s&&o.inlineContent?null:[]}for(var a in this.marks){var c=this.marks[a],u=c.spec.excludes;c.excluded=null==u?[c]:""==u?[]:cs(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function cs(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}as.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof es))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},as.prototype.text=function(t,e){var n=this.nodes.text;return new Bi(n,n.defaultAttrs,t,di.setFrom(e))},as.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},as.prototype.nodeFromJSON=function(t){return zi.fromJSON(this,t)},as.prototype.markFromJSON=function(t){return di.fromJSON(this,t)},as.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var us=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)})),this.normalizeLists=!this.tags.some((function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)}))};us.prototype.parse=function(t,e){void 0===e&&(e={});var n=new vs(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},us.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new vs(this,e,!0);return n.addAll(t,null,e.from,e.to),yi.maxOpen(n.finish())},us.prototype.matchTag=function(t,e,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(ms(t,o.tag)&&(void 0===o.namespace||t.namespaceURI==o.namespace)&&(!o.context||e.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(t);if(!1===i)continue;o.attrs=i}return o}}},us.prototype.matchStyle=function(t,e,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(t)||i.context&&!n.matchesContext(i.context)||i.style.length>t.length&&(61!=i.style.charCodeAt(t.length)||i.style.slice(t.length+1)!=e))){if(i.getAttrs){var s=i.getAttrs(e);if(!1===s)continue;i.attrs=s}return i}}},us.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=gs(t)),t.mark=e}))};for(var o in t.marks)r(o);var i=function(e){var r=t.nodes[s].spec.parseDOM;r&&r.forEach((function(t){n(t=gs(t)),t.node=s}))};for(var s in t.nodes)i();return e},us.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new us(t,us.schemaRules(t)))};var ls={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},fs={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},hs={ol:!0,ul:!0};function ps(t){return(t?1:0)|("full"===t?2:0)}var ds=function(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=di.none,this.pendingMarks=r,this.stashMarks=[]};ds.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(ui.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},ds.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=ui.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(ui.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},ds.prototype.popFromStashMark=function(t){for(var e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]},ds.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):bs(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}};var vs=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,i=ps(e.preserveWhitespace)|(n?4:0);r=o?new ds(o.type,o.attrs,di.none,di.none,!0,e.topMatch||o.type.contentMatch,i):new ds(n?null:t.schema.topNodeType,null,di.none,di.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},ys={top:{configurable:!0},currentPos:{configurable:!0}};function ms(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function gs(t){var e={};for(var n in t)e[n]=t[n];return e}function bs(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var i=[];return function t(n){i.push(n);for(var r=0;r<n.edgeCount;r++){var o=n.edge(r),s=o.type,a=o.next;if(s==e)return!0;if(i.indexOf(a)<0&&t(a))return!0}}(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}ys.top.get=function(){return this.nodes[this.open]},vs.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},vs.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},vs.prototype.addElement=function(t,e){var n,r=t.nodeName.toLowerCase();hs.hasOwnProperty(r)&&this.parser.normalizeLists&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&hs.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var o=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(n=this.parser.matchTag(t,this,e));if(o?o.ignore:fs.hasOwnProperty(r))this.findInside(t);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(t=o.skip);var i,s=this.top,a=this.needsBlock;if(ls.hasOwnProperty(r))i=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),i&&this.sync(s),this.needsBlock=a}else this.addElementByRule(t,o,!1===o.consuming?n:null)},vs.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},vs.prototype.readStyles=function(t){var e=di.none;t:for(var n=0;n<t.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(t[n],t[n+1],this,r);if(!o)continue t;if(o.ignore)return null;if(e=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(e),!1!==o.consuming)break;r=o}return e},vs.prototype.addElementByRule=function(t,e,n){var r,o,i,s=this;e.node?(o=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(o.create(e.attrs))||this.leafFallback(t):r=this.enter(o,e.attrs,e.preserveWhitespace):(i=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(i));var a=this.top;if(o&&o.isLeaf)this.findInside(t);else if(n)this.addElement(t,n);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return s.insertNode(t)}));else{var c=e.contentElement;"string"==typeof c?c=t.querySelector(c):"function"==typeof c&&(c=c(t)),c||(c=t),this.findAround(t,c,!0),this.addAll(c,r)}r&&(this.sync(a),this.open--),i&&this.removePendingMark(i,a)},vs.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&ls.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},vs.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},vs.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},vs.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},vs.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:ps(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new ds(t,e,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},vs.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},vs.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},vs.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},ys.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},vs.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},vs.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},vs.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},vs.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},vs.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1);return function t(s,a){for(;s>=0;s--){var c=n[s];if(""==c){if(s==n.length-1||0==s)continue;for(;a>=i;a--)if(t(s-1,a))return!0;return!1}var u=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!u||u.name!=c&&-1==u.groups.indexOf(c))return!1;a--}return!0}(n.length-1,this.open)},vs.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},vs.prototype.addPendingMark=function(t){var e=function(t,e){for(var n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},vs.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(t)>-1)r.pendingMarks=t.removeFromSet(r.pendingMarks);else{r.activeMarks=t.removeFromSet(r.activeMarks);var o=r.popFromStashMark(t);o&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==e)break}},Object.defineProperties(vs.prototype,ys);var ws=function(t,e){this.nodes=t||{},this.marks=e||{}};function ks(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function xs(t){return t.document||window.document}ws.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=xs(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],u=r.serializeMark(c,t.isInline,e);u&&(i.push(c,o),o.appendChild(u.dom),o=u.contentDOM||u.dom)}}o.appendChild(r.serializeNode(t,e))})),n},ws.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=ws.renderSpec(xs(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},ws.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},ws.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&ws.renderSpec(xs(n),r(t,e))},ws.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var u in c=2,a)if(null!=a[u]){var l=u.indexOf(" ");l>0?s.setAttributeNS(u.slice(0,l),u.slice(l+1),a[u]):s.setAttribute(u,a[u])}for(var f=c;f<e.length;f++){var h=e[f];if(0===h){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var p=ws.renderSpec(t,h,n),d=p.dom,v=p.contentDOM;if(s.appendChild(d),v){if(i)throw new RangeError("Multiple content holes");i=v}}return{dom:s,contentDOM:i}},ws.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new ws(this.nodesFromSchema(t),this.marksFromSchema(t)))},ws.nodesFromSchema=function(t){var e=ks(t.nodes);return e.text||(e.text=function(t){return t.text}),e},ws.marksFromSchema=function(t){return ks(t.marks)};var Ss=Object.create(null),Os=function(t,e,n){this.ranges=n||[new Es(t.min(e),t.max(e))],this.$anchor=t,this.$head=e},Cs={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};Cs.anchor.get=function(){return this.$anchor.pos},Cs.head.get=function(){return this.$head.pos},Cs.from.get=function(){return this.$from.pos},Cs.to.get=function(){return this.$to.pos},Cs.$from.get=function(){return this.ranges[0].$from},Cs.$to.get=function(){return this.ranges[0].$to},Cs.empty.get=function(){for(var t=this.ranges,e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0},Os.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},Os.prototype.replace=function(t,e){void 0===e&&(e=yi.empty);for(var n=e.content.lastChild,r=null,o=0;o<e.openEnd;o++)r=n,n=n.lastChild;for(var i=t.steps.length,s=this.ranges,a=0;a<s.length;a++){var c=s[a],u=c.$from,l=c.$to,f=t.mapping.slice(i);t.replaceRange(f.map(u.pos),f.map(l.pos),a?yi.empty:e),0==a&&Ds(t,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}},Os.prototype.replaceWith=function(t,e){for(var n=t.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],s=i.$from,a=i.$to,c=t.mapping.slice(n),u=c.map(s.pos),l=c.map(a.pos);o?t.deleteRange(u,l):(t.replaceRangeWith(u,l,e),Ds(t,n,e.isInline?-1:1))}},Os.findFrom=function(t,e,n){var r=t.parent.inlineContent?new _s(t):js(t.node(0),t.parent,t.pos,t.index(),e,n);if(r)return r;for(var o=t.depth-1;o>=0;o--){var i=e<0?js(t.node(0),t.node(o),t.before(o+1),t.index(o),e,n):js(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,e,n);if(i)return i}},Os.near=function(t,e){return void 0===e&&(e=1),this.findFrom(t,e)||this.findFrom(t,-e)||new As(t.node(0))},Os.atStart=function(t){return js(t,t,0,0,1)||new As(t)},Os.atEnd=function(t){return js(t,t,t.content.size,t.childCount,-1)||new As(t)},Os.fromJSON=function(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=Ss[e.type];if(!n)throw new RangeError("No selection type "+e.type+" defined");return n.fromJSON(t,e)},Os.jsonID=function(t,e){if(t in Ss)throw new RangeError("Duplicate use of selection JSON ID "+t);return Ss[t]=e,e.prototype.jsonID=t,e},Os.prototype.getBookmark=function(){return _s.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(Os.prototype,Cs),Os.prototype.visible=!0;var Es=function(t,e){this.$from=t,this.$to=e},_s=function(t){function e(e,n){void 0===n&&(n=e),t.call(this,e,n)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},e.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));if(!o.parent.inlineContent)return t.near(o);var i=n.resolve(r.map(this.anchor));return new e(i.parent.inlineContent?i:o,o)},e.prototype.replace=function(e,n){if(void 0===n&&(n=yi.empty),t.prototype.replace.call(this,e,n),n==yi.empty){var r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head},e.prototype.getBookmark=function(){return new Ms(this.anchor,this.head)},e.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(n.anchor),t.resolve(n.head))},e.create=function(t,e,n){void 0===n&&(n=e);var r=t.resolve(e);return new this(r,n==e?r:t.resolve(n))},e.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=i>=0?1:-1),!r.parent.inlineContent){var s=t.findFrom(r,o,!0)||t.findFrom(r,-o,!0);if(!s)return t.near(r,o);r=s.$head}return n.parent.inlineContent||(0==i||(n=(t.findFrom(n,-o,!0)||t.findFrom(n,o,!0)).$anchor).pos<r.pos!=i<0)&&(n=r),new e(n,r)},Object.defineProperties(e.prototype,n),e}(Os);Os.jsonID("text",_s);var Ms=function(t,e){this.anchor=t,this.head=e};Ms.prototype.map=function(t){return new Ms(t.map(this.anchor),t.map(this.head))},Ms.prototype.resolve=function(t){return _s.between(t.resolve(this.anchor),t.resolve(this.head))};var Ts=function(t){function e(e){var n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);t.call(this,e,r),this.node=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(n,r){var o=r.mapResult(this.anchor),i=o.deleted,s=o.pos,a=n.resolve(s);return i?t.near(a):new e(a)},e.prototype.content=function(){return new yi(ui.from(this.node),0,0)},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor},e.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},e.prototype.getBookmark=function(){return new Ns(this.anchor)},e.fromJSON=function(t,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(n.anchor))},e.create=function(t,e){return new this(t.resolve(e))},e.isSelectable=function(t){return!t.isText&&!1!==t.type.spec.selectable},e}(Os);Ts.prototype.visible=!1,Os.jsonID("node",Ts);var Ns=function(t){this.anchor=t};Ns.prototype.map=function(t){var e=t.mapResult(this.anchor),n=e.deleted,r=e.pos;return n?new Ms(r,r):new Ns(r)},Ns.prototype.resolve=function(t){var e=t.resolve(this.anchor),n=e.nodeAfter;return n&&Ts.isSelectable(n)?new Ts(e):Os.near(e)};var As=function(t){function e(e){t.call(this,e.resolve(0),e.resolve(e.content.size))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.replace=function(e,n){if(void 0===n&&(n=yi.empty),n==yi.empty){e.delete(0,e.doc.content.size);var r=t.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else t.prototype.replace.call(this,e,n)},e.prototype.toJSON=function(){return{type:"all"}},e.fromJSON=function(t){return new e(t)},e.prototype.map=function(t){return new e(t)},e.prototype.eq=function(t){return t instanceof e},e.prototype.getBookmark=function(){return Is},e}(Os);Os.jsonID("all",As);var Is={map:function(){return this},resolve:function(t){return new As(t)}};function js(t,e,n,r,o,i){if(e.inlineContent)return _s.create(t,n);for(var s=r-(o>0?0:1);o>0?s<e.childCount:s>=0;s+=o){var a=e.child(s);if(a.isAtom){if(!i&&Ts.isSelectable(a))return Ts.create(t,n-(o<0?a.nodeSize:0))}else{var c=js(t,a,n+o,o<0?a.childCount:0,o,i);if(c)return c}n+=a.nodeSize*o}}function Ds(t,e,n){var r=t.steps.length-1;if(!(r<e)){var o,i=t.steps[r];if(i instanceof u.c||i instanceof u.b)t.mapping.maps[r].forEach((function(t,e,n,r){null==o&&(o=r)})),t.setSelection(Os.near(t.doc.resolve(o),n))}}var Rs=function(t){function e(e){t.call(this,e.doc),this.time=Date.now(),this.curSelection=e.selection,this.curSelectionFor=0,this.storedMarks=e.storedMarks,this.updated=0,this.meta=Object.create(null)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},e.prototype.setSelection=function(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return(1&this.updated)>0},e.prototype.setStoredMarks=function(t){return this.storedMarks=t,this.updated|=2,this},e.prototype.ensureMarks=function(t){return di.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this},e.prototype.addStoredMark=function(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))},e.prototype.removeStoredMark=function(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(2&this.updated)>0},e.prototype.addStep=function(e,n){t.prototype.addStep.call(this,e,n),this.updated=-3&this.updated,this.storedMarks=null},e.prototype.setTime=function(t){return this.time=t,this},e.prototype.replaceSelection=function(t){return this.selection.replace(this,t),this},e.prototype.replaceSelectionWith=function(t,e){var n=this.selection;return!1!==e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||di.none))),n.replaceWith(this,t),this},e.prototype.deleteSelection=function(){return this.selection.replace(this),this},e.prototype.insertText=function(t,e,n){void 0===n&&(n=e);var r=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();if(!t)return this.deleteRange(e,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(e);o=n==e?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(e,n,r.text(t,o)),this.selection.empty||this.setSelection(Os.near(this.selection.$to)),this},e.prototype.setMeta=function(t,e){return this.meta["string"==typeof t?t:t.key]=e,this},e.prototype.getMeta=function(t){return this.meta["string"==typeof t?t:t.key]},n.isGeneric.get=function(){for(var t in this.meta)return!1;return!0},e.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(e.prototype,n),e}(u.d);function Ps(t,e){return e&&t?t.bind(e):t}var zs=function(t,e,n){this.name=t,this.init=Ps(e.init,n),this.apply=Ps(e.apply,n)},Fs=[new zs("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new zs("selection",{init:function(t,e){return t.selection||Os.atStart(e.doc)},apply:function(t){return t.selection}}),new zs("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new zs("scrollToSelection",{init:function(){return 0},apply:function(t,e){return t.scrolledIntoView?e+1:e}})],Bs=function(t,e){var n=this;this.schema=t,this.fields=Fs.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),e&&e.forEach((function(t){if(n.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");n.plugins.push(t),n.pluginsByKey[t.key]=t,t.spec.state&&n.fields.push(new zs(t.key,t.spec.state,t))}))},Ls=function(t){this.config=t},$s={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};$s.schema.get=function(){return this.config.schema},$s.plugins.get=function(){return this.config.plugins},Ls.prototype.apply=function(t){return this.applyTransaction(t).state},Ls.prototype.filterTransaction=function(t,e){void 0===e&&(e=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=e){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,t,this))return!1}return!0},Ls.prototype.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var e=[t],n=this.applyInner(t),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var s=this.config.plugins[i];if(s.spec.appendTransaction){var a=r?r[i].n:0,c=r?r[i].state:this,u=a<e.length&&s.spec.appendTransaction.call(s,a?e.slice(a):e,c,n);if(u&&n.filterTransaction(u,i)){if(u.setMeta("appendedTransaction",t),!r){r=[];for(var l=0;l<this.config.plugins.length;l++)r.push(l<i?{state:n,n:e.length}:{state:this,n:0})}e.push(u),n=n.applyInner(u),o=!0}r&&(r[i]={state:n,n:e.length})}}if(!o)return{state:n,transactions:e}}},Ls.prototype.applyInner=function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var e=new Ls(this.config),n=this.config.fields,r=0;r<n.length;r++){var o=n[r];e[o.name]=o.apply(t,this[o.name],this,e)}for(var i=0;i<qs.length;i++)qs[i](this,t,e);return e},$s.tr.get=function(){return new Rs(this)},Ls.create=function(t){for(var e=new Bs(t.schema||t.doc.type.schema,t.plugins),n=new Ls(e),r=0;r<e.fields.length;r++)n[e.fields[r].name]=e.fields[r].init(t,n);return n},Ls.prototype.reconfigure=function(t){for(var e=new Bs(t.schema||this.schema,t.plugins),n=e.fields,r=new Ls(e),o=0;o<n.length;o++){var i=n[o].name;r[i]=this.hasOwnProperty(i)?this[i]:n[o].init(t,r)}return r},Ls.prototype.toJSON=function(t){var e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map((function(t){return t.toJSON()}))),t&&"object"==typeof t)for(var n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=t[n],o=r.spec.state;o&&o.toJSON&&(e[n]=o.toJSON.call(r,this[r.key]))}return e},Ls.fromJSON=function(t,e,n){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var r=new Bs(t.schema,t.plugins),o=new Ls(r);return r.fields.forEach((function(r){if("doc"==r.name)o.doc=zi.fromJSON(t.schema,e.doc);else if("selection"==r.name)o.selection=Os.fromJSON(o.doc,e.selection);else if("storedMarks"==r.name)e.storedMarks&&(o.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(n)for(var i in n){var s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(e,i))return void(o[r.name]=a.fromJSON.call(s,t,e[i],o))}o[r.name]=r.init(t,o)}})),o},Ls.addApplyListener=function(t){qs.push(t)},Ls.removeApplyListener=function(t){var e=qs.indexOf(t);e>-1&&qs.splice(e,1)},Object.defineProperties(Ls.prototype,$s);var qs=[];function Js(t,e,n){for(var r in t){var o=t[r];o instanceof Function?o=o.bind(e):"handleDOMEvents"==r&&(o=Js(o,e,{})),n[r]=o}return n}var Us=function(t){this.props={},t.props&&Js(t.props,this,this.props),this.spec=t,this.key=t.key?t.key.key:Ws("plugin")};Us.prototype.getState=function(t){return t[this.key]};var Vs=Object.create(null);function Ws(t){return t in Vs?t+"$"+ ++Vs[t]:(Vs[t]=0,t+"$")}var Hs=function(t){void 0===t&&(t="key"),this.key=Ws(t)};function Ks(t){return void 0===t&&(t={}),new Us({view:function(e){return new Ys(e,t)}})}Hs.prototype.get=function(t){return t.config.pluginsByKey[this.key]},Hs.prototype.getState=function(t){return t[this.key]};var Ys=function(t,e){var n=this;this.editorView=t,this.width=e.width||1,this.color=e.color||"black",this.class=e.class,this.cursorPos=null,this.element=null,this.timeout=null,this.handlers=["dragover","dragend","drop","dragleave"].map((function(e){var r=function(t){return n[e](t)};return t.dom.addEventListener(e,r),{name:e,handler:r}}))};function Gs(t,e,n){for(var r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;var o=t.child(r),i=e.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(var s=0;o.text[s]==i.text[s];s++)n++;return n}if(o.content.size||i.content.size){var a=Gs(o.content,i.content,n+1);if(null!=a)return a}n+=o.nodeSize}else n+=o.nodeSize}}function Qs(t,e,n,r){for(var o=t.childCount,i=e.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};var s=t.child(--o),a=e.child(--i),c=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){for(var u=0,l=Math.min(s.text.length,a.text.length);u<l&&s.text[s.text.length-u-1]==a.text[a.text.length-u-1];)u++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){var f=Qs(s.content,a.content,n-1,r-1);if(f)return f}n-=c,r-=c}else n-=c,r-=c}}Ys.prototype.destroy=function(){var t=this;this.handlers.forEach((function(e){var n=e.name,r=e.handler;return t.editorView.dom.removeEventListener(n,r)}))},Ys.prototype.update=function(t,e){null!=this.cursorPos&&e.doc!=t.state.doc&&this.updateOverlay()},Ys.prototype.setCursor=function(t){t!=this.cursorPos&&(this.cursorPos=t,null==t?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())},Ys.prototype.updateOverlay=function(){var t,e=this.editorView.state.doc.resolve(this.cursorPos);if(!e.parent.inlineContent){var n=e.nodeBefore,r=e.nodeAfter;if(n||r){var o=this.editorView.nodeDOM(this.cursorPos-(n?n.nodeSize:0)).getBoundingClientRect(),i=n?o.bottom:o.top;n&&r&&(i=(i+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),t={left:o.left,right:o.right,top:i-this.width/2,bottom:i+this.width/2}}}if(!t){var s=this.editorView.coordsAtPos(this.cursorPos);t={left:s.left-this.width/2,right:s.left+this.width/2,top:s.top,bottom:s.bottom}}var a=this.editorView.dom.offsetParent;this.element||(this.element=a.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color);var c=!a||a==document.body&&"static"==getComputedStyle(a).position?{left:-pageXOffset,top:-pageYOffset}:a.getBoundingClientRect();this.element.style.left=t.left-c.left+"px",this.element.style.top=t.top-c.top+"px",this.element.style.width=t.right-t.left+"px",this.element.style.height=t.bottom-t.top+"px"},Ys.prototype.scheduleRemoval=function(t){var e=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){return e.setCursor(null)}),t)},Ys.prototype.dragover=function(t){if(this.editorView.editable){var e=this.editorView.posAtCoords({left:t.clientX,top:t.clientY});if(e){var n=e.pos;this.editorView.dragging&&this.editorView.dragging.slice&&null==(n=Object(u.g)(this.editorView.state.doc,n,this.editorView.dragging.slice))&&(n=e.pos),this.setCursor(n),this.scheduleRemoval(5e3)}}},Ys.prototype.dragend=function(){this.scheduleRemoval(20)},Ys.prototype.drop=function(){this.scheduleRemoval(20)},Ys.prototype.dragleave=function(t){t.target!=this.editorView.dom&&this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)};var Xs=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},Zs={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};Xs.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var u=s+1;a.nodesBetween(Math.max(0,t-u),Math.min(a.content.size,e-u),n,r+u)}s=c}},Xs.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},Xs.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},Xs.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new Xs(r,this.size+t.size)},Xs.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var o=0,i=0;i<e;o++){var s=this.content[o],a=i+s.nodeSize;a>t&&((i<t||a>e)&&(s=s.isText?s.cut(Math.max(0,t-i),Math.min(s.text.length,e-i)):s.cut(Math.max(0,t-i-1),Math.min(s.content.size,e-i-1))),n.push(s),r+=s.nodeSize),i=a}return new Xs(n,r)},Xs.prototype.cutByIndex=function(t,e){return t==e?Xs.empty:0==t&&e==this.content.length?this:new Xs(this.content.slice(t,e))},Xs.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new Xs(r,o)},Xs.prototype.addToStart=function(t){return new Xs([t].concat(this.content),this.size+t.nodeSize)},Xs.prototype.addToEnd=function(t){return new Xs(this.content.concat(t),this.size+t.nodeSize)},Xs.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},Zs.firstChild.get=function(){return this.content.length?this.content[0]:null},Zs.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},Zs.childCount.get=function(){return this.content.length},Xs.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},Xs.prototype.maybeChild=function(t){return this.content[t]},Xs.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},Xs.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),Gs(this,t,e)},Xs.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),Qs(this,t,e,n)},Xs.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return ea(0,t);if(t==this.size)return ea(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?ea(n+1,o):ea(n,r);r=o}},Xs.prototype.toString=function(){return"<"+this.toStringInner()+">"},Xs.prototype.toStringInner=function(){return this.content.join(", ")},Xs.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},Xs.fromJSON=function(t,e){if(!e)return Xs.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new Xs(e.map(t.nodeFromJSON))},Xs.fromArray=function(t){if(!t.length)return Xs.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new Xs(e||t,n)},Xs.from=function(t){if(!t)return Xs.empty;if(t instanceof Xs)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new Xs([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(Xs.prototype,Zs);var ta={index:0,offset:0};function ea(t,e){return ta.index=t,ta.offset=e,ta}function na(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!na(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e)||!na(t[o],e[o]))return!1;for(var i in e)if(!(i in t))return!1}return!0}Xs.empty=new Xs([],0);var ra=function(t,e){this.type=t,this.attrs=e};function oa(t){var e=Error.call(this,t);return e.__proto__=oa.prototype,e}ra.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},ra.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},ra.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},ra.prototype.eq=function(t){return this==t||this.type==t.type&&na(this.attrs,t.attrs)},ra.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},ra.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},ra.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},ra.setFrom=function(t){if(!t||0==t.length)return ra.none;if(t instanceof ra)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},ra.none=[],oa.prototype=Object.create(Error.prototype),oa.prototype.constructor=oa,oa.prototype.name="ReplaceError";var ia=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},sa={size:{configurable:!0}};function aa(t,e,n){var r=t.findIndex(e),o=r.index,i=r.offset,s=t.maybeChild(o),a=t.findIndex(n),c=a.index,u=a.offset;if(i==e||s.isText){if(u!=n&&!t.child(c).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return t.replaceChild(o,s.copy(aa(s.content,e-i-1,n-i-1)))}function ca(t,e,n,r){var o=t.findIndex(e),i=o.index,s=o.offset,a=t.maybeChild(i);if(s==e||a.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));var c=ca(a.content,e-s-1,n);return c&&t.replaceChild(i,a.copy(c))}function ua(t,e,n){if(n.openStart>t.depth)throw new oa("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new oa("Inconsistent open depths");return la(t,e,n,0)}function la(t,e,n,r){var o=t.index(r),i=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){var s=la(t,e,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){var a=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(Xs.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(n,t);return va(i,ya(t,a.start,a.end,e,r))}var c=t.parent,u=c.content;return va(c,u.cut(0,t.parentOffset).append(n.content).append(u.cut(e.parentOffset)))}return va(i,ma(t,e,r))}function fa(t,e){if(!e.type.compatibleContent(t.type))throw new oa("Cannot join "+e.type.name+" onto "+t.type.name)}function ha(t,e,n){var r=t.node(n);return fa(r,e.node(n)),r}function pa(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function da(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(pa(t.nodeAfter,r),i++));for(var a=i;a<s;a++)pa(o.child(a),r);e&&e.depth==n&&e.textOffset&&pa(e.nodeBefore,r)}function va(t,e){if(!t.type.validContent(e))throw new oa("Invalid content for node "+t.type.name);return t.copy(e)}function ya(t,e,n,r,o){var i=t.depth>o&&ha(t,e,o+1),s=r.depth>o&&ha(n,r,o+1),a=[];return da(null,t,o,a),i&&s&&e.index(o)==n.index(o)?(fa(i,s),pa(va(i,ya(t,e,n,r,o+1)),a)):(i&&pa(va(i,ma(t,e,o+1)),a),da(e,n,o,a),s&&pa(va(s,ma(n,r,o+1)),a)),da(r,null,o,a),new Xs(a)}function ma(t,e,n){var r=[];(da(null,t,n,r),t.depth>n)&&pa(va(ha(t,e,n+1),ma(t,e,n+1)),r);return da(e,null,n,r),new Xs(r)}sa.size.get=function(){return this.content.size-this.openStart-this.openEnd},ia.prototype.insertAt=function(t,e){var n=ca(this.content,t+this.openStart,e,null);return n&&new ia(n,this.openStart,this.openEnd)},ia.prototype.removeBetween=function(t,e){return new ia(aa(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},ia.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},ia.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},ia.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},ia.fromJSON=function(t,e){if(!e)return ia.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new ia(Xs.fromJSON(t,e.content),n,r)},ia.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new ia(t,n,r)},Object.defineProperties(ia.prototype,sa),ia.empty=new ia(Xs.empty,0,0);var ga=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},ba={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};ga.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},ba.parent.get=function(){return this.node(this.depth)},ba.doc.get=function(){return this.node(0)},ga.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},ga.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},ga.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},ga.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},ga.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},ga.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},ga.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},ba.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},ba.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},ba.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},ga.prototype.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,o=0;o<t;o++)r+=n.child(o).nodeSize;return r},ga.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return ra.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},ga.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},ga.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},ga.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new Sa(this,t,n)},ga.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},ga.prototype.max=function(t){return t.pos>this.pos?t:this},ga.prototype.min=function(t){return t.pos<this.pos?t:this},ga.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},ga.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,u=o-c;if(n.push(i,a,r+c),!u)break;if((i=i.child(a)).isText)break;o=u-1,r+=c+1}return new ga(e,n,o)},ga.resolveCached=function(t,e){for(var n=0;n<wa.length;n++){var r=wa[n];if(r.pos==e&&r.doc==t)return r}var o=wa[ka]=ga.resolve(t,e);return ka=(ka+1)%xa,o},Object.defineProperties(ga.prototype,ba);var wa=[],ka=0,xa=12,Sa=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},Oa={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};Oa.start.get=function(){return this.$from.before(this.depth+1)},Oa.end.get=function(){return this.$to.after(this.depth+1)},Oa.parent.get=function(){return this.$from.node(this.depth)},Oa.startIndex.get=function(){return this.$from.index(this.depth)},Oa.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(Sa.prototype,Oa);var Ca=Object.create(null),Ea=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||Xs.empty,this.marks=r||ra.none},_a={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};_a.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},_a.childCount.get=function(){return this.content.childCount},Ea.prototype.child=function(t){return this.content.child(t)},Ea.prototype.maybeChild=function(t){return this.content.maybeChild(t)},Ea.prototype.forEach=function(t){this.content.forEach(t)},Ea.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},Ea.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},_a.textContent.get=function(){return this.textBetween(0,this.content.size,"")},Ea.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},_a.firstChild.get=function(){return this.content.firstChild},_a.lastChild.get=function(){return this.content.lastChild},Ea.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},Ea.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},Ea.prototype.hasMarkup=function(t,e,n){return this.type==t&&na(this.attrs,e||t.defaultAttrs||Ca)&&ra.sameSet(this.marks,n||ra.none)},Ea.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},Ea.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},Ea.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},Ea.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return ia.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new ia(a,r.depth-i,o.depth-i)},Ea.prototype.replace=function(t,e,n){return ua(this.resolve(t),this.resolve(e),n)},Ea.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},Ea.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},Ea.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},Ea.prototype.resolve=function(t){return ga.resolveCached(this,t)},Ea.prototype.resolveNoCache=function(t){return ga.resolve(this,t)},Ea.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},_a.isBlock.get=function(){return this.type.isBlock},_a.isTextblock.get=function(){return this.type.isTextblock},_a.inlineContent.get=function(){return this.type.inlineContent},_a.isInline.get=function(){return this.type.isInline},_a.isText.get=function(){return this.type.isText},_a.isLeaf.get=function(){return this.type.isLeaf},_a.isAtom.get=function(){return this.type.isAtom},Ea.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),Ta(this.marks,t)},Ea.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},Ea.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=Xs.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,e);if(!s||!s.validEnd)return!1;for(var a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0},Ea.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},Ea.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},Ea.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},Ea.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},Ea.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=Xs.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(Ea.prototype,_a);var Ma=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Ta(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(Ea);function Ta(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var Na=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},Aa={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};Na.parse=function(t,e){var n=new Ia(t,e);if(null==n.next)return Na.empty;var r=Da(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return n(La(t,0));function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];La(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new Na(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(Ba);i.next.push(o[s],e[a.join(",")]||n(a))}return i}}(function(t){var e=[[]];return o(i(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}function i(t,e){if("choice"==t.type)return t.exprs.reduce((function(t,n){return t.concat(i(n,e))}),[]);if("seq"==t.type)for(var s=0;;s++){var a=i(t.exprs[s],e);if(s==t.exprs.length-1)return a;o(a,e=n())}else{if("star"==t.type){var c=n();return r(e,c),o(i(t.expr,c),c),[r(c)]}if("plus"==t.type){var u=n();return o(i(t.expr,e),u),o(i(t.expr,u),u),[r(u)]}if("opt"==t.type)return[r(e)].concat(i(t.expr,e));if("range"==t.type){for(var l=e,f=0;f<t.min;f++){var h=n();o(i(t.expr,l),h),l=h}if(-1==t.max)o(i(t.expr,l),l);else for(var p=t.min;p<t.max;p++){var d=n();r(l,d),o(i(t.expr,l),d),l=d}return[r(l)]}if("name"==t.type)return[r(e,null,t.value)]}}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],u=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(u)&&r.push(u)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},Na.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},Na.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},Aa.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},Aa.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},Na.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},Na.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,s){var a=i.matchFragment(t,n);if(a&&(!e||a.validEnd))return Xs.from(s.map((function(t){return t.createAndFill()})));for(var c=0;c<i.next.length;c+=2){var u=i.next[c],l=i.next[c+1];if(!u.isText&&!u.hasRequiredAttrs()&&-1==r.indexOf(l)){r.push(l);var f=o(l,s.concat(u));if(f)return f}}}(this,[])},Na.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},Na.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},Aa.edgeCount.get=function(){return this.next.length>>1},Na.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},Na.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(Na.prototype,Aa),Na.empty=new Na(!0);var Ia=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},ja={next:{configurable:!0}};function Da(t){var e=[];do{e.push(Ra(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function Ra(t){var e=[];do{e.push(Pa(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function Pa(t){for(var e=function(t){if(t.eat("(")){var e=Da(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=Fa(t,e)}return e}function za(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function Fa(t,e){var n=za(t),r=n;return t.eat(",")&&(r="}"!=t.next?za(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function Ba(t,e){return e-t}function La(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(Ba)}function $a(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function qa(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function Ja(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new Wa(t[n]);return e}ja.next.get=function(){return this.tokens[this.pos]},Ia.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},Ia.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(Ia.prototype,ja);var Ua=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=Ja(n.attrs),this.defaultAttrs=$a(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},Va={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Va.isInline.get=function(){return!this.isBlock},Va.isTextblock.get=function(){return this.isBlock&&this.inlineContent},Va.isLeaf.get=function(){return this.contentMatch==Na.empty},Va.isAtom.get=function(){return this.isLeaf||this.spec.atom},Ua.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},Ua.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},Ua.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:qa(this.attrs,t)},Ua.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Ea(this,this.computeAttrs(t),Xs.from(e),ra.setFrom(n))},Ua.prototype.createChecked=function(t,e,n){if(e=Xs.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new Ea(this,this.computeAttrs(t),e,ra.setFrom(n))},Ua.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=Xs.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e).fillBefore(Xs.empty,!0);return o?new Ea(this,t,e.append(o),ra.setFrom(n)):null},Ua.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},Ua.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},Ua.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},Ua.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:ra.empty:t},Ua.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new Ua(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(Ua.prototype,Va);var Wa=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},Ha={isRequired:{configurable:!0}};Ha.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(Wa.prototype,Ha);var Ka=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=Ja(r.attrs),this.rank=e,this.excluded=null;var o=$a(this.attrs);this.instance=o&&new ra(this,o)};Ka.prototype.create=function(t){return!t&&this.instance?this.instance:new ra(this,qa(this.attrs,t))},Ka.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new Ka(t,r++,e,o)})),n},Ka.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},Ka.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},Ka.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var Ya=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=l.a.from(t.nodes),this.spec.marks=l.a.from(t.marks),this.nodes=Ua.compile(this.spec.nodes,this),this.marks=Ka.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],i=o.spec.content||"",s=o.spec.marks;o.contentMatch=n[i]||(n[i]=Na.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==s?null:s?Ga(this,s.split(" ")):""!=s&&o.inlineContent?null:[]}for(var a in this.marks){var c=this.marks[a],u=c.spec.excludes;c.excluded=null==u?[c]:""==u?[]:Ga(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function Ga(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}Ya.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof Ua))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},Ya.prototype.text=function(t,e){var n=this.nodes.text;return new Ma(n,n.defaultAttrs,t,ra.setFrom(e))},Ya.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},Ya.prototype.nodeFromJSON=function(t){return Ea.fromJSON(this,t)},Ya.prototype.markFromJSON=function(t){return ra.fromJSON(this,t)},Ya.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var Qa=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)})),this.normalizeLists=!this.tags.some((function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)}))};Qa.prototype.parse=function(t,e){void 0===e&&(e={});var n=new rc(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},Qa.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new rc(this,e,!0);return n.addAll(t,null,e.from,e.to),ia.maxOpen(n.finish())},Qa.prototype.matchTag=function(t,e,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(ic(t,o.tag)&&(void 0===o.namespace||t.namespaceURI==o.namespace)&&(!o.context||e.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(t);if(!1===i)continue;o.attrs=i}return o}}},Qa.prototype.matchStyle=function(t,e,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(t)||i.context&&!n.matchesContext(i.context)||i.style.length>t.length&&(61!=i.style.charCodeAt(t.length)||i.style.slice(t.length+1)!=e))){if(i.getAttrs){var s=i.getAttrs(e);if(!1===s)continue;i.attrs=s}return i}}},Qa.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=sc(t)),t.mark=e}))};for(var o in t.marks)r(o);var i=function(e){var r=t.nodes[s].spec.parseDOM;r&&r.forEach((function(t){n(t=sc(t)),t.node=s}))};for(var s in t.nodes)i();return e},Qa.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new Qa(t,Qa.schemaRules(t)))};var Xa={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Za={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},tc={ol:!0,ul:!0};function ec(t){return(t?1:0)|("full"===t?2:0)}var nc=function(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=ra.none,this.pendingMarks=r,this.stashMarks=[]};nc.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(Xs.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},nc.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=Xs.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(Xs.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},nc.prototype.popFromStashMark=function(t){for(var e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]},nc.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):ac(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}};var rc=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,i=ec(e.preserveWhitespace)|(n?4:0);r=o?new nc(o.type,o.attrs,ra.none,ra.none,!0,e.topMatch||o.type.contentMatch,i):new nc(n?null:t.schema.topNodeType,null,ra.none,ra.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},oc={top:{configurable:!0},currentPos:{configurable:!0}};function ic(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function sc(t){var e={};for(var n in t)e[n]=t[n];return e}function ac(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var i=[];return function t(n){i.push(n);for(var r=0;r<n.edgeCount;r++){var o=n.edge(r),s=o.type,a=o.next;if(s==e)return!0;if(i.indexOf(a)<0&&t(a))return!0}}(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}oc.top.get=function(){return this.nodes[this.open]},rc.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},rc.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},rc.prototype.addElement=function(t,e){var n,r=t.nodeName.toLowerCase();tc.hasOwnProperty(r)&&this.parser.normalizeLists&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&tc.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var o=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(n=this.parser.matchTag(t,this,e));if(o?o.ignore:Za.hasOwnProperty(r))this.findInside(t);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(t=o.skip);var i,s=this.top,a=this.needsBlock;if(Xa.hasOwnProperty(r))i=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),i&&this.sync(s),this.needsBlock=a}else this.addElementByRule(t,o,!1===o.consuming?n:null)},rc.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},rc.prototype.readStyles=function(t){var e=ra.none;t:for(var n=0;n<t.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(t[n],t[n+1],this,r);if(!o)continue t;if(o.ignore)return null;if(e=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(e),!1!==o.consuming)break;r=o}return e},rc.prototype.addElementByRule=function(t,e,n){var r,o,i,s=this;e.node?(o=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(o.create(e.attrs))||this.leafFallback(t):r=this.enter(o,e.attrs,e.preserveWhitespace):(i=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(i));var a=this.top;if(o&&o.isLeaf)this.findInside(t);else if(n)this.addElement(t,n);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return s.insertNode(t)}));else{var c=e.contentElement;"string"==typeof c?c=t.querySelector(c):"function"==typeof c&&(c=c(t)),c||(c=t),this.findAround(t,c,!0),this.addAll(c,r)}r&&(this.sync(a),this.open--),i&&this.removePendingMark(i,a)},rc.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&Xa.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},rc.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},rc.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},rc.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},rc.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:ec(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new nc(t,e,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},rc.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},rc.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},rc.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},oc.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},rc.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},rc.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},rc.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},rc.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},rc.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1);return function t(s,a){for(;s>=0;s--){var c=n[s];if(""==c){if(s==n.length-1||0==s)continue;for(;a>=i;a--)if(t(s-1,a))return!0;return!1}var u=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!u||u.name!=c&&-1==u.groups.indexOf(c))return!1;a--}return!0}(n.length-1,this.open)},rc.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},rc.prototype.addPendingMark=function(t){var e=function(t,e){for(var n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},rc.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(t)>-1)r.pendingMarks=t.removeFromSet(r.pendingMarks);else{r.activeMarks=t.removeFromSet(r.activeMarks);var o=r.popFromStashMark(t);o&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==e)break}},Object.defineProperties(rc.prototype,oc);var cc=function(t,e){this.nodes=t||{},this.marks=e||{}};function uc(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function lc(t){return t.document||window.document}cc.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=lc(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],u=r.serializeMark(c,t.isInline,e);u&&(i.push(c,o),o.appendChild(u.dom),o=u.contentDOM||u.dom)}}o.appendChild(r.serializeNode(t,e))})),n},cc.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=cc.renderSpec(lc(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},cc.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},cc.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&cc.renderSpec(lc(n),r(t,e))},cc.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var u in c=2,a)if(null!=a[u]){var l=u.indexOf(" ");l>0?s.setAttributeNS(u.slice(0,l),u.slice(l+1),a[u]):s.setAttribute(u,a[u])}for(var f=c;f<e.length;f++){var h=e[f];if(0===h){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var p=cc.renderSpec(t,h,n),d=p.dom,v=p.contentDOM;if(s.appendChild(d),v){if(i)throw new RangeError("Multiple content holes");i=v}}return{dom:s,contentDOM:i}},cc.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new cc(this.nodesFromSchema(t),this.marksFromSchema(t)))},cc.nodesFromSchema=function(t){var e=uc(t.nodes);return e.text||(e.text=function(t){return t.text}),e},cc.marksFromSchema=function(t){return uc(t.marks)};var fc=Object.create(null),hc=function(t,e,n){this.ranges=n||[new dc(t.min(e),t.max(e))],this.$anchor=t,this.$head=e},pc={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};pc.anchor.get=function(){return this.$anchor.pos},pc.head.get=function(){return this.$head.pos},pc.from.get=function(){return this.$from.pos},pc.to.get=function(){return this.$to.pos},pc.$from.get=function(){return this.ranges[0].$from},pc.$to.get=function(){return this.ranges[0].$to},pc.empty.get=function(){for(var t=this.ranges,e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0},hc.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},hc.prototype.replace=function(t,e){void 0===e&&(e=ia.empty);for(var n=e.content.lastChild,r=null,o=0;o<e.openEnd;o++)r=n,n=n.lastChild;for(var i=t.steps.length,s=this.ranges,a=0;a<s.length;a++){var c=s[a],u=c.$from,l=c.$to,f=t.mapping.slice(i);t.replaceRange(f.map(u.pos),f.map(l.pos),a?ia.empty:e),0==a&&xc(t,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}},hc.prototype.replaceWith=function(t,e){for(var n=t.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],s=i.$from,a=i.$to,c=t.mapping.slice(n),u=c.map(s.pos),l=c.map(a.pos);o?t.deleteRange(u,l):(t.replaceRangeWith(u,l,e),xc(t,n,e.isInline?-1:1))}},hc.findFrom=function(t,e,n){var r=t.parent.inlineContent?new vc(t):kc(t.node(0),t.parent,t.pos,t.index(),e,n);if(r)return r;for(var o=t.depth-1;o>=0;o--){var i=e<0?kc(t.node(0),t.node(o),t.before(o+1),t.index(o),e,n):kc(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,e,n);if(i)return i}},hc.near=function(t,e){return void 0===e&&(e=1),this.findFrom(t,e)||this.findFrom(t,-e)||new bc(t.node(0))},hc.atStart=function(t){return kc(t,t,0,0,1)||new bc(t)},hc.atEnd=function(t){return kc(t,t,t.content.size,t.childCount,-1)||new bc(t)},hc.fromJSON=function(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=fc[e.type];if(!n)throw new RangeError("No selection type "+e.type+" defined");return n.fromJSON(t,e)},hc.jsonID=function(t,e){if(t in fc)throw new RangeError("Duplicate use of selection JSON ID "+t);return fc[t]=e,e.prototype.jsonID=t,e},hc.prototype.getBookmark=function(){return vc.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(hc.prototype,pc),hc.prototype.visible=!0;var dc=function(t,e){this.$from=t,this.$to=e},vc=function(t){function e(e,n){void 0===n&&(n=e),t.call(this,e,n)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},e.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));if(!o.parent.inlineContent)return t.near(o);var i=n.resolve(r.map(this.anchor));return new e(i.parent.inlineContent?i:o,o)},e.prototype.replace=function(e,n){if(void 0===n&&(n=ia.empty),t.prototype.replace.call(this,e,n),n==ia.empty){var r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head},e.prototype.getBookmark=function(){return new yc(this.anchor,this.head)},e.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(n.anchor),t.resolve(n.head))},e.create=function(t,e,n){void 0===n&&(n=e);var r=t.resolve(e);return new this(r,n==e?r:t.resolve(n))},e.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=i>=0?1:-1),!r.parent.inlineContent){var s=t.findFrom(r,o,!0)||t.findFrom(r,-o,!0);if(!s)return t.near(r,o);r=s.$head}return n.parent.inlineContent||(0==i||(n=(t.findFrom(n,-o,!0)||t.findFrom(n,o,!0)).$anchor).pos<r.pos!=i<0)&&(n=r),new e(n,r)},Object.defineProperties(e.prototype,n),e}(hc);hc.jsonID("text",vc);var yc=function(t,e){this.anchor=t,this.head=e};yc.prototype.map=function(t){return new yc(t.map(this.anchor),t.map(this.head))},yc.prototype.resolve=function(t){return vc.between(t.resolve(this.anchor),t.resolve(this.head))};var mc=function(t){function e(e){var n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);t.call(this,e,r),this.node=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(n,r){var o=r.mapResult(this.anchor),i=o.deleted,s=o.pos,a=n.resolve(s);return i?t.near(a):new e(a)},e.prototype.content=function(){return new ia(Xs.from(this.node),0,0)},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor},e.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},e.prototype.getBookmark=function(){return new gc(this.anchor)},e.fromJSON=function(t,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(n.anchor))},e.create=function(t,e){return new this(t.resolve(e))},e.isSelectable=function(t){return!t.isText&&!1!==t.type.spec.selectable},e}(hc);mc.prototype.visible=!1,hc.jsonID("node",mc);var gc=function(t){this.anchor=t};gc.prototype.map=function(t){var e=t.mapResult(this.anchor),n=e.deleted,r=e.pos;return n?new yc(r,r):new gc(r)},gc.prototype.resolve=function(t){var e=t.resolve(this.anchor),n=e.nodeAfter;return n&&mc.isSelectable(n)?new mc(e):hc.near(e)};var bc=function(t){function e(e){t.call(this,e.resolve(0),e.resolve(e.content.size))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.replace=function(e,n){if(void 0===n&&(n=ia.empty),n==ia.empty){e.delete(0,e.doc.content.size);var r=t.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else t.prototype.replace.call(this,e,n)},e.prototype.toJSON=function(){return{type:"all"}},e.fromJSON=function(t){return new e(t)},e.prototype.map=function(t){return new e(t)},e.prototype.eq=function(t){return t instanceof e},e.prototype.getBookmark=function(){return wc},e}(hc);hc.jsonID("all",bc);var wc={map:function(){return this},resolve:function(t){return new bc(t)}};function kc(t,e,n,r,o,i){if(e.inlineContent)return vc.create(t,n);for(var s=r-(o>0?0:1);o>0?s<e.childCount:s>=0;s+=o){var a=e.child(s);if(a.isAtom){if(!i&&mc.isSelectable(a))return mc.create(t,n-(o<0?a.nodeSize:0))}else{var c=kc(t,a,n+o,o<0?a.childCount:0,o,i);if(c)return c}n+=a.nodeSize*o}}function xc(t,e,n){var r=t.steps.length-1;if(!(r<e)){var o,i=t.steps[r];if(i instanceof u.c||i instanceof u.b)t.mapping.maps[r].forEach((function(t,e,n,r){null==o&&(o=r)})),t.setSelection(hc.near(t.doc.resolve(o),n))}}var Sc=function(t){function e(e){t.call(this,e.doc),this.time=Date.now(),this.curSelection=e.selection,this.curSelectionFor=0,this.storedMarks=e.storedMarks,this.updated=0,this.meta=Object.create(null)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},e.prototype.setSelection=function(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return(1&this.updated)>0},e.prototype.setStoredMarks=function(t){return this.storedMarks=t,this.updated|=2,this},e.prototype.ensureMarks=function(t){return ra.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this},e.prototype.addStoredMark=function(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))},e.prototype.removeStoredMark=function(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(2&this.updated)>0},e.prototype.addStep=function(e,n){t.prototype.addStep.call(this,e,n),this.updated=-3&this.updated,this.storedMarks=null},e.prototype.setTime=function(t){return this.time=t,this},e.prototype.replaceSelection=function(t){return this.selection.replace(this,t),this},e.prototype.replaceSelectionWith=function(t,e){var n=this.selection;return!1!==e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||ra.none))),n.replaceWith(this,t),this},e.prototype.deleteSelection=function(){return this.selection.replace(this),this},e.prototype.insertText=function(t,e,n){void 0===n&&(n=e);var r=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();if(!t)return this.deleteRange(e,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(e);o=n==e?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(e,n,r.text(t,o)),this.selection.empty||this.setSelection(hc.near(this.selection.$to)),this},e.prototype.setMeta=function(t,e){return this.meta["string"==typeof t?t:t.key]=e,this},e.prototype.getMeta=function(t){return this.meta["string"==typeof t?t:t.key]},n.isGeneric.get=function(){for(var t in this.meta)return!1;return!0},e.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(e.prototype,n),e}(u.d);function Oc(t,e){return e&&t?t.bind(e):t}var Cc=function(t,e,n){this.name=t,this.init=Oc(e.init,n),this.apply=Oc(e.apply,n)},Ec=[new Cc("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new Cc("selection",{init:function(t,e){return t.selection||hc.atStart(e.doc)},apply:function(t){return t.selection}}),new Cc("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Cc("scrollToSelection",{init:function(){return 0},apply:function(t,e){return t.scrolledIntoView?e+1:e}})],_c=function(t,e){var n=this;this.schema=t,this.fields=Ec.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),e&&e.forEach((function(t){if(n.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");n.plugins.push(t),n.pluginsByKey[t.key]=t,t.spec.state&&n.fields.push(new Cc(t.key,t.spec.state,t))}))},Mc=function(t){this.config=t},Tc={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};Tc.schema.get=function(){return this.config.schema},Tc.plugins.get=function(){return this.config.plugins},Mc.prototype.apply=function(t){return this.applyTransaction(t).state},Mc.prototype.filterTransaction=function(t,e){void 0===e&&(e=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=e){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,t,this))return!1}return!0},Mc.prototype.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var e=[t],n=this.applyInner(t),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var s=this.config.plugins[i];if(s.spec.appendTransaction){var a=r?r[i].n:0,c=r?r[i].state:this,u=a<e.length&&s.spec.appendTransaction.call(s,a?e.slice(a):e,c,n);if(u&&n.filterTransaction(u,i)){if(u.setMeta("appendedTransaction",t),!r){r=[];for(var l=0;l<this.config.plugins.length;l++)r.push(l<i?{state:n,n:e.length}:{state:this,n:0})}e.push(u),n=n.applyInner(u),o=!0}r&&(r[i]={state:n,n:e.length})}}if(!o)return{state:n,transactions:e}}},Mc.prototype.applyInner=function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var e=new Mc(this.config),n=this.config.fields,r=0;r<n.length;r++){var o=n[r];e[o.name]=o.apply(t,this[o.name],this,e)}for(var i=0;i<Nc.length;i++)Nc[i](this,t,e);return e},Tc.tr.get=function(){return new Sc(this)},Mc.create=function(t){for(var e=new _c(t.schema||t.doc.type.schema,t.plugins),n=new Mc(e),r=0;r<e.fields.length;r++)n[e.fields[r].name]=e.fields[r].init(t,n);return n},Mc.prototype.reconfigure=function(t){for(var e=new _c(t.schema||this.schema,t.plugins),n=e.fields,r=new Mc(e),o=0;o<n.length;o++){var i=n[o].name;r[i]=this.hasOwnProperty(i)?this[i]:n[o].init(t,r)}return r},Mc.prototype.toJSON=function(t){var e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map((function(t){return t.toJSON()}))),t&&"object"==typeof t)for(var n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=t[n],o=r.spec.state;o&&o.toJSON&&(e[n]=o.toJSON.call(r,this[r.key]))}return e},Mc.fromJSON=function(t,e,n){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var r=new _c(t.schema,t.plugins),o=new Mc(r);return r.fields.forEach((function(r){if("doc"==r.name)o.doc=Ea.fromJSON(t.schema,e.doc);else if("selection"==r.name)o.selection=hc.fromJSON(o.doc,e.selection);else if("storedMarks"==r.name)e.storedMarks&&(o.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(n)for(var i in n){var s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(e,i))return void(o[r.name]=a.fromJSON.call(s,t,e[i],o))}o[r.name]=r.init(t,o)}})),o},Mc.addApplyListener=function(t){Nc.push(t)},Mc.removeApplyListener=function(t){var e=Nc.indexOf(t);e>-1&&Nc.splice(e,1)},Object.defineProperties(Mc.prototype,Tc);var Nc=[];function Ac(t,e,n){for(var r in t){var o=t[r];o instanceof Function?o=o.bind(e):"handleDOMEvents"==r&&(o=Ac(o,e,{})),n[r]=o}return n}var Ic=function(t){this.props={},t.props&&Ac(t.props,this,this.props),this.spec=t,this.key=t.key?t.key.key:Dc("plugin")};Ic.prototype.getState=function(t){return t[this.key]};var jc=Object.create(null);function Dc(t){return t in jc?t+"$"+ ++jc[t]:(jc[t]=0,t+"$")}var Rc=function(t){void 0===t&&(t="key"),this.key=Dc(t)};Rc.prototype.get=function(t){return t.config.pluginsByKey[this.key]},Rc.prototype.getState=function(t){return t[this.key]};var Pc={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var zc=/Edge\/(\d+)/.exec(navigator.userAgent),Fc=/MSIE \d/.test(navigator.userAgent),Bc=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);Pc.mac=/Mac/.test(navigator.platform);var Lc=Pc.ie=!!(Fc||Bc||zc);Pc.ie_version=Fc?document.documentMode||6:Bc?+Bc[1]:zc?+zc[1]:null,Pc.gecko=!Lc&&/gecko\/(\d+)/i.test(navigator.userAgent),Pc.gecko_version=Pc.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var $c=!Lc&&/Chrome\/(\d+)/.exec(navigator.userAgent);Pc.chrome=!!$c,Pc.chrome_version=$c&&+$c[1],Pc.ios=!Lc&&/AppleWebKit/.test(navigator.userAgent)&&(/Mobile\/\w+/.test(navigator.userAgent)||!!(navigator.maxTouchPoints&&navigator.maxTouchPoints>2)),Pc.android=/Android \d/.test(navigator.userAgent),Pc.webkit="webkitFontSmoothing"in document.documentElement.style,Pc.safari=/Apple Computer/.test(navigator.vendor),Pc.webkit_version=Pc.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var qc=function(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e},Jc=function(t){var e=t.parentNode;return e&&11==e.nodeType?e.host:e},Uc=null,Vc=function(t,e,n){var r=Uc||(Uc=document.createRange());return r.setEnd(t,null==n?t.nodeValue.length:n),r.setStart(t,e||0),r},Wc=function(t,e,n,r){return n&&(Kc(t,e,n,r,-1)||Kc(t,e,n,r,1))},Hc=/^(img|br|input|textarea|hr)$/i;function Kc(t,e,n,r,o){for(;;){if(t==n&&e==r)return!0;if(e==(o<0?0:Yc(t))){var i=t.parentNode;if(1!=i.nodeType||Gc(t)||Hc.test(t.nodeName)||"false"==t.contentEditable)return!1;e=qc(t)+(o<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if("false"==(t=t.childNodes[e+(o<0?-1:0)]).contentEditable)return!1;e=o<0?Yc(t):0}}}function Yc(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function Gc(t){for(var e,n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}var Qc=function(t){var e=t.isCollapsed;return e&&Pc.chrome&&t.rangeCount&&!t.getRangeAt(0).collapsed&&(e=!1),e};function Xc(t,e){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function Zc(t){return{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function tu(t,e){return"number"==typeof t?t:t[e]}function eu(t){var e=t.getBoundingClientRect();return{left:e.left,right:e.left+t.clientWidth,top:e.top,bottom:e.top+t.clientHeight}}function nu(t,e,n){for(var r=t.someProp("scrollThreshold")||0,o=t.someProp("scrollMargin")||5,i=t.dom.ownerDocument,s=n||t.dom;s;s=Jc(s))if(1==s.nodeType){var a=s==i.body||1!=s.nodeType,c=a?Zc(i):eu(s),u=0,l=0;if(e.top<c.top+tu(r,"top")?l=-(c.top-e.top+tu(o,"top")):e.bottom>c.bottom-tu(r,"bottom")&&(l=e.bottom-c.bottom+tu(o,"bottom")),e.left<c.left+tu(r,"left")?u=-(c.left-e.left+tu(o,"left")):e.right>c.right-tu(r,"right")&&(u=e.right-c.right+tu(o,"right")),u||l)if(a)i.defaultView.scrollBy(u,l);else{var f=s.scrollLeft,h=s.scrollTop;l&&(s.scrollTop+=l),u&&(s.scrollLeft+=u);var p=s.scrollLeft-f,d=s.scrollTop-h;e={left:e.left-p,top:e.top-d,right:e.right-p,bottom:e.bottom-d}}if(a)break}}function ru(t){for(var e=[],n=t.ownerDocument;t&&(e.push({dom:t,top:t.scrollTop,left:t.scrollLeft}),t!=n);t=Jc(t));return e}function ou(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=r.dom,i=r.top,s=r.left;o.scrollTop!=i+e&&(o.scrollTop=i+e),o.scrollLeft!=s&&(o.scrollLeft=s)}}var iu=null;function su(t,e){for(var n,r,o=2e8,i=0,s=e.top,a=e.top,c=t.firstChild,u=0;c;c=c.nextSibling,u++){var l=void 0;if(1==c.nodeType)l=c.getClientRects();else{if(3!=c.nodeType)continue;l=Vc(c).getClientRects()}for(var f=0;f<l.length;f++){var h=l[f];if(h.top<=s&&h.bottom>=a){s=Math.max(h.bottom,s),a=Math.min(h.top,a);var p=h.left>e.left?h.left-e.left:h.right<e.left?e.left-h.right:0;if(p<o){n=c,o=p,r=p&&3==n.nodeType?{left:h.right<e.left?h.right:h.left,top:e.top}:e,1==c.nodeType&&p&&(i=u+(e.left>=(h.left+h.right)/2?1:0));continue}}!n&&(e.left>=h.right&&e.top>=h.top||e.left>=h.left&&e.top>=h.bottom)&&(i=u+1)}}return n&&3==n.nodeType?function(t,e){for(var n=t.nodeValue.length,r=document.createRange(),o=0;o<n;o++){r.setEnd(t,o+1),r.setStart(t,o);var i=lu(r,1);if(i.top!=i.bottom&&au(e,i))return{node:t,offset:o+(e.left>=(i.left+i.right)/2?1:0)}}return{node:t,offset:0}}(n,r):!n||o&&1==n.nodeType?{node:t,offset:i}:su(n,r)}function au(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function cu(t,e,n){var r=t.childNodes.length;if(r&&n.top<n.bottom)for(var o=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),i=o;;){var s=t.childNodes[i];if(1==s.nodeType)for(var a=s.getClientRects(),c=0;c<a.length;c++){var u=a[c];if(au(e,u))return cu(s,e,u)}if((i=(i+1)%r)==o)break}return t}function uu(t,e){var n,r,o,i,s=t.root;if(s.caretPositionFromPoint)try{var a=s.caretPositionFromPoint(e.left,e.top);a&&(o=(n=a).offsetNode,i=n.offset)}catch(v){}if(!o&&s.caretRangeFromPoint){var c=s.caretRangeFromPoint(e.left,e.top);c&&(o=(r=c).startContainer,i=r.startOffset)}var u,l=s.elementFromPoint(e.left,e.top+1);if(!l||!t.dom.contains(1!=l.nodeType?l.parentNode:l)){var f=t.dom.getBoundingClientRect();if(!au(e,f))return null;if(!(l=cu(t.dom,e,f)))return null}if(Pc.safari&&l.draggable&&(o=i=null),l=function(t,e){var n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}(l,e),o){if(Pc.gecko&&1==o.nodeType&&(i=Math.min(i,o.childNodes.length))<o.childNodes.length){var h,p=o.childNodes[i];"IMG"==p.nodeName&&(h=p.getBoundingClientRect()).right<=e.left&&h.bottom>e.top&&i++}o==t.dom&&i==o.childNodes.length-1&&1==o.lastChild.nodeType&&e.top>o.lastChild.getBoundingClientRect().bottom?u=t.state.doc.content.size:0!=i&&1==o.nodeType&&"BR"==o.childNodes[i-1].nodeName||(u=function(t,e,n,r){for(var o=-1,i=e;i!=t.dom;){var s=t.docView.nearestDesc(i,!0);if(!s)return null;if(s.node.isBlock&&s.parent){var a=s.dom.getBoundingClientRect();if(a.left>r.left||a.top>r.top)o=s.posBefore;else{if(!(a.right<r.left||a.bottom<r.top))break;o=s.posAfter}}i=s.dom.parentNode}return o>-1?o:t.docView.posFromDOM(e,n)}(t,o,i,e))}null==u&&(u=function(t,e,n){var r=su(e,n),o=r.node,i=r.offset,s=-1;if(1==o.nodeType&&!o.firstChild){var a=o.getBoundingClientRect();s=a.left!=a.right&&n.left>(a.left+a.right)/2?1:-1}return t.docView.posFromDOM(o,i,s)}(t,l,e));var d=t.docView.nearestDesc(l,!0);return{pos:u,inside:d?d.posAtStart-d.border:-1}}function lu(t,e){var n=t.getClientRects();return n.length?n[e<0?0:n.length-1]:t.getBoundingClientRect()}var fu=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function hu(t,e,n){var r=t.docView.domFromPos(e),o=r.node,i=r.offset,s=t.state.doc.resolve(e),a=s.parent.inlineContent,c=Pc.webkit||Pc.gecko;if(3==o.nodeType&&c&&fu.test(o.nodeValue)){var u=lu(Vc(o,i,i),n);if(Pc.gecko&&i&&/\s/.test(o.nodeValue[i-1])&&i<o.nodeValue.length){var l=lu(Vc(o,i-1,i-1),-1);if(l.top==u.top){var f=lu(Vc(o,i,i+1),-1);if(f.top!=u.top)return pu(f,f.left<l.left)}}return u}if(a){for(var h=s.depth?t.docView.domAfterPos(s.before()):t.dom;n<0&&!i&&o!=h;)i=qc(o),o=o.parentNode;for(;n>=0&&i==Yc(o)&&o!=h;)i=qc(o)+1,o=o.parentNode}if(3==o.nodeType)return n<0?pu(lu(Vc(o,i-1,i),1),!1):pu(lu(Vc(o,i,i+1),-1),!0);if(!a){if(i&&(n<0||i==Yc(o))){var p=o.childNodes[i-1];if(1==p.nodeType)return du(p.getBoundingClientRect(),!1)}if(i<Yc(o)){var d=o.childNodes[i];if(1==d.nodeType)return du(d.getBoundingClientRect(),!0)}return du(o.getBoundingClientRect(),n>=0)}if(i&&(n<0||i==Yc(o))){var v=o.childNodes[i-1],y=3==v.nodeType?Vc(v,Yc(v)-(c?0:1)):1==v.nodeType&&"BR"!=v.nodeName?v:null;if(y)return pu(lu(y,1),!1)}if(i<Yc(o)){var m=o.childNodes[i],g=3==m.nodeType?Vc(m,0,c?0:1):1==m.nodeType?m:null;if(g)return pu(lu(g,-1),!0)}return pu(lu(3==o.nodeType?Vc(o):o,-n),n>=0)}function pu(t,e){if(0==t.width)return t;var n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function du(t,e){if(0==t.height)return t;var n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function vu(t,e,n){var r=t.state,o=t.root.activeElement;r!=e&&t.updateState(e),o!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),o!=t.dom&&o&&o.focus()}}var yu=/[\u0590-\u08ac]/;var mu=null,gu=null,bu=!1;function wu(t,e,n){return mu==e&&gu==n?bu:(mu=e,gu=n,bu="up"==n||"down"==n?function(t,e,n){var r=e.selection,o="up"==n?r.$anchor.min(r.$head):r.$anchor.max(r.$head);return vu(t,e,(function(){for(var e=t.docView.domFromPos(o.pos).node;;){var r=t.docView.nearestDesc(e,!0);if(!r)break;if(r.node.isBlock){e=r.dom;break}e=r.dom.parentNode}for(var i=hu(t,o.pos,1),s=e.firstChild;s;s=s.nextSibling){var a=void 0;if(1==s.nodeType)a=s.getClientRects();else{if(3!=s.nodeType)continue;a=Vc(s,0,s.nodeValue.length).getClientRects()}for(var c=0;c<a.length;c++){var u=a[c];if(u.bottom>u.top&&("up"==n?u.bottom<i.top+1:u.top>i.bottom-1))return!1}}return!0}))}(t,e,n):function(t,e,n){var r=e.selection.$head;if(!r.parent.isTextblock)return!1;var o=r.parentOffset,i=!o,s=o==r.parent.content.size,a=getSelection();return yu.test(r.parent.textContent)&&a.modify?vu(t,e,(function(){var e=a.getRangeAt(0),o=a.focusNode,i=a.focusOffset,s=a.caretBidiLevel;a.modify("move",n,"character");var c=!(r.depth?t.docView.domAfterPos(r.before()):t.dom).contains(1==a.focusNode.nodeType?a.focusNode:a.focusNode.parentNode)||o==a.focusNode&&i==a.focusOffset;return a.removeAllRanges(),a.addRange(e),null!=s&&(a.caretBidiLevel=s),c})):"left"==n||"backward"==n?i:s}(t,e,n))}var ku=function(t,e,n,r){this.parent=t,this.children=e,this.dom=n,n.pmViewDesc=this,this.contentDOM=r,this.dirty=0},xu={beforePosition:{configurable:!0},size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0}};ku.prototype.matchesWidget=function(){return!1},ku.prototype.matchesMark=function(){return!1},ku.prototype.matchesNode=function(){return!1},ku.prototype.matchesHack=function(){return!1},xu.beforePosition.get=function(){return!1},ku.prototype.parseRule=function(){return null},ku.prototype.stopEvent=function(){return!1},xu.size.get=function(){for(var t=0,e=0;e<this.children.length;e++)t+=this.children[e].size;return t},xu.border.get=function(){return 0},ku.prototype.destroy=function(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var t=0;t<this.children.length;t++)this.children[t].destroy()},ku.prototype.posBeforeChild=function(t){for(var e=0,n=this.posAtStart;e<this.children.length;e++){var r=this.children[e];if(r==t)return n;n+=r.size}},xu.posBefore.get=function(){return this.parent.posBeforeChild(this)},xu.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},xu.posAfter.get=function(){return this.posBefore+this.size},xu.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},ku.prototype.localPosFromDOM=function(t,e,n){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(n<0){var r,o;if(t==this.contentDOM)r=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.previousSibling}for(;r&&(!(o=r.pmViewDesc)||o.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(o)+o.size:this.posAtStart}var i,s;if(t==this.contentDOM)i=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;i=t.nextSibling}for(;i&&(!(s=i.pmViewDesc)||s.parent!=this);)i=i.nextSibling;return i?this.posBeforeChild(s):this.posAtEnd}var a;if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))a=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(var c=t;;c=c.parentNode){if(c==this.dom){a=!1;break}if(c.parentNode.firstChild!=c)break}if(null==a&&e==t.childNodes.length)for(var u=t;;u=u.parentNode){if(u==this.dom){a=!0;break}if(u.parentNode.lastChild!=u)break}}return(null==a?n>0:a)?this.posAtEnd:this.posAtStart},ku.prototype.nearestDesc=function(t,e){for(var n=!0,r=t;r;r=r.parentNode){var o=this.getDesc(r);if(o&&(!e||o.node)){if(!n||!o.nodeDOM||(1==o.nodeDOM.nodeType?o.nodeDOM.contains(1==t.nodeType?t:t.parentNode):o.nodeDOM==t))return o;n=!1}}},ku.prototype.getDesc=function(t){for(var e=t.pmViewDesc,n=e;n;n=n.parent)if(n==this)return e},ku.prototype.posFromDOM=function(t,e,n){for(var r=t;r;r=r.parentNode){var o=this.getDesc(r);if(o)return o.localPosFromDOM(t,e,n)}return-1},ku.prototype.descAt=function(t){for(var e=0,n=0;e<this.children.length;e++){var r=this.children[e],o=n+r.size;if(n==t&&o!=n){for(;!r.border&&r.children.length;)r=r.children[0];return r}if(t<o)return r.descAt(t-n-r.border);n=o}},ku.prototype.domFromPos=function(t){if(!this.contentDOM)return{node:this.dom,offset:0};for(var e=0,n=0;;n++){if(e==t){for(;n<this.children.length&&(this.children[n].beforePosition||this.children[n].dom.parentNode!=this.contentDOM);)n++;return{node:this.contentDOM,offset:n==this.children.length?this.contentDOM.childNodes.length:qc(this.children[n].dom)}}if(n==this.children.length)throw new Error("Invalid position "+t);var r=this.children[n],o=e+r.size;if(t<o)return r.domFromPos(t-e-r.border);e=o}},ku.prototype.parseRange=function(t,e,n){if(void 0===n&&(n=0),0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var r=-1,o=-1,i=n,s=0;;s++){var a=this.children[s],c=i+a.size;if(-1==r&&t<=c){var u=i+a.border;if(t>=u&&e<=c-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(t,e,u);t=i;for(var l=s;l>0;l--){var f=this.children[l-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){r=qc(f.dom)+1;break}t-=f.size}-1==r&&(r=0)}if(r>-1&&(c>e||s==this.children.length-1)){e=c;for(var h=s+1;h<this.children.length;h++){var p=this.children[h];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(-1)){o=qc(p.dom);break}e+=p.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=c}return{node:this.contentDOM,from:t,to:e,fromOffset:r,toOffset:o}},ku.prototype.emptyChildAt=function(t){if(this.border||!this.contentDOM||!this.children.length)return!1;var e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)},ku.prototype.domAfterPos=function(t){var e=this.domFromPos(t),n=e.node,r=e.offset;if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+t);return n.childNodes[r]},ku.prototype.setSelection=function(t,e,n,r){for(var o=Math.min(t,e),i=Math.max(t,e),s=0,a=0;s<this.children.length;s++){var c=this.children[s],u=a+c.size;if(o>a&&i<u)return c.setSelection(t-a-c.border,e-a-c.border,n,r);a=u}var l=this.domFromPos(t),f=this.domFromPos(e),h=n.getSelection(),p=!1;if((Pc.gecko||Pc.safari)&&t==e)if(3==l.node.nodeType)p=l.offset&&"\n"==l.node.nodeValue[l.offset-1];else{var d=l.node.childNodes[l.offset-1];p=d&&("BR"==d.nodeName||"false"==d.contentEditable)}if(r||p&&Pc.safari||!Wc(l.node,l.offset,h.anchorNode,h.anchorOffset)||!Wc(f.node,f.offset,h.focusNode,h.focusOffset)){var v=!1;if((h.extend||t==e)&&!p){h.collapse(l.node,l.offset);try{t!=e&&h.extend(f.node,f.offset),v=!0}catch(g){if(!(g instanceof DOMException))throw g}}if(!v){if(t>e){var y=l;l=f,f=y}var m=document.createRange();m.setEnd(f.node,f.offset),m.setStart(l.node,l.offset),h.removeAllRanges(),h.addRange(m)}}},ku.prototype.ignoreMutation=function(t){return!this.contentDOM&&"selection"!=t.type},xu.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},ku.prototype.markDirty=function(t,e){for(var n=0,r=0;r<this.children.length;r++){var o=this.children[r],i=n+o.size;if(n==i?t<=i&&e>=n:t<i&&e>n){var s=n+o.border,a=i-o.border;if(t>=s&&e<=a)return this.dirty=t==n||e==i?2:1,void(t!=s||e!=a||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(t-s,e-s):o.dirty=3);o.dirty=3}n=i}this.dirty=2},ku.prototype.markParentsDirty=function(){for(var t=1,e=this.parent;e;e=e.parent,t++){var n=1==t?2:1;e.dirty<n&&(e.dirty=n)}},Object.defineProperties(ku.prototype,xu);var Su=[],Ou=function(t){function e(e,n,r,o){var i,s=n.type.toDOM;if("function"==typeof s&&(s=s(r,(function(){return i?i.parent?i.parent.posBeforeChild(i):void 0:o}))),!n.type.spec.raw){if(1!=s.nodeType){var a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable=!1,s.classList.add("ProseMirror-widget")}t.call(this,e,Su,s,null),this.widget=n,i=this}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={beforePosition:{configurable:!0}};return n.beforePosition.get=function(){return this.widget.type.side<0},e.prototype.matchesWidget=function(t){return 0==this.dirty&&t.type.eq(this.widget.type)},e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.stopEvent=function(t){var e=this.widget.spec.stopEvent;return!!e&&e(t)},e.prototype.ignoreMutation=function(t){return"selection"!=t.type||this.widget.spec.ignoreSelection},Object.defineProperties(e.prototype,n),e}(ku),Cu=function(t){function e(e,n,r,o){t.call(this,e,Su,n,null),this.textDOM=r,this.text=o}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0}};return n.size.get=function(){return this.text.length},e.prototype.localPosFromDOM=function(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e},e.prototype.domFromPos=function(t){return{node:this.textDOM,offset:t}},e.prototype.ignoreMutation=function(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue},Object.defineProperties(e.prototype,n),e}(ku),Eu=function(t){function e(e,n,r,o){t.call(this,e,[],r,o),this.mark=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.create=function(t,n,r,o){var i=o.nodeViews[n.type.name],s=i&&i(n,o,r);return s&&s.dom||(s=cc.renderSpec(document,n.type.spec.toDOM(n,r))),new e(t,n,s.dom,s.contentDOM||s.dom)},e.prototype.parseRule=function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},e.prototype.matchesMark=function(t){return 3!=this.dirty&&this.mark.eq(t)},e.prototype.markDirty=function(e,n){if(t.prototype.markDirty.call(this,e,n),0!=this.dirty){for(var r=this.parent;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}},e.prototype.slice=function(t,n,r){var o=e.create(this.parent,this.mark,!0,r),i=this.children,s=this.size;n<s&&(i=Ju(i,n,s,r)),t>0&&(i=Ju(i,0,t,r));for(var a=0;a<i.length;a++)i[a].parent=o;return o.children=i,o},e}(ku),_u=function(t){function e(e,n,r,o,i,s,a,c,u){t.call(this,e,n.isLeaf?Su:[],i,s),this.nodeDOM=a,this.node=n,this.outerDeco=r,this.innerDeco=o,s&&this.updateChildren(c,u)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0},border:{configurable:!0}};return e.create=function(t,n,r,o,i,s){var a,c,u=i.nodeViews[n.type.name],l=u&&u(n,i,(function(){return c?c.parent?c.parent.posBeforeChild(c):void 0:s}),r),f=l&&l.dom,h=l&&l.contentDOM;if(n.isText)if(f){if(3!=f.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else f=document.createTextNode(n.text);else f||(f=(a=cc.renderSpec(document,n.type.spec.toDOM(n))).dom,h=a.contentDOM);h||n.isText||"BR"==f.nodeName||(f.hasAttribute("contenteditable")||(f.contentEditable=!1),n.type.spec.draggable&&(f.draggable=!0));var p=f;return f=Fu(f,r,n),l?c=new Au(t,n,r,o,f,h,p,l,i,s+1):n.isText?new Tu(t,n,r,o,f,p,i):new e(t,n,r,o,f,h,p,i,s+1)},e.prototype.parseRule=function(){var t=this;if(this.node.type.spec.reparseInView)return null;var e={node:this.node.type.name,attrs:this.node.attrs};return this.node.type.spec.code&&(e.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?e.contentElement=this.contentDOM:e.getContent=function(){return t.contentDOM?Xs.empty:t.node.content},e},e.prototype.matchesNode=function(t,e,n){return 0==this.dirty&&t.eq(this.node)&&Bu(e,this.outerDeco)&&n.eq(this.innerDeco)},n.size.get=function(){return this.node.nodeSize},n.border.get=function(){return this.node.isLeaf?0:1},e.prototype.updateChildren=function(t,e){var n=this,r=this.node.inlineContent,o=e,i=r&&t.composing&&this.localCompositionNode(t,e),s=new $u(this,i&&i.node);!function(t,e,n,r){var o=e.locals(t),i=0;if(0==o.length){for(var s=0;s<t.childCount;s++){var a=t.child(s);r(a,o,e.forChild(i,a),s),i+=a.nodeSize}return}for(var c=0,u=[],l=null,f=0;;){if(c<o.length&&o[c].to==i){for(var h=o[c++],p=void 0;c<o.length&&o[c].to==i;)(p||(p=[h])).push(o[c++]);if(p){p.sort(qu);for(var d=0;d<p.length;d++)n(p[d],f,!!l)}else n(h,f,!!l)}var v=void 0,y=void 0;if(l)y=-1,v=l,l=null;else{if(!(f<t.childCount))break;y=f,v=t.child(f++)}for(var m=0;m<u.length;m++)u[m].to<=i&&u.splice(m--,1);for(;c<o.length&&o[c].from<=i&&o[c].to>i;)u.push(o[c++]);var g=i+v.nodeSize;if(v.isText){var b=g;c<o.length&&o[c].from<b&&(b=o[c].from);for(var w=0;w<u.length;w++)u[w].to<b&&(b=u[w].to);b<g&&(l=v.cut(b-i),v=v.cut(0,b-i),g=b,y=-1)}r(v,u.length?v.isInline&&!v.isLeaf?u.filter((function(t){return!t.inline})):u.slice():Su,e.forChild(i,v),y),i=g}}(this.node,this.innerDeco,(function(e,i,a){e.spec.marks?s.syncToMarks(e.spec.marks,r,t):e.type.side>=0&&!a&&s.syncToMarks(i==n.node.childCount?ra.none:n.node.child(i).marks,r,t),s.placeWidget(e,t,o)}),(function(e,n,i,a){s.syncToMarks(e.marks,r,t),s.findNodeMatch(e,n,i,a)||s.updateNextNode(e,n,i,t,a)||s.addNode(e,n,i,t,o),o+=e.nodeSize})),s.syncToMarks(Su,r,t),this.node.isTextblock&&s.addTextblockHacks(),s.destroyRest(),(s.changed||2==this.dirty)&&(i&&this.protectLocalComposition(t,i),Iu(this.contentDOM,this.children,t),Pc.ios&&function(t){if("UL"==t.nodeName||"OL"==t.nodeName){var e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}(this.dom))},e.prototype.localCompositionNode=function(t,e){var n=t.state.selection,r=n.from,o=n.to;if(!(!(t.state.selection instanceof vc)||r<e||o>e+this.node.content.size)){var i=t.root.getSelection(),s=function(t,e){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0){if(t.childNodes.length>e&&3==t.childNodes[e].nodeType)return t.childNodes[e];e=Yc(t=t.childNodes[e-1])}else{if(!(1==t.nodeType&&e<t.childNodes.length))return null;t=t.childNodes[e],e=0}}}(i.focusNode,i.focusOffset);if(s&&this.dom.contains(s.parentNode)){var a=s.nodeValue,c=function(t,e,n,r){for(var o=0,i=0;o<t.childCount&&i<=r;){var s=t.child(o++),a=i;if(i+=s.nodeSize,s.isText){for(var c=s.text;o<t.childCount;){var u=t.child(o++);if(i+=u.nodeSize,!u.isText)break;c+=u.text}if(i>=n){var l=c.lastIndexOf(e,r-a);if(l>=0&&l+e.length+a>=n)return a+l}}}return-1}(this.node.content,a,r-e,o-e);return c<0?null:{node:s,pos:c,text:a}}}},e.prototype.protectLocalComposition=function(t,e){var n=e.node,r=e.pos,o=e.text;if(!this.getDesc(n)){for(var i=n;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=null)}var s=new Cu(this,i,n,o);t.compositionNodes.push(s),this.children=Ju(this.children,r,r+o.length,t,s)}},e.prototype.update=function(t,e,n,r){return!(3==this.dirty||!t.sameMarkup(this.node))&&(this.updateInner(t,e,n,r),!0)},e.prototype.updateInner=function(t,e,n,r){this.updateOuterDeco(e),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0},e.prototype.updateOuterDeco=function(t){if(!Bu(t,this.outerDeco)){var e=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=Pu(this.dom,this.nodeDOM,Ru(this.outerDeco,this.node,e),Ru(t,this.node,e)),this.dom!=n&&(n.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=t}},e.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)},e.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")},Object.defineProperties(e.prototype,n),e}(ku);function Mu(t,e,n,r,o){return Fu(r,e,t),new _u(null,t,e,n,r,r,r,o,0)}var Tu=function(t){function e(e,n,r,o,i,s,a){t.call(this,e,n,r,o,i,null,s,a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.parseRule=function(){for(var t=this.nodeDOM.parentNode;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}},e.prototype.update=function(t,e,n,r){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node))&&(this.updateOuterDeco(e),0==this.dirty&&t.text==this.node.text||t.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=t.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=t,this.dirty=0,!0)},e.prototype.inParent=function(){for(var t=this.parent.contentDOM,e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1},e.prototype.domFromPos=function(t){return{node:this.nodeDOM,offset:t}},e.prototype.localPosFromDOM=function(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):t.prototype.localPosFromDOM.call(this,e,n,r)},e.prototype.ignoreMutation=function(t){return"characterData"!=t.type&&"selection"!=t.type},e.prototype.slice=function(t,n,r){var o=this.node.cut(t,n),i=document.createTextNode(o.text);return new e(this.parent,o,this.outerDeco,this.innerDeco,i,i,r)},e}(_u),Nu=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.matchesHack=function(){return 0==this.dirty},e}(ku),Au=function(t){function e(e,n,r,o,i,s,a,c,u,l){t.call(this,e,n,r,o,i,s,a,u,l),this.spec=c}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(e,n,r,o){if(3==this.dirty)return!1;if(this.spec.update){var i=this.spec.update(e,n);return i&&this.updateInner(e,n,r,o),i}return!(!this.contentDOM&&!e.isLeaf)&&t.prototype.update.call(this,e,n,r,o)},e.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():t.prototype.selectNode.call(this)},e.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():t.prototype.deselectNode.call(this)},e.prototype.setSelection=function(e,n,r,o){this.spec.setSelection?this.spec.setSelection(e,n,r):t.prototype.setSelection.call(this,e,n,r,o)},e.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),t.prototype.destroy.call(this)},e.prototype.stopEvent=function(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)},e.prototype.ignoreMutation=function(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):t.prototype.ignoreMutation.call(this,e)},e}(_u);function Iu(t,e,n){for(var r=t.firstChild,o=!1,i=0;i<e.length;i++){var s=e[i],a=s.dom;if(a.parentNode==t){for(;a!=r;)r=Lu(r),o=!0;r=r.nextSibling}else o=!0,t.insertBefore(a,r);if(s instanceof Eu){var c=r?r.previousSibling:t.lastChild;Iu(s.contentDOM,s.children,n),r=c?c.nextSibling:t.firstChild}}for(;r;)r=Lu(r),o=!0;o&&n.trackWrites==t&&(n.trackWrites=null)}function ju(t){t&&(this.nodeName=t)}ju.prototype=Object.create(null);var Du=[new ju];function Ru(t,e,n){if(0==t.length)return Du;for(var r=n?Du[0]:new ju,o=[r],i=0;i<t.length;i++){var s=t[i].type.attrs;if(s)for(var a in s.nodeName&&o.push(r=new ju(s.nodeName)),s){var c=s[a];null!=c&&(n&&1==o.length&&o.push(r=new ju(e.isInline?"span":"div")),"class"==a?r.class=(r.class?r.class+" ":"")+c:"style"==a?r.style=(r.style?r.style+";":"")+c:"nodeName"!=a&&(r[a]=c))}}return o}function Pu(t,e,n,r){if(n==Du&&r==Du)return e;for(var o=e,i=0;i<r.length;i++){var s=r[i],a=n[i];if(i){var c=void 0;a&&a.nodeName==s.nodeName&&o!=t&&(c=o.parentNode)&&c.tagName.toLowerCase()==s.nodeName||((c=document.createElement(s.nodeName)).pmIsDeco=!0,c.appendChild(o),a=Du[0]),o=c}zu(o,a||Du[0],s)}return o}function zu(t,e,n){for(var r in e)"class"==r||"style"==r||"nodeName"==r||r in n||t.removeAttribute(r);for(var o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=e[o]&&t.setAttribute(o,n[o]);if(e.class!=n.class){for(var i=e.class?e.class.split(" "):Su,s=n.class?n.class.split(" "):Su,a=0;a<i.length;a++)-1==s.indexOf(i[a])&&t.classList.remove(i[a]);for(var c=0;c<s.length;c++)-1==i.indexOf(s[c])&&t.classList.add(s[c])}if(e.style!=n.style){if(e.style)for(var u,l=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;u=l.exec(e.style);)t.style.removeProperty(u[1]);n.style&&(t.style.cssText+=n.style)}}function Fu(t,e,n){return Pu(t,t,Du,Ru(e,n,1!=t.nodeType))}function Bu(t,e){if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function Lu(t){var e=t.nextSibling;return t.parentNode.removeChild(t),e}var $u=function(t,e){this.top=t,this.lock=e,this.index=0,this.stack=[],this.changed=!1;var n=function(t,e){for(var n=[],r=t.childCount,o=e.length-1;r>0&&o>=0;o--){var i=e[o],s=i.node;if(s){if(s!=t.child(r-1))break;n.push(i),--r}}return{nodes:n.reverse(),offset:r}}(t.node.content,t.children);this.preMatched=n.nodes,this.preMatchOffset=n.offset};function qu(t,e){return t.type.side-e.type.side}function Ju(t,e,n,r,o){for(var i=[],s=0,a=0;s<t.length;s++){var c=t[s],u=a,l=a+=c.size;u>=n||l<=e?i.push(c):(u<e&&i.push(c.slice(0,e-u,r)),o&&(i.push(o),o=null),l>n&&i.push(c.slice(n-u,c.size,r)))}return i}function Uu(t,e){var n=t.root.getSelection(),r=t.state.doc;if(!n.focusNode)return null;var o=t.docView.nearestDesc(n.focusNode),i=o&&0==o.size,s=t.docView.posFromDOM(n.focusNode,n.focusOffset);if(s<0)return null;var a,c,u=r.resolve(s);if(Qc(n)){for(a=u;o&&!o.node;)o=o.parent;if(o&&o.node.isAtom&&mc.isSelectable(o.node)&&o.parent&&(!o.node.isInline||!function(t,e,n){for(var r=0==e,o=e==Yc(t);r||o;){if(t==n)return!0;var i=qc(t);if(!(t=t.parentNode))return!1;r=r&&0==i,o=o&&i==Yc(t)}}(n.focusNode,n.focusOffset,o.dom))){var l=o.posBefore;c=new mc(s==l?u:r.resolve(l))}}else{var f=t.docView.posFromDOM(n.anchorNode,n.anchorOffset);if(f<0)return null;a=r.resolve(f)}c||(c=Xu(t,a,u,"pointer"==e||t.state.selection.head<u.pos&&!i?1:-1));return c}function Vu(t,e){var n=t.state.selection;if(Gu(t,n),t.editable?t.hasFocus():Zu(t)&&document.activeElement&&document.activeElement.contains(t.dom)){if(t.domObserver.disconnectSelection(),t.cursorWrapper)!function(t){var e=t.root.getSelection(),n=document.createRange(),r=t.cursorWrapper.dom,o="IMG"==r.nodeName;o?n.setEnd(r.parentNode,qc(r)+1):n.setEnd(r,0);n.collapse(!1),e.removeAllRanges(),e.addRange(n),!o&&!t.state.selection.visible&&Pc.ie&&Pc.ie_version<=11&&(r.disabled=!0,r.disabled=!1)}(t);else{var r,o,i=n.anchor,s=n.head;!Wu||n instanceof vc||(n.$from.parent.inlineContent||(r=Hu(t,n.from)),n.empty||n.$from.parent.inlineContent||(o=Hu(t,n.to))),t.docView.setSelection(i,s,t.root,e),Wu&&(r&&Yu(r),o&&Yu(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(t){var e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.hideSelectionGuard);var n=t.root.getSelection(),r=n.anchorNode,o=n.anchorOffset;e.addEventListener("selectionchange",t.hideSelectionGuard=function(){n.anchorNode==r&&n.anchorOffset==o||(e.removeEventListener("selectionchange",t.hideSelectionGuard),t.dom.classList.remove("ProseMirror-hideselection"))})}(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}$u.prototype.getPreMatch=function(t){return t>=this.preMatchOffset?this.preMatched[t-this.preMatchOffset]:null},$u.prototype.destroyBetween=function(t,e){if(t!=e){for(var n=t;n<e;n++)this.top.children[n].destroy();this.top.children.splice(t,e-t),this.changed=!0}},$u.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},$u.prototype.syncToMarks=function(t,e,n){for(var r=0,o=this.stack.length>>1,i=Math.min(o,t.length);r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(t[r])&&!1!==t[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<t.length;){this.stack.push(this.top,this.index+1);for(var s=-1,a=this.index;a<Math.min(this.index+3,this.top.children.length);a++)if(this.top.children[a].matchesMark(t[o])){s=a;break}if(s>-1)s>this.index&&(this.changed=!0,this.destroyBetween(this.index,s)),this.top=this.top.children[this.index];else{var c=Eu.create(this.top,t[o],e,n);this.top.children.splice(this.index,0,c),this.top=c,this.changed=!0}this.index=0,o++}},$u.prototype.findNodeMatch=function(t,e,n,r){var o=-1,i=r<0?void 0:this.getPreMatch(r),s=this.top.children;if(i&&i.matchesNode(t,e,n))o=s.indexOf(i);else for(var a=this.index,c=Math.min(s.length,a+5);a<c;a++){var u=s[a];if(u.matchesNode(t,e,n)&&this.preMatched.indexOf(u)<0){o=a;break}}return!(o<0)&&(this.destroyBetween(this.index,o),this.index++,!0)},$u.prototype.updateNextNode=function(t,e,n,r,o){for(var i=this.index;i<this.top.children.length;i++){var s=this.top.children[i];if(s instanceof _u){var a=this.preMatched.indexOf(s);if(a>-1&&a+this.preMatchOffset!=o)return!1;var c=s.dom;if(!(this.lock&&(c==this.lock||1==c.nodeType&&c.contains(this.lock.parentNode))&&!(t.isText&&s.node&&s.node.isText&&s.nodeDOM.nodeValue==t.text&&3!=s.dirty&&Bu(e,s.outerDeco)))&&s.update(t,e,n,r))return this.destroyBetween(this.index,i),s.dom!=c&&(this.changed=!0),this.index++,!0;break}}return!1},$u.prototype.addNode=function(t,e,n,r,o){this.top.children.splice(this.index++,0,_u.create(this.top,t,e,n,r,o)),this.changed=!0},$u.prototype.placeWidget=function(t,e,n){var r=this.index<this.top.children.length?this.top.children[this.index]:null;if(!r||!r.matchesWidget(t)||t!=r.widget&&r.widget.type.toDOM.parentNode){var o=new Ou(this.top,t,e,n);this.top.children.splice(this.index++,0,o),this.changed=!0}else this.index++},$u.prototype.addTextblockHacks=function(){for(var t=this.top.children[this.index-1];t instanceof Eu;)t=t.children[t.children.length-1];if(!t||!(t instanceof Tu)||/\n$/.test(t.node.text))if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack())this.index++;else{var e=document.createElement("br");this.top.children.splice(this.index++,0,new Nu(this.top,Su,e,null)),this.changed=!0}};var Wu=Pc.safari||Pc.chrome&&Pc.chrome_version<63;function Hu(t,e){var n=t.docView.domFromPos(e),r=n.node,o=n.offset,i=o<r.childNodes.length?r.childNodes[o]:null,s=o?r.childNodes[o-1]:null;if(Pc.safari&&i&&"false"==i.contentEditable)return Ku(i);if((!i||"false"==i.contentEditable)&&(!s||"false"==s.contentEditable)){if(i)return Ku(i);if(s)return Ku(s)}}function Ku(t){return t.contentEditable="true",Pc.safari&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Yu(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function Gu(t,e){if(e instanceof mc){var n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Qu(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Qu(t)}function Qu(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=null)}function Xu(t,e,n,r){return t.someProp("createSelectionBetween",(function(r){return r(t,e,n)}))||vc.between(e,n,r)}function Zu(t){var e=t.root.getSelection();if(!e.anchorNode)return!1;try{return t.dom.contains(3==e.anchorNode.nodeType?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(3==e.focusNode.nodeType?e.focusNode.parentNode:e.focusNode))}catch(n){return!1}}function tl(t,e){var n=t.selection,r=n.$anchor,o=n.$head,i=e>0?r.max(o):r.min(o),s=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return s&&hc.findFrom(s,e)}function el(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function nl(t,e,n){var r=t.state.selection;if(!(r instanceof vc)){if(r instanceof mc&&r.node.isInline)return el(t,new vc(e>0?r.$to:r.$from));var o=tl(t.state,e);return!!o&&el(t,o)}if(!r.empty||n.indexOf("s")>-1)return!1;if(t.endOfTextblock(e>0?"right":"left")){var i=tl(t.state,e);return!!(i&&i instanceof mc)&&el(t,i)}if(!(Pc.mac&&n.indexOf("m")>-1)){var s,a=r.$head,c=a.textOffset?null:e<0?a.nodeBefore:a.nodeAfter;if(!c||c.isText)return!1;var u=e<0?a.pos-c.nodeSize:a.pos;return!!(c.isAtom||(s=t.docView.descAt(u))&&!s.contentDOM)&&(mc.isSelectable(c)?el(t,new mc(e<0?t.state.doc.resolve(a.pos-c.nodeSize):a)):!!Pc.webkit&&el(t,new vc(t.state.doc.resolve(e<0?u:u+c.nodeSize))))}}function rl(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function ol(t){var e=t.pmViewDesc;return e&&0==e.size&&(t.nextSibling||"BR"!=t.nodeName)}function il(t){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n){var o,i,s=!1;for(Pc.gecko&&1==n.nodeType&&r<rl(n)&&ol(n.childNodes[r])&&(s=!0);;)if(r>0){if(1!=n.nodeType)break;var a=n.childNodes[r-1];if(ol(a))o=n,i=--r;else{if(3!=a.nodeType)break;r=(n=a).nodeValue.length}}else{if(al(n))break;for(var c=n.previousSibling;c&&ol(c);)o=n.parentNode,i=qc(c),c=c.previousSibling;if(c)r=rl(n=c);else{if((n=n.parentNode)==t.dom)break;r=0}}s?cl(t,e,n,r):o&&cl(t,e,o,i)}}function sl(t){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n){for(var o,i,s=rl(n);;)if(r<s){if(1!=n.nodeType)break;if(!ol(n.childNodes[r]))break;o=n,i=++r}else{if(al(n))break;for(var a=n.nextSibling;a&&ol(a);)o=a.parentNode,i=qc(a)+1,a=a.nextSibling;if(a)r=0,s=rl(n=a);else{if((n=n.parentNode)==t.dom)break;r=s=0}}o&&cl(t,e,o,i)}}function al(t){var e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function cl(t,e,n,r){if(Qc(e)){var o=document.createRange();o.setEnd(n,r),o.setStart(n,r),e.removeAllRanges(),e.addRange(o)}else e.extend&&e.extend(n,r);t.domObserver.setCurSelection();var i=t.state;setTimeout((function(){t.state==i&&Vu(t)}),50)}function ul(t,e,n){var r=t.state.selection;if(r instanceof vc&&!r.empty||n.indexOf("s")>-1)return!1;if(Pc.mac&&n.indexOf("m")>-1)return!1;var o=r.$from,i=r.$to;if(!o.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){var s=tl(t.state,e);if(s&&s instanceof mc)return el(t,s)}if(!o.parent.inlineContent){var a=hc.findFrom(e<0?o:i,e);return!a||el(t,a)}return!1}function ll(t,e){if(!(t.state.selection instanceof vc))return!0;var n=t.state.selection,r=n.$head,o=n.$anchor,i=n.empty;if(!r.sameParent(o))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;var s=!r.textOffset&&(e<0?r.nodeBefore:r.nodeAfter);if(s&&!s.isText){var a=t.state.tr;return e<0?a.delete(r.pos-s.nodeSize,r.pos):a.delete(r.pos,r.pos+s.nodeSize),t.dispatch(a),!0}return!1}function fl(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function hl(t,e){var n=e.keyCode,r=function(t){var e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}(e);return 8==n||Pc.mac&&72==n&&"c"==r?ll(t,-1)||il(t):46==n||Pc.mac&&68==n&&"c"==r?ll(t,1)||sl(t):13==n||27==n||(37==n?nl(t,-1,r)||il(t):39==n?nl(t,1,r)||sl(t):38==n?ul(t,-1,r)||il(t):40==n?function(t){if(Pc.safari&&!(t.state.selection.$head.parentOffset>0)){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n&&1==n.nodeType&&0==r&&n.firstChild&&"false"==n.firstChild.contentEditable){var o=n.firstChild;fl(t,o,!0),setTimeout((function(){return fl(t,o,!1)}),20)}}}(t)||ul(t,1,r)||sl(t):r==(Pc.mac?"m":"c")&&(66==n||73==n||89==n||90==n))}function pl(t){var e=t.pmViewDesc;if(e)return e.parseRule();if("BR"==t.nodeName&&t.parentNode){if(Pc.safari&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){var n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}if(t.parentNode.lastChild==t||Pc.safari&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if("IMG"==t.nodeName&&t.getAttribute("mark-placeholder"))return{ignore:!0}}function dl(t,e,n,r,o){if(e<0){var i=t.lastSelectionTime>Date.now()-50?t.lastSelectionOrigin:null,s=Uu(t,i);if(s&&!t.state.selection.eq(s)){var a=t.state.tr.setSelection(s);"pointer"==i?a.setMeta("pointer",!0):"key"==i&&a.scrollIntoView(),t.dispatch(a)}}else{var c=t.state.doc.resolve(e),u=c.sharedDepth(n);e=c.before(u+1),n=t.state.doc.resolve(n).after(u+1);var l,f,h=t.state.selection,p=function(t,e,n){var r=t.docView.parseRange(e,n),o=r.node,i=r.fromOffset,s=r.toOffset,a=r.from,c=r.to,u=t.root.getSelection(),l=null,f=u.anchorNode;if(f&&t.dom.contains(1==f.nodeType?f:f.parentNode)&&(l=[{node:f,offset:u.anchorOffset}],Qc(u)||l.push({node:u.focusNode,offset:u.focusOffset})),Pc.chrome&&8===t.lastKeyCode)for(var h=s;h>i;h--){var p=o.childNodes[h-1],d=p.pmViewDesc;if("BR"==p.nodeType&&!d){s=h;break}if(!d||d.size)break}var v=t.state.doc,y=t.someProp("domParser")||Qa.fromSchema(t.state.schema),m=v.resolve(a),g=null,b=y.parse(o,{topNode:m.parent,topMatch:m.parent.contentMatchAt(m.index()),topOpen:!0,from:i,to:s,preserveWhitespace:!m.parent.type.spec.code||"full",editableContent:!0,findPositions:l,ruleFromNode:pl,context:m});if(l&&null!=l[0].pos){var w=l[0].pos,k=l[1]&&l[1].pos;null==k&&(k=w),g={anchor:w+a,head:k+a}}return{doc:b,sel:g,from:a,to:c}}(t,e,n),d=t.state.doc,v=d.slice(p.from,p.to);8===t.lastKeyCode&&Date.now()-100<t.lastKeyCodeTime?(l=t.state.selection.to,f="end"):(l=t.state.selection.from,f="start"),t.lastKeyCode=null;var y=function(t,e,n,r,o){var i=t.findDiffStart(e,n);if(null==i)return null;var s=t.findDiffEnd(e,n+t.size,n+e.size),a=s.a,c=s.b;if("end"==o){r-=a+Math.max(0,i-Math.min(a,c))-i}if(a<i&&t.size<e.size){c=(i-=r<=i&&r>=a?i-r:0)+(c-a),a=i}else if(c<i){a=(i-=r<=i&&r>=c?i-r:0)+(a-c),c=i}return{start:i,endA:a,endB:c}}(v.content,p.doc.content,p.from,l,f);if(!y){if(!(r&&h instanceof vc&&!h.empty&&h.$head.sameParent(h.$anchor))||t.composing||p.sel&&p.sel.anchor!=p.sel.head){if(Pc.ios&&t.lastIOSEnter>Date.now()-225&&o.some((function(t){return"DIV"==t.nodeName||"P"==t.nodeName}))&&t.someProp("handleKeyDown",(function(e){return e(t,Xc(13,"Enter"))})))return void(t.lastIOSEnter=0);if(p.sel){var m=vl(t,t.state.doc,p.sel);m&&!m.eq(t.state.selection)&&t.dispatch(t.state.tr.setSelection(m))}return}y={start:h.from,endA:h.to,endB:h.to}}t.domChangeCount++,t.state.selection.from<t.state.selection.to&&y.start==y.endB&&t.state.selection instanceof vc&&(y.start>t.state.selection.from&&y.start<=t.state.selection.from+2?y.start=t.state.selection.from:y.endA<t.state.selection.to&&y.endA>=t.state.selection.to-2&&(y.endB+=t.state.selection.to-y.endA,y.endA=t.state.selection.to)),Pc.ie&&Pc.ie_version<=11&&y.endB==y.start+1&&y.endA==y.start&&y.start>p.from&&" \xa0"==p.doc.textBetween(y.start-p.from-1,y.start-p.from+1)&&(y.start--,y.endA--,y.endB--);var g,b=p.doc.resolveNoCache(y.start-p.from),w=p.doc.resolveNoCache(y.endB-p.from),k=b.sameParent(w)&&b.parent.inlineContent;if((Pc.ios&&t.lastIOSEnter>Date.now()-225&&(!k||o.some((function(t){return"DIV"==t.nodeName||"P"==t.nodeName})))||!k&&b.pos<p.doc.content.size&&(g=hc.findFrom(p.doc.resolve(b.pos+1),1,!0))&&g.head==w.pos)&&t.someProp("handleKeyDown",(function(e){return e(t,Xc(13,"Enter"))})))t.lastIOSEnter=0;else if(t.state.selection.anchor>y.start&&function(t,e,n,r,o){if(!r.parent.isTextblock||n-e<=o.pos-r.pos||yl(r,!0,!1)<o.pos)return!1;var i=t.resolve(e);if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;var s=t.resolve(yl(i,!0,!0));if(!s.parent.isTextblock||s.pos>n||yl(s,!0,!1)<n)return!1;return r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(d,y.start,y.endA,b,w)&&t.someProp("handleKeyDown",(function(e){return e(t,Xc(8,"Backspace"))})))Pc.android&&Pc.chrome&&t.domObserver.suppressSelectionUpdates();else{Pc.android&&!k&&b.start()!=w.start()&&0==w.parentOffset&&b.depth==w.depth&&p.sel&&p.sel.anchor==p.sel.head&&p.sel.head==y.endA&&(y.endB-=2,w=p.doc.resolveNoCache(y.endB-p.from),setTimeout((function(){t.someProp("handleKeyDown",(function(e){return e(t,Xc(13,"Enter"))}))}),20));var x,S,O,C,E=y.start,_=y.endA;if(k)if(b.pos==w.pos)Pc.ie&&Pc.ie_version<=11&&0==b.parentOffset&&(t.domObserver.suppressSelectionUpdates(),setTimeout((function(){return Vu(t)}),20)),x=t.state.tr.delete(E,_),S=d.resolve(y.start).marksAcross(d.resolve(y.endA));else if(y.endA==y.endB&&(C=d.resolve(y.start))&&(O=function(t,e){for(var n,r,o,i=t.firstChild.marks,s=e.firstChild.marks,a=i,c=s,u=0;u<s.length;u++)a=s[u].removeFromSet(a);for(var l=0;l<i.length;l++)c=i[l].removeFromSet(c);if(1==a.length&&0==c.length)r=a[0],n="add",o=function(t){return t.mark(r.addToSet(t.marks))};else{if(0!=a.length||1!=c.length)return null;r=c[0],n="remove",o=function(t){return t.mark(r.removeFromSet(t.marks))}}for(var f=[],h=0;h<e.childCount;h++)f.push(o(e.child(h)));if(Xs.from(f).eq(t))return{mark:r,type:n}}(b.parent.content.cut(b.parentOffset,w.parentOffset),C.parent.content.cut(C.parentOffset,y.endA-C.start()))))x=t.state.tr,"add"==O.type?x.addMark(E,_,O.mark):x.removeMark(E,_,O.mark);else if(b.parent.child(b.index()).isText&&b.index()==w.index()-(w.textOffset?0:1)){var M=b.parent.textBetween(b.parentOffset,w.parentOffset);if(t.someProp("handleTextInput",(function(e){return e(t,E,_,M)})))return;x=t.state.tr.insertText(M,E,_)}if(x||(x=t.state.tr.replace(E,_,p.doc.slice(y.start-p.from,y.endB-p.from))),p.sel){var T=vl(t,x.doc,p.sel);T&&!(Pc.chrome&&Pc.android&&t.composing&&T.empty&&(T.head==E||T.head==x.mapping.map(_)-1)||Pc.ie&&T.empty&&T.head==E)&&x.setSelection(T)}S&&x.ensureMarks(S),t.dispatch(x.scrollIntoView())}}}function vl(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Xu(t,e.resolve(n.anchor),e.resolve(n.head))}function yl(t,e,n){for(var r=t.depth,o=e?t.end():t.pos;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,o++,e=!1;if(n)for(var i=t.node(r).maybeChild(t.indexAfter(r));i&&!i.isLeaf;)i=i.firstChild,o++;return o}function ml(t,e){for(var n=[],r=e.content,o=e.openStart,i=e.openEnd;o>1&&i>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,i--;var s=r.firstChild;n.push(s.type.name,s.attrs!=s.type.defaultAttrs?s.attrs:null),r=s.content}var a=t.someProp("clipboardSerializer")||cc.fromSchema(t.state.schema),c=Cl(),u=c.createElement("div");u.appendChild(a.serializeFragment(r,{document:c}));for(var l,f=u.firstChild;f&&1==f.nodeType&&(l=Sl[f.nodeName.toLowerCase()]);){for(var h=l.length-1;h>=0;h--){for(var p=c.createElement(l[h]);u.firstChild;)p.appendChild(u.firstChild);u.appendChild(p)}f=u.firstChild}return f&&1==f.nodeType&&f.setAttribute("data-pm-slice",o+" "+i+" "+JSON.stringify(n)),{dom:u,text:t.someProp("clipboardTextSerializer",(function(t){return t(e)}))||e.content.textBetween(0,e.content.size,"\n\n")}}function gl(t,e,n,r,o){var i,s,a=o.parent.type.spec.code;if(!n&&!e)return null;var c=e&&(r||a||!n);if(c){if(t.someProp("transformPastedText",(function(t){e=t(e,a||r)})),a)return new ia(Xs.from(t.state.schema.text(e)),0,0);var u=t.someProp("clipboardTextParser",(function(t){return t(e,o,r)}));u?s=u:(i=document.createElement("div"),e.trim().split(/(?:\r\n?|\n)+/).forEach((function(t){i.appendChild(document.createElement("p")).textContent=t})))}else t.someProp("transformPastedHTML",(function(t){n=t(n)})),i=function(t){var e=/(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));var n,r=Cl().createElement("div"),o=/(?:<meta [^>]*>)*<([a-z][^>\s]+)/i.exec(t),i=0;(n=o&&Sl[o[1].toLowerCase()])&&(t=n.map((function(t){return"<"+t+">"})).join("")+t+n.map((function(t){return"</"+t+">"})).reverse().join(""),i=n.length);r.innerHTML=t;for(var s=0;s<i;s++)r=r.firstChild;return r}(n);var l=i&&i.querySelector("[data-pm-slice]"),f=l&&/^(\d+) (\d+) (.*)/.exec(l.getAttribute("data-pm-slice"));if(!s){var h=t.someProp("clipboardParser")||t.someProp("domParser")||Qa.fromSchema(t.state.schema);s=h.parseSlice(i,{preserveWhitespace:!(!c&&!f),context:o})}return s=f?function(t,e){if(!t.size)return t;var n,r=t.content.firstChild.type.schema;try{n=JSON.parse(e)}catch(u){return t}for(var o=t.content,i=t.openStart,s=t.openEnd,a=n.length-2;a>=0;a-=2){var c=r.nodes[n[a]];if(!c||c.hasRequiredAttrs())break;o=Xs.from(c.create(n[a+1],o)),i++,s++}return new ia(o,i,s)}(function(t,e,n){e<t.openStart&&(t=new ia(xl(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd));n<t.openEnd&&(t=new ia(xl(t.content,1,n,t.openEnd,0,0),t.openStart,n));return t}(s,+f[1],+f[2]),f[3]):ia.maxOpen(function(t,e){if(t.childCount<2)return t;for(var n=function(n){var r=e.node(n).contentMatchAt(e.index(n)),o=void 0,i=[];if(t.forEach((function(t){if(i){var e,n=r.findWrapping(t.type);if(!n)return i=null;if(e=i.length&&o.length&&wl(n,o,t,i[i.length-1],0))i[i.length-1]=e;else{i.length&&(i[i.length-1]=kl(i[i.length-1],o.length));var s=bl(t,n);i.push(s),r=r.matchType(s.type,s.attrs),o=n}}})),i)return{v:Xs.from(i)}},r=e.depth;r>=0;r--){var o=n(r);if(o)return o.v}return t}(s.content,o),!1),t.someProp("transformPasted",(function(t){s=t(s)})),s}function bl(t,e,n){void 0===n&&(n=0);for(var r=e.length-1;r>=n;r--)t=e[r].create(null,Xs.from(t));return t}function wl(t,e,n,r,o){if(o<t.length&&o<e.length&&t[o]==e[o]){var i=wl(t,e,n,r.lastChild,o+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(o==t.length-1?n.type:t[o+1]))return r.copy(r.content.append(Xs.from(bl(n,t,o+1))))}}function kl(t,e){if(0==e)return t;var n=t.content.replaceChild(t.childCount-1,kl(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(Xs.empty,!0);return t.copy(n.append(r))}function xl(t,e,n,r,o,i){var s=e<0?t.firstChild:t.lastChild,a=s.content;return o<r-1&&(a=xl(a,e,n,r,o+1,i)),o>=n&&(a=e<0?s.contentMatchAt(0).fillBefore(a,t.childCount>1||i<=o).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(Xs.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(a))}var Sl={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},Ol=null;function Cl(){return Ol||(Ol=document.implementation.createHTMLDocument("title"))}var El={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},_l=Pc.ie&&Pc.ie_version<=11,Ml=function(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};Ml.prototype.set=function(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset},Ml.prototype.eq=function(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset};var Tl=function(t,e){var n=this;this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=window.MutationObserver&&new window.MutationObserver((function(t){for(var e=0;e<t.length;e++)n.queue.push(t[e]);Pc.ie&&Pc.ie_version<=11&&t.some((function(t){return"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length}))?n.flushSoon():n.flush()})),this.currentSelection=new Ml,_l&&(this.onCharData=function(t){n.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),n.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};Tl.prototype.flushSoon=function(){var t=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((function(){t.flushingSoon=-1,t.flush()}),20))},Tl.prototype.forceFlush=function(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())},Tl.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,El),_l&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},Tl.prototype.stop=function(){var t=this;if(this.observer){var e=this.observer.takeRecords();if(e.length){for(var n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout((function(){return t.flush()}),20)}this.observer.disconnect()}_l&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},Tl.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},Tl.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},Tl.prototype.suppressSelectionUpdates=function(){var t=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return t.suppressingSelectionUpdates=!1}),50)},Tl.prototype.onSelectionChange=function(){if((!(t=this.view).editable||t.root.activeElement==t.dom)&&Zu(t)){var t;if(this.suppressingSelectionUpdates)return Vu(this.view);if(Pc.ie&&Pc.ie_version<=11&&!this.view.state.selection.empty){var e=this.view.root.getSelection();if(e.focusNode&&Wc(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}},Tl.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())},Tl.prototype.ignoreSelectionChange=function(t){if(0==t.rangeCount)return!0;var e=t.getRangeAt(0).commonAncestorContainer,n=this.view.docView.nearestDesc(e);return n&&n.ignoreMutation({type:"selection",target:3==e.nodeType?e.parentNode:e})?(this.setCurSelection(),!0):void 0},Tl.prototype.flush=function(){if(this.view.docView&&!(this.flushingSoon>-1)){var t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);var e=this.view.root.getSelection(),n=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(e)&&Zu(this.view)&&!this.ignoreSelectionChange(e),r=-1,o=-1,i=!1,s=[];if(this.view.editable)for(var a=0;a<t.length;a++){var c=this.registerMutation(t[a],s);c&&(r=r<0?c.from:Math.min(c.from,r),o=o<0?c.to:Math.max(c.to,o),c.typeOver&&(i=!0))}if(Pc.gecko&&s.length>1){var u=s.filter((function(t){return"BR"==t.nodeName}));if(2==u.length){var l=u[0],f=u[1];l.parentNode&&l.parentNode.parentNode==f.parentNode?f.remove():l.remove()}}(r>-1||n)&&(r>-1&&(this.view.docView.markDirty(r,o),function(t){if(Nl)return;Nl=!0,"normal"==getComputedStyle(t.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.")}(this.view)),this.handleDOMChange(r,o,i,s),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(e)||Vu(this.view))}},Tl.prototype.registerMutation=function(t,e){if(e.indexOf(t.target)>-1)return null;var n=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(n==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(t))return null;if("childList"==t.type){var r=t.previousSibling,o=t.nextSibling;if(Pc.ie&&Pc.ie_version<=11&&t.addedNodes.length)for(var i=0;i<t.addedNodes.length;i++){var s=t.addedNodes[i],a=s.previousSibling,c=s.nextSibling;(!a||Array.prototype.indexOf.call(t.addedNodes,a)<0)&&(r=a),(!c||Array.prototype.indexOf.call(t.addedNodes,c)<0)&&(o=c)}for(var u=r&&r.parentNode==t.target?qc(r)+1:0,l=n.localPosFromDOM(t.target,u,-1),f=o&&o.parentNode==t.target?qc(o):t.target.childNodes.length,h=0;h<t.addedNodes.length;h++)e.push(t.addedNodes[h]);return{from:l,to:n.localPosFromDOM(t.target,f,1)}}return"attributes"==t.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}};var Nl=!1;var Al={},Il={};function jl(t,e){t.lastSelectionOrigin=e,t.lastSelectionTime=Date.now()}function Dl(t){t.someProp("handleDOMEvents",(function(e){for(var n in e)t.eventHandlers[n]||t.dom.addEventListener(n,t.eventHandlers[n]=function(e){return Rl(t,e)})}))}function Rl(t,e){return t.someProp("handleDOMEvents",(function(n){var r=n[e.type];return!!r&&(r(t,e)||e.defaultPrevented)}))}function Pl(t){return{left:t.clientX,top:t.clientY}}function zl(t,e,n,r,o){if(-1==r)return!1;for(var i=t.state.doc.resolve(r),s=function(r){if(t.someProp(e,(function(e){return r>i.depth?e(t,n,i.nodeAfter,i.before(r),o,!0):e(t,n,i.node(r),i.before(r),o,!1)})))return{v:!0}},a=i.depth+1;a>0;a--){var c=s(a);if(c)return c.v}return!1}function Fl(t,e,n){t.focused||t.focus();var r=t.state.tr.setSelection(e);"pointer"==n&&r.setMeta("pointer",!0),t.dispatch(r)}function Bl(t,e,n,r,o){return zl(t,"handleClickOn",e,n,r)||t.someProp("handleClick",(function(n){return n(t,e,r)}))||(o?function(t,e){if(-1==e)return!1;var n,r,o=t.state.selection;o instanceof mc&&(n=o.node);for(var i=t.state.doc.resolve(e),s=i.depth+1;s>0;s--){var a=s>i.depth?i.nodeAfter:i.node(s);if(mc.isSelectable(a)){r=n&&o.$from.depth>0&&s>=o.$from.depth&&i.before(o.$from.depth+1)==o.$from.pos?i.before(o.$from.depth):i.before(s);break}}return null!=r&&(Fl(t,mc.create(t.state.doc,r),"pointer"),!0)}(t,n):function(t,e){if(-1==e)return!1;var n=t.state.doc.resolve(e),r=n.nodeAfter;return!!(r&&r.isAtom&&mc.isSelectable(r))&&(Fl(t,new mc(n),"pointer"),!0)}(t,n))}function Ll(t,e,n,r){return zl(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",(function(n){return n(t,e,r)}))}function $l(t,e,n,r){return zl(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",(function(n){return n(t,e,r)}))||function(t,e){var n=t.state.doc;if(-1==e)return!!n.inlineContent&&(Fl(t,vc.create(n,0,n.content.size),"pointer"),!0);for(var r=n.resolve(e),o=r.depth+1;o>0;o--){var i=o>r.depth?r.nodeAfter:r.node(o),s=r.before(o);if(i.inlineContent)Fl(t,vc.create(n,s+1,s+1+i.content.size),"pointer");else{if(!mc.isSelectable(i))continue;Fl(t,mc.create(n,s),"pointer")}return!0}}(t,n)}function ql(t){return Yl(t)}Il.keydown=function(t,e){if(t.shiftKey=16==e.keyCode||e.shiftKey,!Vl(t,e))if(t.domObserver.forceFlush(),t.lastKeyCode=e.keyCode,t.lastKeyCodeTime=Date.now(),!Pc.ios||13!=e.keyCode||e.ctrlKey||e.altKey||e.metaKey)t.someProp("handleKeyDown",(function(n){return n(t,e)}))||hl(t,e)?e.preventDefault():jl(t,"key");else{var n=Date.now();t.lastIOSEnter=n,t.lastIOSEnterFallbackTimeout=setTimeout((function(){t.lastIOSEnter==n&&(t.someProp("handleKeyDown",(function(e){return e(t,Xc(13,"Enter"))})),t.lastIOSEnter=0)}),200)}},Il.keyup=function(t,e){16==e.keyCode&&(t.shiftKey=!1)},Il.keypress=function(t,e){if(!(Vl(t,e)||!e.charCode||e.ctrlKey&&!e.altKey||Pc.mac&&e.metaKey))if(t.someProp("handleKeyPress",(function(n){return n(t,e)})))e.preventDefault();else{var n=t.state.selection;if(!(n instanceof vc)||!n.$from.sameParent(n.$to)){var r=String.fromCharCode(e.charCode);t.someProp("handleTextInput",(function(e){return e(t,n.$from.pos,n.$to.pos,r)}))||t.dispatch(t.state.tr.insertText(r).scrollIntoView()),e.preventDefault()}}};var Jl=Pc.mac?"metaKey":"ctrlKey";Al.mousedown=function(t,e){t.shiftKey=e.shiftKey;var n=ql(t),r=Date.now(),o="singleClick";r-t.lastClick.time<500&&function(t,e){var n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}(e,t.lastClick)&&!e[Jl]&&("singleClick"==t.lastClick.type?o="doubleClick":"doubleClick"==t.lastClick.type&&(o="tripleClick")),t.lastClick={time:r,x:e.clientX,y:e.clientY,type:o};var i=t.posAtCoords(Pl(e));i&&("singleClick"==o?t.mouseDown=new Ul(t,i,e,n):("doubleClick"==o?Ll:$l)(t,i.pos,i.inside,e)?e.preventDefault():jl(t,"pointer"))};var Ul=function(t,e,n,r){var o,i,s=this;if(this.view=t,this.startDoc=t.state.doc,this.pos=e,this.event=n,this.flushed=r,this.selectNode=n[Jl],this.allowDefault=n.shiftKey,e.inside>-1)o=t.state.doc.nodeAt(e.inside),i=e.inside;else{var a=t.state.doc.resolve(e.pos);o=a.parent,i=a.depth?a.before():0}this.mightDrag=null;var c=r?null:n.target,u=c?t.docView.nearestDesc(c,!0):null;this.target=u?u.dom:null,(o.type.spec.draggable&&!1!==o.type.spec.selectable||t.state.selection instanceof mc&&i==t.state.selection.from)&&(this.mightDrag={node:o,pos:i,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&Pc.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){return s.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),jl(t,"pointer")};function Vl(t,e){return!!t.composing||!!(Pc.safari&&Math.abs(e.timeStamp-t.compositionEndedAt)<500)&&(t.compositionEndedAt=-2e8,!0)}Ul.prototype.done=function(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.view.mouseDown=null},Ul.prototype.up=function(t){if(this.done(),this.view.dom.contains(3==t.target.nodeType?t.target.parentNode:t.target)){var e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(Pl(t))),this.allowDefault||!e?jl(this.view,"pointer"):Bl(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():this.flushed||Pc.safari&&this.mightDrag&&!this.mightDrag.node.isAtom||Pc.chrome&&!(this.view.state.selection instanceof vc)&&(e.pos==this.view.state.selection.from||e.pos==this.view.state.selection.to)?(Fl(this.view,hc.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault()):jl(this.view,"pointer")}},Ul.prototype.move=function(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0),jl(this.view,"pointer")},Al.touchdown=function(t){ql(t),jl(t,"pointer")},Al.contextmenu=function(t){return ql(t)};var Wl=Pc.android?5e3:-1;function Hl(t,e){clearTimeout(t.composingTimeout),e>-1&&(t.composingTimeout=setTimeout((function(){return Yl(t)}),e))}function Kl(t){for(t.composing=!1;t.compositionNodes.length>0;)t.compositionNodes.pop().markParentsDirty()}function Yl(t,e){if(t.domObserver.forceFlush(),Kl(t),e||t.docView.dirty){var n=Uu(t);return n&&!n.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(n)):t.updateState(t.state),!0}return!1}Il.compositionstart=Il.compositionupdate=function(t){if(!t.composing){t.domObserver.flush();var e=t.state,n=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some((function(t){return!1===t.type.spec.inclusive}))))t.markCursor=t.state.storedMarks||n.marks(),Yl(t,!0),t.markCursor=null;else if(Yl(t),Pc.gecko&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length)for(var r=t.root.getSelection(),o=r.focusNode,i=r.focusOffset;o&&1==o.nodeType&&0!=i;){var s=i<0?o.lastChild:o.childNodes[i-1];if(!s)break;if(3==s.nodeType){r.collapse(s,s.nodeValue.length);break}o=s,i=-1}t.composing=!0}Hl(t,Wl)},Il.compositionend=function(t,e){t.composing&&(t.composing=!1,t.compositionEndedAt=e.timeStamp,Hl(t,20))};var Gl=Pc.ie&&Pc.ie_version<15||Pc.ios&&Pc.webkit_version<604;function Ql(t,e,n,r){var o=gl(t,e,n,t.shiftKey,t.state.selection.$from);if(!t.someProp("handlePaste",(function(e){return e(t,r,o||ia.empty)}))&&o){var i=function(t){return 0==t.openStart&&0==t.openEnd&&1==t.content.childCount?t.content.firstChild:null}(o),s=i?t.state.tr.replaceSelectionWith(i,t.shiftKey):t.state.tr.replaceSelection(o);t.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste"))}}Al.copy=Il.cut=function(t,e){var n=t.state.selection,r="cut"==e.type;if(!n.empty){var o=Gl?null:e.clipboardData,i=ml(t,n.content()),s=i.dom,a=i.text;o?(e.preventDefault(),o.clearData(),o.setData("text/html",s.innerHTML),o.setData("text/plain",a)):function(t,e){if(t.dom.parentNode){var n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";var r=getSelection(),o=document.createRange();o.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout((function(){n.parentNode&&n.parentNode.removeChild(n),t.focus()}),50)}}(t,s),r&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},Il.paste=function(t,e){var n=Gl?null:e.clipboardData,r=n&&n.getData("text/html"),o=n&&n.getData("text/plain");n&&(r||o||n.files.length)?(Ql(t,o,r,e),e.preventDefault()):function(t,e){if(t.dom.parentNode){var n=t.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout((function(){t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Ql(t,r.value,null,e):Ql(t,r.textContent,r.innerHTML,e)}),50)}}(t,e)};var Xl=function(t,e){this.slice=t,this.move=e},Zl=Pc.mac?"altKey":"ctrlKey";for(var tf in Al.dragstart=function(t,e){var n=t.mouseDown;if(n&&n.done(),e.dataTransfer){var r=t.state.selection,o=r.empty?null:t.posAtCoords(Pl(e));if(o&&o.pos>=r.from&&o.pos<=(r instanceof mc?r.to-1:r.to));else if(n&&n.mightDrag)t.dispatch(t.state.tr.setSelection(mc.create(t.state.doc,n.mightDrag.pos)));else if(e.target&&1==e.target.nodeType){var i=t.docView.nearestDesc(e.target,!0);if(!i||!i.node.type.spec.draggable||i==t.docView)return;t.dispatch(t.state.tr.setSelection(mc.create(t.state.doc,i.posBefore)))}var s=t.state.selection.content(),a=ml(t,s),c=a.dom,u=a.text;e.dataTransfer.clearData(),e.dataTransfer.setData(Gl?"Text":"text/html",c.innerHTML),Gl||e.dataTransfer.setData("text/plain",u),t.dragging=new Xl(s,!e[Zl])}},Al.dragend=function(t){var e=t.dragging;window.setTimeout((function(){t.dragging==e&&(t.dragging=null)}),50)},Il.dragover=Il.dragenter=function(t,e){return e.preventDefault()},Il.drop=function(t,e){var n=t.dragging;if(t.dragging=null,e.dataTransfer){var r=t.posAtCoords(Pl(e));if(r){var o=t.state.doc.resolve(r.pos);if(o){var i=n&&n.slice||gl(t,e.dataTransfer.getData(Gl?"Text":"text/plain"),Gl?null:e.dataTransfer.getData("text/html"),!1,o),s=n&&!e[Zl];if(t.someProp("handleDrop",(function(n){return n(t,e,i||ia.empty,s)})))e.preventDefault();else if(i){e.preventDefault();var a=i?Object(u.g)(t.state.doc,o.pos,i):o.pos;null==a&&(a=o.pos);var c=t.state.tr;s&&c.deleteSelection();var l=c.mapping.map(a),f=0==i.openStart&&0==i.openEnd&&1==i.content.childCount,h=c.doc;if(f?c.replaceRangeWith(l,l,i.content.firstChild):c.replaceRange(l,l,i),!c.doc.eq(h)){var p=c.doc.resolve(l);if(f&&mc.isSelectable(i.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(i.content.firstChild))c.setSelection(new mc(p));else{var d=c.mapping.map(a);c.mapping.maps[c.mapping.maps.length-1].forEach((function(t,e,n,r){return d=r})),c.setSelection(Xu(t,p,c.doc.resolve(d)))}t.focus(),t.dispatch(c.setMeta("uiEvent","drop"))}}}}}},Al.focus=function(t){t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout((function(){t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.root.getSelection())&&Vu(t)}),20))},Al.blur=function(t){t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),t.domObserver.currentSelection.set({}),t.focused=!1)},Al.beforeinput=function(t,e){if(Pc.chrome&&Pc.android&&"deleteContentBackward"==e.inputType){var n=t.domChangeCount;setTimeout((function(){if(t.domChangeCount==n&&(t.dom.blur(),t.focus(),!t.someProp("handleKeyDown",(function(e){return e(t,Xc(8,"Backspace"))})))){var e=t.state.selection.$cursor;e&&e.pos>0&&t.dispatch(t.state.tr.delete(e.pos-1,e.pos).scrollIntoView())}}),50)}},Il)Al[tf]=Il[tf];function ef(t,e){if(t==e)return!0;for(var n in t)if(t[n]!==e[n])return!1;for(var r in e)if(!(r in t))return!1;return!0}var nf=function(t,e){this.spec=e||uf,this.side=this.spec.side||0,this.toDOM=t};nf.prototype.map=function(t,e,n,r){var o=t.mapResult(e.from+r,this.side<0?-1:1),i=o.pos;return o.deleted?null:new sf(i-n,i-n,this)},nf.prototype.valid=function(){return!0},nf.prototype.eq=function(t){return this==t||t instanceof nf&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&ef(this.spec,t.spec))};var rf=function(t,e){this.spec=e||uf,this.attrs=t};rf.prototype.map=function(t,e,n,r){var o=t.map(e.from+r,this.spec.inclusiveStart?-1:1)-n,i=t.map(e.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new sf(o,i,this)},rf.prototype.valid=function(t,e){return e.from<e.to},rf.prototype.eq=function(t){return this==t||t instanceof rf&&ef(this.attrs,t.attrs)&&ef(this.spec,t.spec)},rf.is=function(t){return t.type instanceof rf};var of=function(t,e){this.spec=e||uf,this.attrs=t};of.prototype.map=function(t,e,n,r){var o=t.mapResult(e.from+r,1);if(o.deleted)return null;var i=t.mapResult(e.to+r,-1);return i.deleted||i.pos<=o.pos?null:new sf(o.pos-n,i.pos-n,this)},of.prototype.valid=function(t,e){var n=t.content.findIndex(e.from),r=n.index,o=n.offset;return o==e.from&&o+t.child(r).nodeSize==e.to},of.prototype.eq=function(t){return this==t||t instanceof of&&ef(this.attrs,t.attrs)&&ef(this.spec,t.spec)};var sf=function(t,e,n){this.from=t,this.to=e,this.type=n},af={spec:{configurable:!0},inline:{configurable:!0}};sf.prototype.copy=function(t,e){return new sf(t,e,this.type)},sf.prototype.eq=function(t,e){return void 0===e&&(e=0),this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to},sf.prototype.map=function(t,e,n){return this.type.map(t,this,e,n)},sf.widget=function(t,e,n){return new sf(t,t,new nf(e,n))},sf.inline=function(t,e,n,r){return new sf(t,e,new rf(n,r))},sf.node=function(t,e,n,r){return new sf(t,e,new of(n,r))},af.spec.get=function(){return this.type.spec},af.inline.get=function(){return this.type instanceof rf},Object.defineProperties(sf.prototype,af);var cf=[],uf={},lf=function(t,e){this.local=t&&t.length?t:cf,this.children=e&&e.length?e:cf};lf.create=function(t,e){return e.length?yf(e,t,0,uf):ff},lf.prototype.find=function(t,e,n){var r=[];return this.findInner(null==t?0:t,null==e?1e9:e,r,0,n),r},lf.prototype.findInner=function(t,e,n,r,o){for(var i=0;i<this.local.length;i++){var s=this.local[i];s.from<=e&&s.to>=t&&(!o||o(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(var a=0;a<this.children.length;a+=3)if(this.children[a]<e&&this.children[a+1]>t){var c=this.children[a]+1;this.children[a+2].findInner(t-c,e-c,n,r+c,o)}},lf.prototype.map=function(t,e,n){return this==ff||0==t.maps.length?this:this.mapInner(t,e,0,0,n||uf)},lf.prototype.mapInner=function(t,e,n,r,o){for(var i,s=0;s<this.local.length;s++){var a=this.local[s].map(t,n,r);a&&a.type.valid(e,a)?(i||(i=[])).push(a):o.onRemove&&o.onRemove(this.local[s].spec)}return this.children.length?function(t,e,n,r,o,i,s){for(var a=t.slice(),c=function(t,e,n,r){for(var s=0;s<a.length;s+=3){var c=a[s+1],u=void 0;-1==c||t>c+i||(e>=a[s]+i?a[s+1]=-1:n>=o&&(u=r-n-(e-t))&&(a[s]+=u,a[s+1]+=u))}},u=0;u<n.maps.length;u++)n.maps[u].forEach(c);for(var l=!1,f=0;f<a.length;f+=3)if(-1==a[f+1]){var h=n.map(t[f]+i),p=h-o;if(p<0||p>=r.content.size){l=!0;continue}var d=n.map(t[f+1]+i,-1)-o,v=r.content.findIndex(p),y=v.index,m=v.offset,g=r.maybeChild(y);if(g&&m==p&&m+g.nodeSize==d){var b=a[f+2].mapInner(n,g,h+1,t[f]+i+1,s);b!=ff?(a[f]=p,a[f+1]=d,a[f+2]=b):(a[f+1]=-2,l=!0)}else l=!0}if(l){var w=yf(function(t,e,n,r,o,i,s){function a(t,e){for(var i=0;i<t.local.length;i++){var c=t.local[i].map(r,o,e);c?n.push(c):s.onRemove&&s.onRemove(t.local[i].spec)}for(var u=0;u<t.children.length;u+=3)a(t.children[u+2],t.children[u]+e+1)}for(var c=0;c<t.length;c+=3)-1==t[c+1]&&a(t[c+2],e[c]+i+1);return n}(a,t,e||[],n,o,i,s),r,0,s);e=w.local;for(var k=0;k<a.length;k+=3)a[k+1]<0&&(a.splice(k,3),k-=3);for(var x=0,S=0;x<w.children.length;x+=3){for(var O=w.children[x];S<a.length&&a[S]<O;)S+=3;a.splice(S,0,w.children[x],w.children[x+1],w.children[x+2])}}return new lf(e&&e.sort(mf),a)}(this.children,i,t,e,n,r,o):i?new lf(i.sort(mf)):ff},lf.prototype.add=function(t,e){return e.length?this==ff?lf.create(t,e):this.addInner(t,e,0):this},lf.prototype.addInner=function(t,e,n){var r,o=this,i=0;t.forEach((function(t,s){var a,c=s+n;if(a=df(e,t,c)){for(r||(r=o.children.slice());i<r.length&&r[i]<s;)i+=3;r[i]==s?r[i+2]=r[i+2].addInner(t,a,c+1):r.splice(i,0,s,s+t.nodeSize,yf(a,t,c+1,uf)),i+=3}}));var s=pf(i?vf(e):e,-n);return new lf(s.length?this.local.concat(s).sort(mf):this.local,r||this.children)},lf.prototype.remove=function(t){return 0==t.length||this==ff?this:this.removeInner(t,0)},lf.prototype.removeInner=function(t,e){for(var n=this.children,r=this.local,o=0;o<n.length;o+=3){for(var i=void 0,s=n[o]+e,a=n[o+1]+e,c=0,u=void 0;c<t.length;c++)(u=t[c])&&u.from>s&&u.to<a&&(t[c]=null,(i||(i=[])).push(u));if(i){n==this.children&&(n=this.children.slice());var l=n[o+2].removeInner(i,s+1);l!=ff?n[o+2]=l:(n.splice(o,3),o-=3)}}if(r.length)for(var f=0,h=void 0;f<t.length;f++)if(h=t[f])for(var p=0;p<r.length;p++)r[p].eq(h,e)&&(r==this.local&&(r=this.local.slice()),r.splice(p--,1));return n==this.children&&r==this.local?this:r.length||n.length?new lf(r,n):ff},lf.prototype.forChild=function(t,e){if(this==ff)return this;if(e.isLeaf)return lf.empty;for(var n,r,o=0;o<this.children.length;o+=3)if(this.children[o]>=t){this.children[o]==t&&(n=this.children[o+2]);break}for(var i=t+1,s=i+e.content.size,a=0;a<this.local.length;a++){var c=this.local[a];if(c.from<s&&c.to>i&&c.type instanceof rf){var u=Math.max(i,c.from)-i,l=Math.min(s,c.to)-i;u<l&&(r||(r=[])).push(c.copy(u,l))}}if(r){var f=new lf(r.sort(mf));return n?new hf([f,n]):f}return n||ff},lf.prototype.eq=function(t){if(this==t)return!0;if(!(t instanceof lf)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(var e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(var n=0;n<this.children.length;n+=3)if(this.children[n]!=t.children[n]||this.children[n+1]!=t.children[n+1]||!this.children[n+2].eq(t.children[n+2]))return!1;return!0},lf.prototype.locals=function(t){return gf(this.localsInner(t))},lf.prototype.localsInner=function(t){if(this==ff)return cf;if(t.inlineContent||!this.local.some(rf.is))return this.local;for(var e=[],n=0;n<this.local.length;n++)this.local[n].type instanceof rf||e.push(this.local[n]);return e};var ff=new lf;lf.empty=ff,lf.removeOverlap=gf;var hf=function(t){this.members=t};function pf(t,e){if(!e||!t.length)return t;for(var n=[],r=0;r<t.length;r++){var o=t[r];n.push(new sf(o.from+e,o.to+e,o.type))}return n}function df(t,e,n){if(e.isLeaf)return null;for(var r=n+e.nodeSize,o=null,i=0,s=void 0;i<t.length;i++)(s=t[i])&&s.from>n&&s.to<r&&((o||(o=[])).push(s),t[i]=null);return o}function vf(t){for(var e=[],n=0;n<t.length;n++)null!=t[n]&&e.push(t[n]);return e}function yf(t,e,n,r){var o=[],i=!1;e.forEach((function(e,s){var a=df(t,e,s+n);if(a){i=!0;var c=yf(a,e,n+s+1,r);c!=ff&&o.push(s,s+e.nodeSize,c)}}));for(var s=pf(i?vf(t):t,-n).sort(mf),a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||o.length?new lf(s,o):ff}function mf(t,e){return t.from-e.from||t.to-e.to}function gf(t){for(var e=t,n=0;n<e.length-1;n++){var r=e[n];if(r.from!=r.to)for(var o=n+1;o<e.length;o++){var i=e[o];if(i.from!=r.from){i.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,i.from),bf(e,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(e==t&&(e=t.slice()),e[o]=i.copy(i.from,r.to),bf(e,o+1,i.copy(r.to,i.to)))}}return e}function bf(t,e,n){for(;e<t.length&&mf(n,t[e])>0;)e++;t.splice(e,0,n)}function wf(t){var e=[];return t.someProp("decorations",(function(n){var r=n(t.state);r&&r!=ff&&e.push(r)})),t.cursorWrapper&&e.push(lf.create(t.state.doc,[t.cursorWrapper.deco])),hf.from(e)}hf.prototype.forChild=function(t,e){if(e.isLeaf)return lf.empty;for(var n=[],r=0;r<this.members.length;r++){var o=this.members[r].forChild(t,e);o!=ff&&(o instanceof hf?n=n.concat(o.members):n.push(o))}return hf.from(n)},hf.prototype.eq=function(t){if(!(t instanceof hf)||t.members.length!=this.members.length)return!1;for(var e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0},hf.prototype.locals=function(t){for(var e,n=!0,r=0;r<this.members.length;r++){var o=this.members[r].localsInner(t);if(o.length)if(e){n&&(e=e.slice(),n=!1);for(var i=0;i<o.length;i++)e.push(o[i])}else e=o}return e?gf(n?e:e.sort(mf)):cf},hf.from=function(t){switch(t.length){case 0:return ff;case 1:return t[0];default:return new hf(t)}};var kf=function(t,e){this._props=e,this.state=e.state,this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.trackWrites=null,this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):t.apply?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=Cf(this),this.markCursor=null,this.cursorWrapper=null,Of(this),this.nodeViews=Ef(this),this.docView=Mu(this.state.doc,Sf(this),wf(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,function(t){t.shiftKey=!1,t.mouseDown=null,t.lastKeyCode=null,t.lastKeyCodeTime=0,t.lastClick={time:0,x:0,y:0,type:""},t.lastSelectionOrigin=null,t.lastSelectionTime=0,t.lastIOSEnter=0,t.lastIOSEnterFallbackTimeout=null,t.composing=!1,t.composingTimeout=null,t.compositionNodes=[],t.compositionEndedAt=-2e8,t.domObserver=new Tl(t,(function(e,n,r,o){return dl(t,e,n,r,o)})),t.domObserver.start(),t.domChangeCount=0,t.eventHandlers=Object.create(null);var e=function(e){var n=Al[e];t.dom.addEventListener(e,t.eventHandlers[e]=function(e){!function(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(var n=e.target;n!=t.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}(t,e)||Rl(t,e)||!t.editable&&e.type in Il||n(t,e)})};for(var n in Al)e(n);Pc.safari&&t.dom.addEventListener("input",(function(){return null})),Dl(t)}(this),this.pluginViews=[],this.updatePluginViews()},xf={props:{configurable:!0},root:{configurable:!0}};function Sf(t){var e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",(function(n){if("function"==typeof n&&(n=n(t.state)),n)for(var r in n)"class"==r?e.class+=" "+n[r]:e[r]||"contenteditable"==r||"nodeName"==r||(e[r]=String(n[r]))})),[sf.node(0,t.state.doc.content.size,e)]}function Of(t){if(t.markCursor){var e=document.createElement("img");e.setAttribute("mark-placeholder","true"),t.cursorWrapper={dom:e,deco:sf.widget(t.state.selection.head,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function Cf(t){return!t.someProp("editable",(function(e){return!1===e(t.state)}))}function Ef(t){var e={};return t.someProp("nodeViews",(function(t){for(var n in t)Object.prototype.hasOwnProperty.call(e,n)||(e[n]=t[n])})),e}xf.props.get=function(){if(this._props.state!=this.state){var t=this._props;for(var e in this._props={},t)this._props[e]=t[e];this._props.state=this.state}return this._props},kf.prototype.update=function(t){t.handleDOMEvents!=this._props.handleDOMEvents&&Dl(this),this._props=t,this.updateStateInner(t.state,!0)},kf.prototype.setProps=function(t){var e={};for(var n in this._props)e[n]=this._props[n];for(var r in e.state=this.state,t)e[r]=t[r];this.update(e)},kf.prototype.updateState=function(t){this.updateStateInner(t,this.state.plugins!=t.plugins)},kf.prototype.updateStateInner=function(t,e){var n=this,r=this.state,o=!1,i=!1;if(t.storedMarks&&this.composing&&(Kl(this),i=!0),this.state=t,e){var s=Ef(this);(function(t,e){var n=0,r=0;for(var o in t){if(t[o]!=e[o])return!0;n++}for(var i in e)r++;return n!=r})(s,this.nodeViews)&&(this.nodeViews=s,o=!0),Dl(this)}this.editable=Cf(this),Of(this);var a=wf(this),c=Sf(this),u=e?"reset":t.scrollToSelection>r.scrollToSelection?"to selection":"preserve",l=o||!this.docView.matchesNode(t.doc,c,a);!l&&t.selection.eq(r.selection)||(i=!0);var f="preserve"==u&&i&&null==this.dom.style.overflowAnchor&&function(t){for(var e,n,r=t.dom.getBoundingClientRect(),o=Math.max(0,r.top),i=(r.left+r.right)/2,s=o+1;s<Math.min(innerHeight,r.bottom);s+=5){var a=t.root.elementFromPoint(i,s);if(a!=t.dom&&t.dom.contains(a)){var c=a.getBoundingClientRect();if(c.top>=o-20){e=a,n=c.top;break}}}return{refDOM:e,refTop:n,stack:ru(t.dom)}}(this);if(i){this.domObserver.stop();var h=l&&(Pc.ie||Pc.chrome)&&!this.composing&&!r.selection.empty&&!t.selection.empty&&function(t,e){var n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}(r.selection,t.selection);if(l){var p=Pc.chrome?this.trackWrites=this.root.getSelection().focusNode:null;!o&&this.docView.update(t.doc,c,a,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=Mu(t.doc,c,a,this.dom,this)),p&&!this.trackWrites&&(h=!0)}h||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&function(t){var e=t.docView.domFromPos(t.state.selection.anchor),n=t.root.getSelection();return Wc(e.node,e.offset,n.anchorNode,n.anchorOffset)}(this))?Vu(this,h):(Gu(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(r),"reset"==u)this.dom.scrollTop=0;else if("to selection"==u){var d=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",(function(t){return t(n)}))||(t.selection instanceof mc?nu(this,this.docView.domAfterPos(t.selection.from).getBoundingClientRect(),d):nu(this,this.coordsAtPos(t.selection.head,1),d))}else f&&function(t){var e=t.refDOM,n=t.refTop,r=t.stack,o=e?e.getBoundingClientRect().top:0;ou(r,0==o?0:o-n)}(f)},kf.prototype.destroyPluginViews=function(){for(var t;t=this.pluginViews.pop();)t.destroy&&t.destroy()},kf.prototype.updatePluginViews=function(t){if(t&&t.plugins==this.state.plugins)for(var e=0;e<this.pluginViews.length;e++){var n=this.pluginViews[e];n.update&&n.update(this,t)}else{this.destroyPluginViews();for(var r=0;r<this.state.plugins.length;r++){var o=this.state.plugins[r];o.spec.view&&this.pluginViews.push(o.spec.view(this))}}},kf.prototype.someProp=function(t,e){var n,r=this._props&&this._props[t];if(null!=r&&(n=e?e(r):r))return n;var o=this.state.plugins;if(o)for(var i=0;i<o.length;i++){var s=o[i].props[t];if(null!=s&&(n=e?e(s):s))return n}},kf.prototype.hasFocus=function(){return this.root.activeElement==this.dom},kf.prototype.focus=function(){this.domObserver.stop(),this.editable&&function(t){if(t.setActive)return t.setActive();if(iu)return t.focus(iu);var e=ru(t);t.focus(null==iu?{get preventScroll(){return iu={preventScroll:!0},!0}}:void 0),iu||(iu=!1,ou(e,0))}(this.dom),Vu(this),this.domObserver.start()},xf.root.get=function(){var t=this._root;if(null==t)for(var e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=function(){return document.getSelection()}),this._root=e;return t||document},kf.prototype.posAtCoords=function(t){return uu(this,t)},kf.prototype.coordsAtPos=function(t,e){return void 0===e&&(e=1),hu(this,t,e)},kf.prototype.domAtPos=function(t){return this.docView.domFromPos(t)},kf.prototype.nodeDOM=function(t){var e=this.docView.descAt(t);return e?e.nodeDOM:null},kf.prototype.posAtDOM=function(t,e,n){void 0===n&&(n=-1);var r=this.docView.posFromDOM(t,e,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r},kf.prototype.endOfTextblock=function(t,e){return wu(this,e||this.state,t)},kf.prototype.destroy=function(){this.docView&&(!function(t){for(var e in t.domObserver.stop(),t.eventHandlers)t.dom.removeEventListener(e,t.eventHandlers[e]);clearTimeout(t.composingTimeout),clearTimeout(t.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],wf(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},kf.prototype.dispatchEvent=function(t){return function(t,e){Rl(t,e)||!Al[e.type]||!t.editable&&e.type in Il||Al[e.type](t,e)}(this,t)},kf.prototype.dispatch=function(t){var e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))},Object.defineProperties(kf.prototype,xf);var _f=function(t){function e(e){t.call(this,e,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));return e.valid(o)?new e(o):t.near(o)},e.prototype.content=function(){return ia.empty},e.prototype.eq=function(t){return t instanceof e&&t.head==this.head},e.prototype.toJSON=function(){return{type:"gapcursor",pos:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new e(t.resolve(n.pos))},e.prototype.getBookmark=function(){return new Mf(this.anchor)},e.valid=function(t){var e=t.parent;if(e.isTextblock||!function(t){for(var e=t.depth;e>=0;e--){var n=t.index(e);if(0!=n)for(var r=t.node(e).child(n-1);;r=r.lastChild){if(0==r.childCount&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}}return!0}(t)||!function(t){for(var e=t.depth;e>=0;e--){var n=t.indexAfter(e),r=t.node(e);if(n!=r.childCount)for(var o=r.child(n);;o=o.firstChild){if(0==o.childCount&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}}return!0}(t))return!1;var n=e.type.spec.allowGapCursor;if(null!=n)return n;var r=e.contentMatchAt(t.index()).defaultType;return r&&r.isTextblock},e.findFrom=function(t,n,r){t:for(;;){if(!r&&e.valid(t))return t;for(var o=t.pos,i=null,s=t.depth;;s--){var a=t.node(s);if(n>0?t.indexAfter(s)<a.childCount:t.index(s)>0){i=a.child(n>0?t.indexAfter(s):t.index(s)-1);break}if(0==s)return null;o+=n;var c=t.doc.resolve(o);if(e.valid(c))return c}for(;;){var u=n>0?i.firstChild:i.lastChild;if(!u){if(i.isAtom&&!i.isText&&!mc.isSelectable(i)){t=t.doc.resolve(o+i.nodeSize*n),r=!1;continue t}break}i=u,o+=n;var l=t.doc.resolve(o);if(e.valid(l))return l}return null}},e}(hc);_f.prototype.visible=!1,hc.jsonID("gapcursor",_f);var Mf=function(t){this.pos=t};Mf.prototype.map=function(t){return new Mf(t.map(this.pos))},Mf.prototype.resolve=function(t){var e=t.resolve(this.pos);return _f.valid(e)?new _f(e):hc.near(e)};var Tf=Object(r.a)({ArrowLeft:Nf("horiz",-1),ArrowRight:Nf("horiz",1),ArrowUp:Nf("vert",-1),ArrowDown:Nf("vert",1)});function Nf(t,e){var n="vert"==t?e>0?"down":"up":e>0?"right":"left";return function(t,r,o){var i=t.selection,s=e>0?i.$to:i.$from,a=i.empty;if(i instanceof vc){if(!o.endOfTextblock(n)||0==s.depth)return!1;a=!1,s=t.doc.resolve(e>0?s.after():s.before())}var c=_f.findFrom(s,e,a);return!!c&&(r&&r(t.tr.setSelection(new _f(c))),!0)}}function Af(t,e,n){if(!t.editable)return!1;var r=t.state.doc.resolve(e);if(!_f.valid(r))return!1;var o=t.posAtCoords({left:n.clientX,top:n.clientY}).inside;return!(o>-1&&mc.isSelectable(t.state.doc.nodeAt(o)))&&(t.dispatch(t.state.tr.setSelection(new _f(r))),!0)}function If(t){if(!(t.selection instanceof _f))return null;var e=document.createElement("div");return e.className="ProseMirror-gapcursor",lf.create(t.doc,[sf.widget(t.selection.head,e,{key:"gapcursor"})])}function jf(){var t=arguments[0];"string"==typeof t&&(t=document.createElement(t));var e=1,n=arguments[1];if(n&&"object"==typeof n&&null==n.nodeType&&!Array.isArray(n)){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=n[r];"string"==typeof o?t.setAttribute(r,o):null!=o&&(t[r]=o)}e++}for(;e<arguments.length;e++)Df(t,arguments[e]);return t}function Df(t,e){if("string"==typeof e)t.appendChild(document.createTextNode(e));else if(null==e);else if(null!=e.nodeType)t.appendChild(e);else{if(!Array.isArray(e))throw new RangeError("Unsupported child node: "+e);for(var n=0;n<e.length;n++)Df(t,e[n])}}function Rf(t,e,n){for(var r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;var o=t.child(r),i=e.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(var s=0;o.text[s]==i.text[s];s++)n++;return n}if(o.content.size||i.content.size){var a=Rf(o.content,i.content,n+1);if(null!=a)return a}n+=o.nodeSize}else n+=o.nodeSize}}function Pf(t,e,n,r){for(var o=t.childCount,i=e.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};var s=t.child(--o),a=e.child(--i),c=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){for(var u=0,l=Math.min(s.text.length,a.text.length);u<l&&s.text[s.text.length-u-1]==a.text[a.text.length-u-1];)u++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){var f=Pf(s.content,a.content,n-1,r-1);if(f)return f}n-=c,r-=c}else n-=c,r-=c}}var zf=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},Ff={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};zf.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var u=s+1;a.nodesBetween(Math.max(0,t-u),Math.min(a.content.size,e-u),n,r+u)}s=c}},zf.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},zf.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},zf.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new zf(r,this.size+t.size)},zf.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var o=0,i=0;i<e;o++){var s=this.content[o],a=i+s.nodeSize;a>t&&((i<t||a>e)&&(s=s.isText?s.cut(Math.max(0,t-i),Math.min(s.text.length,e-i)):s.cut(Math.max(0,t-i-1),Math.min(s.content.size,e-i-1))),n.push(s),r+=s.nodeSize),i=a}return new zf(n,r)},zf.prototype.cutByIndex=function(t,e){return t==e?zf.empty:0==t&&e==this.content.length?this:new zf(this.content.slice(t,e))},zf.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new zf(r,o)},zf.prototype.addToStart=function(t){return new zf([t].concat(this.content),this.size+t.nodeSize)},zf.prototype.addToEnd=function(t){return new zf(this.content.concat(t),this.size+t.nodeSize)},zf.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},Ff.firstChild.get=function(){return this.content.length?this.content[0]:null},Ff.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},Ff.childCount.get=function(){return this.content.length},zf.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},zf.prototype.maybeChild=function(t){return this.content[t]},zf.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},zf.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),Rf(this,t,e)},zf.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),Pf(this,t,e,n)},zf.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return Lf(0,t);if(t==this.size)return Lf(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?Lf(n+1,o):Lf(n,r);r=o}},zf.prototype.toString=function(){return"<"+this.toStringInner()+">"},zf.prototype.toStringInner=function(){return this.content.join(", ")},zf.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},zf.fromJSON=function(t,e){if(!e)return zf.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new zf(e.map(t.nodeFromJSON))},zf.fromArray=function(t){if(!t.length)return zf.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new zf(e||t,n)},zf.from=function(t){if(!t)return zf.empty;if(t instanceof zf)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new zf([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(zf.prototype,Ff);var Bf={index:0,offset:0};function Lf(t,e){return Bf.index=t,Bf.offset=e,Bf}function $f(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!$f(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e)||!$f(t[o],e[o]))return!1;for(var i in e)if(!(i in t))return!1}return!0}zf.empty=new zf([],0);var qf=function(t,e){this.type=t,this.attrs=e};function Jf(t){var e=Error.call(this,t);return e.__proto__=Jf.prototype,e}qf.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},qf.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},qf.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},qf.prototype.eq=function(t){return this==t||this.type==t.type&&$f(this.attrs,t.attrs)},qf.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},qf.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},qf.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},qf.setFrom=function(t){if(!t||0==t.length)return qf.none;if(t instanceof qf)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},qf.none=[],Jf.prototype=Object.create(Error.prototype),Jf.prototype.constructor=Jf,Jf.prototype.name="ReplaceError";var Uf=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},Vf={size:{configurable:!0}};function Wf(t,e,n){var r=t.findIndex(e),o=r.index,i=r.offset,s=t.maybeChild(o),a=t.findIndex(n),c=a.index,u=a.offset;if(i==e||s.isText){if(u!=n&&!t.child(c).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return t.replaceChild(o,s.copy(Wf(s.content,e-i-1,n-i-1)))}function Hf(t,e,n,r){var o=t.findIndex(e),i=o.index,s=o.offset,a=t.maybeChild(i);if(s==e||a.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));var c=Hf(a.content,e-s-1,n);return c&&t.replaceChild(i,a.copy(c))}function Kf(t,e,n){if(n.openStart>t.depth)throw new Jf("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Jf("Inconsistent open depths");return Yf(t,e,n,0)}function Yf(t,e,n,r){var o=t.index(r),i=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){var s=Yf(t,e,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){var a=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(zf.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(n,t);return th(i,eh(t,a.start,a.end,e,r))}var c=t.parent,u=c.content;return th(c,u.cut(0,t.parentOffset).append(n.content).append(u.cut(e.parentOffset)))}return th(i,nh(t,e,r))}function Gf(t,e){if(!e.type.compatibleContent(t.type))throw new Jf("Cannot join "+e.type.name+" onto "+t.type.name)}function Qf(t,e,n){var r=t.node(n);return Gf(r,e.node(n)),r}function Xf(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Zf(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(Xf(t.nodeAfter,r),i++));for(var a=i;a<s;a++)Xf(o.child(a),r);e&&e.depth==n&&e.textOffset&&Xf(e.nodeBefore,r)}function th(t,e){if(!t.type.validContent(e))throw new Jf("Invalid content for node "+t.type.name);return t.copy(e)}function eh(t,e,n,r,o){var i=t.depth>o&&Qf(t,e,o+1),s=r.depth>o&&Qf(n,r,o+1),a=[];return Zf(null,t,o,a),i&&s&&e.index(o)==n.index(o)?(Gf(i,s),Xf(th(i,eh(t,e,n,r,o+1)),a)):(i&&Xf(th(i,nh(t,e,o+1)),a),Zf(e,n,o,a),s&&Xf(th(s,nh(n,r,o+1)),a)),Zf(r,null,o,a),new zf(a)}function nh(t,e,n){var r=[];(Zf(null,t,n,r),t.depth>n)&&Xf(th(Qf(t,e,n+1),nh(t,e,n+1)),r);return Zf(e,null,n,r),new zf(r)}Vf.size.get=function(){return this.content.size-this.openStart-this.openEnd},Uf.prototype.insertAt=function(t,e){var n=Hf(this.content,t+this.openStart,e,null);return n&&new Uf(n,this.openStart,this.openEnd)},Uf.prototype.removeBetween=function(t,e){return new Uf(Wf(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},Uf.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},Uf.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},Uf.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},Uf.fromJSON=function(t,e){if(!e)return Uf.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new Uf(zf.fromJSON(t,e.content),n,r)},Uf.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new Uf(t,n,r)},Object.defineProperties(Uf.prototype,Vf),Uf.empty=new Uf(zf.empty,0,0);var rh=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},oh={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};rh.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},oh.parent.get=function(){return this.node(this.depth)},oh.doc.get=function(){return this.node(0)},rh.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},rh.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},rh.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},rh.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},rh.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},rh.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},rh.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},oh.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},oh.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},oh.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},rh.prototype.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,o=0;o<t;o++)r+=n.child(o).nodeSize;return r},rh.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return qf.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},rh.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},rh.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},rh.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new ch(this,t,n)},rh.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},rh.prototype.max=function(t){return t.pos>this.pos?t:this},rh.prototype.min=function(t){return t.pos<this.pos?t:this},rh.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},rh.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,u=o-c;if(n.push(i,a,r+c),!u)break;if((i=i.child(a)).isText)break;o=u-1,r+=c+1}return new rh(e,n,o)},rh.resolveCached=function(t,e){for(var n=0;n<ih.length;n++){var r=ih[n];if(r.pos==e&&r.doc==t)return r}var o=ih[sh]=rh.resolve(t,e);return sh=(sh+1)%ah,o},Object.defineProperties(rh.prototype,oh);var ih=[],sh=0,ah=12,ch=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},uh={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};uh.start.get=function(){return this.$from.before(this.depth+1)},uh.end.get=function(){return this.$to.after(this.depth+1)},uh.parent.get=function(){return this.$from.node(this.depth)},uh.startIndex.get=function(){return this.$from.index(this.depth)},uh.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(ch.prototype,uh);var lh=Object.create(null),fh=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||zf.empty,this.marks=r||qf.none},hh={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};hh.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},hh.childCount.get=function(){return this.content.childCount},fh.prototype.child=function(t){return this.content.child(t)},fh.prototype.maybeChild=function(t){return this.content.maybeChild(t)},fh.prototype.forEach=function(t){this.content.forEach(t)},fh.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},fh.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},hh.textContent.get=function(){return this.textBetween(0,this.content.size,"")},fh.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},hh.firstChild.get=function(){return this.content.firstChild},hh.lastChild.get=function(){return this.content.lastChild},fh.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},fh.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},fh.prototype.hasMarkup=function(t,e,n){return this.type==t&&$f(this.attrs,e||t.defaultAttrs||lh)&&qf.sameSet(this.marks,n||qf.none)},fh.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},fh.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},fh.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},fh.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return Uf.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new Uf(a,r.depth-i,o.depth-i)},fh.prototype.replace=function(t,e,n){return Kf(this.resolve(t),this.resolve(e),n)},fh.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},fh.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},fh.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},fh.prototype.resolve=function(t){return rh.resolveCached(this,t)},fh.prototype.resolveNoCache=function(t){return rh.resolve(this,t)},fh.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},hh.isBlock.get=function(){return this.type.isBlock},hh.isTextblock.get=function(){return this.type.isTextblock},hh.inlineContent.get=function(){return this.type.inlineContent},hh.isInline.get=function(){return this.type.isInline},hh.isText.get=function(){return this.type.isText},hh.isLeaf.get=function(){return this.type.isLeaf},hh.isAtom.get=function(){return this.type.isAtom},fh.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),dh(this.marks,t)},fh.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},fh.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=zf.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,e);if(!s||!s.validEnd)return!1;for(var a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0},fh.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},fh.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},fh.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},fh.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},fh.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=zf.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(fh.prototype,hh);var ph=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):dh(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(fh);function dh(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var vh=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},yh={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};vh.parse=function(t,e){var n=new mh(t,e);if(null==n.next)return vh.empty;var r=bh(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return n(Ch(t,0));function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];Ch(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new vh(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(Oh);i.next.push(o[s],e[a.join(",")]||n(a))}return i}}(function(t){var e=[[]];return o(i(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}function i(t,e){if("choice"==t.type)return t.exprs.reduce((function(t,n){return t.concat(i(n,e))}),[]);if("seq"==t.type)for(var s=0;;s++){var a=i(t.exprs[s],e);if(s==t.exprs.length-1)return a;o(a,e=n())}else{if("star"==t.type){var c=n();return r(e,c),o(i(t.expr,c),c),[r(c)]}if("plus"==t.type){var u=n();return o(i(t.expr,e),u),o(i(t.expr,u),u),[r(u)]}if("opt"==t.type)return[r(e)].concat(i(t.expr,e));if("range"==t.type){for(var l=e,f=0;f<t.min;f++){var h=n();o(i(t.expr,l),h),l=h}if(-1==t.max)o(i(t.expr,l),l);else for(var p=t.min;p<t.max;p++){var d=n();r(l,d),o(i(t.expr,l),d),l=d}return[r(l)]}if("name"==t.type)return[r(e,null,t.value)]}}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],u=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(u)&&r.push(u)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},vh.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},vh.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},yh.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},yh.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},vh.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},vh.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,s){var a=i.matchFragment(t,n);if(a&&(!e||a.validEnd))return zf.from(s.map((function(t){return t.createAndFill()})));for(var c=0;c<i.next.length;c+=2){var u=i.next[c],l=i.next[c+1];if(!u.isText&&!u.hasRequiredAttrs()&&-1==r.indexOf(l)){r.push(l);var f=o(l,s.concat(u));if(f)return f}}}(this,[])},vh.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},vh.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},yh.edgeCount.get=function(){return this.next.length>>1},vh.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},vh.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(vh.prototype,yh),vh.empty=new vh(!0);var mh=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},gh={next:{configurable:!0}};function bh(t){var e=[];do{e.push(wh(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function wh(t){var e=[];do{e.push(kh(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function kh(t){for(var e=function(t){if(t.eat("(")){var e=bh(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=Sh(t,e)}return e}function xh(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function Sh(t,e){var n=xh(t),r=n;return t.eat(",")&&(r="}"!=t.next?xh(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function Oh(t,e){return e-t}function Ch(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(Oh)}function Eh(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function _h(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function Mh(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new Ah(t[n]);return e}gh.next.get=function(){return this.tokens[this.pos]},mh.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},mh.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(mh.prototype,gh);var Th=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=Mh(n.attrs),this.defaultAttrs=Eh(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},Nh={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Nh.isInline.get=function(){return!this.isBlock},Nh.isTextblock.get=function(){return this.isBlock&&this.inlineContent},Nh.isLeaf.get=function(){return this.contentMatch==vh.empty},Nh.isAtom.get=function(){return this.isLeaf||this.spec.atom},Th.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},Th.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},Th.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:_h(this.attrs,t)},Th.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new fh(this,this.computeAttrs(t),zf.from(e),qf.setFrom(n))},Th.prototype.createChecked=function(t,e,n){if(e=zf.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new fh(this,this.computeAttrs(t),e,qf.setFrom(n))},Th.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=zf.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e).fillBefore(zf.empty,!0);return o?new fh(this,t,e.append(o),qf.setFrom(n)):null},Th.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},Th.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},Th.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},Th.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:qf.empty:t},Th.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new Th(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(Th.prototype,Nh);var Ah=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},Ih={isRequired:{configurable:!0}};Ih.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(Ah.prototype,Ih);var jh=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=Mh(r.attrs),this.rank=e,this.excluded=null;var o=Eh(this.attrs);this.instance=o&&new qf(this,o)};jh.prototype.create=function(t){return!t&&this.instance?this.instance:new qf(this,_h(this.attrs,t))},jh.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new jh(t,r++,e,o)})),n},jh.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},jh.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},jh.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var Dh=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=l.a.from(t.nodes),this.spec.marks=l.a.from(t.marks),this.nodes=Th.compile(this.spec.nodes,this),this.marks=jh.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],i=o.spec.content||"",s=o.spec.marks;o.contentMatch=n[i]||(n[i]=vh.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==s?null:s?Rh(this,s.split(" ")):""!=s&&o.inlineContent?null:[]}for(var a in this.marks){var c=this.marks[a],u=c.spec.excludes;c.excluded=null==u?[c]:""==u?[]:Rh(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function Rh(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}Dh.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof Th))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},Dh.prototype.text=function(t,e){var n=this.nodes.text;return new ph(n,n.defaultAttrs,t,qf.setFrom(e))},Dh.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},Dh.prototype.nodeFromJSON=function(t){return fh.fromJSON(this,t)},Dh.prototype.markFromJSON=function(t){return qf.fromJSON(this,t)},Dh.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var Ph=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)})),this.normalizeLists=!this.tags.some((function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)}))};Ph.prototype.parse=function(t,e){void 0===e&&(e={});var n=new qh(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},Ph.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new qh(this,e,!0);return n.addAll(t,null,e.from,e.to),Uf.maxOpen(n.finish())},Ph.prototype.matchTag=function(t,e,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(Uh(t,o.tag)&&(void 0===o.namespace||t.namespaceURI==o.namespace)&&(!o.context||e.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(t);if(!1===i)continue;o.attrs=i}return o}}},Ph.prototype.matchStyle=function(t,e,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(t)||i.context&&!n.matchesContext(i.context)||i.style.length>t.length&&(61!=i.style.charCodeAt(t.length)||i.style.slice(t.length+1)!=e))){if(i.getAttrs){var s=i.getAttrs(e);if(!1===s)continue;i.attrs=s}return i}}},Ph.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=Vh(t)),t.mark=e}))};for(var o in t.marks)r(o);var i=function(e){var r=t.nodes[s].spec.parseDOM;r&&r.forEach((function(t){n(t=Vh(t)),t.node=s}))};for(var s in t.nodes)i();return e},Ph.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new Ph(t,Ph.schemaRules(t)))};var zh={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Fh={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Bh={ol:!0,ul:!0};function Lh(t){return(t?1:0)|("full"===t?2:0)}var $h=function(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=qf.none,this.pendingMarks=r,this.stashMarks=[]};$h.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(zf.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},$h.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=zf.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(zf.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},$h.prototype.popFromStashMark=function(t){for(var e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]},$h.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):Wh(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}};var qh=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,i=Lh(e.preserveWhitespace)|(n?4:0);r=o?new $h(o.type,o.attrs,qf.none,qf.none,!0,e.topMatch||o.type.contentMatch,i):new $h(n?null:t.schema.topNodeType,null,qf.none,qf.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},Jh={top:{configurable:!0},currentPos:{configurable:!0}};function Uh(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Vh(t){var e={};for(var n in t)e[n]=t[n];return e}function Wh(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var i=[];return function t(n){i.push(n);for(var r=0;r<n.edgeCount;r++){var o=n.edge(r),s=o.type,a=o.next;if(s==e)return!0;if(i.indexOf(a)<0&&t(a))return!0}}(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}Jh.top.get=function(){return this.nodes[this.open]},qh.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},qh.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},qh.prototype.addElement=function(t,e){var n,r=t.nodeName.toLowerCase();Bh.hasOwnProperty(r)&&this.parser.normalizeLists&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&Bh.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var o=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(n=this.parser.matchTag(t,this,e));if(o?o.ignore:Fh.hasOwnProperty(r))this.findInside(t);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(t=o.skip);var i,s=this.top,a=this.needsBlock;if(zh.hasOwnProperty(r))i=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),i&&this.sync(s),this.needsBlock=a}else this.addElementByRule(t,o,!1===o.consuming?n:null)},qh.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},qh.prototype.readStyles=function(t){var e=qf.none;t:for(var n=0;n<t.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(t[n],t[n+1],this,r);if(!o)continue t;if(o.ignore)return null;if(e=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(e),!1!==o.consuming)break;r=o}return e},qh.prototype.addElementByRule=function(t,e,n){var r,o,i,s=this;e.node?(o=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(o.create(e.attrs))||this.leafFallback(t):r=this.enter(o,e.attrs,e.preserveWhitespace):(i=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(i));var a=this.top;if(o&&o.isLeaf)this.findInside(t);else if(n)this.addElement(t,n);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return s.insertNode(t)}));else{var c=e.contentElement;"string"==typeof c?c=t.querySelector(c):"function"==typeof c&&(c=c(t)),c||(c=t),this.findAround(t,c,!0),this.addAll(c,r)}r&&(this.sync(a),this.open--),i&&this.removePendingMark(i,a)},qh.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&zh.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},qh.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},qh.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},qh.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},qh.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:Lh(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new $h(t,e,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},qh.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},qh.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},qh.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},Jh.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},qh.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},qh.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},qh.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},qh.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},qh.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1);return function t(s,a){for(;s>=0;s--){var c=n[s];if(""==c){if(s==n.length-1||0==s)continue;for(;a>=i;a--)if(t(s-1,a))return!0;return!1}var u=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!u||u.name!=c&&-1==u.groups.indexOf(c))return!1;a--}return!0}(n.length-1,this.open)},qh.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},qh.prototype.addPendingMark=function(t){var e=function(t,e){for(var n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},qh.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(t)>-1)r.pendingMarks=t.removeFromSet(r.pendingMarks);else{r.activeMarks=t.removeFromSet(r.activeMarks);var o=r.popFromStashMark(t);o&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==e)break}},Object.defineProperties(qh.prototype,Jh);var Hh=function(t,e){this.nodes=t||{},this.marks=e||{}};function Kh(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Yh(t){return t.document||window.document}Hh.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=Yh(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],u=r.serializeMark(c,t.isInline,e);u&&(i.push(c,o),o.appendChild(u.dom),o=u.contentDOM||u.dom)}}o.appendChild(r.serializeNode(t,e))})),n},Hh.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=Hh.renderSpec(Yh(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},Hh.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},Hh.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&Hh.renderSpec(Yh(n),r(t,e))},Hh.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var u in c=2,a)if(null!=a[u]){var l=u.indexOf(" ");l>0?s.setAttributeNS(u.slice(0,l),u.slice(l+1),a[u]):s.setAttribute(u,a[u])}for(var f=c;f<e.length;f++){var h=e[f];if(0===h){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var p=Hh.renderSpec(t,h,n),d=p.dom,v=p.contentDOM;if(s.appendChild(d),v){if(i)throw new RangeError("Multiple content holes");i=v}}return{dom:s,contentDOM:i}},Hh.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new Hh(this.nodesFromSchema(t),this.marksFromSchema(t)))},Hh.nodesFromSchema=function(t){var e=Kh(t.nodes);return e.text||(e.text=function(t){return t.text}),e},Hh.marksFromSchema=function(t){return Kh(t.marks)};var Gh=Object.create(null),Qh=function(t,e,n){this.ranges=n||[new Zh(t.min(e),t.max(e))],this.$anchor=t,this.$head=e},Xh={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};Xh.anchor.get=function(){return this.$anchor.pos},Xh.head.get=function(){return this.$head.pos},Xh.from.get=function(){return this.$from.pos},Xh.to.get=function(){return this.$to.pos},Xh.$from.get=function(){return this.ranges[0].$from},Xh.$to.get=function(){return this.ranges[0].$to},Xh.empty.get=function(){for(var t=this.ranges,e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0},Qh.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},Qh.prototype.replace=function(t,e){void 0===e&&(e=Uf.empty);for(var n=e.content.lastChild,r=null,o=0;o<e.openEnd;o++)r=n,n=n.lastChild;for(var i=t.steps.length,s=this.ranges,a=0;a<s.length;a++){var c=s[a],u=c.$from,l=c.$to,f=t.mapping.slice(i);t.replaceRange(f.map(u.pos),f.map(l.pos),a?Uf.empty:e),0==a&&ap(t,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}},Qh.prototype.replaceWith=function(t,e){for(var n=t.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],s=i.$from,a=i.$to,c=t.mapping.slice(n),u=c.map(s.pos),l=c.map(a.pos);o?t.deleteRange(u,l):(t.replaceRangeWith(u,l,e),ap(t,n,e.isInline?-1:1))}},Qh.findFrom=function(t,e,n){var r=t.parent.inlineContent?new tp(t):sp(t.node(0),t.parent,t.pos,t.index(),e,n);if(r)return r;for(var o=t.depth-1;o>=0;o--){var i=e<0?sp(t.node(0),t.node(o),t.before(o+1),t.index(o),e,n):sp(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,e,n);if(i)return i}},Qh.near=function(t,e){return void 0===e&&(e=1),this.findFrom(t,e)||this.findFrom(t,-e)||new op(t.node(0))},Qh.atStart=function(t){return sp(t,t,0,0,1)||new op(t)},Qh.atEnd=function(t){return sp(t,t,t.content.size,t.childCount,-1)||new op(t)},Qh.fromJSON=function(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=Gh[e.type];if(!n)throw new RangeError("No selection type "+e.type+" defined");return n.fromJSON(t,e)},Qh.jsonID=function(t,e){if(t in Gh)throw new RangeError("Duplicate use of selection JSON ID "+t);return Gh[t]=e,e.prototype.jsonID=t,e},Qh.prototype.getBookmark=function(){return tp.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(Qh.prototype,Xh),Qh.prototype.visible=!0;var Zh=function(t,e){this.$from=t,this.$to=e},tp=function(t){function e(e,n){void 0===n&&(n=e),t.call(this,e,n)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},e.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));if(!o.parent.inlineContent)return t.near(o);var i=n.resolve(r.map(this.anchor));return new e(i.parent.inlineContent?i:o,o)},e.prototype.replace=function(e,n){if(void 0===n&&(n=Uf.empty),t.prototype.replace.call(this,e,n),n==Uf.empty){var r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head},e.prototype.getBookmark=function(){return new ep(this.anchor,this.head)},e.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(n.anchor),t.resolve(n.head))},e.create=function(t,e,n){void 0===n&&(n=e);var r=t.resolve(e);return new this(r,n==e?r:t.resolve(n))},e.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=i>=0?1:-1),!r.parent.inlineContent){var s=t.findFrom(r,o,!0)||t.findFrom(r,-o,!0);if(!s)return t.near(r,o);r=s.$head}return n.parent.inlineContent||(0==i||(n=(t.findFrom(n,-o,!0)||t.findFrom(n,o,!0)).$anchor).pos<r.pos!=i<0)&&(n=r),new e(n,r)},Object.defineProperties(e.prototype,n),e}(Qh);Qh.jsonID("text",tp);var ep=function(t,e){this.anchor=t,this.head=e};ep.prototype.map=function(t){return new ep(t.map(this.anchor),t.map(this.head))},ep.prototype.resolve=function(t){return tp.between(t.resolve(this.anchor),t.resolve(this.head))};var np=function(t){function e(e){var n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);t.call(this,e,r),this.node=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(n,r){var o=r.mapResult(this.anchor),i=o.deleted,s=o.pos,a=n.resolve(s);return i?t.near(a):new e(a)},e.prototype.content=function(){return new Uf(zf.from(this.node),0,0)},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor},e.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},e.prototype.getBookmark=function(){return new rp(this.anchor)},e.fromJSON=function(t,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(n.anchor))},e.create=function(t,e){return new this(t.resolve(e))},e.isSelectable=function(t){return!t.isText&&!1!==t.type.spec.selectable},e}(Qh);np.prototype.visible=!1,Qh.jsonID("node",np);var rp=function(t){this.anchor=t};rp.prototype.map=function(t){var e=t.mapResult(this.anchor),n=e.deleted,r=e.pos;return n?new ep(r,r):new rp(r)},rp.prototype.resolve=function(t){var e=t.resolve(this.anchor),n=e.nodeAfter;return n&&np.isSelectable(n)?new np(e):Qh.near(e)};var op=function(t){function e(e){t.call(this,e.resolve(0),e.resolve(e.content.size))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.replace=function(e,n){if(void 0===n&&(n=Uf.empty),n==Uf.empty){e.delete(0,e.doc.content.size);var r=t.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else t.prototype.replace.call(this,e,n)},e.prototype.toJSON=function(){return{type:"all"}},e.fromJSON=function(t){return new e(t)},e.prototype.map=function(t){return new e(t)},e.prototype.eq=function(t){return t instanceof e},e.prototype.getBookmark=function(){return ip},e}(Qh);Qh.jsonID("all",op);var ip={map:function(){return this},resolve:function(t){return new op(t)}};function sp(t,e,n,r,o,i){if(e.inlineContent)return tp.create(t,n);for(var s=r-(o>0?0:1);o>0?s<e.childCount:s>=0;s+=o){var a=e.child(s);if(a.isAtom){if(!i&&np.isSelectable(a))return np.create(t,n-(o<0?a.nodeSize:0))}else{var c=sp(t,a,n+o,o<0?a.childCount:0,o,i);if(c)return c}n+=a.nodeSize*o}}function ap(t,e,n){var r=t.steps.length-1;if(!(r<e)){var o,i=t.steps[r];if(i instanceof u.c||i instanceof u.b)t.mapping.maps[r].forEach((function(t,e,n,r){null==o&&(o=r)})),t.setSelection(Qh.near(t.doc.resolve(o),n))}}var cp=function(t){function e(e){t.call(this,e.doc),this.time=Date.now(),this.curSelection=e.selection,this.curSelectionFor=0,this.storedMarks=e.storedMarks,this.updated=0,this.meta=Object.create(null)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},e.prototype.setSelection=function(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return(1&this.updated)>0},e.prototype.setStoredMarks=function(t){return this.storedMarks=t,this.updated|=2,this},e.prototype.ensureMarks=function(t){return qf.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this},e.prototype.addStoredMark=function(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))},e.prototype.removeStoredMark=function(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(2&this.updated)>0},e.prototype.addStep=function(e,n){t.prototype.addStep.call(this,e,n),this.updated=-3&this.updated,this.storedMarks=null},e.prototype.setTime=function(t){return this.time=t,this},e.prototype.replaceSelection=function(t){return this.selection.replace(this,t),this},e.prototype.replaceSelectionWith=function(t,e){var n=this.selection;return!1!==e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||qf.none))),n.replaceWith(this,t),this},e.prototype.deleteSelection=function(){return this.selection.replace(this),this},e.prototype.insertText=function(t,e,n){void 0===n&&(n=e);var r=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();if(!t)return this.deleteRange(e,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(e);o=n==e?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(e,n,r.text(t,o)),this.selection.empty||this.setSelection(Qh.near(this.selection.$to)),this},e.prototype.setMeta=function(t,e){return this.meta["string"==typeof t?t:t.key]=e,this},e.prototype.getMeta=function(t){return this.meta["string"==typeof t?t:t.key]},n.isGeneric.get=function(){for(var t in this.meta)return!1;return!0},e.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(e.prototype,n),e}(u.d);function up(t,e){return e&&t?t.bind(e):t}var lp=function(t,e,n){this.name=t,this.init=up(e.init,n),this.apply=up(e.apply,n)},fp=[new lp("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new lp("selection",{init:function(t,e){return t.selection||Qh.atStart(e.doc)},apply:function(t){return t.selection}}),new lp("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new lp("scrollToSelection",{init:function(){return 0},apply:function(t,e){return t.scrolledIntoView?e+1:e}})],hp=function(t,e){var n=this;this.schema=t,this.fields=fp.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),e&&e.forEach((function(t){if(n.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");n.plugins.push(t),n.pluginsByKey[t.key]=t,t.spec.state&&n.fields.push(new lp(t.key,t.spec.state,t))}))},pp=function(t){this.config=t},dp={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};dp.schema.get=function(){return this.config.schema},dp.plugins.get=function(){return this.config.plugins},pp.prototype.apply=function(t){return this.applyTransaction(t).state},pp.prototype.filterTransaction=function(t,e){void 0===e&&(e=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=e){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,t,this))return!1}return!0},pp.prototype.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var e=[t],n=this.applyInner(t),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var s=this.config.plugins[i];if(s.spec.appendTransaction){var a=r?r[i].n:0,c=r?r[i].state:this,u=a<e.length&&s.spec.appendTransaction.call(s,a?e.slice(a):e,c,n);if(u&&n.filterTransaction(u,i)){if(u.setMeta("appendedTransaction",t),!r){r=[];for(var l=0;l<this.config.plugins.length;l++)r.push(l<i?{state:n,n:e.length}:{state:this,n:0})}e.push(u),n=n.applyInner(u),o=!0}r&&(r[i]={state:n,n:e.length})}}if(!o)return{state:n,transactions:e}}},pp.prototype.applyInner=function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var e=new pp(this.config),n=this.config.fields,r=0;r<n.length;r++){var o=n[r];e[o.name]=o.apply(t,this[o.name],this,e)}for(var i=0;i<vp.length;i++)vp[i](this,t,e);return e},dp.tr.get=function(){return new cp(this)},pp.create=function(t){for(var e=new hp(t.schema||t.doc.type.schema,t.plugins),n=new pp(e),r=0;r<e.fields.length;r++)n[e.fields[r].name]=e.fields[r].init(t,n);return n},pp.prototype.reconfigure=function(t){for(var e=new hp(t.schema||this.schema,t.plugins),n=e.fields,r=new pp(e),o=0;o<n.length;o++){var i=n[o].name;r[i]=this.hasOwnProperty(i)?this[i]:n[o].init(t,r)}return r},pp.prototype.toJSON=function(t){var e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map((function(t){return t.toJSON()}))),t&&"object"==typeof t)for(var n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=t[n],o=r.spec.state;o&&o.toJSON&&(e[n]=o.toJSON.call(r,this[r.key]))}return e},pp.fromJSON=function(t,e,n){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var r=new hp(t.schema,t.plugins),o=new pp(r);return r.fields.forEach((function(r){if("doc"==r.name)o.doc=fh.fromJSON(t.schema,e.doc);else if("selection"==r.name)o.selection=Qh.fromJSON(o.doc,e.selection);else if("storedMarks"==r.name)e.storedMarks&&(o.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(n)for(var i in n){var s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(e,i))return void(o[r.name]=a.fromJSON.call(s,t,e[i],o))}o[r.name]=r.init(t,o)}})),o},pp.addApplyListener=function(t){vp.push(t)},pp.removeApplyListener=function(t){var e=vp.indexOf(t);e>-1&&vp.splice(e,1)},Object.defineProperties(pp.prototype,dp);var vp=[];function yp(t,e,n){for(var r in t){var o=t[r];o instanceof Function?o=o.bind(e):"handleDOMEvents"==r&&(o=yp(o,e,{})),n[r]=o}return n}var mp=function(t){this.props={},t.props&&yp(t.props,this,this.props),this.spec=t,this.key=t.key?t.key.key:bp("plugin")};mp.prototype.getState=function(t){return t[this.key]};var gp=Object.create(null);function bp(t){return t in gp?t+"$"+ ++gp[t]:(gp[t]=0,t+"$")}var wp=function(t){void 0===t&&(t="key"),this.key=bp(t)};wp.prototype.get=function(t){return t.config.pluginsByKey[this.key]},wp.prototype.getState=function(t){return t[this.key]};var kp="http://www.w3.org/2000/svg",xp="ProseMirror-icon";function Sp(t){var e=document.createElement("div");if(e.className=xp,t.path){var n="pm-icon-"+function(t){for(var e=0,n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n)|0;return e}(t.path).toString(16);document.getElementById(n)||function(t,e){var n=document.getElementById(xp+"-collection");n||((n=document.createElementNS(kp,"svg")).id=xp+"-collection",n.style.display="none",document.body.insertBefore(n,document.body.firstChild));var r=document.createElementNS(kp,"symbol");r.id=t,r.setAttribute("viewBox","0 0 "+e.width+" "+e.height),r.appendChild(document.createElementNS(kp,"path")).setAttribute("d",e.path),n.appendChild(r)}(n,t);var r=e.appendChild(document.createElementNS(kp,"svg"));r.style.width=t.width/t.height+"em",r.appendChild(document.createElementNS(kp,"use")).setAttributeNS("http://www.w3.org/1999/xlink","href",/([^#]*)/.exec(document.location)[1]+"#"+n)}else t.dom?e.appendChild(t.dom.cloneNode(!0)):(e.appendChild(document.createElement("span")).textContent=t.text||"",t.css&&(e.firstChild.style.cssText=t.css));return e}var Op="ProseMirror-menu",Cp=function(t){this.spec=t};function Ep(t,e){return t._props.translate?t._props.translate(e):e}Cp.prototype.render=function(t){var e=this.spec,n=e.render?e.render(t):e.icon?Sp(e.icon):e.label?jf("div",null,Ep(t,e.label)):null;if(!n)throw new RangeError("MenuItem without icon or label property");if(e.title){var r="function"===typeof e.title?e.title(t.state):e.title;n.setAttribute("title",Ep(t,r))}return e.class&&n.classList.add(e.class),e.css&&(n.style.cssText+=e.css),n.addEventListener("mousedown",(function(r){r.preventDefault(),n.classList.contains(Op+"-disabled")||e.run(t.state,t.dispatch,t,r)})),{dom:n,update:function(t){if(e.select){var r=e.select(t);if(n.style.display=r?"":"none",!r)return!1}var o=!0;if(e.enable&&(o=e.enable(t)||!1,$p(n,Op+"-disabled",!o)),e.active){var i=o&&e.active(t)||!1;$p(n,Op+"-active",i)}return!0}}};var _p={time:0,node:null};function Mp(t){_p.time=Date.now(),_p.node=t.target}function Tp(t){return Date.now()-100<_p.time&&_p.node&&t.contains(_p.node)}var Np=function(t,e){this.options=e||{},this.content=Array.isArray(t)?t:[t]};function Ap(t,e){for(var n=[],r=[],o=0;o<t.length;o++){var i=t[o].render(e),s=i.dom,a=i.update;n.push(jf("div",{class:Op+"-dropdown-item"},s)),r.push(a)}return{dom:n,update:Ip(r,n)}}function Ip(t,e){return function(n){for(var r=!1,o=0;o<t.length;o++){var i=t[o](n);e[o].style.display=i?"":"none",i&&(r=!0)}return r}}Np.prototype.render=function(t){var e=this,n=Ap(this.content,t),r=jf("div",{class:Op+"-dropdown "+(this.options.class||""),style:this.options.css},Ep(t,this.options.label));this.options.title&&r.setAttribute("title",Ep(t,this.options.title));var o=jf("div",{class:Op+"-dropdown-wrap"},r),i=null,s=null,a=function(){i&&i.close()&&(i=null,window.removeEventListener("mousedown",s))};return r.addEventListener("mousedown",(function(t){t.preventDefault(),Mp(t),i?a():(i=e.expand(o,n.dom),window.addEventListener("mousedown",s=function(){Tp(o)||a()}))})),{dom:o,update:function(t){var e=n.update(t);return o.style.display=e?"":"none",e}}},Np.prototype.expand=function(t,e){var n=jf("div",{class:Op+"-dropdown-menu "+(this.options.class||"")},e),r=!1;return t.appendChild(n),{close:function(){if(!r)return r=!0,t.removeChild(n),!0},node:n}};var jp=function(t,e){this.options=e||{},this.content=Array.isArray(t)?t:[t]};jp.prototype.render=function(t){var e=Ap(this.content,t),n=jf("div",{class:Op+"-submenu-label"},Ep(t,this.options.label)),r=jf("div",{class:Op+"-submenu-wrap"},n,jf("div",{class:Op+"-submenu"},e.dom)),o=null;return n.addEventListener("mousedown",(function(t){t.preventDefault(),Mp(t),$p(r,Op+"-submenu-wrap-active"),o||window.addEventListener("mousedown",o=function(){Tp(r)||(r.classList.remove(Op+"-submenu-wrap-active"),window.removeEventListener("mousedown",o),o=null)})})),{dom:r,update:function(t){var n=e.update(t);return r.style.display=n?"":"none",n}}};var Dp={join:{width:800,height:900,path:"M0 75h800v125h-800z M0 825h800v-125h-800z M250 400h100v-100h100v100h100v100h-100v100h-100v-100h-100z"},lift:{width:1024,height:1024,path:"M219 310v329q0 7-5 12t-12 5q-8 0-13-5l-164-164q-5-5-5-13t5-13l164-164q5-5 13-5 7 0 12 5t5 12zM1024 749v109q0 7-5 12t-12 5h-987q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h987q7 0 12 5t5 12zM1024 530v109q0 7-5 12t-12 5h-621q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h621q7 0 12 5t5 12zM1024 310v109q0 7-5 12t-12 5h-621q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h621q7 0 12 5t5 12zM1024 91v109q0 7-5 12t-12 5h-987q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h987q7 0 12 5t5 12z"},selectParentNode:{text:"\u2b1a",css:"font-weight: bold"},undo:{width:1024,height:1024,path:"M761 1024c113-206 132-520-313-509v253l-384-384 384-384v248c534-13 594 472 313 775z"},redo:{width:1024,height:1024,path:"M576 248v-248l384 384-384 384v-253c-446-10-427 303-313 509-280-303-221-789 313-775z"},strong:{width:805,height:1024,path:"M317 869q42 18 80 18 214 0 214-191 0-65-23-102-15-25-35-42t-38-26-46-14-48-6-54-1q-41 0-57 5 0 30-0 90t-0 90q0 4-0 38t-0 55 2 47 6 38zM309 442q24 4 62 4 46 0 81-7t62-25 42-51 14-81q0-40-16-70t-45-46-61-24-70-8q-28 0-74 7 0 28 2 86t2 86q0 15-0 45t-0 45q0 26 0 39zM0 950l1-53q8-2 48-9t60-15q4-6 7-15t4-19 3-18 1-21 0-19v-37q0-561-12-585-2-4-12-8t-25-6-28-4-27-2-17-1l-2-47q56-1 194-6t213-5q13 0 39 0t38 0q40 0 78 7t73 24 61 40 42 59 16 78q0 29-9 54t-22 41-36 32-41 25-48 22q88 20 146 76t58 141q0 57-20 102t-53 74-78 48-93 27-100 8q-25 0-75-1t-75-1q-60 0-175 6t-132 6z"},em:{width:585,height:1024,path:"M0 949l9-48q3-1 46-12t63-21q16-20 23-57 0-4 35-165t65-310 29-169v-14q-13-7-31-10t-39-4-33-3l10-58q18 1 68 3t85 4 68 1q27 0 56-1t69-4 56-3q-2 22-10 50-17 5-58 16t-62 19q-4 10-8 24t-5 22-4 26-3 24q-15 84-50 239t-44 203q-1 5-7 33t-11 51-9 47-3 32l0 10q9 2 105 17-1 25-9 56-6 0-18 0t-18 0q-16 0-49-5t-49-5q-78-1-117-1-29 0-81 5t-69 6z"},code:{width:896,height:1024,path:"M608 192l-96 96 224 224-224 224 96 96 288-320-288-320zM288 192l-288 320 288 320 96-96-224-224 224-224-96-96z"},link:{width:951,height:1024,path:"M832 694q0-22-16-38l-118-118q-16-16-38-16-24 0-41 18 1 1 10 10t12 12 8 10 7 14 2 15q0 22-16 38t-38 16q-8 0-15-2t-14-7-10-8-12-12-10-10q-18 17-18 41 0 22 16 38l117 118q15 15 38 15 22 0 38-14l84-83q16-16 16-38zM430 292q0-22-16-38l-117-118q-16-16-38-16-22 0-38 15l-84 83q-16 16-16 38 0 22 16 38l118 118q15 15 38 15 24 0 41-17-1-1-10-10t-12-12-8-10-7-14-2-15q0-22 16-38t38-16q8 0 15 2t14 7 10 8 12 12 10 10q18-17 18-41zM941 694q0 68-48 116l-84 83q-47 47-116 47-69 0-116-48l-117-118q-47-47-47-116 0-70 50-119l-50-50q-49 50-118 50-68 0-116-48l-118-118q-48-48-48-116t48-116l84-83q47-47 116-47 69 0 116 48l117 118q47 47 47 116 0 70-50 119l50 50q49-50 118-50 68 0 116 48l118 118q48 48 48 116z"},bulletList:{width:768,height:896,path:"M0 512h128v-128h-128v128zM0 256h128v-128h-128v128zM0 768h128v-128h-128v128zM256 512h512v-128h-512v128zM256 256h512v-128h-512v128zM256 768h512v-128h-512v128z"},orderedList:{width:768,height:896,path:"M320 512h448v-128h-448v128zM320 768h448v-128h-448v128zM320 128v128h448v-128h-448zM79 384h78v-256h-36l-85 23v50l43-2v185zM189 590c0-36-12-78-96-78-33 0-64 6-83 16l1 66c21-10 42-15 67-15s32 11 32 28c0 26-30 58-110 112v50h192v-67l-91 2c49-30 87-66 87-113l1-1z"},blockquote:{width:640,height:896,path:"M0 448v256h256v-256h-128c0 0 0-128 128-128v-128c0 0-256 0-256 256zM640 320v-128c0 0-256 0-256 256v256h256v-256h-128c0 0 0-128 128-128z"}},Rp=new Cp({title:"Join with above block",run:nr,select:function(t){return nr(t)},icon:Dp.join}),Pp=new Cp({title:"Lift out of enclosing block",run:or,select:function(t){return or(t)},icon:Dp.lift}),zp=new Cp({title:"Select parent node",run:cr,select:function(t){return cr(t)},icon:Dp.selectParentNode}),Fp=new Cp({title:"Undo last change",run:le,enable:function(t){return le(t)},icon:Dp.undo}),Bp=new Cp({title:"Redo last undone change",run:fe,enable:function(t){return fe(t)},icon:Dp.redo});function Lp(t,e){var n=fr(t,e.attrs),r={run:n,enable:function(t){return n(t)},active:function(n){var r=n.selection,o=r.$from,i=r.to,s=r.node;return s?s.hasMarkup(t,e.attrs):i<=o.end()&&o.parent.hasMarkup(t,e.attrs)}};for(var o in e)r[o]=e[o];return new Cp(r)}function $p(t,e,n){n?t.classList.add(e):t.classList.remove(e)}var qp="ProseMirror-menubar";var Jp=function(t,e){var n=this;this.editorView=t,this.options=e,this.wrapper=jf("div",{class:qp+"-wrapper"}),this.menu=this.wrapper.appendChild(jf("div",{class:qp})),this.menu.className=qp,this.spacer=null,t.dom.parentNode.replaceChild(this.wrapper,t.dom),this.wrapper.appendChild(t.dom),this.maxHeight=0,this.widthForMaxHeight=0,this.floating=!1;var r=function(t,e){for(var n=document.createDocumentFragment(),r=[],o=[],i=0;i<e.length;i++){for(var s=e[i],a=[],c=[],u=0;u<s.length;u++){var l=s[u].render(t),f=l.dom,h=l.update,p=jf("span",{class:Op+"item"},f);n.appendChild(p),c.push(p),a.push(h)}a.length&&(r.push(Ip(a,c)),i<e.length-1&&o.push(n.appendChild(jf("span",{class:Op+"separator"}))))}return{dom:n,update:function(t){for(var e=!1,n=!1,i=0;i<r.length;i++){var s=r[i](t);i&&(o[i-1].style.display=n&&s?"":"none"),n=s,s&&(e=!0)}return e}}}(this.editorView,this.options.content),o=r.dom,i=r.update;if(this.contentUpdate=i,this.menu.appendChild(o),this.update(),e.floating&&!function(){if("undefined"==typeof navigator)return!1;var t=navigator.userAgent;return!/Edge\/\d/.test(t)&&/AppleWebKit/.test(t)&&/Mobile\/\w+/.test(t)}()){this.updateFloat();var s=function(t){for(var e=[window],n=t.parentNode;n;n=n.parentNode)e.push(n);return e}(this.wrapper);this.scrollFunc=function(t){var e=n.editorView.root;(e.body||e).contains(n.wrapper)?n.updateFloat(t.target.getBoundingClientRect&&t.target):s.forEach((function(t){return t.removeEventListener("scroll",n.scrollFunc)}))},s.forEach((function(t){return t.addEventListener("scroll",n.scrollFunc)}))}};function Up(t,e,n){for(var r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;var o=t.child(r),i=e.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(var s=0;o.text[s]==i.text[s];s++)n++;return n}if(o.content.size||i.content.size){var a=Up(o.content,i.content,n+1);if(null!=a)return a}n+=o.nodeSize}else n+=o.nodeSize}}function Vp(t,e,n,r){for(var o=t.childCount,i=e.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};var s=t.child(--o),a=e.child(--i),c=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){for(var u=0,l=Math.min(s.text.length,a.text.length);u<l&&s.text[s.text.length-u-1]==a.text[a.text.length-u-1];)u++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){var f=Vp(s.content,a.content,n-1,r-1);if(f)return f}n-=c,r-=c}else n-=c,r-=c}}Jp.prototype.update=function(){this.contentUpdate(this.editorView.state),this.floating?this.updateScrollCursor():(this.menu.offsetWidth!=this.widthForMaxHeight&&(this.widthForMaxHeight=this.menu.offsetWidth,this.maxHeight=0),this.menu.offsetHeight>this.maxHeight&&(this.maxHeight=this.menu.offsetHeight,this.menu.style.minHeight=this.maxHeight+"px"))},Jp.prototype.updateScrollCursor=function(){var t=this.editorView.root.getSelection();if(t.focusNode){var e=t.getRangeAt(0).getClientRects(),n=e[function(t){if(t.anchorNode==t.focusNode)return t.anchorOffset>t.focusOffset;return t.anchorNode.compareDocumentPosition(t.focusNode)==Node.DOCUMENT_POSITION_FOLLOWING}(t)?0:e.length-1];if(n){var r=this.menu.getBoundingClientRect();if(n.top<r.bottom&&n.bottom>r.top){var o=function(t){for(var e=t.parentNode;e;e=e.parentNode)if(e.scrollHeight>e.clientHeight)return e}(this.wrapper);o&&(o.scrollTop-=r.bottom-n.top)}}}},Jp.prototype.updateFloat=function(t){var e=this.wrapper,n=e.getBoundingClientRect(),r=t?Math.max(0,t.getBoundingClientRect().top):0;if(this.floating)if(n.top>=r||n.bottom<this.menu.offsetHeight+10)this.floating=!1,this.menu.style.position=this.menu.style.left=this.menu.style.top=this.menu.style.width="",this.menu.style.display="",this.spacer.parentNode.removeChild(this.spacer),this.spacer=null;else{var o=(e.offsetWidth-e.clientWidth)/2;this.menu.style.left=n.left+o+"px",this.menu.style.display=n.top>window.innerHeight?"none":"",t&&(this.menu.style.top=r+"px")}else if(n.top<r&&n.bottom>=this.menu.offsetHeight+10){this.floating=!0;var i=this.menu.getBoundingClientRect();this.menu.style.left=i.left+"px",this.menu.style.width=i.width+"px",t&&(this.menu.style.top=r+"px"),this.menu.style.position="fixed",this.spacer=jf("div",{class:qp+"-spacer",style:"height: "+i.height+"px"}),e.insertBefore(this.spacer,this.menu)}},Jp.prototype.destroy=function(){this.wrapper.parentNode&&this.wrapper.parentNode.replaceChild(this.editorView.dom,this.wrapper)};var Wp=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},Hp={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};Wp.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var u=s+1;a.nodesBetween(Math.max(0,t-u),Math.min(a.content.size,e-u),n,r+u)}s=c}},Wp.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},Wp.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},Wp.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new Wp(r,this.size+t.size)},Wp.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var o=0,i=0;i<e;o++){var s=this.content[o],a=i+s.nodeSize;a>t&&((i<t||a>e)&&(s=s.isText?s.cut(Math.max(0,t-i),Math.min(s.text.length,e-i)):s.cut(Math.max(0,t-i-1),Math.min(s.content.size,e-i-1))),n.push(s),r+=s.nodeSize),i=a}return new Wp(n,r)},Wp.prototype.cutByIndex=function(t,e){return t==e?Wp.empty:0==t&&e==this.content.length?this:new Wp(this.content.slice(t,e))},Wp.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new Wp(r,o)},Wp.prototype.addToStart=function(t){return new Wp([t].concat(this.content),this.size+t.nodeSize)},Wp.prototype.addToEnd=function(t){return new Wp(this.content.concat(t),this.size+t.nodeSize)},Wp.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},Hp.firstChild.get=function(){return this.content.length?this.content[0]:null},Hp.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},Hp.childCount.get=function(){return this.content.length},Wp.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},Wp.prototype.maybeChild=function(t){return this.content[t]},Wp.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},Wp.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),Up(this,t,e)},Wp.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),Vp(this,t,e,n)},Wp.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return Yp(0,t);if(t==this.size)return Yp(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?Yp(n+1,o):Yp(n,r);r=o}},Wp.prototype.toString=function(){return"<"+this.toStringInner()+">"},Wp.prototype.toStringInner=function(){return this.content.join(", ")},Wp.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},Wp.fromJSON=function(t,e){if(!e)return Wp.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new Wp(e.map(t.nodeFromJSON))},Wp.fromArray=function(t){if(!t.length)return Wp.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new Wp(e||t,n)},Wp.from=function(t){if(!t)return Wp.empty;if(t instanceof Wp)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new Wp([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(Wp.prototype,Hp);var Kp={index:0,offset:0};function Yp(t,e){return Kp.index=t,Kp.offset=e,Kp}function Gp(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!Gp(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e)||!Gp(t[o],e[o]))return!1;for(var i in e)if(!(i in t))return!1}return!0}Wp.empty=new Wp([],0);var Qp=function(t,e){this.type=t,this.attrs=e};function Xp(t){var e=Error.call(this,t);return e.__proto__=Xp.prototype,e}Qp.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},Qp.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},Qp.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},Qp.prototype.eq=function(t){return this==t||this.type==t.type&&Gp(this.attrs,t.attrs)},Qp.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},Qp.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},Qp.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},Qp.setFrom=function(t){if(!t||0==t.length)return Qp.none;if(t instanceof Qp)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},Qp.none=[],Xp.prototype=Object.create(Error.prototype),Xp.prototype.constructor=Xp,Xp.prototype.name="ReplaceError";var Zp=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},td={size:{configurable:!0}};function ed(t,e,n){var r=t.findIndex(e),o=r.index,i=r.offset,s=t.maybeChild(o),a=t.findIndex(n),c=a.index,u=a.offset;if(i==e||s.isText){if(u!=n&&!t.child(c).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return t.replaceChild(o,s.copy(ed(s.content,e-i-1,n-i-1)))}function nd(t,e,n,r){var o=t.findIndex(e),i=o.index,s=o.offset,a=t.maybeChild(i);if(s==e||a.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));var c=nd(a.content,e-s-1,n);return c&&t.replaceChild(i,a.copy(c))}function rd(t,e,n){if(n.openStart>t.depth)throw new Xp("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Xp("Inconsistent open depths");return od(t,e,n,0)}function od(t,e,n,r){var o=t.index(r),i=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){var s=od(t,e,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){var a=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(Wp.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(n,t);return ud(i,ld(t,a.start,a.end,e,r))}var c=t.parent,u=c.content;return ud(c,u.cut(0,t.parentOffset).append(n.content).append(u.cut(e.parentOffset)))}return ud(i,fd(t,e,r))}function id(t,e){if(!e.type.compatibleContent(t.type))throw new Xp("Cannot join "+e.type.name+" onto "+t.type.name)}function sd(t,e,n){var r=t.node(n);return id(r,e.node(n)),r}function ad(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function cd(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(ad(t.nodeAfter,r),i++));for(var a=i;a<s;a++)ad(o.child(a),r);e&&e.depth==n&&e.textOffset&&ad(e.nodeBefore,r)}function ud(t,e){if(!t.type.validContent(e))throw new Xp("Invalid content for node "+t.type.name);return t.copy(e)}function ld(t,e,n,r,o){var i=t.depth>o&&sd(t,e,o+1),s=r.depth>o&&sd(n,r,o+1),a=[];return cd(null,t,o,a),i&&s&&e.index(o)==n.index(o)?(id(i,s),ad(ud(i,ld(t,e,n,r,o+1)),a)):(i&&ad(ud(i,fd(t,e,o+1)),a),cd(e,n,o,a),s&&ad(ud(s,fd(n,r,o+1)),a)),cd(r,null,o,a),new Wp(a)}function fd(t,e,n){var r=[];(cd(null,t,n,r),t.depth>n)&&ad(ud(sd(t,e,n+1),fd(t,e,n+1)),r);return cd(e,null,n,r),new Wp(r)}td.size.get=function(){return this.content.size-this.openStart-this.openEnd},Zp.prototype.insertAt=function(t,e){var n=nd(this.content,t+this.openStart,e,null);return n&&new Zp(n,this.openStart,this.openEnd)},Zp.prototype.removeBetween=function(t,e){return new Zp(ed(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},Zp.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},Zp.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},Zp.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},Zp.fromJSON=function(t,e){if(!e)return Zp.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new Zp(Wp.fromJSON(t,e.content),n,r)},Zp.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new Zp(t,n,r)},Object.defineProperties(Zp.prototype,td),Zp.empty=new Zp(Wp.empty,0,0);var hd=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},pd={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};hd.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},pd.parent.get=function(){return this.node(this.depth)},pd.doc.get=function(){return this.node(0)},hd.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},hd.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},hd.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},hd.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},hd.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},hd.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},hd.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},pd.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},pd.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},pd.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},hd.prototype.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,o=0;o<t;o++)r+=n.child(o).nodeSize;return r},hd.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return Qp.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},hd.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},hd.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},hd.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new md(this,t,n)},hd.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},hd.prototype.max=function(t){return t.pos>this.pos?t:this},hd.prototype.min=function(t){return t.pos<this.pos?t:this},hd.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},hd.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,u=o-c;if(n.push(i,a,r+c),!u)break;if((i=i.child(a)).isText)break;o=u-1,r+=c+1}return new hd(e,n,o)},hd.resolveCached=function(t,e){for(var n=0;n<dd.length;n++){var r=dd[n];if(r.pos==e&&r.doc==t)return r}var o=dd[vd]=hd.resolve(t,e);return vd=(vd+1)%yd,o},Object.defineProperties(hd.prototype,pd);var dd=[],vd=0,yd=12,md=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},gd={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};gd.start.get=function(){return this.$from.before(this.depth+1)},gd.end.get=function(){return this.$to.after(this.depth+1)},gd.parent.get=function(){return this.$from.node(this.depth)},gd.startIndex.get=function(){return this.$from.index(this.depth)},gd.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(md.prototype,gd);var bd=Object.create(null),wd=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||Wp.empty,this.marks=r||Qp.none},kd={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};kd.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},kd.childCount.get=function(){return this.content.childCount},wd.prototype.child=function(t){return this.content.child(t)},wd.prototype.maybeChild=function(t){return this.content.maybeChild(t)},wd.prototype.forEach=function(t){this.content.forEach(t)},wd.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},wd.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},kd.textContent.get=function(){return this.textBetween(0,this.content.size,"")},wd.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},kd.firstChild.get=function(){return this.content.firstChild},kd.lastChild.get=function(){return this.content.lastChild},wd.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},wd.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},wd.prototype.hasMarkup=function(t,e,n){return this.type==t&&Gp(this.attrs,e||t.defaultAttrs||bd)&&Qp.sameSet(this.marks,n||Qp.none)},wd.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},wd.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},wd.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},wd.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return Zp.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new Zp(a,r.depth-i,o.depth-i)},wd.prototype.replace=function(t,e,n){return rd(this.resolve(t),this.resolve(e),n)},wd.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},wd.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},wd.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},wd.prototype.resolve=function(t){return hd.resolveCached(this,t)},wd.prototype.resolveNoCache=function(t){return hd.resolve(this,t)},wd.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},kd.isBlock.get=function(){return this.type.isBlock},kd.isTextblock.get=function(){return this.type.isTextblock},kd.inlineContent.get=function(){return this.type.inlineContent},kd.isInline.get=function(){return this.type.isInline},kd.isText.get=function(){return this.type.isText},kd.isLeaf.get=function(){return this.type.isLeaf},kd.isAtom.get=function(){return this.type.isAtom},wd.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),Sd(this.marks,t)},wd.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},wd.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=Wp.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,e);if(!s||!s.validEnd)return!1;for(var a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0},wd.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},wd.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},wd.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},wd.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},wd.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=Wp.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(wd.prototype,kd);var xd=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Sd(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(wd);function Sd(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var Od=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},Cd={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};Od.parse=function(t,e){var n=new Ed(t,e);if(null==n.next)return Od.empty;var r=Md(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return n(Dd(t,0));function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];Dd(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new Od(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(jd);i.next.push(o[s],e[a.join(",")]||n(a))}return i}}(function(t){var e=[[]];return o(i(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}function i(t,e){if("choice"==t.type)return t.exprs.reduce((function(t,n){return t.concat(i(n,e))}),[]);if("seq"==t.type)for(var s=0;;s++){var a=i(t.exprs[s],e);if(s==t.exprs.length-1)return a;o(a,e=n())}else{if("star"==t.type){var c=n();return r(e,c),o(i(t.expr,c),c),[r(c)]}if("plus"==t.type){var u=n();return o(i(t.expr,e),u),o(i(t.expr,u),u),[r(u)]}if("opt"==t.type)return[r(e)].concat(i(t.expr,e));if("range"==t.type){for(var l=e,f=0;f<t.min;f++){var h=n();o(i(t.expr,l),h),l=h}if(-1==t.max)o(i(t.expr,l),l);else for(var p=t.min;p<t.max;p++){var d=n();r(l,d),o(i(t.expr,l),d),l=d}return[r(l)]}if("name"==t.type)return[r(e,null,t.value)]}}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],u=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(u)&&r.push(u)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},Od.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},Od.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},Cd.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},Cd.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},Od.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},Od.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,s){var a=i.matchFragment(t,n);if(a&&(!e||a.validEnd))return Wp.from(s.map((function(t){return t.createAndFill()})));for(var c=0;c<i.next.length;c+=2){var u=i.next[c],l=i.next[c+1];if(!u.isText&&!u.hasRequiredAttrs()&&-1==r.indexOf(l)){r.push(l);var f=o(l,s.concat(u));if(f)return f}}}(this,[])},Od.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},Od.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},Cd.edgeCount.get=function(){return this.next.length>>1},Od.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},Od.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(Od.prototype,Cd),Od.empty=new Od(!0);var Ed=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},_d={next:{configurable:!0}};function Md(t){var e=[];do{e.push(Td(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function Td(t){var e=[];do{e.push(Nd(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function Nd(t){for(var e=function(t){if(t.eat("(")){var e=Md(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=Id(t,e)}return e}function Ad(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function Id(t,e){var n=Ad(t),r=n;return t.eat(",")&&(r="}"!=t.next?Ad(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function jd(t,e){return e-t}function Dd(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(jd)}function Rd(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function Pd(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function zd(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new Ld(t[n]);return e}_d.next.get=function(){return this.tokens[this.pos]},Ed.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},Ed.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(Ed.prototype,_d);var Fd=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=zd(n.attrs),this.defaultAttrs=Rd(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},Bd={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Bd.isInline.get=function(){return!this.isBlock},Bd.isTextblock.get=function(){return this.isBlock&&this.inlineContent},Bd.isLeaf.get=function(){return this.contentMatch==Od.empty},Bd.isAtom.get=function(){return this.isLeaf||this.spec.atom},Fd.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},Fd.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},Fd.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:Pd(this.attrs,t)},Fd.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new wd(this,this.computeAttrs(t),Wp.from(e),Qp.setFrom(n))},Fd.prototype.createChecked=function(t,e,n){if(e=Wp.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new wd(this,this.computeAttrs(t),e,Qp.setFrom(n))},Fd.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=Wp.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e).fillBefore(Wp.empty,!0);return o?new wd(this,t,e.append(o),Qp.setFrom(n)):null},Fd.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},Fd.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},Fd.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},Fd.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:Qp.empty:t},Fd.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new Fd(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(Fd.prototype,Bd);var Ld=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},$d={isRequired:{configurable:!0}};$d.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(Ld.prototype,$d);var qd=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=zd(r.attrs),this.rank=e,this.excluded=null;var o=Rd(this.attrs);this.instance=o&&new Qp(this,o)};qd.prototype.create=function(t){return!t&&this.instance?this.instance:new Qp(this,Pd(this.attrs,t))},qd.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new qd(t,r++,e,o)})),n},qd.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},qd.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},qd.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var Jd=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=l.a.from(t.nodes),this.spec.marks=l.a.from(t.marks),this.nodes=Fd.compile(this.spec.nodes,this),this.marks=qd.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],i=o.spec.content||"",s=o.spec.marks;o.contentMatch=n[i]||(n[i]=Od.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==s?null:s?Ud(this,s.split(" ")):""!=s&&o.inlineContent?null:[]}for(var a in this.marks){var c=this.marks[a],u=c.spec.excludes;c.excluded=null==u?[c]:""==u?[]:Ud(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function Ud(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}Jd.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof Fd))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},Jd.prototype.text=function(t,e){var n=this.nodes.text;return new xd(n,n.defaultAttrs,t,Qp.setFrom(e))},Jd.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},Jd.prototype.nodeFromJSON=function(t){return wd.fromJSON(this,t)},Jd.prototype.markFromJSON=function(t){return Qp.fromJSON(this,t)},Jd.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var Vd=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)})),this.normalizeLists=!this.tags.some((function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)}))};Vd.prototype.parse=function(t,e){void 0===e&&(e={});var n=new Qd(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},Vd.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new Qd(this,e,!0);return n.addAll(t,null,e.from,e.to),Zp.maxOpen(n.finish())},Vd.prototype.matchTag=function(t,e,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(Zd(t,o.tag)&&(void 0===o.namespace||t.namespaceURI==o.namespace)&&(!o.context||e.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(t);if(!1===i)continue;o.attrs=i}return o}}},Vd.prototype.matchStyle=function(t,e,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(t)||i.context&&!n.matchesContext(i.context)||i.style.length>t.length&&(61!=i.style.charCodeAt(t.length)||i.style.slice(t.length+1)!=e))){if(i.getAttrs){var s=i.getAttrs(e);if(!1===s)continue;i.attrs=s}return i}}},Vd.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=tv(t)),t.mark=e}))};for(var o in t.marks)r(o);var i=function(e){var r=t.nodes[s].spec.parseDOM;r&&r.forEach((function(t){n(t=tv(t)),t.node=s}))};for(var s in t.nodes)i();return e},Vd.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new Vd(t,Vd.schemaRules(t)))};var Wd={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Hd={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Kd={ol:!0,ul:!0};function Yd(t){return(t?1:0)|("full"===t?2:0)}var Gd=function(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=Qp.none,this.pendingMarks=r,this.stashMarks=[]};Gd.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(Wp.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},Gd.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=Wp.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(Wp.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},Gd.prototype.popFromStashMark=function(t){for(var e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]},Gd.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):ev(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}};var Qd=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,i=Yd(e.preserveWhitespace)|(n?4:0);r=o?new Gd(o.type,o.attrs,Qp.none,Qp.none,!0,e.topMatch||o.type.contentMatch,i):new Gd(n?null:t.schema.topNodeType,null,Qp.none,Qp.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},Xd={top:{configurable:!0},currentPos:{configurable:!0}};function Zd(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function tv(t){var e={};for(var n in t)e[n]=t[n];return e}function ev(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var i=[];return function t(n){i.push(n);for(var r=0;r<n.edgeCount;r++){var o=n.edge(r),s=o.type,a=o.next;if(s==e)return!0;if(i.indexOf(a)<0&&t(a))return!0}}(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}Xd.top.get=function(){return this.nodes[this.open]},Qd.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},Qd.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},Qd.prototype.addElement=function(t,e){var n,r=t.nodeName.toLowerCase();Kd.hasOwnProperty(r)&&this.parser.normalizeLists&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&Kd.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var o=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(n=this.parser.matchTag(t,this,e));if(o?o.ignore:Hd.hasOwnProperty(r))this.findInside(t);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(t=o.skip);var i,s=this.top,a=this.needsBlock;if(Wd.hasOwnProperty(r))i=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),i&&this.sync(s),this.needsBlock=a}else this.addElementByRule(t,o,!1===o.consuming?n:null)},Qd.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},Qd.prototype.readStyles=function(t){var e=Qp.none;t:for(var n=0;n<t.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(t[n],t[n+1],this,r);if(!o)continue t;if(o.ignore)return null;if(e=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(e),!1!==o.consuming)break;r=o}return e},Qd.prototype.addElementByRule=function(t,e,n){var r,o,i,s=this;e.node?(o=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(o.create(e.attrs))||this.leafFallback(t):r=this.enter(o,e.attrs,e.preserveWhitespace):(i=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(i));var a=this.top;if(o&&o.isLeaf)this.findInside(t);else if(n)this.addElement(t,n);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return s.insertNode(t)}));else{var c=e.contentElement;"string"==typeof c?c=t.querySelector(c):"function"==typeof c&&(c=c(t)),c||(c=t),this.findAround(t,c,!0),this.addAll(c,r)}r&&(this.sync(a),this.open--),i&&this.removePendingMark(i,a)},Qd.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&Wd.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},Qd.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},Qd.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},Qd.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},Qd.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:Yd(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new Gd(t,e,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},Qd.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},Qd.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},Qd.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},Xd.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},Qd.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},Qd.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},Qd.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},Qd.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},Qd.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1);return function t(s,a){for(;s>=0;s--){var c=n[s];if(""==c){if(s==n.length-1||0==s)continue;for(;a>=i;a--)if(t(s-1,a))return!0;return!1}var u=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!u||u.name!=c&&-1==u.groups.indexOf(c))return!1;a--}return!0}(n.length-1,this.open)},Qd.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},Qd.prototype.addPendingMark=function(t){var e=function(t,e){for(var n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},Qd.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(t)>-1)r.pendingMarks=t.removeFromSet(r.pendingMarks);else{r.activeMarks=t.removeFromSet(r.activeMarks);var o=r.popFromStashMark(t);o&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==e)break}},Object.defineProperties(Qd.prototype,Xd);var nv=function(t,e){this.nodes=t||{},this.marks=e||{}};function rv(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function ov(t){return t.document||window.document}nv.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=ov(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],u=r.serializeMark(c,t.isInline,e);u&&(i.push(c,o),o.appendChild(u.dom),o=u.contentDOM||u.dom)}}o.appendChild(r.serializeNode(t,e))})),n},nv.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=nv.renderSpec(ov(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},nv.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},nv.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&nv.renderSpec(ov(n),r(t,e))},nv.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var u in c=2,a)if(null!=a[u]){var l=u.indexOf(" ");l>0?s.setAttributeNS(u.slice(0,l),u.slice(l+1),a[u]):s.setAttribute(u,a[u])}for(var f=c;f<e.length;f++){var h=e[f];if(0===h){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var p=nv.renderSpec(t,h,n),d=p.dom,v=p.contentDOM;if(s.appendChild(d),v){if(i)throw new RangeError("Multiple content holes");i=v}}return{dom:s,contentDOM:i}},nv.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new nv(this.nodesFromSchema(t),this.marksFromSchema(t)))},nv.nodesFromSchema=function(t){var e=rv(t.nodes);return e.text||(e.text=function(t){return t.text}),e},nv.marksFromSchema=function(t){return rv(t.marks)};function iv(t,e){return function(n,r){var o=n.selection,i=o.$from,s=o.$to,a=i.blockRange(s),c=!1,l=a;if(!a)return!1;if(a.depth>=2&&i.node(a.depth-1).type.compatibleContent(t)&&0==a.startIndex){if(0==i.index(a.depth-1))return!1;var f=n.doc.resolve(a.start-2);l=new md(f,f,a.depth),a.endIndex<a.parent.childCount&&(a=new md(i,n.doc.resolve(s.end(a.depth)),a.depth)),c=!0}var h=Object(u.h)(l,t,e,a);return!!h&&(r&&r(function(t,e,n,r,o){for(var i=Wp.empty,s=n.length-1;s>=0;s--)i=Wp.from(n[s].type.create(n[s].attrs,i));t.step(new u.b(e.start-(r?2:0),e.end,e.start,e.end,new Zp(i,0,0),n.length,!0));for(var a=0,c=0;c<n.length;c++)n[c].type==o&&(a=c+1);for(var l=n.length-a,f=e.start+n.length-(r?2:0),h=e.parent,p=e.startIndex,d=e.endIndex,v=!0;p<d;p++,v=!1)!v&&Object(u.f)(t.doc,f,l)&&(t.split(f,l),f+=2*l),f+=h.child(p).nodeSize;return t}(n.tr,a,h,c,t).scrollIntoView()),!0)}}function sv(t){return function(e,n){var r=e.selection,o=r.$from,i=r.$to,s=o.blockRange(i,(function(e){return e.childCount&&e.firstChild.type==t}));return!!s&&(!n||(o.node(s.depth-1).type==t?function(t,e,n,r){var o=t.tr,i=r.end,s=r.$to.end(r.depth);i<s&&(o.step(new u.b(i-1,s,i,s,new Zp(Wp.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new md(o.doc.resolve(r.$from.pos),o.doc.resolve(s),r.depth));return e(o.lift(r,Object(u.j)(r)).scrollIntoView()),!0}(e,n,t,s):function(t,e,n){for(var r=t.tr,o=n.parent,i=n.end,s=n.endIndex-1,a=n.startIndex;s>a;s--)i-=o.child(s).nodeSize,r.delete(i-1,i+1);var c=r.doc.resolve(n.start),l=c.nodeAfter,f=0==n.startIndex,h=n.endIndex==o.childCount,p=c.node(-1),d=c.index(-1);if(!p.canReplace(d+(f?0:1),d+1,l.content.append(h?Wp.empty:Wp.from(o))))return!1;var v=c.pos,y=v+l.nodeSize;return r.step(new u.b(v-(f?1:0),y+(h?1:0),v+1,y-1,new Zp((f?Wp.empty:Wp.from(o.copy(Wp.empty))).append(h?Wp.empty:Wp.from(o.copy(Wp.empty))),f?0:1,h?0:1),f?0:1)),e(r.scrollIntoView()),!0}(e,n,s)))}}function av(t,e,n){for(var r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;var o=t.child(r),i=e.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(var s=0;o.text[s]==i.text[s];s++)n++;return n}if(o.content.size||i.content.size){var a=av(o.content,i.content,n+1);if(null!=a)return a}n+=o.nodeSize}else n+=o.nodeSize}}function cv(t,e,n,r){for(var o=t.childCount,i=e.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};var s=t.child(--o),a=e.child(--i),c=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){for(var u=0,l=Math.min(s.text.length,a.text.length);u<l&&s.text[s.text.length-u-1]==a.text[a.text.length-u-1];)u++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){var f=cv(s.content,a.content,n-1,r-1);if(f)return f}n-=c,r-=c}else n-=c,r-=c}}var uv=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},lv={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};uv.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var u=s+1;a.nodesBetween(Math.max(0,t-u),Math.min(a.content.size,e-u),n,r+u)}s=c}},uv.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},uv.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},uv.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new uv(r,this.size+t.size)},uv.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var o=0,i=0;i<e;o++){var s=this.content[o],a=i+s.nodeSize;a>t&&((i<t||a>e)&&(s=s.isText?s.cut(Math.max(0,t-i),Math.min(s.text.length,e-i)):s.cut(Math.max(0,t-i-1),Math.min(s.content.size,e-i-1))),n.push(s),r+=s.nodeSize),i=a}return new uv(n,r)},uv.prototype.cutByIndex=function(t,e){return t==e?uv.empty:0==t&&e==this.content.length?this:new uv(this.content.slice(t,e))},uv.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new uv(r,o)},uv.prototype.addToStart=function(t){return new uv([t].concat(this.content),this.size+t.nodeSize)},uv.prototype.addToEnd=function(t){return new uv(this.content.concat(t),this.size+t.nodeSize)},uv.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},lv.firstChild.get=function(){return this.content.length?this.content[0]:null},lv.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},lv.childCount.get=function(){return this.content.length},uv.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},uv.prototype.maybeChild=function(t){return this.content[t]},uv.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},uv.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),av(this,t,e)},uv.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),cv(this,t,e,n)},uv.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return hv(0,t);if(t==this.size)return hv(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?hv(n+1,o):hv(n,r);r=o}},uv.prototype.toString=function(){return"<"+this.toStringInner()+">"},uv.prototype.toStringInner=function(){return this.content.join(", ")},uv.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},uv.fromJSON=function(t,e){if(!e)return uv.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new uv(e.map(t.nodeFromJSON))},uv.fromArray=function(t){if(!t.length)return uv.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new uv(e||t,n)},uv.from=function(t){if(!t)return uv.empty;if(t instanceof uv)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new uv([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(uv.prototype,lv);var fv={index:0,offset:0};function hv(t,e){return fv.index=t,fv.offset=e,fv}function pv(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!pv(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e)||!pv(t[o],e[o]))return!1;for(var i in e)if(!(i in t))return!1}return!0}uv.empty=new uv([],0);var dv=function(t,e){this.type=t,this.attrs=e};function vv(t){var e=Error.call(this,t);return e.__proto__=vv.prototype,e}dv.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},dv.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},dv.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},dv.prototype.eq=function(t){return this==t||this.type==t.type&&pv(this.attrs,t.attrs)},dv.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},dv.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},dv.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},dv.setFrom=function(t){if(!t||0==t.length)return dv.none;if(t instanceof dv)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},dv.none=[],vv.prototype=Object.create(Error.prototype),vv.prototype.constructor=vv,vv.prototype.name="ReplaceError";var yv=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},mv={size:{configurable:!0}};function gv(t,e,n){var r=t.findIndex(e),o=r.index,i=r.offset,s=t.maybeChild(o),a=t.findIndex(n),c=a.index,u=a.offset;if(i==e||s.isText){if(u!=n&&!t.child(c).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return t.replaceChild(o,s.copy(gv(s.content,e-i-1,n-i-1)))}function bv(t,e,n,r){var o=t.findIndex(e),i=o.index,s=o.offset,a=t.maybeChild(i);if(s==e||a.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));var c=bv(a.content,e-s-1,n);return c&&t.replaceChild(i,a.copy(c))}function wv(t,e,n){if(n.openStart>t.depth)throw new vv("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new vv("Inconsistent open depths");return kv(t,e,n,0)}function kv(t,e,n,r){var o=t.index(r),i=t.node(r);if(o==e.index(r)&&r<t.depth-n.openStart){var s=kv(t,e,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=r||e.depth!=r){var a=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(uv.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(n,t);return Ev(i,_v(t,a.start,a.end,e,r))}var c=t.parent,u=c.content;return Ev(c,u.cut(0,t.parentOffset).append(n.content).append(u.cut(e.parentOffset)))}return Ev(i,Mv(t,e,r))}function xv(t,e){if(!e.type.compatibleContent(t.type))throw new vv("Cannot join "+e.type.name+" onto "+t.type.name)}function Sv(t,e,n){var r=t.node(n);return xv(r,e.node(n)),r}function Ov(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Cv(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(Ov(t.nodeAfter,r),i++));for(var a=i;a<s;a++)Ov(o.child(a),r);e&&e.depth==n&&e.textOffset&&Ov(e.nodeBefore,r)}function Ev(t,e){if(!t.type.validContent(e))throw new vv("Invalid content for node "+t.type.name);return t.copy(e)}function _v(t,e,n,r,o){var i=t.depth>o&&Sv(t,e,o+1),s=r.depth>o&&Sv(n,r,o+1),a=[];return Cv(null,t,o,a),i&&s&&e.index(o)==n.index(o)?(xv(i,s),Ov(Ev(i,_v(t,e,n,r,o+1)),a)):(i&&Ov(Ev(i,Mv(t,e,o+1)),a),Cv(e,n,o,a),s&&Ov(Ev(s,Mv(n,r,o+1)),a)),Cv(r,null,o,a),new uv(a)}function Mv(t,e,n){var r=[];(Cv(null,t,n,r),t.depth>n)&&Ov(Ev(Sv(t,e,n+1),Mv(t,e,n+1)),r);return Cv(e,null,n,r),new uv(r)}mv.size.get=function(){return this.content.size-this.openStart-this.openEnd},yv.prototype.insertAt=function(t,e){var n=bv(this.content,t+this.openStart,e,null);return n&&new yv(n,this.openStart,this.openEnd)},yv.prototype.removeBetween=function(t,e){return new yv(gv(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},yv.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},yv.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},yv.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},yv.fromJSON=function(t,e){if(!e)return yv.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new yv(uv.fromJSON(t,e.content),n,r)},yv.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new yv(t,n,r)},Object.defineProperties(yv.prototype,mv),yv.empty=new yv(uv.empty,0,0);var Tv=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},Nv={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};Tv.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},Nv.parent.get=function(){return this.node(this.depth)},Nv.doc.get=function(){return this.node(0)},Tv.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},Tv.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},Tv.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},Tv.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},Tv.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},Tv.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},Tv.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},Nv.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},Nv.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},Nv.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},Tv.prototype.posAtIndex=function(t,e){e=this.resolveDepth(e);for(var n=this.path[3*e],r=0==e?0:this.path[3*e-1]+1,o=0;o<t;o++)r+=n.child(o).nodeSize;return r},Tv.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return dv.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},Tv.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},Tv.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},Tv.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new Dv(this,t,n)},Tv.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},Tv.prototype.max=function(t){return t.pos>this.pos?t:this},Tv.prototype.min=function(t){return t.pos<this.pos?t:this},Tv.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},Tv.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,u=o-c;if(n.push(i,a,r+c),!u)break;if((i=i.child(a)).isText)break;o=u-1,r+=c+1}return new Tv(e,n,o)},Tv.resolveCached=function(t,e){for(var n=0;n<Av.length;n++){var r=Av[n];if(r.pos==e&&r.doc==t)return r}var o=Av[Iv]=Tv.resolve(t,e);return Iv=(Iv+1)%jv,o},Object.defineProperties(Tv.prototype,Nv);var Av=[],Iv=0,jv=12,Dv=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},Rv={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};Rv.start.get=function(){return this.$from.before(this.depth+1)},Rv.end.get=function(){return this.$to.after(this.depth+1)},Rv.parent.get=function(){return this.$from.node(this.depth)},Rv.startIndex.get=function(){return this.$from.index(this.depth)},Rv.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(Dv.prototype,Rv);var Pv=Object.create(null),zv=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||uv.empty,this.marks=r||dv.none},Fv={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Fv.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},Fv.childCount.get=function(){return this.content.childCount},zv.prototype.child=function(t){return this.content.child(t)},zv.prototype.maybeChild=function(t){return this.content.maybeChild(t)},zv.prototype.forEach=function(t){this.content.forEach(t)},zv.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},zv.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},Fv.textContent.get=function(){return this.textBetween(0,this.content.size,"")},zv.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},Fv.firstChild.get=function(){return this.content.firstChild},Fv.lastChild.get=function(){return this.content.lastChild},zv.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},zv.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},zv.prototype.hasMarkup=function(t,e,n){return this.type==t&&pv(this.attrs,e||t.defaultAttrs||Pv)&&dv.sameSet(this.marks,n||dv.none)},zv.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},zv.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},zv.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},zv.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return yv.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new yv(a,r.depth-i,o.depth-i)},zv.prototype.replace=function(t,e,n){return wv(this.resolve(t),this.resolve(e),n)},zv.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},zv.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},zv.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},zv.prototype.resolve=function(t){return Tv.resolveCached(this,t)},zv.prototype.resolveNoCache=function(t){return Tv.resolve(this,t)},zv.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},Fv.isBlock.get=function(){return this.type.isBlock},Fv.isTextblock.get=function(){return this.type.isTextblock},Fv.inlineContent.get=function(){return this.type.inlineContent},Fv.isInline.get=function(){return this.type.isInline},Fv.isText.get=function(){return this.type.isText},Fv.isLeaf.get=function(){return this.type.isLeaf},Fv.isAtom.get=function(){return this.type.isAtom},zv.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),Lv(this.marks,t)},zv.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},zv.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=uv.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,e);if(!s||!s.validEnd)return!1;for(var a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0},zv.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},zv.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},zv.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},zv.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},zv.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=uv.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(zv.prototype,Fv);var Bv=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Lv(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(zv);function Lv(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var $v=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},qv={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};$v.parse=function(t,e){var n=new Jv(t,e);if(null==n.next)return $v.empty;var r=Vv(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return n(Qv(t,0));function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];Qv(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new $v(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(Gv);i.next.push(o[s],e[a.join(",")]||n(a))}return i}}(function(t){var e=[[]];return o(i(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}function i(t,e){if("choice"==t.type)return t.exprs.reduce((function(t,n){return t.concat(i(n,e))}),[]);if("seq"==t.type)for(var s=0;;s++){var a=i(t.exprs[s],e);if(s==t.exprs.length-1)return a;o(a,e=n())}else{if("star"==t.type){var c=n();return r(e,c),o(i(t.expr,c),c),[r(c)]}if("plus"==t.type){var u=n();return o(i(t.expr,e),u),o(i(t.expr,u),u),[r(u)]}if("opt"==t.type)return[r(e)].concat(i(t.expr,e));if("range"==t.type){for(var l=e,f=0;f<t.min;f++){var h=n();o(i(t.expr,l),h),l=h}if(-1==t.max)o(i(t.expr,l),l);else for(var p=t.min;p<t.max;p++){var d=n();r(l,d),o(i(t.expr,l),d),l=d}return[r(l)]}if("name"==t.type)return[r(e,null,t.value)]}}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],u=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(u)&&r.push(u)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},$v.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},$v.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},qv.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},qv.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},$v.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},$v.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,s){var a=i.matchFragment(t,n);if(a&&(!e||a.validEnd))return uv.from(s.map((function(t){return t.createAndFill()})));for(var c=0;c<i.next.length;c+=2){var u=i.next[c],l=i.next[c+1];if(!u.isText&&!u.hasRequiredAttrs()&&-1==r.indexOf(l)){r.push(l);var f=o(l,s.concat(u));if(f)return f}}}(this,[])},$v.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},$v.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},qv.edgeCount.get=function(){return this.next.length>>1},$v.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},$v.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties($v.prototype,qv),$v.empty=new $v(!0);var Jv=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},Uv={next:{configurable:!0}};function Vv(t){var e=[];do{e.push(Wv(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function Wv(t){var e=[];do{e.push(Hv(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function Hv(t){for(var e=function(t){if(t.eat("(")){var e=Vv(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=Yv(t,e)}return e}function Kv(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function Yv(t,e){var n=Kv(t),r=n;return t.eat(",")&&(r="}"!=t.next?Kv(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function Gv(t,e){return e-t}function Qv(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(Gv)}function Xv(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function Zv(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function ty(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new ry(t[n]);return e}Uv.next.get=function(){return this.tokens[this.pos]},Jv.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},Jv.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(Jv.prototype,Uv);var ey=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=ty(n.attrs),this.defaultAttrs=Xv(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},ny={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};ny.isInline.get=function(){return!this.isBlock},ny.isTextblock.get=function(){return this.isBlock&&this.inlineContent},ny.isLeaf.get=function(){return this.contentMatch==$v.empty},ny.isAtom.get=function(){return this.isLeaf||this.spec.atom},ey.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},ey.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},ey.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:Zv(this.attrs,t)},ey.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new zv(this,this.computeAttrs(t),uv.from(e),dv.setFrom(n))},ey.prototype.createChecked=function(t,e,n){if(e=uv.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new zv(this,this.computeAttrs(t),e,dv.setFrom(n))},ey.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=uv.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e).fillBefore(uv.empty,!0);return o?new zv(this,t,e.append(o),dv.setFrom(n)):null},ey.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},ey.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},ey.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},ey.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:dv.empty:t},ey.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new ey(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(ey.prototype,ny);var ry=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},oy={isRequired:{configurable:!0}};oy.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(ry.prototype,oy);var iy=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=ty(r.attrs),this.rank=e,this.excluded=null;var o=Xv(this.attrs);this.instance=o&&new dv(this,o)};iy.prototype.create=function(t){return!t&&this.instance?this.instance:new dv(this,Zv(this.attrs,t))},iy.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new iy(t,r++,e,o)})),n},iy.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},iy.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},iy.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var sy=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=l.a.from(t.nodes),this.spec.marks=l.a.from(t.marks),this.nodes=ey.compile(this.spec.nodes,this),this.marks=iy.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],i=o.spec.content||"",s=o.spec.marks;o.contentMatch=n[i]||(n[i]=$v.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==s?null:s?ay(this,s.split(" ")):""!=s&&o.inlineContent?null:[]}for(var a in this.marks){var c=this.marks[a],u=c.spec.excludes;c.excluded=null==u?[c]:""==u?[]:ay(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function ay(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}sy.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof ey))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},sy.prototype.text=function(t,e){var n=this.nodes.text;return new Bv(n,n.defaultAttrs,t,dv.setFrom(e))},sy.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},sy.prototype.nodeFromJSON=function(t){return zv.fromJSON(this,t)},sy.prototype.markFromJSON=function(t){return dv.fromJSON(this,t)},sy.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var cy=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)})),this.normalizeLists=!this.tags.some((function(e){if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;var n=t.nodes[e.node];return n.contentMatch.matchType(n)}))};cy.prototype.parse=function(t,e){void 0===e&&(e={});var n=new dy(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},cy.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new dy(this,e,!0);return n.addAll(t,null,e.from,e.to),yv.maxOpen(n.finish())},cy.prototype.matchTag=function(t,e,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(yy(t,o.tag)&&(void 0===o.namespace||t.namespaceURI==o.namespace)&&(!o.context||e.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(t);if(!1===i)continue;o.attrs=i}return o}}},cy.prototype.matchStyle=function(t,e,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(t)||i.context&&!n.matchesContext(i.context)||i.style.length>t.length&&(61!=i.style.charCodeAt(t.length)||i.style.slice(t.length+1)!=e))){if(i.getAttrs){var s=i.getAttrs(e);if(!1===s)continue;i.attrs=s}return i}}},cy.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=my(t)),t.mark=e}))};for(var o in t.marks)r(o);var i=function(e){var r=t.nodes[s].spec.parseDOM;r&&r.forEach((function(t){n(t=my(t)),t.node=s}))};for(var s in t.nodes)i();return e},cy.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new cy(t,cy.schemaRules(t)))};var uy={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ly={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},fy={ol:!0,ul:!0};function hy(t){return(t?1:0)|("full"===t?2:0)}var py=function(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=dv.none,this.pendingMarks=r,this.stashMarks=[]};py.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(uv.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},py.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=uv.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(uv.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},py.prototype.popFromStashMark=function(t){for(var e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]},py.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):gy(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}};var dy=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,i=hy(e.preserveWhitespace)|(n?4:0);r=o?new py(o.type,o.attrs,dv.none,dv.none,!0,e.topMatch||o.type.contentMatch,i):new py(n?null:t.schema.topNodeType,null,dv.none,dv.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},vy={top:{configurable:!0},currentPos:{configurable:!0}};function yy(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function my(t){var e={};for(var n in t)e[n]=t[n];return e}function gy(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var i=[];return function t(n){i.push(n);for(var r=0;r<n.edgeCount;r++){var o=n.edge(r),s=o.type,a=o.next;if(s==e)return!0;if(i.indexOf(a)<0&&t(a))return!0}}(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}vy.top.get=function(){return this.nodes[this.open]},dy.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},dy.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},dy.prototype.addElement=function(t,e){var n,r=t.nodeName.toLowerCase();fy.hasOwnProperty(r)&&this.parser.normalizeLists&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&fy.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var o=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(n=this.parser.matchTag(t,this,e));if(o?o.ignore:ly.hasOwnProperty(r))this.findInside(t);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(t=o.skip);var i,s=this.top,a=this.needsBlock;if(uy.hasOwnProperty(r))i=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),i&&this.sync(s),this.needsBlock=a}else this.addElementByRule(t,o,!1===o.consuming?n:null)},dy.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},dy.prototype.readStyles=function(t){var e=dv.none;t:for(var n=0;n<t.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(t[n],t[n+1],this,r);if(!o)continue t;if(o.ignore)return null;if(e=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(e),!1!==o.consuming)break;r=o}return e},dy.prototype.addElementByRule=function(t,e,n){var r,o,i,s=this;e.node?(o=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(o.create(e.attrs))||this.leafFallback(t):r=this.enter(o,e.attrs,e.preserveWhitespace):(i=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(i));var a=this.top;if(o&&o.isLeaf)this.findInside(t);else if(n)this.addElement(t,n);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return s.insertNode(t)}));else{var c=e.contentElement;"string"==typeof c?c=t.querySelector(c):"function"==typeof c&&(c=c(t)),c||(c=t),this.findAround(t,c,!0),this.addAll(c,r)}r&&(this.sync(a),this.open--),i&&this.removePendingMark(i,a)},dy.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&uy.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},dy.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},dy.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},dy.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},dy.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:hy(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new py(t,e,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},dy.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},dy.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},dy.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},vy.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},dy.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},dy.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},dy.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},dy.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},dy.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1);return function t(s,a){for(;s>=0;s--){var c=n[s];if(""==c){if(s==n.length-1||0==s)continue;for(;a>=i;a--)if(t(s-1,a))return!0;return!1}var u=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!u||u.name!=c&&-1==u.groups.indexOf(c))return!1;a--}return!0}(n.length-1,this.open)},dy.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},dy.prototype.addPendingMark=function(t){var e=function(t,e){for(var n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},dy.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(t)>-1)r.pendingMarks=t.removeFromSet(r.pendingMarks);else{r.activeMarks=t.removeFromSet(r.activeMarks);var o=r.popFromStashMark(t);o&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==e)break}},Object.defineProperties(dy.prototype,vy);var by=function(t,e){this.nodes=t||{},this.marks=e||{}};function wy(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function ky(t){return t.document||window.document}by.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=ky(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],u=r.serializeMark(c,t.isInline,e);u&&(i.push(c,o),o.appendChild(u.dom),o=u.contentDOM||u.dom)}}o.appendChild(r.serializeNode(t,e))})),n},by.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=by.renderSpec(ky(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},by.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},by.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&by.renderSpec(ky(n),r(t,e))},by.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var u in c=2,a)if(null!=a[u]){var l=u.indexOf(" ");l>0?s.setAttributeNS(u.slice(0,l),u.slice(l+1),a[u]):s.setAttribute(u,a[u])}for(var f=c;f<e.length;f++){var h=e[f];if(0===h){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var p=by.renderSpec(t,h,n),d=p.dom,v=p.contentDOM;if(s.appendChild(d),v){if(i)throw new RangeError("Multiple content holes");i=v}}return{dom:s,contentDOM:i}},by.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new by(this.nodesFromSchema(t),this.marksFromSchema(t)))},by.nodesFromSchema=function(t){var e=wy(t.nodes);return e.text||(e.text=function(t){return t.text}),e},by.marksFromSchema=function(t){return wy(t.marks)};var xy=Object.create(null),Sy=function(t,e,n){this.ranges=n||[new Cy(t.min(e),t.max(e))],this.$anchor=t,this.$head=e},Oy={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};Oy.anchor.get=function(){return this.$anchor.pos},Oy.head.get=function(){return this.$head.pos},Oy.from.get=function(){return this.$from.pos},Oy.to.get=function(){return this.$to.pos},Oy.$from.get=function(){return this.ranges[0].$from},Oy.$to.get=function(){return this.ranges[0].$to},Oy.empty.get=function(){for(var t=this.ranges,e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0},Sy.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},Sy.prototype.replace=function(t,e){void 0===e&&(e=yv.empty);for(var n=e.content.lastChild,r=null,o=0;o<e.openEnd;o++)r=n,n=n.lastChild;for(var i=t.steps.length,s=this.ranges,a=0;a<s.length;a++){var c=s[a],u=c.$from,l=c.$to,f=t.mapping.slice(i);t.replaceRange(f.map(u.pos),f.map(l.pos),a?yv.empty:e),0==a&&jy(t,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}},Sy.prototype.replaceWith=function(t,e){for(var n=t.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],s=i.$from,a=i.$to,c=t.mapping.slice(n),u=c.map(s.pos),l=c.map(a.pos);o?t.deleteRange(u,l):(t.replaceRangeWith(u,l,e),jy(t,n,e.isInline?-1:1))}},Sy.findFrom=function(t,e,n){var r=t.parent.inlineContent?new Ey(t):Iy(t.node(0),t.parent,t.pos,t.index(),e,n);if(r)return r;for(var o=t.depth-1;o>=0;o--){var i=e<0?Iy(t.node(0),t.node(o),t.before(o+1),t.index(o),e,n):Iy(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,e,n);if(i)return i}},Sy.near=function(t,e){return void 0===e&&(e=1),this.findFrom(t,e)||this.findFrom(t,-e)||new Ny(t.node(0))},Sy.atStart=function(t){return Iy(t,t,0,0,1)||new Ny(t)},Sy.atEnd=function(t){return Iy(t,t,t.content.size,t.childCount,-1)||new Ny(t)},Sy.fromJSON=function(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=xy[e.type];if(!n)throw new RangeError("No selection type "+e.type+" defined");return n.fromJSON(t,e)},Sy.jsonID=function(t,e){if(t in xy)throw new RangeError("Duplicate use of selection JSON ID "+t);return xy[t]=e,e.prototype.jsonID=t,e},Sy.prototype.getBookmark=function(){return Ey.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(Sy.prototype,Oy),Sy.prototype.visible=!0;var Cy=function(t,e){this.$from=t,this.$to=e},Ey=function(t){function e(e,n){void 0===n&&(n=e),t.call(this,e,n)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},e.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));if(!o.parent.inlineContent)return t.near(o);var i=n.resolve(r.map(this.anchor));return new e(i.parent.inlineContent?i:o,o)},e.prototype.replace=function(e,n){if(void 0===n&&(n=yv.empty),t.prototype.replace.call(this,e,n),n==yv.empty){var r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head},e.prototype.getBookmark=function(){return new _y(this.anchor,this.head)},e.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(n.anchor),t.resolve(n.head))},e.create=function(t,e,n){void 0===n&&(n=e);var r=t.resolve(e);return new this(r,n==e?r:t.resolve(n))},e.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=i>=0?1:-1),!r.parent.inlineContent){var s=t.findFrom(r,o,!0)||t.findFrom(r,-o,!0);if(!s)return t.near(r,o);r=s.$head}return n.parent.inlineContent||(0==i||(n=(t.findFrom(n,-o,!0)||t.findFrom(n,o,!0)).$anchor).pos<r.pos!=i<0)&&(n=r),new e(n,r)},Object.defineProperties(e.prototype,n),e}(Sy);Sy.jsonID("text",Ey);var _y=function(t,e){this.anchor=t,this.head=e};_y.prototype.map=function(t){return new _y(t.map(this.anchor),t.map(this.head))},_y.prototype.resolve=function(t){return Ey.between(t.resolve(this.anchor),t.resolve(this.head))};var My=function(t){function e(e){var n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);t.call(this,e,r),this.node=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(n,r){var o=r.mapResult(this.anchor),i=o.deleted,s=o.pos,a=n.resolve(s);return i?t.near(a):new e(a)},e.prototype.content=function(){return new yv(uv.from(this.node),0,0)},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor},e.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},e.prototype.getBookmark=function(){return new Ty(this.anchor)},e.fromJSON=function(t,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(n.anchor))},e.create=function(t,e){return new this(t.resolve(e))},e.isSelectable=function(t){return!t.isText&&!1!==t.type.spec.selectable},e}(Sy);My.prototype.visible=!1,Sy.jsonID("node",My);var Ty=function(t){this.anchor=t};Ty.prototype.map=function(t){var e=t.mapResult(this.anchor),n=e.deleted,r=e.pos;return n?new _y(r,r):new Ty(r)},Ty.prototype.resolve=function(t){var e=t.resolve(this.anchor),n=e.nodeAfter;return n&&My.isSelectable(n)?new My(e):Sy.near(e)};var Ny=function(t){function e(e){t.call(this,e.resolve(0),e.resolve(e.content.size))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.replace=function(e,n){if(void 0===n&&(n=yv.empty),n==yv.empty){e.delete(0,e.doc.content.size);var r=t.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else t.prototype.replace.call(this,e,n)},e.prototype.toJSON=function(){return{type:"all"}},e.fromJSON=function(t){return new e(t)},e.prototype.map=function(t){return new e(t)},e.prototype.eq=function(t){return t instanceof e},e.prototype.getBookmark=function(){return Ay},e}(Sy);Sy.jsonID("all",Ny);var Ay={map:function(){return this},resolve:function(t){return new Ny(t)}};function Iy(t,e,n,r,o,i){if(e.inlineContent)return Ey.create(t,n);for(var s=r-(o>0?0:1);o>0?s<e.childCount:s>=0;s+=o){var a=e.child(s);if(a.isAtom){if(!i&&My.isSelectable(a))return My.create(t,n-(o<0?a.nodeSize:0))}else{var c=Iy(t,a,n+o,o<0?a.childCount:0,o,i);if(c)return c}n+=a.nodeSize*o}}function jy(t,e,n){var r=t.steps.length-1;if(!(r<e)){var o,i=t.steps[r];if(i instanceof u.c||i instanceof u.b)t.mapping.maps[r].forEach((function(t,e,n,r){null==o&&(o=r)})),t.setSelection(Sy.near(t.doc.resolve(o),n))}}var Dy=function(t){function e(e){t.call(this,e.doc),this.time=Date.now(),this.curSelection=e.selection,this.curSelectionFor=0,this.storedMarks=e.storedMarks,this.updated=0,this.meta=Object.create(null)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},e.prototype.setSelection=function(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return(1&this.updated)>0},e.prototype.setStoredMarks=function(t){return this.storedMarks=t,this.updated|=2,this},e.prototype.ensureMarks=function(t){return dv.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this},e.prototype.addStoredMark=function(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))},e.prototype.removeStoredMark=function(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(2&this.updated)>0},e.prototype.addStep=function(e,n){t.prototype.addStep.call(this,e,n),this.updated=-3&this.updated,this.storedMarks=null},e.prototype.setTime=function(t){return this.time=t,this},e.prototype.replaceSelection=function(t){return this.selection.replace(this,t),this},e.prototype.replaceSelectionWith=function(t,e){var n=this.selection;return!1!==e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||dv.none))),n.replaceWith(this,t),this},e.prototype.deleteSelection=function(){return this.selection.replace(this),this},e.prototype.insertText=function(t,e,n){void 0===n&&(n=e);var r=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();if(!t)return this.deleteRange(e,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(e);o=n==e?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(e,n,r.text(t,o)),this.selection.empty||this.setSelection(Sy.near(this.selection.$to)),this},e.prototype.setMeta=function(t,e){return this.meta["string"==typeof t?t:t.key]=e,this},e.prototype.getMeta=function(t){return this.meta["string"==typeof t?t:t.key]},n.isGeneric.get=function(){for(var t in this.meta)return!1;return!0},e.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(e.prototype,n),e}(u.d);function Ry(t,e){return e&&t?t.bind(e):t}var Py=function(t,e,n){this.name=t,this.init=Ry(e.init,n),this.apply=Ry(e.apply,n)},zy=[new Py("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new Py("selection",{init:function(t,e){return t.selection||Sy.atStart(e.doc)},apply:function(t){return t.selection}}),new Py("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Py("scrollToSelection",{init:function(){return 0},apply:function(t,e){return t.scrolledIntoView?e+1:e}})],Fy=function(t,e){var n=this;this.schema=t,this.fields=zy.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),e&&e.forEach((function(t){if(n.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");n.plugins.push(t),n.pluginsByKey[t.key]=t,t.spec.state&&n.fields.push(new Py(t.key,t.spec.state,t))}))},By=function(t){this.config=t},Ly={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};Ly.schema.get=function(){return this.config.schema},Ly.plugins.get=function(){return this.config.plugins},By.prototype.apply=function(t){return this.applyTransaction(t).state},By.prototype.filterTransaction=function(t,e){void 0===e&&(e=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=e){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,t,this))return!1}return!0},By.prototype.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var e=[t],n=this.applyInner(t),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var s=this.config.plugins[i];if(s.spec.appendTransaction){var a=r?r[i].n:0,c=r?r[i].state:this,u=a<e.length&&s.spec.appendTransaction.call(s,a?e.slice(a):e,c,n);if(u&&n.filterTransaction(u,i)){if(u.setMeta("appendedTransaction",t),!r){r=[];for(var l=0;l<this.config.plugins.length;l++)r.push(l<i?{state:n,n:e.length}:{state:this,n:0})}e.push(u),n=n.applyInner(u),o=!0}r&&(r[i]={state:n,n:e.length})}}if(!o)return{state:n,transactions:e}}},By.prototype.applyInner=function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var e=new By(this.config),n=this.config.fields,r=0;r<n.length;r++){var o=n[r];e[o.name]=o.apply(t,this[o.name],this,e)}for(var i=0;i<$y.length;i++)$y[i](this,t,e);return e},Ly.tr.get=function(){return new Dy(this)},By.create=function(t){for(var e=new Fy(t.schema||t.doc.type.schema,t.plugins),n=new By(e),r=0;r<e.fields.length;r++)n[e.fields[r].name]=e.fields[r].init(t,n);return n},By.prototype.reconfigure=function(t){for(var e=new Fy(t.schema||this.schema,t.plugins),n=e.fields,r=new By(e),o=0;o<n.length;o++){var i=n[o].name;r[i]=this.hasOwnProperty(i)?this[i]:n[o].init(t,r)}return r},By.prototype.toJSON=function(t){var e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map((function(t){return t.toJSON()}))),t&&"object"==typeof t)for(var n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=t[n],o=r.spec.state;o&&o.toJSON&&(e[n]=o.toJSON.call(r,this[r.key]))}return e},By.fromJSON=function(t,e,n){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var r=new Fy(t.schema,t.plugins),o=new By(r);return r.fields.forEach((function(r){if("doc"==r.name)o.doc=zv.fromJSON(t.schema,e.doc);else if("selection"==r.name)o.selection=Sy.fromJSON(o.doc,e.selection);else if("storedMarks"==r.name)e.storedMarks&&(o.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(n)for(var i in n){var s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(e,i))return void(o[r.name]=a.fromJSON.call(s,t,e[i],o))}o[r.name]=r.init(t,o)}})),o},By.addApplyListener=function(t){$y.push(t)},By.removeApplyListener=function(t){var e=$y.indexOf(t);e>-1&&$y.splice(e,1)},Object.defineProperties(By.prototype,Ly);var $y=[];function qy(t,e,n){for(var r in t){var o=t[r];o instanceof Function?o=o.bind(e):"handleDOMEvents"==r&&(o=qy(o,e,{})),n[r]=o}return n}var Jy=function(t){this.props={},t.props&&qy(t.props,this,this.props),this.spec=t,this.key=t.key?t.key.key:Vy("plugin")};Jy.prototype.getState=function(t){return t[this.key]};var Uy=Object.create(null);function Vy(t){return t in Uy?t+"$"+ ++Uy[t]:(Uy[t]=0,t+"$")}var Wy=function(t){void 0===t&&(t="key"),this.key=Vy(t)};Wy.prototype.get=function(t){return t.config.pluginsByKey[this.key]},Wy.prototype.getState=function(t){return t[this.key]};var Hy=function(t,e){var n;this.match=t,this.handler="string"==typeof e?(n=e,function(t,e,r,o){var i=n;if(e[1]){var s=e[0].lastIndexOf(e[1]);i+=e[0].slice(s+e[1].length);var a=(r+=s)-o;a>0&&(i=e[0].slice(s-a,s)+i,r=o)}return t.tr.insertText(i,r,o)}):e};function Ky(t,e,n,r,o,i){if(t.composing)return!1;var s=t.state,a=s.doc.resolve(e);if(a.parent.type.spec.code)return!1;for(var c=a.parent.textBetween(Math.max(0,a.parentOffset-500),a.parentOffset,null,"\ufffc")+r,u=0;u<o.length;u++){var l=o[u].match.exec(c),f=l&&o[u].handler(s,l,e-(l[0].length-r.length),n);if(f)return t.dispatch(f.setMeta(i,{transform:f,from:e,to:n,text:r})),!0}return!1}function Yy(t,e){for(var n=t.plugins,r=0;r<n.length;r++){var o=n[r],i=void 0;if(o.spec.isInputRules&&(i=o.getState(t))){if(e){for(var s=t.tr,a=i.transform,c=a.steps.length-1;c>=0;c--)s.step(a.steps[c].invert(a.docs[c]));if(i.text){var u=s.doc.resolve(i.from).marks();s.replaceWith(i.from,i.to,t.schema.text(i.text,u))}else s.delete(i.from,i.to);e(s)}return!0}}return!1}var Gy=new Hy(/--$/,"\u2014"),Qy=new Hy(/\.\.\.$/,"\u2026"),Xy=[new Hy(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"\u201c"),new Hy(/"$/,"\u201d"),new Hy(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"\u2018"),new Hy(/'$/,"\u2019")];function Zy(t,e,n,r){return new Hy(t,(function(t,o,i,s){var a=n instanceof Function?n(o):n,c=t.tr.delete(i,s),l=c.doc.resolve(i).blockRange(),f=l&&Object(u.h)(l,e,a);if(!f)return null;c.wrap(l,f);var h=c.doc.resolve(i-1).nodeBefore;return h&&h.type==e&&Object(u.e)(c.doc,i-1)&&(!r||r(o,h))&&c.join(i-1),c}))}function tm(t,e,n){return new Hy(t,(function(t,r,o,i){var s=t.doc.resolve(o),a=n instanceof Function?n(r):n;return s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e)?t.tr.delete(o,i).setBlockType(o,o,e,a):null}))}var em="ProseMirror-prompt";function nm(t){var e=document.body.appendChild(document.createElement("div"));e.className=em;var n=function(t){e.contains(t.target)||r()};setTimeout((function(){return window.addEventListener("mousedown",n)}),50);var r=function(){window.removeEventListener("mousedown",n),e.parentNode&&e.parentNode.removeChild(e)},o=[];for(var i in t.fields)o.push(t.fields[i].render());var s=document.createElement("button");s.type="submit",s.className=em+"-submit",s.textContent="OK";var a=document.createElement("button");a.type="button",a.className=em+"-cancel",a.textContent="Cancel",a.addEventListener("click",r);var c=e.appendChild(document.createElement("form"));t.title&&(c.appendChild(document.createElement("h5")).textContent=t.title),o.forEach((function(t){c.appendChild(document.createElement("div")).appendChild(t)}));var u=c.appendChild(document.createElement("div"));u.className=em+"-buttons",u.appendChild(s),u.appendChild(document.createTextNode(" ")),u.appendChild(a);var l=e.getBoundingClientRect();e.style.top=(window.innerHeight-l.height)/2+"px",e.style.left=(window.innerWidth-l.width)/2+"px";var f=function(){var e=function(t,e){var n=Object.create(null),r=0;for(var o in t){var i=t[o],s=e[r++],a=i.read(s),c=i.validate(a);if(c)return rm(s,c),null;n[o]=i.clean(a)}return n}(t.fields,o);e&&(r(),t.callback(e))};c.addEventListener("submit",(function(t){t.preventDefault(),f()})),c.addEventListener("keydown",(function(t){27==t.keyCode?(t.preventDefault(),r()):13!=t.keyCode||t.ctrlKey||t.metaKey||t.shiftKey?9==t.keyCode&&window.setTimeout((function(){e.contains(document.activeElement)||r()}),500):(t.preventDefault(),f())}));var h=c.elements[0];h&&h.focus()}function rm(t,e){var n=t.parentNode,r=n.appendChild(document.createElement("div"));r.style.left=t.offsetLeft+t.offsetWidth+2+"px",r.style.top=t.offsetTop-5+"px",r.className="ProseMirror-invalid",r.textContent=e,setTimeout((function(){return n.removeChild(r)}),1500)}var om=function(t){this.options=t};om.prototype.read=function(t){return t.value},om.prototype.validateType=function(t){},om.prototype.validate=function(t){return!t&&this.options.required?"Required field":this.validateType(t)||this.options.validate&&this.options.validate(t)},om.prototype.clean=function(t){return this.options.clean?this.options.clean(t):t};var im=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.render=function(){var t=document.createElement("input");return t.type="text",t.placeholder=this.options.label,t.value=this.options.value||"",t.autocomplete="off",t},e}(om);function sm(t,e){for(var n=t.selection.$from,r=n.depth;r>=0;r--){var o=n.index(r);if(n.node(r).canReplaceWith(o,o,e))return!0}return!1}function am(t,e){var n={label:e.title,run:t};for(var r in e)n[r]=e[r];return e.enable&&!0!==e.enable||e.select||(n[e.enable?"enable":"select"]=function(e){return t(e)}),new Cp(n)}function cm(t,e){var n=t.selection,r=n.from,o=n.$from,i=n.to;return n.empty?e.isInSet(t.storedMarks||o.marks()):t.doc.rangeHasMark(r,i,e)}function um(t,e){var n={active:function(e){return cm(e,t)},enable:!0};for(var r in e)n[r]=e[r];return am(hr(t),n)}function lm(t,e){return am(iv(t,e.attrs),e)}function fm(t){var e,n,r,o={};if((e=t.marks.strong)&&(o.toggleStrong=um(e,{title:"Toggle strong style",icon:Dp.strong})),(e=t.marks.em)&&(o.toggleEm=um(e,{title:"Toggle emphasis",icon:Dp.em})),(e=t.marks.code)&&(o.toggleCode=um(e,{title:"Toggle code font",icon:Dp.code})),(e=t.marks.link)&&(o.toggleLink=(n=e,new Cp({title:"Add or remove link",icon:Dp.link,active:function(t){return cm(t,n)},enable:function(t){return!t.selection.empty},run:function(t,e,r){if(cm(t,n))return hr(n)(t,e),!0;nm({title:"Create a link",fields:{href:new im({label:"Link target",required:!0}),title:new im({label:"Title"})},callback:function(t){hr(n,t)(r.state,r.dispatch),r.focus()}})}}))),(e=t.nodes.image)&&(o.insertImage=(r=e,new Cp({title:"Insert image",label:"Image",enable:function(t){return sm(t,r)},run:function(t,e,n){var o=t.selection,i=o.from,s=o.to,a=null;t.selection instanceof qo&&t.selection.node.type==r&&(a=t.selection.node.attrs),nm({title:"Insert image",fields:{src:new im({label:"Location",required:!0,value:a&&a.src}),title:new im({label:"Title",value:a&&a.title}),alt:new im({label:"Description",value:a?a.alt:t.doc.textBetween(i,s," ")})},callback:function(t){n.dispatch(n.state.tr.replaceSelectionWith(r.createAndFill(t))),n.focus()}})}}))),(e=t.nodes.bullet_list)&&(o.wrapBulletList=lm(e,{title:"Wrap in bullet list",icon:Dp.bulletList})),(e=t.nodes.ordered_list)&&(o.wrapOrderedList=lm(e,{title:"Wrap in ordered list",icon:Dp.orderedList})),(e=t.nodes.blockquote)&&(o.wrapBlockQuote=function(t,e){var n={run:function(n,r){return lr(t,e.attrs)(n,r)},select:function(n){return lr(t,e.attrs instanceof Function?null:e.attrs)(n)}};for(var r in e)n[r]=e[r];return new Cp(n)}(e,{title:"Wrap in block quote",icon:Dp.blockquote})),(e=t.nodes.paragraph)&&(o.makeParagraph=Lp(e,{title:"Change to paragraph",label:"Plain"})),(e=t.nodes.code_block)&&(o.makeCodeBlock=Lp(e,{title:"Change to code block",label:"Code"})),e=t.nodes.heading)for(var i=1;i<=10;i++)o["makeHead"+i]=Lp(e,{title:"Change to heading "+i,label:"Level "+i,attrs:{level:i}});if(e=t.nodes.horizontal_rule){var s=e;o.insertHorizontalRule=new Cp({title:"Insert horizontal rule",label:"Horizontal rule",enable:function(t){return sm(t,s)},run:function(t,e){e(t.tr.replaceSelectionWith(s.create()))}})}var a=function(t){return t.filter((function(t){return t}))};return o.insertMenu=new Np(a([o.insertImage,o.insertHorizontalRule]),{label:"Insert"}),o.typeMenu=new Np(a([o.makeParagraph,o.makeCodeBlock,o.makeHead1&&new jp(a([o.makeHead1,o.makeHead2,o.makeHead3,o.makeHead4,o.makeHead5,o.makeHead6]),{label:"Heading"})]),{label:"Type..."}),o.inlineMenu=[a([o.toggleStrong,o.toggleEm,o.toggleCode,o.toggleLink])],o.blockMenu=[a([o.wrapBulletList,o.wrapOrderedList,o.wrapBlockQuote,Rp,Pp,zp])],o.fullMenu=o.inlineMenu.concat([[o.insertMenu,o.typeMenu]],[[Fp,Bp]],o.blockMenu),o}var hm="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);function pm(t,e){var n,r,o={};function i(t,n){if(e){var r=e[t];if(!1===r)return;r&&(t=r)}o[t]=n}if(i("Mod-z",le),i("Shift-Mod-z",fe),i("Backspace",Yy),hm||i("Mod-y",fe),i("Alt-ArrowUp",nr),i("Alt-ArrowDown",rr),i("Mod-BracketLeft",or),i("Escape",cr),(n=t.marks.strong)&&(i("Mod-b",hr(n)),i("Mod-B",hr(n))),(n=t.marks.em)&&(i("Mod-i",hr(n)),i("Mod-I",hr(n))),(n=t.marks.code)&&i("Mod-`",hr(n)),(n=t.nodes.bullet_list)&&i("Shift-Ctrl-8",iv(n)),(n=t.nodes.ordered_list)&&i("Shift-Ctrl-9",iv(n)),(n=t.nodes.blockquote)&&i("Ctrl->",lr(n)),n=t.nodes.hard_break){var s=n,a=pr(sr,(function(t,e){return e(t.tr.replaceSelectionWith(s.create()).scrollIntoView()),!0}));i("Mod-Enter",a),i("Shift-Enter",a),hm&&i("Ctrl-Enter",a)}if((n=t.nodes.list_item)&&(i("Enter",(r=n,function(t,e){var n=t.selection,o=n.$from,i=n.$to,s=n.node;if(s&&s.isBlock||o.depth<2||!o.sameParent(i))return!1;var a=o.node(-1);if(a.type!=r)return!1;if(0==o.parent.content.size&&o.node(-1).childCount==o.indexAfter(-1)){if(2==o.depth||o.node(-3).type!=r||o.index(-2)!=o.node(-2).childCount-1)return!1;if(e){for(var c=Wp.empty,l=o.index(-1)>0,f=o.depth-(l?1:2);f>=o.depth-3;f--)c=Wp.from(o.node(f).copy(c));c=c.append(Wp.from(r.createAndFill()));var h=t.tr.replace(o.before(l?null:-1),o.after(-3),new Zp(c,l?3:2,2));h.setSelection(t.selection.constructor.near(h.doc.resolve(o.pos+(l?3:2)))),e(h.scrollIntoView())}return!0}var p=i.pos==o.end()?a.contentMatchAt(0).defaultType:null,d=t.tr.delete(o.pos,i.pos),v=p&&[null,{type:p}];return!!Object(u.f)(d.doc,o.pos,2,v)&&(e&&e(d.split(o.pos,2,v).scrollIntoView()),!0)})),i("Mod-[",sv(n)),i("Mod-]",function(t){return function(e,n){var r=e.selection,o=r.$from,i=r.$to,s=o.blockRange(i,(function(e){return e.childCount&&e.firstChild.type==t}));if(!s)return!1;var a=s.startIndex;if(0==a)return!1;var c=s.parent,l=c.child(a-1);if(l.type!=t)return!1;if(n){var f=l.lastChild&&l.lastChild.type==c.type,h=Wp.from(f?t.create():null),p=new Zp(Wp.from(t.create(null,Wp.from(c.type.create(null,h)))),f?3:1,0),d=s.start,v=s.end;n(e.tr.step(new u.b(d-(f?3:1),v,d,v,p,1,!0)).scrollIntoView())}return!0}}(n))),(n=t.nodes.paragraph)&&i("Shift-Ctrl-0",fr(n)),(n=t.nodes.code_block)&&i("Shift-Ctrl-\\",fr(n)),n=t.nodes.heading)for(var c=1;c<=6;c++)i("Shift-Ctrl-"+c,fr(n,{level:c}));if(n=t.nodes.horizontal_rule){var l=n;i("Mod-_",(function(t,e){return e(t.tr.replaceSelectionWith(l.create()).scrollIntoView()),!0}))}return o}function dm(t){var e,n=Xy.concat(Qy,Gy);return(e=t.nodes.blockquote)&&n.push(Zy(/^\s*>\s$/,e)),(e=t.nodes.ordered_list)&&n.push(function(t){return Zy(/^(\d+)\.\s$/,t,(function(t){return{order:+t[1]}}),(function(t,e){return e.childCount+e.attrs.order==+t[1]}))}(e)),(e=t.nodes.bullet_list)&&n.push(function(t){return Zy(/^\s*([-+*])\s$/,t)}(e)),(e=t.nodes.code_block)&&n.push(function(t){return tm(/^```$/,t)}(e)),(e=t.nodes.heading)&&n.push(function(t,e){return tm(new RegExp("^(#{1,"+e+"})\\s$"),t,(function(t){return{level:t[1].length}}))}(e,6)),function(t){var e=t.rules,n=new Jy({state:{init:function(){return null},apply:function(t,e){return t.getMeta(this)||(t.selectionSet||t.docChanged?null:e)}},props:{handleTextInput:function(t,r,o,i){return Ky(t,r,o,i,e,n)},handleDOMEvents:{compositionend:function(t){setTimeout((function(){var r=t.state.selection.$cursor;r&&Ky(t,r.pos,r.pos,"",e,n)}))}}},isInputRules:!0});return n}({rules:n})}function vm(t){var e=[dm(t.schema),Object(r.b)(pm(t.schema,t.mapKeys)),Object(r.b)(br),Ks(),new Ic({props:{decorations:If,createSelectionBetween:function(t,e,n){if(e.pos==n.pos&&_f.valid(n))return new _f(n)},handleClick:Af,handleKeyDown:Tf}})];return!1!==t.menuBar&&e.push(function(t){return new mp({view:function(e){return new Jp(e,t)}})}({floating:!1!==t.floatingMenu,content:t.menuContent||fm(t.schema).fullMenu})),!1!==t.history&&e.push(ue()),e.concat(new ri({props:{attributes:{class:"ProseMirror-example-setup-style"}}}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return A}));var r={};function o(t){var e=null;return function(){return null==e&&(e=t()),e}}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.r(r),n.d(r,"FILE",(function(){return v})),n.d(r,"URL",(function(){return y})),n.d(r,"TEXT",(function(){return m}));var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.entered=[],this.isNodeInDocument=e}var e,n,r;return e=t,(n=[{key:"enter",value:function(t){var e=this,n=this.entered.length;return this.entered=function(t,e){var n=new Set,r=function(t){return n.add(t)};t.forEach(r),e.forEach(r);var o=[];return n.forEach((function(t){return o.push(t)})),o}(this.entered.filter((function(n){return e.isNodeInDocument(n)&&(!n.contains||n.contains(t))})),[t]),0===n&&this.entered.length>0}},{key:"leave",value:function(t){var e,n,r=this.entered.length;return this.entered=(e=this.entered.filter(this.isNodeInDocument),n=t,e.filter((function(t){return t!==n}))),r>0&&0===this.entered.length}},{key:"reset",value:function(){this.entered=[]}}])&&i(e.prototype,n),r&&i(e,r),t}(),a=o((function(){return/firefox/i.test(navigator.userAgent)})),c=o((function(){return Boolean(window.safari)}));function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=e.length,o=[],i=0;i<r;i++)o.push(i);o.sort((function(t,n){return e[t]<e[n]?-1:1}));for(var s,a,c=[],u=[],l=[],f=0;f<r-1;f++)s=e[f+1]-e[f],a=n[f+1]-n[f],u.push(s),c.push(a),l.push(a/s);for(var h=[l[0]],p=0;p<u.length-1;p++){var d=l[p],v=l[p+1];if(d*v<=0)h.push(0);else{s=u[p];var y=u[p+1],m=s+y;h.push(3*m/((m+y)/d+(m+s)/v))}}h.push(l[l.length-1]);for(var g,b=[],w=[],k=0;k<h.length-1;k++){g=l[k];var x=h[k],S=1/u[k],O=x+h[k+1]-g-g;b.push((g-x-O)*S),w.push(O*S*S)}this.xs=e,this.ys=n,this.c1s=h,this.c2s=b,this.c3s=w}var e,n,r;return e=t,(n=[{key:"interpolate",value:function(t){var e=this.xs,n=this.ys,r=this.c1s,o=this.c2s,i=this.c3s,s=e.length-1;if(t===e[s])return n[s];for(var a,c=0,u=i.length-1;c<=u;){var l=e[a=Math.floor(.5*(c+u))];if(l<t)c=a+1;else{if(!(l>t))return n[a];u=a-1}}var f=t-e[s=Math.max(0,u)],h=f*f;return n[s]+r[s]*f+o[s]*h+i[s]*f*h}}])&&u(e.prototype,n),r&&u(e,r),t}();function f(t){var e=1===t.nodeType?t:t.parentElement;if(!e)return null;var n=e.getBoundingClientRect(),r=n.top;return{x:n.left,y:r}}function h(t){return{x:t.clientX,y:t.clientY}}function p(t,e,n,r,o){var i=function(t){var e;return"IMG"===t.nodeName&&(a()||!(null===(e=document.documentElement)||void 0===e?void 0:e.contains(t)))}(e),s=f(i?t:e),u={x:n.x-s.x,y:n.y-s.y},h=t.offsetWidth,p=t.offsetHeight,d=r.anchorX,v=r.anchorY,y=function(t,e,n,r){var o=t?e.width:n,i=t?e.height:r;return c()&&t&&(i/=window.devicePixelRatio,o/=window.devicePixelRatio),{dragPreviewWidth:o,dragPreviewHeight:i}}(i,e,h,p),m=y.dragPreviewWidth,g=y.dragPreviewHeight,b=o.offsetX,w=o.offsetY,k=0===w||w;return{x:0===b||b?b:new l([0,.5,1],[u.x,u.x/h*m,u.x+m-h]).interpolate(d),y:k?w:function(){var t=new l([0,.5,1],[u.y,u.y/p*g,u.y+g-p]).interpolate(v);return c()&&i&&(t+=(window.devicePixelRatio-1)*g),t}()}}var d,v="__NATIVE_FILE__",y="__NATIVE_URL__",m="__NATIVE_TEXT__";function g(t,e,n){var r=e.reduce((function(e,n){return e||t.getData(n)}),"");return null!=r?r:n}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w=(b(d={},v,{exposeProperties:{files:function(t){return Array.prototype.slice.call(t.files)},items:function(t){return t.items}},matchesTypes:["Files"]}),b(d,y,{exposeProperties:{urls:function(t,e){return g(t,e,"").split("\n")}},matchesTypes:["Url","text/uri-list"]}),b(d,m,{exposeProperties:{text:function(t,e){return g(t,e,"")}},matchesTypes:["Text","text/plain"]}),d);function k(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var x=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=e,this.item={},this.initializeExposedProperties()}var e,n,r;return e=t,(n=[{key:"initializeExposedProperties",value:function(){var t=this;Object.keys(this.config.exposeProperties).forEach((function(e){Object.defineProperty(t.item,e,{configurable:!0,enumerable:!0,get:function(){return console.warn("Browser doesn't allow reading \"".concat(e,'" until the drop event.')),null}})}))}},{key:"loadDataTransfer",value:function(t){var e=this;if(t){var n={};Object.keys(this.config.exposeProperties).forEach((function(r){n[r]={value:e.config.exposeProperties[r](t,e.config.matchesTypes),configurable:!0,enumerable:!0}})),Object.defineProperties(this.item,n)}}},{key:"canDrag",value:function(){return!0}},{key:"beginDrag",value:function(){return this.item}},{key:"isDragging",value:function(t,e){return e===t.getSourceId()}},{key:"endDrag",value:function(){}}])&&k(e.prototype,n),r&&k(e,r),t}();function S(t){if(!t)return null;var e=Array.prototype.slice.call(t.types||[]);return Object.keys(w).filter((function(t){return w[t].matchesTypes.some((function(t){return e.indexOf(t)>-1}))}))[0]||null}function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var C=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.globalContext=e}var e,n,r;return e=t,(n=[{key:"window",get:function(){return this.globalContext?this.globalContext:"undefined"!==typeof window?window:void 0}},{key:"document",get:function(){if(this.window)return this.window.document}}])&&O(e.prototype,n),r&&O(e,r),t}();function E(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?E(Object(n),!0).forEach((function(e){M(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function M(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var N=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.getSourceClientOffset=function(t){var e=r.sourceNodes.get(t);return e&&f(e)||null},this.endDragNativeItem=function(){r.isDraggingNativeItem()&&(r.actions.endDrag(),r.currentNativeHandle&&r.registry.removeSource(r.currentNativeHandle),r.currentNativeHandle=null,r.currentNativeSource=null)},this.isNodeInDocument=function(t){return Boolean(t&&r.document&&r.document.body&&document.body.contains(t))},this.endDragIfSourceWasRemovedFromDOM=function(){var t=r.currentDragSourceNode;r.isNodeInDocument(t)||r.clearCurrentDragSourceNode()&&r.actions.endDrag()},this.handleTopDragStartCapture=function(){r.clearCurrentDragSourceNode(),r.dragStartSourceIds=[]},this.handleTopDragStart=function(t){if(!t.defaultPrevented){var e=r.dragStartSourceIds;r.dragStartSourceIds=null;var n=h(t);r.monitor.isDragging()&&r.actions.endDrag(),r.actions.beginDrag(e||[],{publishSource:!1,getSourceClientOffset:r.getSourceClientOffset,clientOffset:n});var o=t.dataTransfer,i=S(o);if(r.monitor.isDragging()){if(o&&"function"===typeof o.setDragImage){var s=r.monitor.getSourceId(),a=r.sourceNodes.get(s),c=r.sourcePreviewNodes.get(s)||a;if(c){var u=r.getCurrentSourcePreviewNodeOptions(),l=p(a,c,n,{anchorX:u.anchorX,anchorY:u.anchorY},{offsetX:u.offsetX,offsetY:u.offsetY});o.setDragImage(c,l.x,l.y)}}try{null===o||void 0===o||o.setData("application/json",{})}catch(f){}r.setCurrentDragSourceNode(t.target),r.getCurrentSourcePreviewNodeOptions().captureDraggingState?r.actions.publishDragSource():setTimeout((function(){return r.actions.publishDragSource()}),0)}else if(i)r.beginDragNativeItem(i);else{if(o&&!o.types&&(t.target&&!t.target.hasAttribute||!t.target.hasAttribute("draggable")))return;t.preventDefault()}}},this.handleTopDragEndCapture=function(){r.clearCurrentDragSourceNode()&&r.actions.endDrag()},this.handleTopDragEnterCapture=function(t){if(r.dragEnterTargetIds=[],r.enterLeaveCounter.enter(t.target)&&!r.monitor.isDragging()){var e=t.dataTransfer,n=S(e);n&&r.beginDragNativeItem(n,e)}},this.handleTopDragEnter=function(t){var e=r.dragEnterTargetIds;(r.dragEnterTargetIds=[],r.monitor.isDragging())&&(r.altKeyPressed=t.altKey,a()||r.actions.hover(e,{clientOffset:h(t)}),e.some((function(t){return r.monitor.canDropOnTarget(t)}))&&(t.preventDefault(),t.dataTransfer&&(t.dataTransfer.dropEffect=r.getCurrentDropEffect())))},this.handleTopDragOverCapture=function(){r.dragOverTargetIds=[]},this.handleTopDragOver=function(t){var e=r.dragOverTargetIds;if(r.dragOverTargetIds=[],!r.monitor.isDragging())return t.preventDefault(),void(t.dataTransfer&&(t.dataTransfer.dropEffect="none"));r.altKeyPressed=t.altKey,r.actions.hover(e||[],{clientOffset:h(t)}),(e||[]).some((function(t){return r.monitor.canDropOnTarget(t)}))?(t.preventDefault(),t.dataTransfer&&(t.dataTransfer.dropEffect=r.getCurrentDropEffect())):r.isDraggingNativeItem()?t.preventDefault():(t.preventDefault(),t.dataTransfer&&(t.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=function(t){r.isDraggingNativeItem()&&t.preventDefault(),r.enterLeaveCounter.leave(t.target)&&r.isDraggingNativeItem()&&r.endDragNativeItem()},this.handleTopDropCapture=function(t){var e;(r.dropTargetIds=[],t.preventDefault(),r.isDraggingNativeItem())&&(null===(e=r.currentNativeSource)||void 0===e||e.loadDataTransfer(t.dataTransfer));r.enterLeaveCounter.reset()},this.handleTopDrop=function(t){var e=r.dropTargetIds;r.dropTargetIds=[],r.actions.hover(e,{clientOffset:h(t)}),r.actions.drop({dropEffect:r.getCurrentDropEffect()}),r.isDraggingNativeItem()?r.endDragNativeItem():r.endDragIfSourceWasRemovedFromDOM()},this.handleSelectStart=function(t){var e=t.target;"function"===typeof e.dragDrop&&("INPUT"===e.tagName||"SELECT"===e.tagName||"TEXTAREA"===e.tagName||e.isContentEditable||(t.preventDefault(),e.dragDrop()))},this.options=new C(n),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.registry=e.getRegistry(),this.enterLeaveCounter=new s(this.isNodeInDocument)}var e,n,o;return e=t,(n=[{key:"profile",value:function(){var t,e;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:(null===(t=this.dragStartSourceIds)||void 0===t?void 0:t.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:(null===(e=this.dragOverTargetIds)||void 0===e?void 0:e.length)||0}}},{key:"setup",value:function(){if(void 0!==this.window){if(this.window.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");this.window.__isReactDndBackendSetUp=!0,this.addEventListeners(this.window)}}},{key:"teardown",value:function(){void 0!==this.window&&(this.window.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.window),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId&&this.window.cancelAnimationFrame(this.asyncEndDragFrameId))}},{key:"connectDragPreview",value:function(t,e,n){var r=this;return this.sourcePreviewNodeOptions.set(t,n),this.sourcePreviewNodes.set(t,e),function(){r.sourcePreviewNodes.delete(t),r.sourcePreviewNodeOptions.delete(t)}}},{key:"connectDragSource",value:function(t,e,n){var r=this;this.sourceNodes.set(t,e),this.sourceNodeOptions.set(t,n);var o=function(e){return r.handleDragStart(e,t)},i=function(t){return r.handleSelectStart(t)};return e.setAttribute("draggable","true"),e.addEventListener("dragstart",o),e.addEventListener("selectstart",i),function(){r.sourceNodes.delete(t),r.sourceNodeOptions.delete(t),e.removeEventListener("dragstart",o),e.removeEventListener("selectstart",i),e.setAttribute("draggable","false")}}},{key:"connectDropTarget",value:function(t,e){var n=this,r=function(e){return n.handleDragEnter(e,t)},o=function(e){return n.handleDragOver(e,t)},i=function(e){return n.handleDrop(e,t)};return e.addEventListener("dragenter",r),e.addEventListener("dragover",o),e.addEventListener("drop",i),function(){e.removeEventListener("dragenter",r),e.removeEventListener("dragover",o),e.removeEventListener("drop",i)}}},{key:"addEventListeners",value:function(t){t.addEventListener&&(t.addEventListener("dragstart",this.handleTopDragStart),t.addEventListener("dragstart",this.handleTopDragStartCapture,!0),t.addEventListener("dragend",this.handleTopDragEndCapture,!0),t.addEventListener("dragenter",this.handleTopDragEnter),t.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),t.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),t.addEventListener("dragover",this.handleTopDragOver),t.addEventListener("dragover",this.handleTopDragOverCapture,!0),t.addEventListener("drop",this.handleTopDrop),t.addEventListener("drop",this.handleTopDropCapture,!0))}},{key:"removeEventListeners",value:function(t){t.removeEventListener&&(t.removeEventListener("dragstart",this.handleTopDragStart),t.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),t.removeEventListener("dragend",this.handleTopDragEndCapture,!0),t.removeEventListener("dragenter",this.handleTopDragEnter),t.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),t.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),t.removeEventListener("dragover",this.handleTopDragOver),t.removeEventListener("dragover",this.handleTopDragOverCapture,!0),t.removeEventListener("drop",this.handleTopDrop),t.removeEventListener("drop",this.handleTopDropCapture,!0))}},{key:"getCurrentSourceNodeOptions",value:function(){var t=this.monitor.getSourceId(),e=this.sourceNodeOptions.get(t);return _({dropEffect:this.altKeyPressed?"copy":"move"},e||{})}},{key:"getCurrentDropEffect",value:function(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}},{key:"getCurrentSourcePreviewNodeOptions",value:function(){var t=this.monitor.getSourceId();return _({anchorX:.5,anchorY:.5,captureDraggingState:!1},this.sourcePreviewNodeOptions.get(t)||{})}},{key:"isDraggingNativeItem",value:function(){var t=this.monitor.getItemType();return Object.keys(r).some((function(e){return r[e]===t}))}},{key:"beginDragNativeItem",value:function(t,e){this.clearCurrentDragSourceNode(),this.currentNativeSource=function(t,e){var n=new x(w[t]);return n.loadDataTransfer(e),n}(t,e),this.currentNativeHandle=this.registry.addSource(t,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}},{key:"setCurrentDragSourceNode",value:function(t){var e=this;this.clearCurrentDragSourceNode(),this.currentDragSourceNode=t,this.mouseMoveTimeoutTimer=setTimeout((function(){return e.window&&e.window.addEventListener("mousemove",e.endDragIfSourceWasRemovedFromDOM,!0)}),1e3)}},{key:"clearCurrentDragSourceNode",value:function(){return!!this.currentDragSourceNode&&(this.currentDragSourceNode=null,this.window&&(this.window.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.window.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)),this.mouseMoveTimeoutTimer=null,!0)}},{key:"handleDragStart",value:function(t,e){t.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(e))}},{key:"handleDragEnter",value:function(t,e){this.dragEnterTargetIds.unshift(e)}},{key:"handleDragOver",value:function(t,e){null===this.dragOverTargetIds&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(e)}},{key:"handleDrop",value:function(t,e){this.dropTargetIds.unshift(e)}},{key:"window",get:function(){return this.options.window}},{key:"document",get:function(){return this.options.document}}])&&T(e.prototype,n),o&&T(e,o),t}(),A=function(t,e){return new N(t,e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return ot}));var r=n(24),o=n(22),i=n(27),s=n(11),a=n(10),c=n(30),u=n(3),l=n(5),f=n(40),h=n(26),p=n(9),d=3e4,v=function t(e){if(e.shouldConnect&&null===e.ws){var n=new WebSocket(e.url),r=e.binaryType,o=null;r&&(n.binaryType=r),e.ws=n,e.connecting=!0,e.connected=!1,n.onmessage=function(t){e.lastMessageReceived=h.a();var n=t.data,r="string"===typeof n?JSON.parse(n):n;r&&"pong"===r.type&&(clearTimeout(o),o=setTimeout(s,15e3)),e.emit("message",[r,e])};var i=function(n){null!==e.ws&&(e.ws=null,e.connecting=!1,e.connected?(e.connected=!1,e.emit("disconnect",[{type:"disconnect",error:n},e])):e.unsuccessfulReconnects++,setTimeout(t,p.g(1200*p.e(e.unsuccessfulReconnects+1),2500),e)),clearTimeout(o)},s=function(){e.ws===n&&e.send({type:"ping"})};n.onclose=function(){return i(null)},n.onerror=function(t){return i(t)},n.onopen=function(){e.lastMessageReceived=h.a(),e.connecting=!1,e.connected=!0,e.unsuccessfulReconnects=0,e.emit("connect",[{type:"connect"},e]),o=setTimeout(s,15e3)}}},y=function(t){Object(s.a)(n,t);var e=Object(a.a)(n);function n(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=o.binaryType;return Object(u.a)(this,n),(r=e.call(this)).url=t,r.ws=null,r.binaryType=s||null,r.connected=!1,r.connecting=!1,r.unsuccessfulReconnects=0,r.lastMessageReceived=0,r.shouldConnect=!0,r._checkInterval=setInterval((function(){r.connected&&d<h.a()-r.lastMessageReceived&&r.ws.close()}),15e3),v(Object(i.a)(r)),r}return Object(l.a)(n,[{key:"send",value:function(t){this.ws&&this.ws.send(JSON.stringify(t))}},{key:"destroy",value:function(){clearInterval(this._checkInterval),this.disconnect(),Object(r.a)(Object(o.a)(n.prototype),"destroy",this).call(this)}},{key:"disconnect",value:function(){this.shouldConnect=!1,null!==this.ws&&this.ws.close()}},{key:"connect",value:function(){this.shouldConnect=!0,this.connected||null!==this.ws||v(this)}}]),n}(f.a),m=n(13),g=n(15),b=n(50),w=n(0),k=n(2),x=n(19),S=function(t){return Promise.resolve(t)},O=n(31),C=n(63),E=new Map,_="undefined"===typeof BroadcastChannel?function(){function t(e){var n=this;Object(u.a)(this,t),this.room=e,this.onmessage=null,addEventListener("storage",(function(t){return t.key===e&&null!==n.onmessage&&n.onmessage({data:O.d(t.newValue||"")})}))}return Object(l.a)(t,[{key:"postMessage",value:function(t){C.a.setItem(this.room,O.e(O.b(t)))}}]),t}():BroadcastChannel,M=function(t){return m.e(E,t,(function(){var e=new Set,n=new _(t);return n.onmessage=function(t){return e.forEach((function(e){return e(t.data)}))},{bc:n,subs:e}}))},T=n(64),N=n(83),A=n.n(N),I=n(6),j=function(t,e){w.m(t,0);var n=I.v(e);w.n(t,n)},D=function(t,e,n){w.m(t,1),w.n(t,I.u(e,n))},R=function(t,e,n){I.m(e,k.l(t),n)},P=R,z=function(t,e,n,r){var o=k.k(t);switch(o){case 0:!function(t,e,n){D(e,n,k.l(t))}(t,e,n);break;case 1:R(t,n,r);break;case 2:P(t,n,r);break;default:throw new Error("Unknown message type")}return o},F=n(42),B=n(48),L=function(t,e){var n=B.a(t).buffer,r=B.a(e).buffer;return crypto.subtle.importKey("raw",n,"PBKDF2",!1,["deriveKey"]).then((function(t){return crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},t,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}))},$=function(t,e){if(!e)return S(t);var n=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:n},e,t).then((function(t){var e=w.e();return w.l(e,"AES-GCM"),w.n(e,n),w.n(e,new Uint8Array(t)),w.f(e)}))},q=function(t,e){if(!e)return S(t);var n,r=k.e(t);"AES-GCM"!==k.j(r)&&(n=g.a("Unknown encryption algorithm"),Promise.reject(n));var o=k.l(r),i=k.l(r);return crypto.subtle.decrypt({name:"AES-GCM",iv:o},e,i).then((function(t){return new Uint8Array(t)}))},J=x.g("y-webrtc"),U=new Map,V=new Map,W=function(t){var e=!0;t.webrtcConns.forEach((function(t){t.synced||(e=!1)})),(!e&&t.synced||e&&!t.synced)&&(t.synced=e,t.provider.emit("synced",[{synced:e}]),J("synced ",x.a,t.name,x.e," with all peers"))},H=function(t,e,n){var r=k.e(e),o=w.e(),i=k.k(r);if(void 0===t)return null;var s=t.awareness,a=t.doc,c=!1;switch(i){case 0:w.m(o,0);var u=z(r,o,a,t);1!==u||t.synced||n(),0===u&&(c=!0);break;case 3:w.m(o,1),w.n(o,F.c(s,Array.from(s.getStates().keys()))),c=!0;break;case 1:F.b(s,k.l(r),t);break;case 4:var l=1===k.h(r),f=k.j(r);if(f!==t.peerId&&(t.bcConns.has(f)&&!l||!t.bcConns.has(f)&&l)){var h=[],p=[];l?(t.bcConns.add(f),p.push(f)):(t.bcConns.delete(f),h.push(f)),t.provider.emit("peers",[{added:p,removed:h,webrtcPeers:Array.from(t.webrtcConns.keys()),bcPeers:Array.from(t.bcConns)}]),Z(t)}break;default:return console.error("Unable to compute message"),o}return c?o:null},K=function(t,e){J("send message to ",x.a,t.remotePeerId,x.e,x.b," (",t.room.name,")",x.f);try{t.peer.send(w.f(e))}catch(n){}},Y=function(){function t(e,n,r,o){var i=this;Object(u.a)(this,t),J("establishing connection to ",x.a,r),this.room=o,this.remotePeerId=r,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new A.a(Object(c.a)({initiator:n},o.provider.peerOpts)),this.peer.on("signal",(function(t){nt(e,o,{to:r,from:o.peerId,type:"signal",signal:t})})),this.peer.on("connect",(function(){J("connected to ",x.a,r),i.connected=!0;var t=o.provider.doc,e=o.awareness,n=w.e();w.m(n,0),j(n,t),K(i,n);var s=e.getStates();if(s.size>0){var a=w.e();w.m(a,1),w.n(a,F.c(e,Array.from(s.keys()))),K(i,a)}})),this.peer.on("close",(function(){i.connected=!1,i.closed=!0,o.webrtcConns.has(i.remotePeerId)&&(o.webrtcConns.delete(i.remotePeerId),o.provider.emit("peers",[{removed:[i.remotePeerId],added:[],webrtcPeers:Array.from(o.webrtcConns.keys()),bcPeers:Array.from(o.bcConns)}])),W(o),i.peer.destroy(),J("closed connection to ",x.a,r),X(o)})),this.peer.on("error",(function(t){J("Error in connection to ",x.a,r,": ",t),X(o)})),this.peer.on("data",(function(t){var e=function(t,e){var n=t.room;return J("received message from ",x.a,t.remotePeerId,x.b," (",n.name,")",x.e,x.f),H(n,e,(function(){t.synced=!0,J("synced ",x.a,n.name,x.e," with ",x.a,t.remotePeerId),W(n)}))}(i,t);null!==e&&K(i,e)}))}return Object(l.a)(t,[{key:"destroy",value:function(){this.peer.destroy()}}]),t}(),G=function(t,e){return $(e,t.key).then((function(e){return t.mux((function(){return function(t,e){var n=M(t);n.bc.postMessage(e),n.subs.forEach((function(t){return t(e)}))}(t.name,e)}))}))},Q=function(t,e){t.bcconnected&&G(t,e),function(t,e){J("broadcast message in ",x.a,t.name,x.e),t.webrtcConns.forEach((function(t){try{t.peer.send(e)}catch(n){}}))}(t,e)},X=function(t){U.forEach((function(e){e.connected&&(e.send({type:"subscribe",topics:[t.name]}),t.webrtcConns.size<t.provider.maxConns&&nt(e,t,{type:"announce",from:t.peerId}))}))},Z=function(t){if(t.provider.filterBcConns){var e=w.e();w.m(e,4),w.i(e,1),w.l(e,t.peerId),G(t,w.f(e))}},tt=function(){function t(e,n,r,o){var i=this;Object(u.a)(this,t),this.peerId=b.d(),this.doc=e,this.awareness=n.awareness,this.provider=n,this.synced=!1,this.name=r,this.key=o,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=Object(T.a)(),this.bcconnected=!1,this._bcSubscriber=function(t){return q(new Uint8Array(t),o).then((function(t){return i.mux((function(){var e=H(i,t,(function(){}));e&&G(i,w.f(e))}))}))},this._docUpdateHandler=function(t,e){var n=w.e();w.m(n,0),function(t,e){w.m(t,2),w.n(t,e)}(n,t),Q(i,w.f(n))},this._awarenessUpdateHandler=function(t,e){var n=t.added,r=t.updated,o=t.removed,s=n.concat(r).concat(o),a=w.e();w.m(a,1),w.n(a,F.c(i.awareness,s)),Q(i,w.f(a))},this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),window.addEventListener("beforeunload",(function(){F.d(i.awareness,[e.clientID],"window unload"),V.forEach((function(t){t.disconnect()}))}))}return Object(l.a)(t,[{key:"connect",value:function(){X(this);var t,e,n=this.name;t=n,e=this._bcSubscriber,M(t).subs.add(e),this.bcconnected=!0,Z(this);var r=w.e();w.m(r,0),j(r,this.doc),G(this,w.f(r));var o=w.e();w.m(o,0),D(o,this.doc),G(this,w.f(o));var i=w.e();w.m(i,3),G(this,w.f(i));var s=w.e();w.m(s,1),w.n(s,F.c(this.awareness,[this.doc.clientID])),G(this,w.f(s))}},{key:"disconnect",value:function(){var t=this;U.forEach((function(e){e.connected&&e.send({type:"unsubscribe",topics:[t.name]})})),F.d(this.awareness,[this.doc.clientID],"disconnect");var e,n,r=w.e();w.m(r,4),w.i(r,0),w.l(r,this.peerId),G(this,w.f(r)),e=this.name,n=this._bcSubscriber,M(e).subs.delete(n),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach((function(t){return t.destroy()}))}},{key:"destroy",value:function(){this.disconnect()}}]),t}(),et=function(t,e,n,r){if(V.has(n))throw g.a('A Yjs Doc connected to room "'.concat(n,'" already exists!'));var o=new tt(t,e,n,r);return V.set(n,o),o},nt=function(t,e,n){e.key?function(t,e){var n=w.e();return w.g(n,t),$(w.f(n),e)}(n,e.key).then((function(n){t.send({type:"publish",topic:e.name,data:O.e(n)})})):t.send({type:"publish",topic:e.name,data:n})},rt=function(t){Object(s.a)(n,t);var e=Object(a.a)(n);function n(t){var r;return Object(u.a)(this,n),(r=e.call(this,t)).providers=new Set,r.on("connect",(function(){J("connected (".concat(t,")"));var e=Array.from(V.keys());r.send({type:"subscribe",topics:e}),V.forEach((function(t){return nt(Object(i.a)(r),t,{type:"announce",from:t.peerId})}))})),r.on("message",(function(t){switch(t.type){case"publish":var e=t.topic,n=V.get(e);if(null==n||"string"!==typeof e)return;var o=function(t){var e=n.webrtcConns,o=n.peerId;if(!(null==t||t.from===o||void 0!==t.to&&t.to!==o||n.bcConns.has(t.from))){var s=e.has(t.from)?function(){}:function(){return n.provider.emit("peers",[{removed:[],added:[t.from],webrtcPeers:Array.from(n.webrtcConns.keys()),bcPeers:Array.from(n.bcConns)}])};switch(t.type){case"announce":e.size<n.provider.maxConns&&(m.e(e,t.from,(function(){return new Y(Object(i.a)(r),!0,t.from,n)})),s());break;case"signal":t.to===o&&(m.e(e,t.from,(function(){return new Y(Object(i.a)(r),!1,t.from,n)})).peer.signal(t.signal),s())}}};n.key?"string"===typeof t.data&&(s=O.d(t.data),a=n.key,q(s,a).then((function(t){return k.g(k.e(new Uint8Array(t)))}))).then(o):o(t.data)}var s,a})),r.on("disconnect",(function(){return J("disconnect (".concat(t,")"))})),r}return n}(y),ot=function(t){Object(s.a)(n,t);var e=Object(a.a)(n);function n(t,r){var o,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=s.signaling,c=void 0===a?["wss://signaling.yjs.dev","wss://y-webrtc-signaling-eu.herokuapp.com","wss://y-webrtc-signaling-us.herokuapp.com"]:a,l=s.password,f=void 0===l?null:l,h=s.awareness,d=void 0===h?new F.a(r):h,v=s.maxConns,y=void 0===v?20+p.c(15*b.b()):v,m=s.filterBcConns,g=void 0===m||m,w=s.peerOpts,k=void 0===w?{}:w;return Object(u.a)(this,n),(o=e.call(this)).roomName=t,o.doc=r,o.filterBcConns=g,o.awareness=d,o.shouldConnect=!1,o.signalingUrls=c,o.signalingConns=[],o.maxConns=y,o.peerOpts=k,o.key=f?L(f,t):S(null),o.room=null,o.key.then((function(e){o.room=et(r,Object(i.a)(o),t,e),o.shouldConnect?o.room.connect():o.room.disconnect()})),o.connect(),o.destroy=o.destroy.bind(Object(i.a)(o)),r.on("destroy",o.destroy),o}return Object(l.a)(n,[{key:"connect",value:function(){var t=this;this.shouldConnect=!0,this.signalingUrls.forEach((function(e){var n=m.e(U,e,(function(){return new rt(e)}));t.signalingConns.push(n),n.providers.add(t)})),this.room&&this.room.connect()}},{key:"disconnect",value:function(){var t=this;this.shouldConnect=!1,this.signalingConns.forEach((function(e){e.providers.delete(t),0===e.providers.size&&(e.destroy(),U.delete(e.url))})),this.room&&this.room.disconnect()}},{key:"destroy",value:function(){var t=this;this.doc.off("destroy",this.destroy),this.key.then((function(){t.room.destroy(),V.delete(t.roomName)})),Object(r.a)(Object(o.a)(n.prototype),"destroy",this).call(this)}},{key:"connected",get:function(){return null!==this.room&&this.shouldConnect}}]),n}(f.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(1),o=n.n(r),i={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},s=o.a.createContext&&o.a.createContext(i),a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},c=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n};function u(t){return t&&t.map((function(t,e){return o.a.createElement(t.tag,a({key:e},t.attr),u(t.child))}))}function l(t){return function(e){return o.a.createElement(f,a({attr:a({},t.attr)},e),u(t.child))}}function f(t){var e=function(e){var n,r=t.attr,i=t.size,s=t.title,u=c(t,["attr","size","title"]),l=i||e.size||"1em";return e.className&&(n=e.className),t.className&&(n=(n?n+" ":"")+t.className),o.a.createElement("svg",a({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},e.attr,r,u,{className:n,style:a(a({color:t.color||e.color},e.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),s&&o.a.createElement("title",null,s),t.children)};return void 0!==s?o.a.createElement(s.Consumer,null,(function(t){return e(t)})):e(i)}function h(t){return l({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{d:"M5 3h2v2H5zm0 4h2v2H5zm0 4h2v2H5zm4-8h2v2H9zm0 4h2v2H9zm0 4h2v2H9z"}}]})(t)}},function(t,e,n){"use strict";var r="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),o=new Uint8Array(16);function i(){if(!r)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(o)}for(var s=[],a=0;a<256;++a)s.push((a+256).toString(16).substr(1));var c=function(t,e){var n=e||0,r=s;return(r[t[n+0]]+r[t[n+1]]+r[t[n+2]]+r[t[n+3]]+"-"+r[t[n+4]]+r[t[n+5]]+"-"+r[t[n+6]]+r[t[n+7]]+"-"+r[t[n+8]]+r[t[n+9]]+"-"+r[t[n+10]]+r[t[n+11]]+r[t[n+12]]+r[t[n+13]]+r[t[n+14]]+r[t[n+15]]).toLowerCase()};e.a=function(t,e,n){"string"===typeof t&&(e="binary"===t?new Uint8Array(16):null,t=null);var r=(t=t||{}).random||(t.rng||i)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){for(var o=n||0,s=0;s<16;++s)e[o+s]=r[s];return e}return c(r)}},,,,function(t,e,n){"use strict";n(69);var r=n(1),o=60103;if(e.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var i=Symbol.for;o=i("react.element"),e.Fragment=i("react.fragment")}var s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a=Object.prototype.hasOwnProperty,c={key:!0,ref:!0,__self:!0,__source:!0};function u(t,e,n){var r,i={},u=null,l=null;for(r in void 0!==n&&(u=""+n),void 0!==e.key&&(u=""+e.key),void 0!==e.ref&&(l=e.ref),e)a.call(e,r)&&!c.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps)void 0===i[r]&&(i[r]=e[r]);return{$$typeof:o,type:t,key:u,ref:l,props:i,_owner:s.current}}e.jsx=u,e.jsxs=u},function(t,e,n){"use strict";var r=n(69),o=60103,i=60106;e.Fragment=60107,e.StrictMode=60108,e.Profiler=60114;var s=60109,a=60110,c=60112;e.Suspense=60113;var u=60115,l=60116;if("function"===typeof Symbol&&Symbol.for){var f=Symbol.for;o=f("react.element"),i=f("react.portal"),e.Fragment=f("react.fragment"),e.StrictMode=f("react.strict_mode"),e.Profiler=f("react.profiler"),s=f("react.provider"),a=f("react.context"),c=f("react.forward_ref"),e.Suspense=f("react.suspense"),u=f("react.memo"),l=f("react.lazy")}var h="function"===typeof Symbol&&Symbol.iterator;function p(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v={};function y(t,e,n){this.props=t,this.context=e,this.refs=v,this.updater=n||d}function m(){}function g(t,e,n){this.props=t,this.context=e,this.refs=v,this.updater=n||d}y.prototype.isReactComponent={},y.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error(p(85));this.updater.enqueueSetState(this,t,e,"setState")},y.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},m.prototype=y.prototype;var b=g.prototype=new m;b.constructor=g,r(b,y.prototype),b.isPureReactComponent=!0;var w={current:null},k=Object.prototype.hasOwnProperty,x={key:!0,ref:!0,__self:!0,__source:!0};function S(t,e,n){var r,i={},s=null,a=null;if(null!=e)for(r in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(s=""+e.key),e)k.call(e,r)&&!x.hasOwnProperty(r)&&(i[r]=e[r]);var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){for(var u=Array(c),l=0;l<c;l++)u[l]=arguments[l+2];i.children=u}if(t&&t.defaultProps)for(r in c=t.defaultProps)void 0===i[r]&&(i[r]=c[r]);return{$$typeof:o,type:t,key:s,ref:a,props:i,_owner:w.current}}function O(t){return"object"===typeof t&&null!==t&&t.$$typeof===o}var C=/\/+/g;function E(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function _(t,e,n,r,s){var a=typeof t;"undefined"!==a&&"boolean"!==a||(t=null);var c=!1;if(null===t)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(t.$$typeof){case o:case i:c=!0}}if(c)return s=s(c=t),t=""===r?"."+E(c,0):r,Array.isArray(s)?(n="",null!=t&&(n=t.replace(C,"$&/")+"/"),_(s,e,n,"",(function(t){return t}))):null!=s&&(O(s)&&(s=function(t,e){return{$$typeof:o,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(s,n+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(C,"$&/")+"/")+t)),e.push(s)),1;if(c=0,r=""===r?".":r+":",Array.isArray(t))for(var u=0;u<t.length;u++){var l=r+E(a=t[u],u);c+=_(a,e,n,l,s)}else if("function"===typeof(l=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=h&&t[h]||t["@@iterator"])?t:null}(t)))for(t=l.call(t),u=0;!(a=t.next()).done;)c+=_(a=a.value,e,n,l=r+E(a,u++),s);else if("object"===a)throw e=""+t,Error(p(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e));return c}function M(t,e,n){if(null==t)return t;var r=[],o=0;return _(t,r,"","",(function(t){return e.call(n,t,o++)})),r}function T(t){if(-1===t._status){var e=t._result;e=e(),t._status=0,t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}if(1===t._status)return t._result;throw t._result}var N={current:null};function A(){var t=N.current;if(null===t)throw Error(p(321));return t}var I={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:w,IsSomeRendererActing:{current:!1},assign:r};e.Children={map:M,forEach:function(t,e,n){M(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return M(t,(function(){e++})),e},toArray:function(t){return M(t,(function(t){return t}))||[]},only:function(t){if(!O(t))throw Error(p(143));return t}},e.Component=y,e.PureComponent=g,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I,e.cloneElement=function(t,e,n){if(null===t||void 0===t)throw Error(p(267,t));var i=r({},t.props),s=t.key,a=t.ref,c=t._owner;if(null!=e){if(void 0!==e.ref&&(a=e.ref,c=w.current),void 0!==e.key&&(s=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(l in e)k.call(e,l)&&!x.hasOwnProperty(l)&&(i[l]=void 0===e[l]&&void 0!==u?u[l]:e[l])}var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){u=Array(l);for(var f=0;f<l;f++)u[f]=arguments[f+2];i.children=u}return{$$typeof:o,type:t.type,key:s,ref:a,props:i,_owner:c}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:a,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:s,_context:t},t.Consumer=t},e.createElement=S,e.createFactory=function(t){var e=S.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:c,render:t}},e.isValidElement=O,e.lazy=function(t){return{$$typeof:l,_payload:{_status:-1,_result:t},_init:T}},e.memo=function(t,e){return{$$typeof:u,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return A().useCallback(t,e)},e.useContext=function(t,e){return A().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return A().useEffect(t,e)},e.useImperativeHandle=function(t,e,n){return A().useImperativeHandle(t,e,n)},e.useLayoutEffect=function(t,e){return A().useLayoutEffect(t,e)},e.useMemo=function(t,e){return A().useMemo(t,e)},e.useReducer=function(t,e,n){return A().useReducer(t,e,n)},e.useRef=function(t){return A().useRef(t)},e.useState=function(t){return A().useState(t)},e.version="17.0.1"},function(t,e,n){"use strict";var r=n(1),o=n(69),i=n(97);function s(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(s(227));var a=new Set,c={};function u(t,e){l(t,e),l(t+"Capture",e)}function l(t,e){for(c[t]=e,t=0;t<e.length;t++)a.add(e[t])}var f=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p=Object.prototype.hasOwnProperty,d={},v={};function y(t,e,n,r,o,i,s){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=s}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){m[t]=new y(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];m[e]=new y(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){m[t]=new y(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){m[t]=new y(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){m[t]=new y(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){m[t]=new y(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){m[t]=new y(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){m[t]=new y(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){m[t]=new y(t,5,!1,t.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function b(t){return t[1].toUpperCase()}function w(t,e,n,r){var o=m.hasOwnProperty(e)?m[e]:null;(null!==o?0===o.type:!r&&(2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])))||(function(t,e,n,r){if(null===e||"undefined"===typeof e||function(t,e,n,r){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,o,r)&&(n=null),r||null===o?function(t){return!!p.call(v,t)||!p.call(d,t)&&(h.test(t)?v[t]=!0:(d[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):o.mustUseProperty?t[o.propertyName]=null===n?3!==o.type&&"":n:(e=o.attributeName,r=o.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(g,b);m[e]=new y(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(g,b);m[e]=new y(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(g,b);m[e]=new y(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){m[t]=new y(t,1,!1,t.toLowerCase(),null,!1,!1)})),m.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){m[t]=new y(t,1,!1,t.toLowerCase(),null,!0,!0)}));var k=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=60103,S=60106,O=60107,C=60108,E=60114,_=60109,M=60110,T=60112,N=60113,A=60120,I=60115,j=60116,D=60121,R=60128,P=60129,z=60130,F=60131;if("function"===typeof Symbol&&Symbol.for){var B=Symbol.for;x=B("react.element"),S=B("react.portal"),O=B("react.fragment"),C=B("react.strict_mode"),E=B("react.profiler"),_=B("react.provider"),M=B("react.context"),T=B("react.forward_ref"),N=B("react.suspense"),A=B("react.suspense_list"),I=B("react.memo"),j=B("react.lazy"),D=B("react.block"),B("react.scope"),R=B("react.opaque.id"),P=B("react.debug_trace_mode"),z=B("react.offscreen"),F=B("react.legacy_hidden")}var L,$="function"===typeof Symbol&&Symbol.iterator;function q(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=$&&t[$]||t["@@iterator"])?t:null}function J(t){if(void 0===L)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);L=e&&e[1]||""}return"\n"+L+t}var U=!1;function V(t,e){if(!t||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var o=c.stack.split("\n"),i=r.stack.split("\n"),s=o.length-1,a=i.length-1;1<=s&&0<=a&&o[s]!==i[a];)a--;for(;1<=s&&0<=a;s--,a--)if(o[s]!==i[a]){if(1!==s||1!==a)do{if(s--,0>--a||o[s]!==i[a])return"\n"+o[s].replace(" at new "," at ")}while(1<=s&&0<=a);break}}}finally{U=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?J(t):""}function W(t){switch(t.tag){case 5:return J(t.type);case 16:return J("Lazy");case 13:return J("Suspense");case 19:return J("SuspenseList");case 0:case 2:case 15:return t=V(t.type,!1);case 11:return t=V(t.type.render,!1);case 22:return t=V(t.type._render,!1);case 1:return t=V(t.type,!0);default:return""}}function H(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case O:return"Fragment";case S:return"Portal";case E:return"Profiler";case C:return"StrictMode";case N:return"Suspense";case A:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case M:return(t.displayName||"Context")+".Consumer";case _:return(t._context.displayName||"Context")+".Provider";case T:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case I:return H(t.type);case D:return H(t._render);case j:e=t._payload,t=t._init;try{return H(t(e))}catch(n){}}return null}function K(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function Y(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function G(t){t._valueTracker||(t._valueTracker=function(t){var e=Y(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var o=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return o.call(this)},set:function(t){r=""+t,i.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(t){r=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function Q(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Y(t)?t.checked?"true":"false":t.value),(t=r)!==n&&(e.setValue(t),!0)}function X(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function Z(t,e){var n=e.checked;return o({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function tt(t,e){var n=null==e.defaultValue?"":e.defaultValue,r=null!=e.checked?e.checked:e.defaultChecked;n=K(null!=e.value?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function et(t,e){null!=(e=e.checked)&&w(t,"checked",e,!1)}function nt(t,e){et(t,e);var n=K(e.value),r=e.type;if(null!=n)"number"===r?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===r||"reset"===r)return void t.removeAttribute("value");e.hasOwnProperty("value")?ot(t,e.type,n):e.hasOwnProperty("defaultValue")&&ot(t,e.type,K(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function rt(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!("submit"!==r&&"reset"!==r||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function ot(t,e,n){"number"===e&&X(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}function it(t,e){return t=o({children:void 0},e),(e=function(t){var e="";return r.Children.forEach(t,(function(t){null!=t&&(e+=t)})),e}(e.children))&&(t.children=e),t}function st(t,e,n,r){if(t=t.options,e){e={};for(var o=0;o<n.length;o++)e["$"+n[o]]=!0;for(n=0;n<t.length;n++)o=e.hasOwnProperty("$"+t[n].value),t[n].selected!==o&&(t[n].selected=o),o&&r&&(t[n].defaultSelected=!0)}else{for(n=""+K(n),e=null,o=0;o<t.length;o++){if(t[o].value===n)return t[o].selected=!0,void(r&&(t[o].defaultSelected=!0));null!==e||t[o].disabled||(e=t[o])}null!==e&&(e.selected=!0)}}function at(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(s(91));return o({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ct(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(s(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(s(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:K(n)}}function ut(t,e){var n=K(e.value),r=K(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=r&&(t.defaultValue=""+r)}function lt(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}var ft="http://www.w3.org/1999/xhtml",ht="http://www.w3.org/2000/svg";function pt(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?pt(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var vt,yt,mt=(yt=function(t,e){if(t.namespaceURI!==ht||"innerHTML"in t)t.innerHTML=e;else{for((vt=vt||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=vt.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,r){MSApp.execUnsafeLocalFunction((function(){return yt(t,e)}))}:yt);function gt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var bt={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},wt=["Webkit","ms","Moz","O"];function kt(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||bt.hasOwnProperty(t)&&bt[t]?(""+e).trim():e+"px"}function xt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var r=0===n.indexOf("--"),o=kt(n,e[n],r);"float"===n&&(n="cssFloat"),r?t.setProperty(n,o):t[n]=o}}Object.keys(bt).forEach((function(t){wt.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),bt[e]=bt[t]}))}));var St=o({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ot(t,e){if(e){if(St[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(s(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(s(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(s(62))}}function Ct(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Et(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var _t=null,Mt=null,Tt=null;function Nt(t){if(t=to(t)){if("function"!==typeof _t)throw Error(s(280));var e=t.stateNode;e&&(e=no(e),_t(t.stateNode,t.type,e))}}function At(t){Mt?Tt?Tt.push(t):Tt=[t]:Mt=t}function It(){if(Mt){var t=Mt,e=Tt;if(Tt=Mt=null,Nt(t),e)for(t=0;t<e.length;t++)Nt(e[t])}}function jt(t,e){return t(e)}function Dt(t,e,n,r,o){return t(e,n,r,o)}function Rt(){}var Pt=jt,zt=!1,Ft=!1;function Bt(){null===Mt&&null===Tt||(Rt(),It())}function Lt(t,e){var n=t.stateNode;if(null===n)return null;var r=no(n);if(null===r)return null;n=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!r;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(s(231,e,typeof n));return n}var $t=!1;if(f)try{var qt={};Object.defineProperty(qt,"passive",{get:function(){$t=!0}}),window.addEventListener("test",qt,qt),window.removeEventListener("test",qt,qt)}catch(yt){$t=!1}function Jt(t,e,n,r,o,i,s,a,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(l){this.onError(l)}}var Ut=!1,Vt=null,Wt=!1,Ht=null,Kt={onError:function(t){Ut=!0,Vt=t}};function Yt(t,e,n,r,o,i,s,a,c){Ut=!1,Vt=null,Jt.apply(Kt,arguments)}function Gt(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(1026&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Qt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function Xt(t){if(Gt(t)!==t)throw Error(s(188))}function Zt(t){if(!(t=function(t){var e=t.alternate;if(!e){if(null===(e=Gt(t)))throw Error(s(188));return e!==t?null:t}for(var n=t,r=e;;){var o=n.return;if(null===o)break;var i=o.alternate;if(null===i){if(null!==(r=o.return)){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return Xt(o),t;if(i===r)return Xt(o),e;i=i.sibling}throw Error(s(188))}if(n.return!==r.return)n=o,r=i;else{for(var a=!1,c=o.child;c;){if(c===n){a=!0,n=o,r=i;break}if(c===r){a=!0,r=o,n=i;break}c=c.sibling}if(!a){for(c=i.child;c;){if(c===n){a=!0,n=i,r=o;break}if(c===r){a=!0,r=i,n=o;break}c=c.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?t:e}(t)))return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function te(t,e){for(var n=t.alternate;null!==e;){if(e===t||e===n)return!0;e=e.return}return!1}var ee,ne,re,oe,ie=!1,se=[],ae=null,ce=null,ue=null,le=new Map,fe=new Map,he=[],pe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function de(t,e,n,r,o){return{blockedOn:t,domEventName:e,eventSystemFlags:16|n,nativeEvent:o,targetContainers:[r]}}function ve(t,e){switch(t){case"focusin":case"focusout":ae=null;break;case"dragenter":case"dragleave":ce=null;break;case"mouseover":case"mouseout":ue=null;break;case"pointerover":case"pointerout":le.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":fe.delete(e.pointerId)}}function ye(t,e,n,r,o,i){return null===t||t.nativeEvent!==i?(t=de(e,n,r,o,i),null!==e&&(null!==(e=to(e))&&ne(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,null!==o&&-1===e.indexOf(o)&&e.push(o),t)}function me(t){var e=Zr(t.target);if(null!==e){var n=Gt(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Qt(n)))return t.blockedOn=e,void oe(t.lanePriority,(function(){i.unstable_runWithPriority(t.priority,(function(){re(n)}))}))}else if(3===e&&n.stateNode.hydrate)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function ge(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ze(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=to(n))&&ne(e),t.blockedOn=n,!1;e.shift()}return!0}function be(t,e,n){ge(t)&&n.delete(e)}function we(){for(ie=!1;0<se.length;){var t=se[0];if(null!==t.blockedOn){null!==(t=to(t.blockedOn))&&ee(t);break}for(var e=t.targetContainers;0<e.length;){var n=Ze(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n){t.blockedOn=n;break}e.shift()}null===t.blockedOn&&se.shift()}null!==ae&&ge(ae)&&(ae=null),null!==ce&&ge(ce)&&(ce=null),null!==ue&&ge(ue)&&(ue=null),le.forEach(be),fe.forEach(be)}function ke(t,e){t.blockedOn===e&&(t.blockedOn=null,ie||(ie=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,we)))}function xe(t){function e(e){return ke(e,t)}if(0<se.length){ke(se[0],t);for(var n=1;n<se.length;n++){var r=se[n];r.blockedOn===t&&(r.blockedOn=null)}}for(null!==ae&&ke(ae,t),null!==ce&&ke(ce,t),null!==ue&&ke(ue,t),le.forEach(e),fe.forEach(e),n=0;n<he.length;n++)(r=he[n]).blockedOn===t&&(r.blockedOn=null);for(;0<he.length&&null===(n=he[0]).blockedOn;)me(n),null===n.blockedOn&&he.shift()}function Se(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Oe={animationend:Se("Animation","AnimationEnd"),animationiteration:Se("Animation","AnimationIteration"),animationstart:Se("Animation","AnimationStart"),transitionend:Se("Transition","TransitionEnd")},Ce={},Ee={};function _e(t){if(Ce[t])return Ce[t];if(!Oe[t])return t;var e,n=Oe[t];for(e in n)if(n.hasOwnProperty(e)&&e in Ee)return Ce[t]=n[e];return t}f&&(Ee=document.createElement("div").style,"AnimationEvent"in window||(delete Oe.animationend.animation,delete Oe.animationiteration.animation,delete Oe.animationstart.animation),"TransitionEvent"in window||delete Oe.transitionend.transition);var Me=_e("animationend"),Te=_e("animationiteration"),Ne=_e("animationstart"),Ae=_e("transitionend"),Ie=new Map,je=new Map,De=["abort","abort",Me,"animationEnd",Te,"animationIteration",Ne,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Ae,"transitionEnd","waiting","waiting"];function Re(t,e){for(var n=0;n<t.length;n+=2){var r=t[n],o=t[n+1];o="on"+(o[0].toUpperCase()+o.slice(1)),je.set(r,e),Ie.set(r,o),u(o,[r])}}(0,i.unstable_now)();var Pe=8;function ze(t){if(0!==(1&t))return Pe=15,1;if(0!==(2&t))return Pe=14,2;if(0!==(4&t))return Pe=13,4;var e=24&t;return 0!==e?(Pe=12,e):0!==(32&t)?(Pe=11,32):0!==(e=192&t)?(Pe=10,e):0!==(256&t)?(Pe=9,256):0!==(e=3584&t)?(Pe=8,e):0!==(4096&t)?(Pe=7,4096):0!==(e=4186112&t)?(Pe=6,e):0!==(e=62914560&t)?(Pe=5,e):67108864&t?(Pe=4,67108864):0!==(134217728&t)?(Pe=3,134217728):0!==(e=805306368&t)?(Pe=2,e):0!==(1073741824&t)?(Pe=1,1073741824):(Pe=8,t)}function Fe(t,e){var n=t.pendingLanes;if(0===n)return Pe=0;var r=0,o=0,i=t.expiredLanes,s=t.suspendedLanes,a=t.pingedLanes;if(0!==i)r=i,o=Pe=15;else if(0!==(i=134217727&n)){var c=i&~s;0!==c?(r=ze(c),o=Pe):0!==(a&=i)&&(r=ze(a),o=Pe)}else 0!==(i=n&~s)?(r=ze(i),o=Pe):0!==a&&(r=ze(a),o=Pe);if(0===r)return 0;if(r=n&((0>(r=31-Ue(r))?0:1<<r)<<1)-1,0!==e&&e!==r&&0===(e&s)){if(ze(e),o<=Pe)return e;Pe=o}if(0!==(e=t.entangledLanes))for(t=t.entanglements,e&=r;0<e;)o=1<<(n=31-Ue(e)),r|=t[n],e&=~o;return r}function Be(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function Le(t,e){switch(t){case 15:return 1;case 14:return 2;case 12:return 0===(t=$e(24&~e))?Le(10,e):t;case 10:return 0===(t=$e(192&~e))?Le(8,e):t;case 8:return 0===(t=$e(3584&~e))&&(0===(t=$e(4186112&~e))&&(t=512)),t;case 2:return 0===(e=$e(805306368&~e))&&(e=268435456),e}throw Error(s(358,t))}function $e(t){return t&-t}function qe(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Je(t,e,n){t.pendingLanes|=e;var r=e-1;t.suspendedLanes&=r,t.pingedLanes&=r,(t=t.eventTimes)[e=31-Ue(e)]=n}var Ue=Math.clz32?Math.clz32:function(t){return 0===t?32:31-(Ve(t)/We|0)|0},Ve=Math.log,We=Math.LN2;var He=i.unstable_UserBlockingPriority,Ke=i.unstable_runWithPriority,Ye=!0;function Ge(t,e,n,r){zt||Rt();var o=Xe,i=zt;zt=!0;try{Dt(o,t,e,n,r)}finally{(zt=i)||Bt()}}function Qe(t,e,n,r){Ke(He,Xe.bind(null,t,e,n,r))}function Xe(t,e,n,r){var o;if(Ye)if((o=0===(4&e))&&0<se.length&&-1<pe.indexOf(t))t=de(null,t,e,n,r),se.push(t);else{var i=Ze(t,e,n,r);if(null===i)o&&ve(t,r);else{if(o){if(-1<pe.indexOf(t))return t=de(i,t,e,n,r),void se.push(t);if(function(t,e,n,r,o){switch(e){case"focusin":return ae=ye(ae,t,e,n,r,o),!0;case"dragenter":return ce=ye(ce,t,e,n,r,o),!0;case"mouseover":return ue=ye(ue,t,e,n,r,o),!0;case"pointerover":var i=o.pointerId;return le.set(i,ye(le.get(i)||null,t,e,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,fe.set(i,ye(fe.get(i)||null,t,e,n,r,o)),!0}return!1}(i,t,e,n,r))return;ve(t,r)}Ir(t,e,r,null,n)}}}function Ze(t,e,n,r){var o=Et(r);if(null!==(o=Zr(o))){var i=Gt(o);if(null===i)o=null;else{var s=i.tag;if(13===s){if(null!==(o=Qt(i)))return o;o=null}else if(3===s){if(i.stateNode.hydrate)return 3===i.tag?i.stateNode.containerInfo:null;o=null}else i!==o&&(o=null)}}return Ir(t,e,r,o,n),null}var tn=null,en=null,nn=null;function rn(){if(nn)return nn;var t,e,n=en,r=n.length,o="value"in tn?tn.value:tn.textContent,i=o.length;for(t=0;t<r&&n[t]===o[t];t++);var s=r-t;for(e=1;e<=s&&n[r-e]===o[i-e];e++);return nn=o.slice(t,1<e?1-e:void 0)}function on(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function sn(){return!0}function an(){return!1}function cn(t){function e(e,n,r,o,i){for(var s in this._reactName=e,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null,t)t.hasOwnProperty(s)&&(e=t[s],this[s]=e?e(o):o[s]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?sn:an,this.isPropagationStopped=an,this}return o(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=sn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=sn)},persist:function(){},isPersistent:sn}),e}var un,ln,fn,hn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pn=cn(hn),dn=o({},hn,{view:0,detail:0}),vn=cn(dn),yn=o({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_n,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==fn&&(fn&&"mousemove"===t.type?(un=t.screenX-fn.screenX,ln=t.screenY-fn.screenY):ln=un=0,fn=t),un)},movementY:function(t){return"movementY"in t?t.movementY:ln}}),mn=cn(yn),gn=cn(o({},yn,{dataTransfer:0})),bn=cn(o({},dn,{relatedTarget:0})),wn=cn(o({},hn,{animationName:0,elapsedTime:0,pseudoElement:0})),kn=cn(o({},hn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}})),xn=cn(o({},hn,{data:0})),Sn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},On={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Cn[t])&&!!e[t]}function _n(){return En}var Mn=cn(o({},dn,{key:function(t){if(t.key){var e=Sn[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=on(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?On[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_n,charCode:function(t){return"keypress"===t.type?on(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?on(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}})),Tn=cn(o({},yn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=cn(o({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_n})),An=cn(o({},hn,{propertyName:0,elapsedTime:0,pseudoElement:0})),In=cn(o({},yn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0})),jn=[9,13,27,32],Dn=f&&"CompositionEvent"in window,Rn=null;f&&"documentMode"in document&&(Rn=document.documentMode);var Pn=f&&"TextEvent"in window&&!Rn,zn=f&&(!Dn||Rn&&8<Rn&&11>=Rn),Fn=String.fromCharCode(32),Bn=!1;function Ln(t,e){switch(t){case"keyup":return-1!==jn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $n(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var qn=!1;var Jn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Un(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Jn[t.type]:"textarea"===e}function Vn(t,e,n,r){At(r),0<(e=Dr(e,"onChange")).length&&(n=new pn("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Wn=null,Hn=null;function Kn(t){Er(t,0)}function Yn(t){if(Q(eo(t)))return t}function Gn(t,e){if("change"===t)return e}var Qn=!1;if(f){var Xn;if(f){var Zn="oninput"in document;if(!Zn){var tr=document.createElement("div");tr.setAttribute("oninput","return;"),Zn="function"===typeof tr.oninput}Xn=Zn}else Xn=!1;Qn=Xn&&(!document.documentMode||9<document.documentMode)}function er(){Wn&&(Wn.detachEvent("onpropertychange",nr),Hn=Wn=null)}function nr(t){if("value"===t.propertyName&&Yn(Hn)){var e=[];if(Vn(e,Hn,t,Et(t)),t=Kn,zt)t(e);else{zt=!0;try{jt(t,e)}finally{zt=!1,Bt()}}}}function rr(t,e,n){"focusin"===t?(er(),Hn=n,(Wn=e).attachEvent("onpropertychange",nr)):"focusout"===t&&er()}function or(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Yn(Hn)}function ir(t,e){if("click"===t)return Yn(e)}function sr(t,e){if("input"===t||"change"===t)return Yn(e)}var ar="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e},cr=Object.prototype.hasOwnProperty;function ur(t,e){if(ar(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!cr.call(e,n[r])||!ar(t[n[r]],e[n[r]]))return!1;return!0}function lr(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function fr(t,e){var n,r=lr(t);for(t=0;r;){if(3===r.nodeType){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=lr(r)}}function hr(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?hr(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function pr(){for(var t=window,e=X();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(r){n=!1}if(!n)break;e=X((t=e.contentWindow).document)}return e}function dr(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var vr=f&&"documentMode"in document&&11>=document.documentMode,yr=null,mr=null,gr=null,br=!1;function wr(t,e,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==yr||yr!==X(r)||("selectionStart"in(r=yr)&&dr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},gr&&ur(gr,r)||(gr=r,0<(r=Dr(mr,"onSelect")).length&&(e=new pn("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=yr)))}Re("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Re("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Re(De,2);for(var kr="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),xr=0;xr<kr.length;xr++)je.set(kr[xr],0);l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Or=new Set("cancel close invalid load scroll toggle".split(" ").concat(Sr));function Cr(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,r,o,i,a,c,u){if(Yt.apply(this,arguments),Ut){if(!Ut)throw Error(s(198));var l=Vt;Ut=!1,Vt=null,Wt||(Wt=!0,Ht=l)}}(r,e,void 0,t),t.currentTarget=null}function Er(t,e){e=0!==(4&e);for(var n=0;n<t.length;n++){var r=t[n],o=r.event;r=r.listeners;t:{var i=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==i&&o.isPropagationStopped())break t;Cr(o,a,u),i=c}else for(s=0;s<r.length;s++){if(c=(a=r[s]).instance,u=a.currentTarget,a=a.listener,c!==i&&o.isPropagationStopped())break t;Cr(o,a,u),i=c}}}if(Wt)throw t=Ht,Wt=!1,Ht=null,t}function _r(t,e){var n=ro(e),r=t+"__bubble";n.has(r)||(Ar(e,t,2,!1),n.add(r))}var Mr="_reactListening"+Math.random().toString(36).slice(2);function Tr(t){t[Mr]||(t[Mr]=!0,a.forEach((function(e){Or.has(e)||Nr(e,!1,t,null),Nr(e,!0,t,null)})))}function Nr(t,e,n,r){var o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,i=n;if("selectionchange"===t&&9!==n.nodeType&&(i=n.ownerDocument),null!==r&&!e&&Or.has(t)){if("scroll"!==t)return;o|=2,i=r}var s=ro(i),a=t+"__"+(e?"capture":"bubble");s.has(a)||(e&&(o|=4),Ar(i,t,o,e),s.add(a))}function Ar(t,e,n,r){var o=je.get(e);switch(void 0===o?2:o){case 0:o=Ge;break;case 1:o=Qe;break;default:o=Xe}n=o.bind(null,e,n,t),o=void 0,!$t||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(o=!0),r?void 0!==o?t.addEventListener(e,n,{capture:!0,passive:o}):t.addEventListener(e,n,!0):void 0!==o?t.addEventListener(e,n,{passive:o}):t.addEventListener(e,n,!1)}function Ir(t,e,n,r,o){var i=r;if(0===(1&e)&&0===(2&e)&&null!==r)t:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var a=r.stateNode.containerInfo;if(a===o||8===a.nodeType&&a.parentNode===o)break;if(4===s)for(s=r.return;null!==s;){var c=s.tag;if((3===c||4===c)&&((c=s.stateNode.containerInfo)===o||8===c.nodeType&&c.parentNode===o))return;s=s.return}for(;null!==a;){if(null===(s=Zr(a)))return;if(5===(c=s.tag)||6===c){r=i=s;continue t}a=a.parentNode}}r=r.return}!function(t,e,n){if(Ft)return t(e,n);Ft=!0;try{Pt(t,e,n)}finally{Ft=!1,Bt()}}((function(){var r=i,o=Et(n),s=[];t:{var a=Ie.get(t);if(void 0!==a){var c=pn,u=t;switch(t){case"keypress":if(0===on(n))break t;case"keydown":case"keyup":c=Mn;break;case"focusin":u="focus",c=bn;break;case"focusout":u="blur",c=bn;break;case"beforeblur":case"afterblur":c=bn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Nn;break;case Me:case Te:case Ne:c=wn;break;case Ae:c=An;break;case"scroll":c=vn;break;case"wheel":c=In;break;case"copy":case"cut":case"paste":c=kn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Tn}var l=0!==(4&e),f=!l&&"scroll"===t,h=l?null!==a?a+"Capture":null:a;l=[];for(var p,d=r;null!==d;){var v=(p=d).stateNode;if(5===p.tag&&null!==v&&(p=v,null!==h&&(null!=(v=Lt(d,h))&&l.push(jr(d,v,p)))),f)break;d=d.return}0<l.length&&(a=new c(a,u,null,n,o),s.push({event:a,listeners:l}))}}if(0===(7&e)){if(c="mouseout"===t||"pointerout"===t,(!(a="mouseover"===t||"pointerover"===t)||0!==(16&e)||!(u=n.relatedTarget||n.fromElement)||!Zr(u)&&!u[Qr])&&(c||a)&&(a=o.window===o?o:(a=o.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?Zr(u):null)&&(u!==(f=Gt(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(c=null,u=r),c!==u)){if(l=mn,v="onMouseLeave",h="onMouseEnter",d="mouse","pointerout"!==t&&"pointerover"!==t||(l=Tn,v="onPointerLeave",h="onPointerEnter",d="pointer"),f=null==c?a:eo(c),p=null==u?a:eo(u),(a=new l(v,d+"leave",c,n,o)).target=f,a.relatedTarget=p,v=null,Zr(o)===r&&((l=new l(h,d+"enter",u,n,o)).target=p,l.relatedTarget=f,v=l),f=v,c&&u)t:{for(h=u,d=0,p=l=c;p;p=Rr(p))d++;for(p=0,v=h;v;v=Rr(v))p++;for(;0<d-p;)l=Rr(l),d--;for(;0<p-d;)h=Rr(h),p--;for(;d--;){if(l===h||null!==h&&l===h.alternate)break t;l=Rr(l),h=Rr(h)}l=null}else l=null;null!==c&&Pr(s,a,c,l,!1),null!==u&&null!==f&&Pr(s,f,u,l,!0)}if("select"===(c=(a=r?eo(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var y=Gn;else if(Un(a))if(Qn)y=sr;else{y=or;var m=rr}else(c=a.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(y=ir);switch(y&&(y=y(t,r))?Vn(s,y,n,o):(m&&m(t,a,r),"focusout"===t&&(m=a._wrapperState)&&m.controlled&&"number"===a.type&&ot(a,"number",a.value)),m=r?eo(r):window,t){case"focusin":(Un(m)||"true"===m.contentEditable)&&(yr=m,mr=r,gr=null);break;case"focusout":gr=mr=yr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(s,n,o);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":wr(s,n,o)}var g;if(Dn)t:{switch(t){case"compositionstart":var b="onCompositionStart";break t;case"compositionend":b="onCompositionEnd";break t;case"compositionupdate":b="onCompositionUpdate";break t}b=void 0}else qn?Ln(t,n)&&(b="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(b="onCompositionStart");b&&(zn&&"ko"!==n.locale&&(qn||"onCompositionStart"!==b?"onCompositionEnd"===b&&qn&&(g=rn()):(en="value"in(tn=o)?tn.value:tn.textContent,qn=!0)),0<(m=Dr(r,b)).length&&(b=new xn(b,t,null,n,o),s.push({event:b,listeners:m}),g?b.data=g:null!==(g=$n(n))&&(b.data=g))),(g=Pn?function(t,e){switch(t){case"compositionend":return $n(e);case"keypress":return 32!==e.which?null:(Bn=!0,Fn);case"textInput":return(t=e.data)===Fn&&Bn?null:t;default:return null}}(t,n):function(t,e){if(qn)return"compositionend"===t||!Dn&&Ln(t,e)?(t=rn(),nn=en=tn=null,qn=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return zn&&"ko"!==e.locale?null:e.data;default:return null}}(t,n))&&(0<(r=Dr(r,"onBeforeInput")).length&&(o=new xn("onBeforeInput","beforeinput",null,n,o),s.push({event:o,listeners:r}),o.data=g))}Er(s,e)}))}function jr(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Dr(t,e){for(var n=e+"Capture",r=[];null!==t;){var o=t,i=o.stateNode;5===o.tag&&null!==i&&(o=i,null!=(i=Lt(t,n))&&r.unshift(jr(t,i,o)),null!=(i=Lt(t,e))&&r.push(jr(t,i,o))),t=t.return}return r}function Rr(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Pr(t,e,n,r,o){for(var i=e._reactName,s=[];null!==n&&n!==r;){var a=n,c=a.alternate,u=a.stateNode;if(null!==c&&c===r)break;5===a.tag&&null!==u&&(a=u,o?null!=(c=Lt(n,i))&&s.unshift(jr(n,c,a)):o||null!=(c=Lt(n,i))&&s.push(jr(n,c,a))),n=n.return}0!==s.length&&t.push({event:e,listeners:s})}function zr(){}var Fr=null,Br=null;function Lr(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function $r(t,e){return"textarea"===t||"option"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var qr="function"===typeof setTimeout?setTimeout:void 0,Jr="function"===typeof clearTimeout?clearTimeout:void 0;function Ur(t){1===t.nodeType?t.textContent="":9===t.nodeType&&(null!=(t=t.body)&&(t.textContent=""))}function Vr(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break}return t}function Wr(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var Hr=0;var Kr=Math.random().toString(36).slice(2),Yr="__reactFiber$"+Kr,Gr="__reactProps$"+Kr,Qr="__reactContainer$"+Kr,Xr="__reactEvents$"+Kr;function Zr(t){var e=t[Yr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Qr]||n[Yr]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=Wr(t);null!==t;){if(n=t[Yr])return n;t=Wr(t)}return e}n=(t=n).parentNode}return null}function to(t){return!(t=t[Yr]||t[Qr])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function eo(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(s(33))}function no(t){return t[Gr]||null}function ro(t){var e=t[Xr];return void 0===e&&(e=t[Xr]=new Set),e}var oo=[],io=-1;function so(t){return{current:t}}function ao(t){0>io||(t.current=oo[io],oo[io]=null,io--)}function co(t,e){io++,oo[io]=t.current,t.current=e}var uo={},lo=so(uo),fo=so(!1),ho=uo;function po(t,e){var n=t.type.contextTypes;if(!n)return uo;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var o,i={};for(o in n)i[o]=e[o];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function vo(t){return null!==(t=t.childContextTypes)&&void 0!==t}function yo(){ao(fo),ao(lo)}function mo(t,e,n){if(lo.current!==uo)throw Error(s(168));co(lo,e),co(fo,n)}function go(t,e,n){var r=t.stateNode;if(t=e.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,H(e)||"Unknown",i));return o({},n,r)}function bo(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||uo,ho=lo.current,co(lo,t),co(fo,fo.current),!0}function wo(t,e,n){var r=t.stateNode;if(!r)throw Error(s(169));n?(t=go(t,e,ho),r.__reactInternalMemoizedMergedChildContext=t,ao(fo),ao(lo),co(lo,t)):ao(fo),co(fo,n)}var ko=null,xo=null,So=i.unstable_runWithPriority,Oo=i.unstable_scheduleCallback,Co=i.unstable_cancelCallback,Eo=i.unstable_shouldYield,_o=i.unstable_requestPaint,Mo=i.unstable_now,To=i.unstable_getCurrentPriorityLevel,No=i.unstable_ImmediatePriority,Ao=i.unstable_UserBlockingPriority,Io=i.unstable_NormalPriority,jo=i.unstable_LowPriority,Do=i.unstable_IdlePriority,Ro={},Po=void 0!==_o?_o:function(){},zo=null,Fo=null,Bo=!1,Lo=Mo(),$o=1e4>Lo?Mo:function(){return Mo()-Lo};function qo(){switch(To()){case No:return 99;case Ao:return 98;case Io:return 97;case jo:return 96;case Do:return 95;default:throw Error(s(332))}}function Jo(t){switch(t){case 99:return No;case 98:return Ao;case 97:return Io;case 96:return jo;case 95:return Do;default:throw Error(s(332))}}function Uo(t,e){return t=Jo(t),So(t,e)}function Vo(t,e,n){return t=Jo(t),Oo(t,e,n)}function Wo(){if(null!==Fo){var t=Fo;Fo=null,Co(t)}Ho()}function Ho(){if(!Bo&&null!==zo){Bo=!0;var t=0;try{var e=zo;Uo(99,(function(){for(;t<e.length;t++){var n=e[t];do{n=n(!0)}while(null!==n)}})),zo=null}catch(n){throw null!==zo&&(zo=zo.slice(t+1)),Oo(No,Wo),n}finally{Bo=!1}}}var Ko=k.ReactCurrentBatchConfig;function Yo(t,e){if(t&&t.defaultProps){for(var n in e=o({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}var Go=so(null),Qo=null,Xo=null,Zo=null;function ti(){Zo=Xo=Qo=null}function ei(t){var e=Go.current;ao(Go),t.type._context._currentValue=e}function ni(t,e){for(;null!==t;){var n=t.alternate;if((t.childLanes&e)===e){if(null===n||(n.childLanes&e)===e)break;n.childLanes|=e}else t.childLanes|=e,null!==n&&(n.childLanes|=e);t=t.return}}function ri(t,e){Qo=t,Zo=Xo=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(Ds=!0),t.firstContext=null)}function oi(t,e){if(Zo!==t&&!1!==e&&0!==e)if("number"===typeof e&&1073741823!==e||(Zo=t,e=1073741823),e={context:t,observedBits:e,next:null},null===Xo){if(null===Qo)throw Error(s(308));Xo=e,Qo.dependencies={lanes:0,firstContext:e,responders:null}}else Xo=Xo.next=e;return t._currentValue}var ii=!1;function si(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function ai(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ci(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ui(t,e){if(null!==(t=t.updateQueue)){var n=(t=t.shared).pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}}function li(t,e){var n=t.updateQueue,r=t.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?o=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?o=i=e:i=i.next=e}else o=i=e;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function fi(t,e,n,r){var i=t.updateQueue;ii=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,c=i.shared.pending;if(null!==c){i.shared.pending=null;var u=c,l=u.next;u.next=null,null===a?s=l:a.next=l,a=u;var f=t.alternate;if(null!==f){var h=(f=f.updateQueue).lastBaseUpdate;h!==a&&(null===h?f.firstBaseUpdate=l:h.next=l,f.lastBaseUpdate=u)}}if(null!==s){for(h=i.baseState,a=0,f=l=u=null;;){c=s.lane;var p=s.eventTime;if((r&c)===c){null!==f&&(f=f.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});t:{var d=t,v=s;switch(c=e,p=n,v.tag){case 1:if("function"===typeof(d=v.payload)){h=d.call(p,h,c);break t}h=d;break t;case 3:d.flags=-4097&d.flags|64;case 0:if(null===(c="function"===typeof(d=v.payload)?d.call(p,h,c):d)||void 0===c)break t;h=o({},h,c);break t;case 2:ii=!0}}null!==s.callback&&(t.flags|=32,null===(c=i.effects)?i.effects=[s]:c.push(s))}else p={eventTime:p,lane:c,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===f?(l=f=p,u=h):f=f.next=p,a|=c;if(null===(s=s.next)){if(null===(c=i.shared.pending))break;s=c.next,c.next=null,i.lastBaseUpdate=c,i.shared.pending=null}}null===f&&(u=h),i.baseState=u,i.firstBaseUpdate=l,i.lastBaseUpdate=f,Fa|=a,t.lanes=a,t.memoizedState=h}}function hi(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var r=t[e],o=r.callback;if(null!==o){if(r.callback=null,r=n,"function"!==typeof o)throw Error(s(191,o));o.call(r)}}}var pi=(new r.Component).refs;function di(t,e,n,r){n=null===(n=n(r,e=t.memoizedState))||void 0===n?e:o({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var vi={isMounted:function(t){return!!(t=t._reactInternals)&&Gt(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=uc(),o=lc(t),i=ci(r,o);i.payload=e,void 0!==n&&null!==n&&(i.callback=n),ui(t,i),fc(t,o,r)},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=uc(),o=lc(t),i=ci(r,o);i.tag=1,i.payload=e,void 0!==n&&null!==n&&(i.callback=n),ui(t,i),fc(t,o,r)},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=uc(),r=lc(t),o=ci(n,r);o.tag=2,void 0!==e&&null!==e&&(o.callback=e),ui(t,o),fc(t,r,n)}};function yi(t,e,n,r,o,i,s){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,i,s):!e.prototype||!e.prototype.isPureReactComponent||(!ur(n,r)||!ur(o,i))}function mi(t,e,n){var r=!1,o=uo,i=e.contextType;return"object"===typeof i&&null!==i?i=oi(i):(o=vo(e)?ho:lo.current,i=(r=null!==(r=e.contextTypes)&&void 0!==r)?po(t,o):uo),e=new e(n,i),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=vi,t.stateNode=e,e._reactInternals=t,r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=i),e}function gi(t,e,n,r){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&vi.enqueueReplaceState(e,e.state,null)}function bi(t,e,n,r){var o=t.stateNode;o.props=n,o.state=t.memoizedState,o.refs=pi,si(t);var i=e.contextType;"object"===typeof i&&null!==i?o.context=oi(i):(i=vo(e)?ho:lo.current,o.context=po(t,i)),fi(t,n,o,r),o.state=t.memoizedState,"function"===typeof(i=e.getDerivedStateFromProps)&&(di(t,e,i,n),o.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(e=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),e!==o.state&&vi.enqueueReplaceState(o,o.state,null),fi(t,n,o,r),o.state=t.memoizedState),"function"===typeof o.componentDidMount&&(t.flags|=4)}var wi=Array.isArray;function ki(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,t));var o=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===o?e.ref:((e=function(t){var e=r.refs;e===pi&&(e=r.refs={}),null===t?delete e[o]:e[o]=t})._stringRef=o,e)}if("string"!==typeof t)throw Error(s(284));if(!n._owner)throw Error(s(290,t))}return t}function xi(t,e){if("textarea"!==t.type)throw Error(s(31,"[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e))}function Si(t){function e(e,n){if(t){var r=e.lastEffect;null!==r?(r.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!t)return null;for(;null!==r;)e(n,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function o(t,e){return(t=Jc(t,e)).index=0,t.sibling=null,t}function i(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<n?(e.flags=2,n):r:(e.flags=2,n):n}function a(e){return t&&null===e.alternate&&(e.flags=2),e}function c(t,e,n,r){return null===e||6!==e.tag?((e=Hc(n,t.mode,r)).return=t,e):((e=o(e,n)).return=t,e)}function u(t,e,n,r){return null!==e&&e.elementType===n.type?((r=o(e,n.props)).ref=ki(t,e,n),r.return=t,r):((r=Uc(n.type,n.key,n.props,null,t.mode,r)).ref=ki(t,e,n),r.return=t,r)}function l(t,e,n,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Kc(n,t.mode,r)).return=t,e):((e=o(e,n.children||[])).return=t,e)}function f(t,e,n,r,i){return null===e||7!==e.tag?((e=Vc(n,t.mode,r,i)).return=t,e):((e=o(e,n)).return=t,e)}function h(t,e,n){if("string"===typeof e||"number"===typeof e)return(e=Hc(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case x:return(n=Uc(e.type,e.key,e.props,null,t.mode,n)).ref=ki(t,null,e),n.return=t,n;case S:return(e=Kc(e,t.mode,n)).return=t,e}if(wi(e)||q(e))return(e=Vc(e,t.mode,n,null)).return=t,e;xi(t,e)}return null}function p(t,e,n,r){var o=null!==e?e.key:null;if("string"===typeof n||"number"===typeof n)return null!==o?null:c(t,e,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===o?n.type===O?f(t,e,n.props.children,r,o):u(t,e,n,r):null;case S:return n.key===o?l(t,e,n,r):null}if(wi(n)||q(n))return null!==o?null:f(t,e,n,r,null);xi(t,n)}return null}function d(t,e,n,r,o){if("string"===typeof r||"number"===typeof r)return c(e,t=t.get(n)||null,""+r,o);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return t=t.get(null===r.key?n:r.key)||null,r.type===O?f(e,t,r.props.children,o,r.key):u(e,t,r,o);case S:return l(e,t=t.get(null===r.key?n:r.key)||null,r,o)}if(wi(r)||q(r))return f(e,t=t.get(n)||null,r,o,null);xi(e,r)}return null}function v(o,s,a,c){for(var u=null,l=null,f=s,v=s=0,y=null;null!==f&&v<a.length;v++){f.index>v?(y=f,f=null):y=f.sibling;var m=p(o,f,a[v],c);if(null===m){null===f&&(f=y);break}t&&f&&null===m.alternate&&e(o,f),s=i(m,s,v),null===l?u=m:l.sibling=m,l=m,f=y}if(v===a.length)return n(o,f),u;if(null===f){for(;v<a.length;v++)null!==(f=h(o,a[v],c))&&(s=i(f,s,v),null===l?u=f:l.sibling=f,l=f);return u}for(f=r(o,f);v<a.length;v++)null!==(y=d(f,o,v,a[v],c))&&(t&&null!==y.alternate&&f.delete(null===y.key?v:y.key),s=i(y,s,v),null===l?u=y:l.sibling=y,l=y);return t&&f.forEach((function(t){return e(o,t)})),u}function y(o,a,c,u){var l=q(c);if("function"!==typeof l)throw Error(s(150));if(null==(c=l.call(c)))throw Error(s(151));for(var f=l=null,v=a,y=a=0,m=null,g=c.next();null!==v&&!g.done;y++,g=c.next()){v.index>y?(m=v,v=null):m=v.sibling;var b=p(o,v,g.value,u);if(null===b){null===v&&(v=m);break}t&&v&&null===b.alternate&&e(o,v),a=i(b,a,y),null===f?l=b:f.sibling=b,f=b,v=m}if(g.done)return n(o,v),l;if(null===v){for(;!g.done;y++,g=c.next())null!==(g=h(o,g.value,u))&&(a=i(g,a,y),null===f?l=g:f.sibling=g,f=g);return l}for(v=r(o,v);!g.done;y++,g=c.next())null!==(g=d(v,o,y,g.value,u))&&(t&&null!==g.alternate&&v.delete(null===g.key?y:g.key),a=i(g,a,y),null===f?l=g:f.sibling=g,f=g);return t&&v.forEach((function(t){return e(o,t)})),l}return function(t,r,i,c){var u="object"===typeof i&&null!==i&&i.type===O&&null===i.key;u&&(i=i.props.children);var l="object"===typeof i&&null!==i;if(l)switch(i.$$typeof){case x:t:{for(l=i.key,u=r;null!==u;){if(u.key===l){switch(u.tag){case 7:if(i.type===O){n(t,u.sibling),(r=o(u,i.props.children)).return=t,t=r;break t}break;default:if(u.elementType===i.type){n(t,u.sibling),(r=o(u,i.props)).ref=ki(t,u,i),r.return=t,t=r;break t}}n(t,u);break}e(t,u),u=u.sibling}i.type===O?((r=Vc(i.props.children,t.mode,c,i.key)).return=t,t=r):((c=Uc(i.type,i.key,i.props,null,t.mode,c)).ref=ki(t,r,i),c.return=t,t=c)}return a(t);case S:t:{for(u=i.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===i.containerInfo&&r.stateNode.implementation===i.implementation){n(t,r.sibling),(r=o(r,i.children||[])).return=t,t=r;break t}n(t,r);break}e(t,r),r=r.sibling}(r=Kc(i,t.mode,c)).return=t,t=r}return a(t)}if("string"===typeof i||"number"===typeof i)return i=""+i,null!==r&&6===r.tag?(n(t,r.sibling),(r=o(r,i)).return=t,t=r):(n(t,r),(r=Hc(i,t.mode,c)).return=t,t=r),a(t);if(wi(i))return v(t,r,i,c);if(q(i))return y(t,r,i,c);if(l&&xi(t,i),"undefined"===typeof i&&!u)switch(t.tag){case 1:case 22:case 0:case 11:case 15:throw Error(s(152,H(t.type)||"Component"))}return n(t,r)}}var Oi=Si(!0),Ci=Si(!1),Ei={},_i=so(Ei),Mi=so(Ei),Ti=so(Ei);function Ni(t){if(t===Ei)throw Error(s(174));return t}function Ai(t,e){switch(co(Ti,e),co(Mi,t),co(_i,Ei),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:dt(null,"");break;default:e=dt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}ao(_i),co(_i,e)}function Ii(){ao(_i),ao(Mi),ao(Ti)}function ji(t){Ni(Ti.current);var e=Ni(_i.current),n=dt(e,t.type);e!==n&&(co(Mi,t),co(_i,n))}function Di(t){Mi.current===t&&(ao(_i),ao(Mi))}var Ri=so(0);function Pi(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(64&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var zi=null,Fi=null,Bi=!1;function Li(t,e){var n=$c(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=e,n.return=t,n.flags=8,null!==t.lastEffect?(t.lastEffect.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n}function $i(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,!0);case 13:default:return!1}}function qi(t){if(Bi){var e=Fi;if(e){var n=e;if(!$i(t,e)){if(!(e=Vr(n.nextSibling))||!$i(t,e))return t.flags=-1025&t.flags|2,Bi=!1,void(zi=t);Li(zi,n)}zi=t,Fi=Vr(e.firstChild)}else t.flags=-1025&t.flags|2,Bi=!1,zi=t}}function Ji(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;zi=t}function Ui(t){if(t!==zi)return!1;if(!Bi)return Ji(t),Bi=!0,!1;var e=t.type;if(5!==t.tag||"head"!==e&&"body"!==e&&!$r(e,t.memoizedProps))for(e=Fi;e;)Li(t,e),e=Vr(e.nextSibling);if(Ji(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(s(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){Fi=Vr(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}Fi=null}}else Fi=zi?Vr(t.stateNode.nextSibling):null;return!0}function Vi(){Fi=zi=null,Bi=!1}var Wi=[];function Hi(){for(var t=0;t<Wi.length;t++)Wi[t]._workInProgressVersionPrimary=null;Wi.length=0}var Ki=k.ReactCurrentDispatcher,Yi=k.ReactCurrentBatchConfig,Gi=0,Qi=null,Xi=null,Zi=null,ts=!1,es=!1;function ns(){throw Error(s(321))}function rs(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ar(t[n],e[n]))return!1;return!0}function os(t,e,n,r,o,i){if(Gi=i,Qi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ki.current=null===t||null===t.memoizedState?Ns:As,t=n(r,o),es){i=0;do{if(es=!1,!(25>i))throw Error(s(301));i+=1,Zi=Xi=null,e.updateQueue=null,Ki.current=Is,t=n(r,o)}while(es)}if(Ki.current=Ts,e=null!==Xi&&null!==Xi.next,Gi=0,Zi=Xi=Qi=null,ts=!1,e)throw Error(s(300));return t}function is(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Zi?Qi.memoizedState=Zi=t:Zi=Zi.next=t,Zi}function ss(){if(null===Xi){var t=Qi.alternate;t=null!==t?t.memoizedState:null}else t=Xi.next;var e=null===Zi?Qi.memoizedState:Zi.next;if(null!==e)Zi=e,Xi=t;else{if(null===t)throw Error(s(310));t={memoizedState:(Xi=t).memoizedState,baseState:Xi.baseState,baseQueue:Xi.baseQueue,queue:Xi.queue,next:null},null===Zi?Qi.memoizedState=Zi=t:Zi=Zi.next=t}return Zi}function as(t,e){return"function"===typeof e?e(t):e}function cs(t){var e=ss(),n=e.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=t;var r=Xi,o=r.baseQueue,i=n.pending;if(null!==i){if(null!==o){var a=o.next;o.next=i.next,i.next=a}r.baseQueue=o=i,n.pending=null}if(null!==o){o=o.next,r=r.baseState;var c=a=i=null,u=o;do{var l=u.lane;if((Gi&l)===l)null!==c&&(c=c.next={lane:0,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),r=u.eagerReducer===t?u.eagerState:t(r,u.action);else{var f={lane:l,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===c?(a=c=f,i=r):c=c.next=f,Qi.lanes|=l,Fa|=l}u=u.next}while(null!==u&&u!==o);null===c?i=r:c.next=a,ar(r,e.memoizedState)||(Ds=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=c,n.lastRenderedState=r}return[e.memoizedState,n.dispatch]}function us(t){var e=ss(),n=e.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=t;var r=n.dispatch,o=n.pending,i=e.memoizedState;if(null!==o){n.pending=null;var a=o=o.next;do{i=t(i,a.action),a=a.next}while(a!==o);ar(i,e.memoizedState)||(Ds=!0),e.memoizedState=i,null===e.baseQueue&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function ls(t,e,n){var r=e._getVersion;r=r(e._source);var o=e._workInProgressVersionPrimary;if(null!==o?t=o===r:(t=t.mutableReadLanes,(t=(Gi&t)===t)&&(e._workInProgressVersionPrimary=r,Wi.push(e))),t)return n(e._source);throw Wi.push(e),Error(s(350))}function fs(t,e,n,r){var o=Na;if(null===o)throw Error(s(349));var i=e._getVersion,a=i(e._source),c=Ki.current,u=c.useState((function(){return ls(o,e,n)})),l=u[1],f=u[0];u=Zi;var h=t.memoizedState,p=h.refs,d=p.getSnapshot,v=h.source;h=h.subscribe;var y=Qi;return t.memoizedState={refs:p,source:e,subscribe:r},c.useEffect((function(){p.getSnapshot=n,p.setSnapshot=l;var t=i(e._source);if(!ar(a,t)){t=n(e._source),ar(f,t)||(l(t),t=lc(y),o.mutableReadLanes|=t&o.pendingLanes),t=o.mutableReadLanes,o.entangledLanes|=t;for(var r=o.entanglements,s=t;0<s;){var c=31-Ue(s),u=1<<c;r[c]|=t,s&=~u}}}),[n,e,r]),c.useEffect((function(){return r(e._source,(function(){var t=p.getSnapshot,n=p.setSnapshot;try{n(t(e._source));var r=lc(y);o.mutableReadLanes|=r&o.pendingLanes}catch(i){n((function(){throw i}))}}))}),[e,r]),ar(d,n)&&ar(v,e)&&ar(h,r)||((t={pending:null,dispatch:null,lastRenderedReducer:as,lastRenderedState:f}).dispatch=l=Ms.bind(null,Qi,t),u.queue=t,u.baseQueue=null,f=ls(o,e,n),u.memoizedState=u.baseState=f),f}function hs(t,e,n){return fs(ss(),t,e,n)}function ps(t){var e=is();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t=(t=e.queue={pending:null,dispatch:null,lastRenderedReducer:as,lastRenderedState:t}).dispatch=Ms.bind(null,Qi,t),[e.memoizedState,t]}function ds(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},null===(e=Qi.updateQueue)?(e={lastEffect:null},Qi.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t),t}function vs(t){return t={current:t},is().memoizedState=t}function ys(){return ss().memoizedState}function ms(t,e,n,r){var o=is();Qi.flags|=t,o.memoizedState=ds(1|e,n,void 0,void 0===r?null:r)}function gs(t,e,n,r){var o=ss();r=void 0===r?null:r;var i=void 0;if(null!==Xi){var s=Xi.memoizedState;if(i=s.destroy,null!==r&&rs(r,s.deps))return void ds(e,n,i,r)}Qi.flags|=t,o.memoizedState=ds(1|e,n,i,r)}function bs(t,e){return ms(516,4,t,e)}function ws(t,e){return gs(516,4,t,e)}function ks(t,e){return gs(4,2,t,e)}function xs(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Ss(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,gs(4,2,xs.bind(null,e,t),n)}function Os(){}function Cs(t,e){var n=ss();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&rs(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Es(t,e){var n=ss();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&rs(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function _s(t,e){var n=qo();Uo(98>n?98:n,(function(){t(!0)})),Uo(97<n?97:n,(function(){var n=Yi.transition;Yi.transition=1;try{t(!1),e()}finally{Yi.transition=n}}))}function Ms(t,e,n){var r=uc(),o=lc(t),i={lane:o,action:n,eagerReducer:null,eagerState:null,next:null},s=e.pending;if(null===s?i.next=i:(i.next=s.next,s.next=i),e.pending=i,s=t.alternate,t===Qi||null!==s&&s===Qi)es=ts=!0;else{if(0===t.lanes&&(null===s||0===s.lanes)&&null!==(s=e.lastRenderedReducer))try{var a=e.lastRenderedState,c=s(a,n);if(i.eagerReducer=s,i.eagerState=c,ar(c,a))return}catch(u){}fc(t,o,r)}}var Ts={readContext:oi,useCallback:ns,useContext:ns,useEffect:ns,useImperativeHandle:ns,useLayoutEffect:ns,useMemo:ns,useReducer:ns,useRef:ns,useState:ns,useDebugValue:ns,useDeferredValue:ns,useTransition:ns,useMutableSource:ns,useOpaqueIdentifier:ns,unstable_isNewReconciler:!1},Ns={readContext:oi,useCallback:function(t,e){return is().memoizedState=[t,void 0===e?null:e],t},useContext:oi,useEffect:bs,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,ms(4,2,xs.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ms(4,2,t,e)},useMemo:function(t,e){var n=is();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=is();return e=void 0!==n?n(e):e,r.memoizedState=r.baseState=e,t=(t=r.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e}).dispatch=Ms.bind(null,Qi,t),[r.memoizedState,t]},useRef:vs,useState:ps,useDebugValue:Os,useDeferredValue:function(t){var e=ps(t),n=e[0],r=e[1];return bs((function(){var e=Yi.transition;Yi.transition=1;try{r(t)}finally{Yi.transition=e}}),[t]),n},useTransition:function(){var t=ps(!1),e=t[0];return vs(t=_s.bind(null,t[1])),[t,e]},useMutableSource:function(t,e,n){var r=is();return r.memoizedState={refs:{getSnapshot:e,setSnapshot:null},source:t,subscribe:n},fs(r,t,e,n)},useOpaqueIdentifier:function(){if(Bi){var t=!1,e=function(t){return{$$typeof:R,toString:t,valueOf:t}}((function(){throw t||(t=!0,n("r:"+(Hr++).toString(36))),Error(s(355))})),n=ps(e)[1];return 0===(2&Qi.mode)&&(Qi.flags|=516,ds(5,(function(){n("r:"+(Hr++).toString(36))}),void 0,null)),e}return ps(e="r:"+(Hr++).toString(36)),e},unstable_isNewReconciler:!1},As={readContext:oi,useCallback:Cs,useContext:oi,useEffect:ws,useImperativeHandle:Ss,useLayoutEffect:ks,useMemo:Es,useReducer:cs,useRef:ys,useState:function(){return cs(as)},useDebugValue:Os,useDeferredValue:function(t){var e=cs(as),n=e[0],r=e[1];return ws((function(){var e=Yi.transition;Yi.transition=1;try{r(t)}finally{Yi.transition=e}}),[t]),n},useTransition:function(){var t=cs(as)[0];return[ys().current,t]},useMutableSource:hs,useOpaqueIdentifier:function(){return cs(as)[0]},unstable_isNewReconciler:!1},Is={readContext:oi,useCallback:Cs,useContext:oi,useEffect:ws,useImperativeHandle:Ss,useLayoutEffect:ks,useMemo:Es,useReducer:us,useRef:ys,useState:function(){return us(as)},useDebugValue:Os,useDeferredValue:function(t){var e=us(as),n=e[0],r=e[1];return ws((function(){var e=Yi.transition;Yi.transition=1;try{r(t)}finally{Yi.transition=e}}),[t]),n},useTransition:function(){var t=us(as)[0];return[ys().current,t]},useMutableSource:hs,useOpaqueIdentifier:function(){return us(as)[0]},unstable_isNewReconciler:!1},js=k.ReactCurrentOwner,Ds=!1;function Rs(t,e,n,r){e.child=null===t?Ci(e,null,n,r):Oi(e,t.child,n,r)}function Ps(t,e,n,r,o){n=n.render;var i=e.ref;return ri(e,o),r=os(t,e,n,r,i,o),null===t||Ds?(e.flags|=1,Rs(t,e,r,o),e.child):(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~o,na(t,e,o))}function zs(t,e,n,r,o,i){if(null===t){var s=n.type;return"function"!==typeof s||qc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Uc(n.type,null,r,e,e.mode,i)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=s,Fs(t,e,s,r,o,i))}return s=t.child,0===(o&i)&&(o=s.memoizedProps,(n=null!==(n=n.compare)?n:ur)(o,r)&&t.ref===e.ref)?na(t,e,i):(e.flags|=1,(t=Jc(s,r)).ref=e.ref,t.return=e,e.child=t)}function Fs(t,e,n,r,o,i){if(null!==t&&ur(t.memoizedProps,r)&&t.ref===e.ref){if(Ds=!1,0===(i&o))return e.lanes=t.lanes,na(t,e,i);0!==(16384&t.flags)&&(Ds=!0)}return $s(t,e,n,r,i)}function Bs(t,e,n){var r=e.pendingProps,o=r.children,i=null!==t?t.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0===(4&e.mode))e.memoizedState={baseLanes:0},bc(e,n);else{if(0===(1073741824&n))return t=null!==i?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t},bc(e,t),null;e.memoizedState={baseLanes:0},bc(e,null!==i?i.baseLanes:n)}else null!==i?(r=i.baseLanes|n,e.memoizedState=null):r=n,bc(e,r);return Rs(t,e,o,n),e.child}function Ls(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=128)}function $s(t,e,n,r,o){var i=vo(n)?ho:lo.current;return i=po(e,i),ri(e,o),n=os(t,e,n,r,i,o),null===t||Ds?(e.flags|=1,Rs(t,e,n,o),e.child):(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~o,na(t,e,o))}function qs(t,e,n,r,o){if(vo(n)){var i=!0;bo(e)}else i=!1;if(ri(e,o),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),mi(e,n,r),bi(e,n,r,o),r=!0;else if(null===t){var s=e.stateNode,a=e.memoizedProps;s.props=a;var c=s.context,u=n.contextType;"object"===typeof u&&null!==u?u=oi(u):u=po(e,u=vo(n)?ho:lo.current);var l=n.getDerivedStateFromProps,f="function"===typeof l||"function"===typeof s.getSnapshotBeforeUpdate;f||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==r||c!==u)&&gi(e,s,r,u),ii=!1;var h=e.memoizedState;s.state=h,fi(e,r,s,o),c=e.memoizedState,a!==r||h!==c||fo.current||ii?("function"===typeof l&&(di(e,n,l,r),c=e.memoizedState),(a=ii||yi(e,n,a,r,h,c,u))?(f||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(e.flags|=4)):("function"===typeof s.componentDidMount&&(e.flags|=4),e.memoizedProps=r,e.memoizedState=c),s.props=r,s.state=c,s.context=u,r=a):("function"===typeof s.componentDidMount&&(e.flags|=4),r=!1)}else{s=e.stateNode,ai(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Yo(e.type,a),s.props=u,f=e.pendingProps,h=s.context,"object"===typeof(c=n.contextType)&&null!==c?c=oi(c):c=po(e,c=vo(n)?ho:lo.current);var p=n.getDerivedStateFromProps;(l="function"===typeof p||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==f||h!==c)&&gi(e,s,r,c),ii=!1,h=e.memoizedState,s.state=h,fi(e,r,s,o);var d=e.memoizedState;a!==f||h!==d||fo.current||ii?("function"===typeof p&&(di(e,n,p,r),d=e.memoizedState),(u=ii||yi(e,n,u,r,h,d,c))?(l||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,d,c),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,d,c)),"function"===typeof s.componentDidUpdate&&(e.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(e.flags|=256)):("function"!==typeof s.componentDidUpdate||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=256),e.memoizedProps=r,e.memoizedState=d),s.props=r,s.state=d,s.context=c,r=u):("function"!==typeof s.componentDidUpdate||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=256),r=!1)}return Js(t,e,n,r,i,o)}function Js(t,e,n,r,o,i){Ls(t,e);var s=0!==(64&e.flags);if(!r&&!s)return o&&wo(e,n,!1),na(t,e,i);r=e.stateNode,js.current=e;var a=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return e.flags|=1,null!==t&&s?(e.child=Oi(e,t.child,null,i),e.child=Oi(e,null,a,i)):Rs(t,e,a,i),e.memoizedState=r.state,o&&wo(e,n,!0),e.child}function Us(t){var e=t.stateNode;e.pendingContext?mo(0,e.pendingContext,e.pendingContext!==e.context):e.context&&mo(0,e.context,!1),Ai(t,e.containerInfo)}var Vs,Ws,Hs,Ks={dehydrated:null,retryLane:0};function Ys(t,e,n){var r,o=e.pendingProps,i=Ri.current,s=!1;return(r=0!==(64&e.flags))||(r=(null===t||null!==t.memoizedState)&&0!==(2&i)),r?(s=!0,e.flags&=-65):null!==t&&null===t.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(i|=1),co(Ri,1&i),null===t?(void 0!==o.fallback&&qi(e),t=o.children,i=o.fallback,s?(t=Gs(e,t,i,n),e.child.memoizedState={baseLanes:n},e.memoizedState=Ks,t):"number"===typeof o.unstable_expectedLoadTime?(t=Gs(e,t,i,n),e.child.memoizedState={baseLanes:n},e.memoizedState=Ks,e.lanes=33554432,t):((n=Wc({mode:"visible",children:t},e.mode,n,null)).return=e,e.child=n)):(t.memoizedState,s?(o=Xs(t,e,o.children,o.fallback,n),s=e.child,i=t.child.memoizedState,s.memoizedState=null===i?{baseLanes:n}:{baseLanes:i.baseLanes|n},s.childLanes=t.childLanes&~n,e.memoizedState=Ks,o):(n=Qs(t,e,o.children,n),e.memoizedState=null,n))}function Gs(t,e,n,r){var o=t.mode,i=t.child;return e={mode:"hidden",children:e},0===(2&o)&&null!==i?(i.childLanes=0,i.pendingProps=e):i=Wc(e,o,0,null),n=Vc(n,o,r,null),i.return=t,n.return=t,i.sibling=n,t.child=i,n}function Qs(t,e,n,r){var o=t.child;return t=o.sibling,n=Jc(o,{mode:"visible",children:n}),0===(2&e.mode)&&(n.lanes=r),n.return=e,n.sibling=null,null!==t&&(t.nextEffect=null,t.flags=8,e.firstEffect=e.lastEffect=t),e.child=n}function Xs(t,e,n,r,o){var i=e.mode,s=t.child;t=s.sibling;var a={mode:"hidden",children:n};return 0===(2&i)&&e.child!==s?((n=e.child).childLanes=0,n.pendingProps=a,null!==(s=n.lastEffect)?(e.firstEffect=n.firstEffect,e.lastEffect=s,s.nextEffect=null):e.firstEffect=e.lastEffect=null):n=Jc(s,a),null!==t?r=Jc(t,r):(r=Vc(r,i,o,null)).flags|=2,r.return=e,n.return=e,n.sibling=r,e.child=n,r}function Zs(t,e){t.lanes|=e;var n=t.alternate;null!==n&&(n.lanes|=e),ni(t.return,e)}function ta(t,e,n,r,o,i){var s=t.memoizedState;null===s?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o,lastEffect:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=o,s.lastEffect=i)}function ea(t,e,n){var r=e.pendingProps,o=r.revealOrder,i=r.tail;if(Rs(t,e,r.children,n),0!==(2&(r=Ri.current)))r=1&r|2,e.flags|=64;else{if(null!==t&&0!==(64&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Zs(t,n);else if(19===t.tag)Zs(t,n);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(co(Ri,r),0===(2&e.mode))e.memoizedState=null;else switch(o){case"forwards":for(n=e.child,o=null;null!==n;)null!==(t=n.alternate)&&null===Pi(t)&&(o=n),n=n.sibling;null===(n=o)?(o=e.child,e.child=null):(o=n.sibling,n.sibling=null),ta(e,!1,o,n,i,e.lastEffect);break;case"backwards":for(n=null,o=e.child,e.child=null;null!==o;){if(null!==(t=o.alternate)&&null===Pi(t)){e.child=o;break}t=o.sibling,o.sibling=n,n=o,o=t}ta(e,!0,n,null,i,e.lastEffect);break;case"together":ta(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function na(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),Fa|=e.lanes,0!==(n&e.childLanes)){if(null!==t&&e.child!==t.child)throw Error(s(153));if(null!==e.child){for(n=Jc(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Jc(t,t.pendingProps)).return=e;n.sibling=null}return e.child}return null}function ra(t,e){if(!Bi)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?e||null===t.tail?t.tail=null:t.tail.sibling=null:r.sibling=null}}function oa(t,e,n){var r=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return vo(e.type)&&yo(),null;case 3:return Ii(),ao(fo),ao(lo),Hi(),(r=e.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==t&&null!==t.child||(Ui(e)?e.flags|=4:r.hydrate||(e.flags|=256)),null;case 5:Di(e);var i=Ni(Ti.current);if(n=e.type,null!==t&&null!=e.stateNode)Ws(t,e,n,r),t.ref!==e.ref&&(e.flags|=128);else{if(!r){if(null===e.stateNode)throw Error(s(166));return null}if(t=Ni(_i.current),Ui(e)){r=e.stateNode,n=e.type;var a=e.memoizedProps;switch(r[Yr]=e,r[Gr]=a,n){case"dialog":_r("cancel",r),_r("close",r);break;case"iframe":case"object":case"embed":_r("load",r);break;case"video":case"audio":for(t=0;t<Sr.length;t++)_r(Sr[t],r);break;case"source":_r("error",r);break;case"img":case"image":case"link":_r("error",r),_r("load",r);break;case"details":_r("toggle",r);break;case"input":tt(r,a),_r("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},_r("invalid",r);break;case"textarea":ct(r,a),_r("invalid",r)}for(var u in Ot(n,a),t=null,a)a.hasOwnProperty(u)&&(i=a[u],"children"===u?"string"===typeof i?r.textContent!==i&&(t=["children",i]):"number"===typeof i&&r.textContent!==""+i&&(t=["children",""+i]):c.hasOwnProperty(u)&&null!=i&&"onScroll"===u&&_r("scroll",r));switch(n){case"input":G(r),rt(r,a,!0);break;case"textarea":G(r),lt(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=zr)}r=t,e.updateQueue=r,null!==r&&(e.flags|=4)}else{switch(u=9===i.nodeType?i:i.ownerDocument,t===ft&&(t=pt(n)),t===ft?"script"===n?((t=u.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof r.is?t=u.createElement(n,{is:r.is}):(t=u.createElement(n),"select"===n&&(u=t,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):t=u.createElementNS(t,n),t[Yr]=e,t[Gr]=r,Vs(t,e),e.stateNode=t,u=Ct(n,r),n){case"dialog":_r("cancel",t),_r("close",t),i=r;break;case"iframe":case"object":case"embed":_r("load",t),i=r;break;case"video":case"audio":for(i=0;i<Sr.length;i++)_r(Sr[i],t);i=r;break;case"source":_r("error",t),i=r;break;case"img":case"image":case"link":_r("error",t),_r("load",t),i=r;break;case"details":_r("toggle",t),i=r;break;case"input":tt(t,r),i=Z(t,r),_r("invalid",t);break;case"option":i=it(t,r);break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=o({},r,{value:void 0}),_r("invalid",t);break;case"textarea":ct(t,r),i=at(t,r),_r("invalid",t);break;default:i=r}Ot(n,i);var l=i;for(a in l)if(l.hasOwnProperty(a)){var f=l[a];"style"===a?xt(t,f):"dangerouslySetInnerHTML"===a?null!=(f=f?f.__html:void 0)&&mt(t,f):"children"===a?"string"===typeof f?("textarea"!==n||""!==f)&&gt(t,f):"number"===typeof f&&gt(t,""+f):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(c.hasOwnProperty(a)?null!=f&&"onScroll"===a&&_r("scroll",t):null!=f&&w(t,a,f,u))}switch(n){case"input":G(t),rt(t,r,!1);break;case"textarea":G(t),lt(t);break;case"option":null!=r.value&&t.setAttribute("value",""+K(r.value));break;case"select":t.multiple=!!r.multiple,null!=(a=r.value)?st(t,!!r.multiple,a,!1):null!=r.defaultValue&&st(t,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(t.onclick=zr)}Lr(n,r)&&(e.flags|=4)}null!==e.ref&&(e.flags|=128)}return null;case 6:if(t&&null!=e.stateNode)Hs(0,e,t.memoizedProps,r);else{if("string"!==typeof r&&null===e.stateNode)throw Error(s(166));n=Ni(Ti.current),Ni(_i.current),Ui(e)?(r=e.stateNode,n=e.memoizedProps,r[Yr]=e,r.nodeValue!==n&&(e.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Yr]=e,e.stateNode=r)}return null;case 13:return ao(Ri),r=e.memoizedState,0!==(64&e.flags)?(e.lanes=n,e):(r=null!==r,n=!1,null===t?void 0!==e.memoizedProps.fallback&&Ui(e):n=null!==t.memoizedState,r&&!n&&0!==(2&e.mode)&&(null===t&&!0!==e.memoizedProps.unstable_avoidThisFallback||0!==(1&Ri.current)?0===Ra&&(Ra=3):(0!==Ra&&3!==Ra||(Ra=4),null===Na||0===(134217727&Fa)&&0===(134217727&Ba)||vc(Na,Ia))),(r||n)&&(e.flags|=4),null);case 4:return Ii(),null===t&&Tr(e.stateNode.containerInfo),null;case 10:return ei(e),null;case 17:return vo(e.type)&&yo(),null;case 19:if(ao(Ri),null===(r=e.memoizedState))return null;if(a=0!==(64&e.flags),null===(u=r.rendering))if(a)ra(r,!1);else{if(0!==Ra||null!==t&&0!==(64&t.flags))for(t=e.child;null!==t;){if(null!==(u=Pi(t))){for(e.flags|=64,ra(r,!1),null!==(a=u.updateQueue)&&(e.updateQueue=a,e.flags|=4),null===r.lastEffect&&(e.firstEffect=null),e.lastEffect=r.lastEffect,r=n,n=e.child;null!==n;)t=r,(a=n).flags&=2,a.nextEffect=null,a.firstEffect=null,a.lastEffect=null,null===(u=a.alternate)?(a.childLanes=0,a.lanes=t,a.child=null,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=u.childLanes,a.lanes=u.lanes,a.child=u.child,a.memoizedProps=u.memoizedProps,a.memoizedState=u.memoizedState,a.updateQueue=u.updateQueue,a.type=u.type,t=u.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return co(Ri,1&Ri.current|2),e.child}t=t.sibling}null!==r.tail&&$o()>Ja&&(e.flags|=64,a=!0,ra(r,!1),e.lanes=33554432)}else{if(!a)if(null!==(t=Pi(u))){if(e.flags|=64,a=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),ra(r,!0),null===r.tail&&"hidden"===r.tailMode&&!u.alternate&&!Bi)return null!==(e=e.lastEffect=r.lastEffect)&&(e.nextEffect=null),null}else 2*$o()-r.renderingStartTime>Ja&&1073741824!==n&&(e.flags|=64,a=!0,ra(r,!1),e.lanes=33554432);r.isBackwards?(u.sibling=e.child,e.child=u):(null!==(n=r.last)?n.sibling=u:e.child=u,r.last=u)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=e.lastEffect,r.renderingStartTime=$o(),n.sibling=null,e=Ri.current,co(Ri,a?1&e|2:1&e),n):null;case 23:case 24:return wc(),null!==t&&null!==t.memoizedState!==(null!==e.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(e.flags|=4),null}throw Error(s(156,e.tag))}function ia(t){switch(t.tag){case 1:vo(t.type)&&yo();var e=t.flags;return 4096&e?(t.flags=-4097&e|64,t):null;case 3:if(Ii(),ao(fo),ao(lo),Hi(),0!==(64&(e=t.flags)))throw Error(s(285));return t.flags=-4097&e|64,t;case 5:return Di(t),null;case 13:return ao(Ri),4096&(e=t.flags)?(t.flags=-4097&e|64,t):null;case 19:return ao(Ri),null;case 4:return Ii(),null;case 10:return ei(t),null;case 23:case 24:return wc(),null;default:return null}}function sa(t,e){try{var n="",r=e;do{n+=W(r),r=r.return}while(r);var o=n}catch(i){o="\nError generating stack: "+i.message+"\n"+i.stack}return{value:t,source:e,stack:o}}function aa(t,e){try{console.error(e.value)}catch(n){setTimeout((function(){throw n}))}}Vs=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ws=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Ni(_i.current);var s,a=null;switch(n){case"input":i=Z(t,i),r=Z(t,r),a=[];break;case"option":i=it(t,i),r=it(t,r),a=[];break;case"select":i=o({},i,{value:void 0}),r=o({},r,{value:void 0}),a=[];break;case"textarea":i=at(t,i),r=at(t,r),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(t.onclick=zr)}for(f in Ot(n,r),n=null,i)if(!r.hasOwnProperty(f)&&i.hasOwnProperty(f)&&null!=i[f])if("style"===f){var u=i[f];for(s in u)u.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==f&&"children"!==f&&"suppressContentEditableWarning"!==f&&"suppressHydrationWarning"!==f&&"autoFocus"!==f&&(c.hasOwnProperty(f)?a||(a=[]):(a=a||[]).push(f,null));for(f in r){var l=r[f];if(u=null!=i?i[f]:void 0,r.hasOwnProperty(f)&&l!==u&&(null!=l||null!=u))if("style"===f)if(u){for(s in u)!u.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&u[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(a||(a=[]),a.push(f,n)),n=l;else"dangerouslySetInnerHTML"===f?(l=l?l.__html:void 0,u=u?u.__html:void 0,null!=l&&u!==l&&(a=a||[]).push(f,l)):"children"===f?"string"!==typeof l&&"number"!==typeof l||(a=a||[]).push(f,""+l):"suppressContentEditableWarning"!==f&&"suppressHydrationWarning"!==f&&(c.hasOwnProperty(f)?(null!=l&&"onScroll"===f&&_r("scroll",t),a||u===l||(a=[])):"object"===typeof l&&null!==l&&l.$$typeof===R?l.toString():(a=a||[]).push(f,l))}n&&(a=a||[]).push("style",n);var f=a;(e.updateQueue=f)&&(e.flags|=4)}},Hs=function(t,e,n,r){n!==r&&(e.flags|=4)};var ca="function"===typeof WeakMap?WeakMap:Map;function ua(t,e,n){(n=ci(-1,n)).tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ha||(Ha=!0,Ka=r),aa(0,e)},n}function la(t,e,n){(n=ci(-1,n)).tag=3;var r=t.type.getDerivedStateFromError;if("function"===typeof r){var o=e.value;n.payload=function(){return aa(0,e),r(o)}}var i=t.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===Ya?Ya=new Set([this]):Ya.add(this),aa(0,e));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}var fa="function"===typeof WeakSet?WeakSet:Set;function ha(t){var e=t.ref;if(null!==e)if("function"===typeof e)try{e(null)}catch(n){zc(t,n)}else e.current=null}function pa(t,e){switch(e.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&e.flags&&null!==t){var n=t.memoizedProps,r=t.memoizedState;e=(t=e.stateNode).getSnapshotBeforeUpdate(e.elementType===e.type?n:Yo(e.type,n),r),t.__reactInternalSnapshotBeforeUpdate=e}return;case 3:return void(256&e.flags&&Ur(e.stateNode.containerInfo));case 5:case 6:case 4:case 17:return}throw Error(s(163))}function da(t,e,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(e=null!==(e=n.updateQueue)?e.lastEffect:null)){t=e=e.next;do{if(3===(3&t.tag)){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}if(null!==(e=null!==(e=n.updateQueue)?e.lastEffect:null)){t=e=e.next;do{var o=t;r=o.next,0!==(4&(o=o.tag))&&0!==(1&o)&&(Dc(n,t),jc(n,t)),t=r}while(t!==e)}return;case 1:return t=n.stateNode,4&n.flags&&(null===e?t.componentDidMount():(r=n.elementType===n.type?e.memoizedProps:Yo(n.type,e.memoizedProps),t.componentDidUpdate(r,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate))),void(null!==(e=n.updateQueue)&&hi(n,e,t));case 3:if(null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}hi(n,e,t)}return;case 5:return t=n.stateNode,void(null===e&&4&n.flags&&Lr(n.type,n.memoizedProps)&&t.focus());case 6:case 4:case 12:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&xe(n)))));case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(s(163))}function va(t,e){for(var n=t;;){if(5===n.tag){var r=n.stateNode;if(e)"function"===typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var o=n.memoizedProps.style;o=void 0!==o&&null!==o&&o.hasOwnProperty("display")?o.display:null,r.style.display=kt("display",o)}}else if(6===n.tag)n.stateNode.nodeValue=e?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===t)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function ya(t,e){if(xo&&"function"===typeof xo.onCommitFiberUnmount)try{xo.onCommitFiberUnmount(ko,e)}catch(i){}switch(e.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect)){var n=t=t.next;do{var r=n,o=r.destroy;if(r=r.tag,void 0!==o)if(0!==(4&r))Dc(e,n);else{r=e;try{o()}catch(i){zc(r,i)}}n=n.next}while(n!==t)}break;case 1:if(ha(e),"function"===typeof(t=e.stateNode).componentWillUnmount)try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(i){zc(e,i)}break;case 5:ha(e);break;case 4:xa(t,e)}}function ma(t){t.alternate=null,t.child=null,t.dependencies=null,t.firstEffect=null,t.lastEffect=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.return=null,t.updateQueue=null}function ga(t){return 5===t.tag||3===t.tag||4===t.tag}function ba(t){t:{for(var e=t.return;null!==e;){if(ga(e))break t;e=e.return}throw Error(s(160))}var n=e;switch(e=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:e=e.containerInfo,r=!0;break;default:throw Error(s(161))}16&n.flags&&(gt(e,""),n.flags&=-17);t:e:for(n=t;;){for(;null===n.sibling;){if(null===n.return||ga(n.return)){n=null;break t}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue e;if(null===n.child||4===n.tag)continue e;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break t}}r?wa(t,n,e):ka(t,n,e)}function wa(t,e,n){var r=t.tag,o=5===r||6===r;if(o)t=o?t.stateNode:t.stateNode.instance,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!==(n=n._reactRootContainer)&&void 0!==n||null!==e.onclick||(e.onclick=zr));else if(4!==r&&null!==(t=t.child))for(wa(t,e,n),t=t.sibling;null!==t;)wa(t,e,n),t=t.sibling}function ka(t,e,n){var r=t.tag,o=5===r||6===r;if(o)t=o?t.stateNode:t.stateNode.instance,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==r&&null!==(t=t.child))for(ka(t,e,n),t=t.sibling;null!==t;)ka(t,e,n),t=t.sibling}function xa(t,e){for(var n,r,o=e,i=!1;;){if(!i){i=o.return;t:for(;;){if(null===i)throw Error(s(160));switch(n=i.stateNode,i.tag){case 5:r=!1;break t;case 3:case 4:n=n.containerInfo,r=!0;break t}i=i.return}i=!0}if(5===o.tag||6===o.tag){t:for(var a=t,c=o,u=c;;)if(ya(a,u),null!==u.child&&4!==u.tag)u.child.return=u,u=u.child;else{if(u===c)break t;for(;null===u.sibling;){if(null===u.return||u.return===c)break t;u=u.return}u.sibling.return=u.return,u=u.sibling}r?(a=n,c=o.stateNode,8===a.nodeType?a.parentNode.removeChild(c):a.removeChild(c)):n.removeChild(o.stateNode)}else if(4===o.tag){if(null!==o.child){n=o.stateNode.containerInfo,r=!0,o.child.return=o,o=o.child;continue}}else if(ya(t,o),null!==o.child){o.child.return=o,o=o.child;continue}if(o===e)break;for(;null===o.sibling;){if(null===o.return||o.return===e)return;4===(o=o.return).tag&&(i=!1)}o.sibling.return=o.return,o=o.sibling}}function Sa(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:var n=e.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3===(3&r.tag)&&(t=r.destroy,r.destroy=void 0,void 0!==t&&t()),r=r.next}while(r!==n)}return;case 1:return;case 5:if(null!=(n=e.stateNode)){r=e.memoizedProps;var o=null!==t?t.memoizedProps:r;t=e.type;var i=e.updateQueue;if(e.updateQueue=null,null!==i){for(n[Gr]=r,"input"===t&&"radio"===r.type&&null!=r.name&&et(n,r),Ct(t,o),e=Ct(t,r),o=0;o<i.length;o+=2){var a=i[o],c=i[o+1];"style"===a?xt(n,c):"dangerouslySetInnerHTML"===a?mt(n,c):"children"===a?gt(n,c):w(n,a,c,e)}switch(t){case"input":nt(n,r);break;case"textarea":ut(n,r);break;case"select":t=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(i=r.value)?st(n,!!r.multiple,i,!1):t!==!!r.multiple&&(null!=r.defaultValue?st(n,!!r.multiple,r.defaultValue,!0):st(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===e.stateNode)throw Error(s(162));return void(e.stateNode.nodeValue=e.memoizedProps);case 3:return void((n=e.stateNode).hydrate&&(n.hydrate=!1,xe(n.containerInfo)));case 12:return;case 13:return null!==e.memoizedState&&(qa=$o(),va(e.child,!0)),void Oa(e);case 19:return void Oa(e);case 17:return;case 23:case 24:return void va(e,null!==e.memoizedState)}throw Error(s(163))}function Oa(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new fa),e.forEach((function(e){var r=Bc.bind(null,t,e);n.has(e)||(n.add(e),e.then(r,r))}))}}function Ca(t,e){return null!==t&&(null===(t=t.memoizedState)||null!==t.dehydrated)&&(null!==(e=e.memoizedState)&&null===e.dehydrated)}var Ea=Math.ceil,_a=k.ReactCurrentDispatcher,Ma=k.ReactCurrentOwner,Ta=0,Na=null,Aa=null,Ia=0,ja=0,Da=so(0),Ra=0,Pa=null,za=0,Fa=0,Ba=0,La=0,$a=null,qa=0,Ja=1/0;function Ua(){Ja=$o()+500}var Va,Wa=null,Ha=!1,Ka=null,Ya=null,Ga=!1,Qa=null,Xa=90,Za=[],tc=[],ec=null,nc=0,rc=null,oc=-1,ic=0,sc=0,ac=null,cc=!1;function uc(){return 0!==(48&Ta)?$o():-1!==oc?oc:oc=$o()}function lc(t){if(0===(2&(t=t.mode)))return 1;if(0===(4&t))return 99===qo()?1:2;if(0===ic&&(ic=za),0!==Ko.transition){0!==sc&&(sc=null!==$a?$a.pendingLanes:0),t=ic;var e=4186112&~sc;return 0===(e&=-e)&&(0===(e=(t=4186112&~t)&-t)&&(e=8192)),e}return t=qo(),0!==(4&Ta)&&98===t?t=Le(12,ic):t=Le(t=function(t){switch(t){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(t),ic),t}function fc(t,e,n){if(50<nc)throw nc=0,rc=null,Error(s(185));if(null===(t=hc(t,e)))return null;Je(t,e,n),t===Na&&(Ba|=e,4===Ra&&vc(t,Ia));var r=qo();1===e?0!==(8&Ta)&&0===(48&Ta)?yc(t):(pc(t,n),0===Ta&&(Ua(),Wo())):(0===(4&Ta)||98!==r&&99!==r||(null===ec?ec=new Set([t]):ec.add(t)),pc(t,n)),$a=t}function hc(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}function pc(t,e){for(var n=t.callbackNode,r=t.suspendedLanes,o=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var c=31-Ue(a),u=1<<c,l=i[c];if(-1===l){if(0===(u&r)||0!==(u&o)){l=e,ze(u);var f=Pe;i[c]=10<=f?l+250:6<=f?l+5e3:-1}}else l<=e&&(t.expiredLanes|=u);a&=~u}if(r=Fe(t,t===Na?Ia:0),e=Pe,0===r)null!==n&&(n!==Ro&&Co(n),t.callbackNode=null,t.callbackPriority=0);else{if(null!==n){if(t.callbackPriority===e)return;n!==Ro&&Co(n)}15===e?(n=yc.bind(null,t),null===zo?(zo=[n],Fo=Oo(No,Ho)):zo.push(n),n=Ro):14===e?n=Vo(99,yc.bind(null,t)):n=Vo(n=function(t){switch(t){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(s(358,t))}}(e),dc.bind(null,t)),t.callbackPriority=e,t.callbackNode=n}}function dc(t){if(oc=-1,sc=ic=0,0!==(48&Ta))throw Error(s(327));var e=t.callbackNode;if(Ic()&&t.callbackNode!==e)return null;var n=Fe(t,t===Na?Ia:0);if(0===n)return null;var r=n,o=Ta;Ta|=16;var i=Sc();for(Na===t&&Ia===r||(Ua(),kc(t,r));;)try{Ec();break}catch(c){xc(t,c)}if(ti(),_a.current=i,Ta=o,null!==Aa?r=0:(Na=null,Ia=0,r=Ra),0!==(za&Ba))kc(t,0);else if(0!==r){if(2===r&&(Ta|=64,t.hydrate&&(t.hydrate=!1,Ur(t.containerInfo)),0!==(n=Be(t))&&(r=Oc(t,n))),1===r)throw e=Pa,kc(t,0),vc(t,n),pc(t,$o()),e;switch(t.finishedWork=t.current.alternate,t.finishedLanes=n,r){case 0:case 1:throw Error(s(345));case 2:Tc(t);break;case 3:if(vc(t,n),(62914560&n)===n&&10<(r=qa+500-$o())){if(0!==Fe(t,0))break;if(((o=t.suspendedLanes)&n)!==n){uc(),t.pingedLanes|=t.suspendedLanes&o;break}t.timeoutHandle=qr(Tc.bind(null,t),r);break}Tc(t);break;case 4:if(vc(t,n),(4186112&n)===n)break;for(r=t.eventTimes,o=-1;0<n;){var a=31-Ue(n);i=1<<a,(a=r[a])>o&&(o=a),n&=~i}if(n=o,10<(n=(120>(n=$o()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ea(n/1960))-n)){t.timeoutHandle=qr(Tc.bind(null,t),n);break}Tc(t);break;case 5:Tc(t);break;default:throw Error(s(329))}}return pc(t,$o()),t.callbackNode===e?dc.bind(null,t):null}function vc(t,e){for(e&=~La,e&=~Ba,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ue(e),r=1<<n;t[n]=-1,e&=~r}}function yc(t){if(0!==(48&Ta))throw Error(s(327));if(Ic(),t===Na&&0!==(t.expiredLanes&Ia)){var e=Ia,n=Oc(t,e);0!==(za&Ba)&&(n=Oc(t,e=Fe(t,e)))}else n=Oc(t,e=Fe(t,0));if(0!==t.tag&&2===n&&(Ta|=64,t.hydrate&&(t.hydrate=!1,Ur(t.containerInfo)),0!==(e=Be(t))&&(n=Oc(t,e))),1===n)throw n=Pa,kc(t,0),vc(t,e),pc(t,$o()),n;return t.finishedWork=t.current.alternate,t.finishedLanes=e,Tc(t),pc(t,$o()),null}function mc(t,e){var n=Ta;Ta|=1;try{return t(e)}finally{0===(Ta=n)&&(Ua(),Wo())}}function gc(t,e){var n=Ta;Ta&=-2,Ta|=8;try{return t(e)}finally{0===(Ta=n)&&(Ua(),Wo())}}function bc(t,e){co(Da,ja),ja|=e,za|=e}function wc(){ja=Da.current,ao(Da)}function kc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,Jr(n)),null!==Aa)for(n=Aa.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&yo();break;case 3:Ii(),ao(fo),ao(lo),Hi();break;case 5:Di(r);break;case 4:Ii();break;case 13:case 19:ao(Ri);break;case 10:ei(r);break;case 23:case 24:wc()}n=n.return}Na=t,Aa=Jc(t.current,null),Ia=ja=za=e,Ra=0,Pa=null,La=Ba=Fa=0}function xc(t,e){for(;;){var n=Aa;try{if(ti(),Ki.current=Ts,ts){for(var r=Qi.memoizedState;null!==r;){var o=r.queue;null!==o&&(o.pending=null),r=r.next}ts=!1}if(Gi=0,Zi=Xi=Qi=null,es=!1,Ma.current=null,null===n||null===n.return){Ra=1,Pa=e,Aa=null;break}t:{var i=t,s=n.return,a=n,c=e;if(e=Ia,a.flags|=2048,a.firstEffect=a.lastEffect=null,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c;if(0===(2&a.mode)){var l=a.alternate;l?(a.updateQueue=l.updateQueue,a.memoizedState=l.memoizedState,a.lanes=l.lanes):(a.updateQueue=null,a.memoizedState=null)}var f=0!==(1&Ri.current),h=s;do{var p;if(p=13===h.tag){var d=h.memoizedState;if(null!==d)p=null!==d.dehydrated;else{var v=h.memoizedProps;p=void 0!==v.fallback&&(!0!==v.unstable_avoidThisFallback||!f)}}if(p){var y=h.updateQueue;if(null===y){var m=new Set;m.add(u),h.updateQueue=m}else y.add(u);if(0===(2&h.mode)){if(h.flags|=64,a.flags|=16384,a.flags&=-2981,1===a.tag)if(null===a.alternate)a.tag=17;else{var g=ci(-1,1);g.tag=2,ui(a,g)}a.lanes|=1;break t}c=void 0,a=e;var b=i.pingCache;if(null===b?(b=i.pingCache=new ca,c=new Set,b.set(u,c)):void 0===(c=b.get(u))&&(c=new Set,b.set(u,c)),!c.has(a)){c.add(a);var w=Fc.bind(null,i,u,a);u.then(w,w)}h.flags|=4096,h.lanes=e;break t}h=h.return}while(null!==h);c=Error((H(a.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Ra&&(Ra=2),c=sa(c,a),h=s;do{switch(h.tag){case 3:i=c,h.flags|=4096,e&=-e,h.lanes|=e,li(h,ua(0,i,e));break t;case 1:i=c;var k=h.type,x=h.stateNode;if(0===(64&h.flags)&&("function"===typeof k.getDerivedStateFromError||null!==x&&"function"===typeof x.componentDidCatch&&(null===Ya||!Ya.has(x)))){h.flags|=4096,e&=-e,h.lanes|=e,li(h,la(h,i,e));break t}}h=h.return}while(null!==h)}Mc(n)}catch(S){e=S,Aa===n&&null!==n&&(Aa=n=n.return);continue}break}}function Sc(){var t=_a.current;return _a.current=Ts,null===t?Ts:t}function Oc(t,e){var n=Ta;Ta|=16;var r=Sc();for(Na===t&&Ia===e||kc(t,e);;)try{Cc();break}catch(o){xc(t,o)}if(ti(),Ta=n,_a.current=r,null!==Aa)throw Error(s(261));return Na=null,Ia=0,Ra}function Cc(){for(;null!==Aa;)_c(Aa)}function Ec(){for(;null!==Aa&&!Eo();)_c(Aa)}function _c(t){var e=Va(t.alternate,t,ja);t.memoizedProps=t.pendingProps,null===e?Mc(t):Aa=e,Ma.current=null}function Mc(t){var e=t;do{var n=e.alternate;if(t=e.return,0===(2048&e.flags)){if(null!==(n=oa(n,e,ja)))return void(Aa=n);if(24!==(n=e).tag&&23!==n.tag||null===n.memoizedState||0!==(1073741824&ja)||0===(4&n.mode)){for(var r=0,o=n.child;null!==o;)r|=o.lanes|o.childLanes,o=o.sibling;n.childLanes=r}null!==t&&0===(2048&t.flags)&&(null===t.firstEffect&&(t.firstEffect=e.firstEffect),null!==e.lastEffect&&(null!==t.lastEffect&&(t.lastEffect.nextEffect=e.firstEffect),t.lastEffect=e.lastEffect),1<e.flags&&(null!==t.lastEffect?t.lastEffect.nextEffect=e:t.firstEffect=e,t.lastEffect=e))}else{if(null!==(n=ia(e)))return n.flags&=2047,void(Aa=n);null!==t&&(t.firstEffect=t.lastEffect=null,t.flags|=2048)}if(null!==(e=e.sibling))return void(Aa=e);Aa=e=t}while(null!==e);0===Ra&&(Ra=5)}function Tc(t){var e=qo();return Uo(99,Nc.bind(null,t,e)),null}function Nc(t,e){do{Ic()}while(null!==Qa);if(0!==(48&Ta))throw Error(s(327));var n=t.finishedWork;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(s(177));t.callbackNode=null;var r=n.lanes|n.childLanes,o=r,i=t.pendingLanes&~o;t.pendingLanes=o,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=o,t.mutableReadLanes&=o,t.entangledLanes&=o,o=t.entanglements;for(var a=t.eventTimes,c=t.expirationTimes;0<i;){var u=31-Ue(i),l=1<<u;o[u]=0,a[u]=-1,c[u]=-1,i&=~l}if(null!==ec&&0===(24&r)&&ec.has(t)&&ec.delete(t),t===Na&&(Aa=Na=null,Ia=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(o=Ta,Ta|=32,Ma.current=null,Fr=Ye,dr(a=pr())){if("selectionStart"in a)c={start:a.selectionStart,end:a.selectionEnd};else t:if(c=(c=a.ownerDocument)&&c.defaultView||window,(l=c.getSelection&&c.getSelection())&&0!==l.rangeCount){c=l.anchorNode,i=l.anchorOffset,u=l.focusNode,l=l.focusOffset;try{c.nodeType,u.nodeType}catch(E){c=null;break t}var f=0,h=-1,p=-1,d=0,v=0,y=a,m=null;e:for(;;){for(var g;y!==c||0!==i&&3!==y.nodeType||(h=f+i),y!==u||0!==l&&3!==y.nodeType||(p=f+l),3===y.nodeType&&(f+=y.nodeValue.length),null!==(g=y.firstChild);)m=y,y=g;for(;;){if(y===a)break e;if(m===c&&++d===i&&(h=f),m===u&&++v===l&&(p=f),null!==(g=y.nextSibling))break;m=(y=m).parentNode}y=g}c=-1===h||-1===p?null:{start:h,end:p}}else c=null;c=c||{start:0,end:0}}else c=null;Br={focusedElem:a,selectionRange:c},Ye=!1,ac=null,cc=!1,Wa=r;do{try{Ac()}catch(E){if(null===Wa)throw Error(s(330));zc(Wa,E),Wa=Wa.nextEffect}}while(null!==Wa);ac=null,Wa=r;do{try{for(a=t;null!==Wa;){var b=Wa.flags;if(16&b&&gt(Wa.stateNode,""),128&b){var w=Wa.alternate;if(null!==w){var k=w.ref;null!==k&&("function"===typeof k?k(null):k.current=null)}}switch(1038&b){case 2:ba(Wa),Wa.flags&=-3;break;case 6:ba(Wa),Wa.flags&=-3,Sa(Wa.alternate,Wa);break;case 1024:Wa.flags&=-1025;break;case 1028:Wa.flags&=-1025,Sa(Wa.alternate,Wa);break;case 4:Sa(Wa.alternate,Wa);break;case 8:xa(a,c=Wa);var x=c.alternate;ma(c),null!==x&&ma(x)}Wa=Wa.nextEffect}}catch(E){if(null===Wa)throw Error(s(330));zc(Wa,E),Wa=Wa.nextEffect}}while(null!==Wa);if(k=Br,w=pr(),b=k.focusedElem,a=k.selectionRange,w!==b&&b&&b.ownerDocument&&hr(b.ownerDocument.documentElement,b)){null!==a&&dr(b)&&(w=a.start,void 0===(k=a.end)&&(k=w),"selectionStart"in b?(b.selectionStart=w,b.selectionEnd=Math.min(k,b.value.length)):(k=(w=b.ownerDocument||document)&&w.defaultView||window).getSelection&&(k=k.getSelection(),c=b.textContent.length,x=Math.min(a.start,c),a=void 0===a.end?x:Math.min(a.end,c),!k.extend&&x>a&&(c=a,a=x,x=c),c=fr(b,x),i=fr(b,a),c&&i&&(1!==k.rangeCount||k.anchorNode!==c.node||k.anchorOffset!==c.offset||k.focusNode!==i.node||k.focusOffset!==i.offset)&&((w=w.createRange()).setStart(c.node,c.offset),k.removeAllRanges(),x>a?(k.addRange(w),k.extend(i.node,i.offset)):(w.setEnd(i.node,i.offset),k.addRange(w))))),w=[];for(k=b;k=k.parentNode;)1===k.nodeType&&w.push({element:k,left:k.scrollLeft,top:k.scrollTop});for("function"===typeof b.focus&&b.focus(),b=0;b<w.length;b++)(k=w[b]).element.scrollLeft=k.left,k.element.scrollTop=k.top}Ye=!!Fr,Br=Fr=null,t.current=n,Wa=r;do{try{for(b=t;null!==Wa;){var S=Wa.flags;if(36&S&&da(b,Wa.alternate,Wa),128&S){w=void 0;var O=Wa.ref;if(null!==O){var C=Wa.stateNode;switch(Wa.tag){case 5:w=C;break;default:w=C}"function"===typeof O?O(w):O.current=w}}Wa=Wa.nextEffect}}catch(E){if(null===Wa)throw Error(s(330));zc(Wa,E),Wa=Wa.nextEffect}}while(null!==Wa);Wa=null,Po(),Ta=o}else t.current=n;if(Ga)Ga=!1,Qa=t,Xa=e;else for(Wa=r;null!==Wa;)e=Wa.nextEffect,Wa.nextEffect=null,8&Wa.flags&&((S=Wa).sibling=null,S.stateNode=null),Wa=e;if(0===(r=t.pendingLanes)&&(Ya=null),1===r?t===rc?nc++:(nc=0,rc=t):nc=0,n=n.stateNode,xo&&"function"===typeof xo.onCommitFiberRoot)try{xo.onCommitFiberRoot(ko,n,void 0,64===(64&n.current.flags))}catch(E){}if(pc(t,$o()),Ha)throw Ha=!1,t=Ka,Ka=null,t;return 0!==(8&Ta)||Wo(),null}function Ac(){for(;null!==Wa;){var t=Wa.alternate;cc||null===ac||(0!==(8&Wa.flags)?te(Wa,ac)&&(cc=!0):13===Wa.tag&&Ca(t,Wa)&&te(Wa,ac)&&(cc=!0));var e=Wa.flags;0!==(256&e)&&pa(t,Wa),0===(512&e)||Ga||(Ga=!0,Vo(97,(function(){return Ic(),null}))),Wa=Wa.nextEffect}}function Ic(){if(90!==Xa){var t=97<Xa?97:Xa;return Xa=90,Uo(t,Rc)}return!1}function jc(t,e){Za.push(e,t),Ga||(Ga=!0,Vo(97,(function(){return Ic(),null})))}function Dc(t,e){tc.push(e,t),Ga||(Ga=!0,Vo(97,(function(){return Ic(),null})))}function Rc(){if(null===Qa)return!1;var t=Qa;if(Qa=null,0!==(48&Ta))throw Error(s(331));var e=Ta;Ta|=32;var n=tc;tc=[];for(var r=0;r<n.length;r+=2){var o=n[r],i=n[r+1],a=o.destroy;if(o.destroy=void 0,"function"===typeof a)try{a()}catch(u){if(null===i)throw Error(s(330));zc(i,u)}}for(n=Za,Za=[],r=0;r<n.length;r+=2){o=n[r],i=n[r+1];try{var c=o.create;o.destroy=c()}catch(u){if(null===i)throw Error(s(330));zc(i,u)}}for(c=t.current.firstEffect;null!==c;)t=c.nextEffect,c.nextEffect=null,8&c.flags&&(c.sibling=null,c.stateNode=null),c=t;return Ta=e,Wo(),!0}function Pc(t,e,n){ui(t,e=ua(0,e=sa(n,e),1)),e=uc(),null!==(t=hc(t,1))&&(Je(t,1,e),pc(t,e))}function zc(t,e){if(3===t.tag)Pc(t,t,e);else for(var n=t.return;null!==n;){if(3===n.tag){Pc(n,t,e);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Ya||!Ya.has(r))){var o=la(n,t=sa(e,t),1);if(ui(n,o),o=uc(),null!==(n=hc(n,1)))Je(n,1,o),pc(n,o);else if("function"===typeof r.componentDidCatch&&(null===Ya||!Ya.has(r)))try{r.componentDidCatch(e,t)}catch(i){}break}}n=n.return}}function Fc(t,e,n){var r=t.pingCache;null!==r&&r.delete(e),e=uc(),t.pingedLanes|=t.suspendedLanes&n,Na===t&&(Ia&n)===n&&(4===Ra||3===Ra&&(62914560&Ia)===Ia&&500>$o()-qa?kc(t,0):La|=n),pc(t,e)}function Bc(t,e){var n=t.stateNode;null!==n&&n.delete(e),0===(e=0)&&(0===(2&(e=t.mode))?e=1:0===(4&e)?e=99===qo()?1:2:(0===ic&&(ic=za),0===(e=$e(62914560&~ic))&&(e=4194304))),n=uc(),null!==(t=hc(t,e))&&(Je(t,e,n),pc(t,n))}function Lc(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function $c(t,e,n,r){return new Lc(t,e,n,r)}function qc(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Jc(t,e){var n=t.alternate;return null===n?((n=$c(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Uc(t,e,n,r,o,i){var a=2;if(r=t,"function"===typeof t)qc(t)&&(a=1);else if("string"===typeof t)a=5;else t:switch(t){case O:return Vc(n.children,o,i,e);case P:a=8,o|=16;break;case C:a=8,o|=1;break;case E:return(t=$c(12,n,e,8|o)).elementType=E,t.type=E,t.lanes=i,t;case N:return(t=$c(13,n,e,o)).type=N,t.elementType=N,t.lanes=i,t;case A:return(t=$c(19,n,e,o)).elementType=A,t.lanes=i,t;case z:return Wc(n,o,i,e);case F:return(t=$c(24,n,e,o)).elementType=F,t.lanes=i,t;default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case _:a=10;break t;case M:a=9;break t;case T:a=11;break t;case I:a=14;break t;case j:a=16,r=null;break t;case D:a=22;break t}throw Error(s(130,null==t?t:typeof t,""))}return(e=$c(a,n,e,o)).elementType=t,e.type=r,e.lanes=i,e}function Vc(t,e,n,r){return(t=$c(7,t,r,e)).lanes=n,t}function Wc(t,e,n,r){return(t=$c(23,t,r,e)).elementType=z,t.lanes=n,t}function Hc(t,e,n){return(t=$c(6,t,null,e)).lanes=n,t}function Kc(t,e,n){return(e=$c(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Yc(t,e,n){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=qe(0),this.expirationTimes=qe(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qe(0),this.mutableSourceEagerHydrationData=null}function Gc(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:t,containerInfo:e,implementation:n}}function Qc(t,e,n,r){var o=e.current,i=uc(),a=lc(o);t:if(n){e:{if(Gt(n=n._reactInternals)!==n||1!==n.tag)throw Error(s(170));var c=n;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(vo(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(null!==c);throw Error(s(171))}if(1===n.tag){var u=n.type;if(vo(u)){n=go(n,u,c);break t}}n=c}else n=uo;return null===e.context?e.context=n:e.pendingContext=n,(e=ci(i,a)).payload={element:t},null!==(r=void 0===r?null:r)&&(e.callback=r),ui(o,e),fc(o,a,i),a}function Xc(t){if(!(t=t.current).child)return null;switch(t.child.tag){case 5:default:return t.child.stateNode}}function Zc(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function tu(t,e){Zc(t,e),(t=t.alternate)&&Zc(t,e)}function eu(t,e,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new Yc(t,e,null!=n&&!0===n.hydrate),e=$c(3,null,null,2===e?7:1===e?3:0),n.current=e,e.stateNode=n,si(e),t[Qr]=n.current,Tr(8===t.nodeType?t.parentNode:t),r)for(t=0;t<r.length;t++){var o=(e=r[t])._getVersion;o=o(e._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[e,o]:n.mutableSourceEagerHydrationData.push(e,o)}this._internalRoot=n}function nu(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function ru(t,e,n,r,o){var i=n._reactRootContainer;if(i){var s=i._internalRoot;if("function"===typeof o){var a=o;o=function(){var t=Xc(s);a.call(t)}}Qc(e,s,t,o)}else{if(i=n._reactRootContainer=function(t,e){if(e||(e=!(!(e=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var n;n=t.lastChild;)t.removeChild(n);return new eu(t,0,e?{hydrate:!0}:void 0)}(n,r),s=i._internalRoot,"function"===typeof o){var c=o;o=function(){var t=Xc(s);c.call(t)}}gc((function(){Qc(e,s,t,o)}))}return Xc(s)}function ou(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!nu(e))throw Error(s(200));return Gc(t,e,null,n)}Va=function(t,e,n){var r=e.lanes;if(null!==t)if(t.memoizedProps!==e.pendingProps||fo.current)Ds=!0;else{if(0===(n&r)){switch(Ds=!1,e.tag){case 3:Us(e),Vi();break;case 5:ji(e);break;case 1:vo(e.type)&&bo(e);break;case 4:Ai(e,e.stateNode.containerInfo);break;case 10:r=e.memoizedProps.value;var o=e.type._context;co(Go,o._currentValue),o._currentValue=r;break;case 13:if(null!==e.memoizedState)return 0!==(n&e.child.childLanes)?Ys(t,e,n):(co(Ri,1&Ri.current),null!==(e=na(t,e,n))?e.sibling:null);co(Ri,1&Ri.current);break;case 19:if(r=0!==(n&e.childLanes),0!==(64&t.flags)){if(r)return ea(t,e,n);e.flags|=64}if(null!==(o=e.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),co(Ri,Ri.current),r)break;return null;case 23:case 24:return e.lanes=0,Bs(t,e,n)}return na(t,e,n)}Ds=0!==(16384&t.flags)}else Ds=!1;switch(e.lanes=0,e.tag){case 2:if(r=e.type,null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,o=po(e,lo.current),ri(e,n),o=os(null,e,r,t,o,n),e.flags|=1,"object"===typeof o&&null!==o&&"function"===typeof o.render&&void 0===o.$$typeof){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,vo(r)){var i=!0;bo(e)}else i=!1;e.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,si(e);var a=r.getDerivedStateFromProps;"function"===typeof a&&di(e,r,a,t),o.updater=vi,e.stateNode=o,o._reactInternals=e,bi(e,r,t,n),e=Js(null,e,r,!0,i,n)}else e.tag=0,Rs(null,e,o,n),e=e.child;return e;case 16:o=e.elementType;t:{switch(null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,o=(i=o._init)(o._payload),e.type=o,i=e.tag=function(t){if("function"===typeof t)return qc(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===T)return 11;if(t===I)return 14}return 2}(o),t=Yo(o,t),i){case 0:e=$s(null,e,o,t,n);break t;case 1:e=qs(null,e,o,t,n);break t;case 11:e=Ps(null,e,o,t,n);break t;case 14:e=zs(null,e,o,Yo(o.type,t),r,n);break t}throw Error(s(306,o,""))}return e;case 0:return r=e.type,o=e.pendingProps,$s(t,e,r,o=e.elementType===r?o:Yo(r,o),n);case 1:return r=e.type,o=e.pendingProps,qs(t,e,r,o=e.elementType===r?o:Yo(r,o),n);case 3:if(Us(e),r=e.updateQueue,null===t||null===r)throw Error(s(282));if(r=e.pendingProps,o=null!==(o=e.memoizedState)?o.element:null,ai(t,e),fi(e,r,null,n),(r=e.memoizedState.element)===o)Vi(),e=na(t,e,n);else{if((i=(o=e.stateNode).hydrate)&&(Fi=Vr(e.stateNode.containerInfo.firstChild),zi=e,i=Bi=!0),i){if(null!=(t=o.mutableSourceEagerHydrationData))for(o=0;o<t.length;o+=2)(i=t[o])._workInProgressVersionPrimary=t[o+1],Wi.push(i);for(n=Ci(e,null,r,n),e.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Rs(t,e,r,n),Vi();e=e.child}return e;case 5:return ji(e),null===t&&qi(e),r=e.type,o=e.pendingProps,i=null!==t?t.memoizedProps:null,a=o.children,$r(r,o)?a=null:null!==i&&$r(r,i)&&(e.flags|=16),Ls(t,e),Rs(t,e,a,n),e.child;case 6:return null===t&&qi(e),null;case 13:return Ys(t,e,n);case 4:return Ai(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=Oi(e,null,r,n):Rs(t,e,r,n),e.child;case 11:return r=e.type,o=e.pendingProps,Ps(t,e,r,o=e.elementType===r?o:Yo(r,o),n);case 7:return Rs(t,e,e.pendingProps,n),e.child;case 8:case 12:return Rs(t,e,e.pendingProps.children,n),e.child;case 10:t:{r=e.type._context,o=e.pendingProps,a=e.memoizedProps,i=o.value;var c=e.type._context;if(co(Go,c._currentValue),c._currentValue=i,null!==a)if(c=a.value,0===(i=ar(c,i)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(c,i):1073741823))){if(a.children===o.children&&!fo.current){e=na(t,e,n);break t}}else for(null!==(c=e.child)&&(c.return=e);null!==c;){var u=c.dependencies;if(null!==u){a=c.child;for(var l=u.firstContext;null!==l;){if(l.context===r&&0!==(l.observedBits&i)){1===c.tag&&((l=ci(-1,n&-n)).tag=2,ui(c,l)),c.lanes|=n,null!==(l=c.alternate)&&(l.lanes|=n),ni(c.return,n),u.lanes|=n;break}l=l.next}}else a=10===c.tag&&c.type===e.type?null:c.child;if(null!==a)a.return=c;else for(a=c;null!==a;){if(a===e){a=null;break}if(null!==(c=a.sibling)){c.return=a.return,a=c;break}a=a.return}c=a}Rs(t,e,o.children,n),e=e.child}return e;case 9:return o=e.type,r=(i=e.pendingProps).children,ri(e,n),r=r(o=oi(o,i.unstable_observedBits)),e.flags|=1,Rs(t,e,r,n),e.child;case 14:return i=Yo(o=e.type,e.pendingProps),zs(t,e,o,i=Yo(o.type,i),r,n);case 15:return Fs(t,e,e.type,e.pendingProps,r,n);case 17:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:Yo(r,o),null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),e.tag=1,vo(r)?(t=!0,bo(e)):t=!1,ri(e,n),mi(e,r,o),bi(e,r,o,n),Js(null,e,r,!0,t,n);case 19:return ea(t,e,n);case 23:case 24:return Bs(t,e,n)}throw Error(s(156,e.tag))},eu.prototype.render=function(t){Qc(t,this._internalRoot,null,null)},eu.prototype.unmount=function(){var t=this._internalRoot,e=t.containerInfo;Qc(null,t,null,(function(){e[Qr]=null}))},ee=function(t){13===t.tag&&(fc(t,4,uc()),tu(t,4))},ne=function(t){13===t.tag&&(fc(t,67108864,uc()),tu(t,67108864))},re=function(t){if(13===t.tag){var e=uc(),n=lc(t);fc(t,n,e),tu(t,n)}},oe=function(t,e){return e()},_t=function(t,e,n){switch(e){case"input":if(nt(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var o=no(r);if(!o)throw Error(s(90));Q(r),nt(r,o)}}}break;case"textarea":ut(t,n);break;case"select":null!=(e=n.value)&&st(t,!!n.multiple,e,!1)}},jt=mc,Dt=function(t,e,n,r,o){var i=Ta;Ta|=4;try{return Uo(98,t.bind(null,e,n,r,o))}finally{0===(Ta=i)&&(Ua(),Wo())}},Rt=function(){0===(49&Ta)&&(function(){if(null!==ec){var t=ec;ec=null,t.forEach((function(t){t.expiredLanes|=24&t.pendingLanes,pc(t,$o())}))}Wo()}(),Ic())},Pt=function(t,e){var n=Ta;Ta|=2;try{return t(e)}finally{0===(Ta=n)&&(Ua(),Wo())}};var iu={Events:[to,eo,no,At,It,Ic,{current:!1}]},su={findFiberByHostInstance:Zr,bundleType:0,version:"17.0.1",rendererPackageName:"react-dom"},au={bundleType:su.bundleType,version:su.version,rendererPackageName:su.rendererPackageName,rendererConfig:su.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Zt(t))?null:t.stateNode},findFiberByHostInstance:su.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var cu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cu.isDisabled&&cu.supportsFiber)try{ko=cu.inject(au),xo=cu}catch(yt){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iu,e.createPortal=ou,e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(s(188));throw Error(s(268,Object.keys(t)))}return t=null===(t=Zt(e))?null:t.stateNode},e.flushSync=function(t,e){var n=Ta;if(0!==(48&n))return t(e);Ta|=1;try{if(t)return Uo(99,t.bind(null,e))}finally{Ta=n,Wo()}},e.hydrate=function(t,e,n){if(!nu(e))throw Error(s(200));return ru(null,t,e,!0,n)},e.render=function(t,e,n){if(!nu(e))throw Error(s(200));return ru(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!nu(t))throw Error(s(40));return!!t._reactRootContainer&&(gc((function(){ru(null,null,t,!1,(function(){t._reactRootContainer=null,t[Qr]=null}))})),!0)},e.unstable_batchedUpdates=mc,e.unstable_createPortal=function(t,e){return ou(t,e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},e.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!nu(n))throw Error(s(200));if(null==t||void 0===t._reactInternals)throw Error(s(38));return ru(t,e,n,!1,r)},e.version="17.0.1"},function(t,e,n){"use strict";t.exports=n(98)},function(t,e,n){"use strict";var r,o,i,s;if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;e.unstable_now=function(){return a.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var l=null,f=null,h=function t(){if(null!==l)try{var n=e.unstable_now();l(!0,n),l=null}catch(r){throw setTimeout(t,0),r}};r=function(t){null!==l?setTimeout(r,0,t):(l=t,setTimeout(h,0))},o=function(t,e){f=setTimeout(t,e)},i=function(){clearTimeout(f)},e.unstable_shouldYield=function(){return!1},s=e.unstable_forceFrameRate=function(){}}else{var p=window.setTimeout,d=window.clearTimeout;if("undefined"!==typeof console){var v=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof v&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var y=!1,m=null,g=-1,b=5,w=0;e.unstable_shouldYield=function(){return e.unstable_now()>=w},s=function(){},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<t?Math.floor(1e3/t):5};var k=new MessageChannel,x=k.port2;k.port1.onmessage=function(){if(null!==m){var t=e.unstable_now();w=t+b;try{m(!0,t)?x.postMessage(null):(y=!1,m=null)}catch(n){throw x.postMessage(null),n}}else y=!1},r=function(t){m=t,y||(y=!0,x.postMessage(null))},o=function(t,n){g=p((function(){t(e.unstable_now())}),n)},i=function(){d(g),g=-1}}function S(t,e){var n=t.length;t.push(e);t:for(;;){var r=n-1>>>1,o=t[r];if(!(void 0!==o&&0<E(o,e)))break t;t[r]=e,t[n]=o,n=r}}function O(t){return void 0===(t=t[0])?null:t}function C(t){var e=t[0];if(void 0!==e){var n=t.pop();if(n!==e){t[0]=n;t:for(var r=0,o=t.length;r<o;){var i=2*(r+1)-1,s=t[i],a=i+1,c=t[a];if(void 0!==s&&0>E(s,n))void 0!==c&&0>E(c,s)?(t[r]=c,t[a]=n,r=a):(t[r]=s,t[i]=n,r=i);else{if(!(void 0!==c&&0>E(c,n)))break t;t[r]=c,t[a]=n,r=a}}}return e}return null}function E(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}var _=[],M=[],T=1,N=null,A=3,I=!1,j=!1,D=!1;function R(t){for(var e=O(M);null!==e;){if(null===e.callback)C(M);else{if(!(e.startTime<=t))break;C(M),e.sortIndex=e.expirationTime,S(_,e)}e=O(M)}}function P(t){if(D=!1,R(t),!j)if(null!==O(_))j=!0,r(z);else{var e=O(M);null!==e&&o(P,e.startTime-t)}}function z(t,n){j=!1,D&&(D=!1,i()),I=!0;var r=A;try{for(R(n),N=O(_);null!==N&&(!(N.expirationTime>n)||t&&!e.unstable_shouldYield());){var s=N.callback;if("function"===typeof s){N.callback=null,A=N.priorityLevel;var a=s(N.expirationTime<=n);n=e.unstable_now(),"function"===typeof a?N.callback=a:N===O(_)&&C(_),R(n)}else C(_);N=O(_)}if(null!==N)var c=!0;else{var u=O(M);null!==u&&o(P,u.startTime-n),c=!1}return c}finally{N=null,A=r,I=!1}}var F=s;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){j||I||(j=!0,r(z))},e.unstable_getCurrentPriorityLevel=function(){return A},e.unstable_getFirstCallbackNode=function(){return O(_)},e.unstable_next=function(t){switch(A){case 1:case 2:case 3:var e=3;break;default:e=A}var n=A;A=e;try{return t()}finally{A=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=F,e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=A;A=t;try{return e()}finally{A=n}},e.unstable_scheduleCallback=function(t,n,s){var a=e.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,t){case 1:var c=-1;break;case 2:c=250;break;case 5:c=1073741823;break;case 4:c=1e4;break;default:c=5e3}return t={id:T++,callback:n,priorityLevel:t,startTime:s,expirationTime:c=s+c,sortIndex:-1},s>a?(t.sortIndex=s,S(M,t),null===O(_)&&t===O(M)&&(D?i():D=!0,o(P,s-a))):(t.sortIndex=c,S(_,t),j||I||(j=!0,r(z))),t},e.unstable_wrapCallback=function(t){var e=A;return function(){var n=A;A=e;try{return t.apply(this,arguments)}finally{A=n}}}},,,function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e,n){var r=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,o="function"===typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",a=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(A){c=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,i=Object.create(o.prototype),s=new M(r||[]);return i._invoke=function(t,e,n){var r=f;return function(o,i){if(r===p)throw new Error("Generator is already running");if(r===d){if("throw"===o)throw i;return N()}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var a=C(s,n);if(a){if(a===v)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var c=l(t,e,n);if("normal"===c.type){if(r=n.done?d:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=d,n.method="throw",n.arg=c.arg)}}}(t,n,s),i}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(A){return{type:"throw",arg:A}}}t.wrap=u;var f="suspendedStart",h="suspendedYield",p="executing",d="completed",v={};function y(){}function m(){}function g(){}var b={};b[i]=function(){return this};var w=Object.getPrototypeOf,k=w&&w(w(T([])));k&&k!==n&&r.call(k,i)&&(b=k);var x=g.prototype=y.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function n(o,i,s,a){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,f=u.value;return f&&"object"===typeof f&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(f).then((function(t){u.value=t,s(u)}),(function(t){return n("throw",t,s,a)}))}a(c.arg)}var o;this._invoke=function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}}function C(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,C(t,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=l(r,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function M(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function T(t){if(t){var n=t[i];if(n)return n.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var o=-1,s=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}return{next:N}}function N(){return{value:e,done:!0}}return m.prototype=x.constructor=g,g.constructor=m,m.displayName=c(g,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,a,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},S(O.prototype),O.prototype[s]=function(){return this},t.AsyncIterator=O,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var s=new O(u(e,n,r,o),i);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(x),c(x,a,"Generator"),x[i]=function(){return this},x.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=T,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(_),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return a.type="throw",a.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],a=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),u=r.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=t,s.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;_(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:T(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}(t.exports);try{regeneratorRuntime=r}catch(o){Function("r","regeneratorRuntime = r")(r)}},function(t,e,n){"use strict";(function(t){var r=n(104),o=n(105),i=n(106);function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=c.prototype:(null===t&&(t=new c(e)),t.length=e),t}function c(t,e,n){if(!c.TYPED_ARRAY_SUPPORT&&!(this instanceof c))return new c(t,e,n);if("number"===typeof t){if("string"===typeof e)throw new Error("If encoding is specified then the first argument must be a string");return f(this,t)}return u(this,t,e,n)}function u(t,e,n,r){if("number"===typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);c.TYPED_ARRAY_SUPPORT?(t=e).__proto__=c.prototype:t=h(t,e);return t}(t,e,n,r):"string"===typeof e?function(t,e,n){"string"===typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(e,n),o=(t=a(t,r)).write(e,n);o!==r&&(t=t.slice(0,o));return t}(t,e,n):function(t,e){if(c.isBuffer(e)){var n=0|p(e.length);return 0===(t=a(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!==typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!==typeof e.length||(r=e.length)!==r?a(t,0):h(t,e);if("Buffer"===e.type&&i(e.data))return h(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!==typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function f(t,e){if(l(e),t=a(t,e<0?0:0|p(e)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function h(t,e){var n=e.length<0?0:0|p(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function p(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function d(t,e){if(c.isBuffer(t))return t.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!==typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return $(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return q(t).length;default:if(r)return $(t).length;e=(""+e).toLowerCase(),r=!0}}function v(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return N(this,e,n);case"utf8":case"utf-8":return E(this,e,n);case"ascii":return M(this,e,n);case"latin1":case"binary":return T(this,e,n);case"base64":return C(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function y(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,o){if(0===t.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"===typeof e&&(e=c.from(e,r)),c.isBuffer(e))return 0===e.length?-1:g(t,e,n,r,o);if("number"===typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):g(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function g(t,e,n,r,o){var i,s=1,a=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){var l=-1;for(i=n;i<a;i++)if(u(t,i)===u(e,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===c)return l*s}else-1!==l&&(i-=i-l),l=-1}else for(n+c>a&&(n=a-c),i=n;i>=0;i--){for(var f=!0,h=0;h<c;h++)if(u(t,i+h)!==u(e,h)){f=!1;break}if(f)return i}return-1}function b(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=e.length;if(i%2!==0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function w(t,e,n,r){return J($(e,t.length-n),t,n,r)}function k(t,e,n,r){return J(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function x(t,e,n,r){return k(t,e,n,r)}function S(t,e,n,r){return J(q(e),t,n,r)}function O(t,e,n,r){return J(function(t,e){for(var n,r,o,i=[],s=0;s<t.length&&!((e-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,o=n%256,i.push(o),i.push(r);return i}(e,t.length-n),t,n,r)}function C(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function E(t,e,n){n=Math.min(t.length,n);for(var r=[],o=e;o<n;){var i,s,a,c,u=t[o],l=null,f=u>239?4:u>223?3:u>191?2:1;if(o+f<=n)switch(f){case 1:u<128&&(l=u);break;case 2:128===(192&(i=t[o+1]))&&(c=(31&u)<<6|63&i)>127&&(l=c);break;case 3:i=t[o+1],s=t[o+2],128===(192&i)&&128===(192&s)&&(c=(15&u)<<12|(63&i)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:i=t[o+1],s=t[o+2],a=t[o+3],128===(192&i)&&128===(192&s)&&128===(192&a)&&(c=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,f=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),o+=f}return function(t){var e=t.length;if(e<=_)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=_));return n}(r)}e.Buffer=c,e.SlowBuffer=function(t){+t!=t&&(t=0);return c.alloc(+t)},e.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"===typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(e){return!1}}(),e.kMaxLength=s(),c.poolSize=8192,c._augment=function(t){return t.__proto__=c.prototype,t},c.from=function(t,e,n){return u(null,t,e,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(t,e,n){return function(t,e,n,r){return l(e),e<=0?a(t,e):void 0!==n?"string"===typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}(null,t,e,n)},c.allocUnsafe=function(t){return f(null,t)},c.allocUnsafeSlow=function(t){return f(null,t)},c.isBuffer=function(t){return!(null==t||!t._isBuffer)},c.compare=function(t,e){if(!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!i(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=c.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var s=t[n];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,o),o+=s.length}return r},c.byteLength=d,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},c.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?E(this,0,t):v.apply(this,arguments)},c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},c.prototype.compare=function(t,e,n,r,o){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(this===t)return 0;for(var i=(o>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(i,s),u=this.slice(r,o),l=t.slice(e,n),f=0;f<a;++f)if(u[f]!==l[f]){i=u[f],s=l[f];break}return i<s?-1:s<i?1:0},c.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},c.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},c.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},c.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"===typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return b(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":return k(this,t,e,n);case"latin1":case"binary":return x(this,t,e,n);case"base64":return S(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var _=4096;function M(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function T(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function N(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=L(t[i]);return o}function A(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function I(t,e,n){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function j(t,e,n,r,o,i){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function D(t,e,n,r){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-n,2);o<i;++o)t[n+o]=(e&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function R(t,e,n,r){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-n,4);o<i;++o)t[n+o]=e>>>8*(r?o:3-o)&255}function P(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function z(t,e,n,r,i){return i||P(t,0,n,4),o.write(t,e,n,r,23,4),n+4}function F(t,e,n,r,i){return i||P(t,0,n,8),o.write(t,e,n,r,52,8),n+8}c.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=c.prototype;else{var o=e-t;n=new c(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+t]}return n},c.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},c.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},c.prototype.readUInt8=function(t,e){return e||I(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return e||I(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return e||I(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return e||I(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return e||I(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*e)),r},c.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=e,o=1,i=this[t+--r];r>0&&(o*=256);)i+=this[t+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},c.prototype.readInt8=function(t,e){return e||I(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){e||I(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(t,e){e||I(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(t,e){return e||I(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return e||I(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return e||I(t,4,this.length),o.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return e||I(t,4,this.length),o.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return e||I(t,8,this.length),o.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return e||I(t,8,this.length),o.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||j(this,t,e,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},c.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||j(this,t,e,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},c.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):R(this,t,e,!0),e+4},c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):R(this,t,e,!1),e+4},c.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);j(this,t,e,n,o-1,-o)}var i=0,s=1,a=0;for(this[e]=255&t;++i<n&&(s*=256);)t<0&&0===a&&0!==this[e+i-1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},c.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);j(this,t,e,n,o-1,-o)}var i=n-1,s=1,a=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===a&&0!==this[e+i+1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},c.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},c.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},c.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):R(this,t,e,!0),e+4},c.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):R(this,t,e,!1),e+4},c.prototype.writeFloatLE=function(t,e,n){return z(this,t,e,!0,n)},c.prototype.writeFloatBE=function(t,e,n){return z(this,t,e,!1,n)},c.prototype.writeDoubleLE=function(t,e,n){return F(this,t,e,!0,n)},c.prototype.writeDoubleBE=function(t,e,n){return F(this,t,e,!1,n)},c.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o,i=r-n;if(this===t&&n<e&&e<r)for(o=i-1;o>=0;--o)t[o+e]=this[o+n];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+i),e);return i},c.prototype.fill=function(t,e,n,r){if("string"===typeof t){if("string"===typeof e?(r=e,e=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"===typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"===typeof t)for(i=e;i<n;++i)this[i]=t;else{var s=c.isBuffer(t)?t:$(new c(t,r).toString()),a=s.length;for(i=0;i<n-e;++i)this[i+e]=s[i%a]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function L(t){return t<16?"0"+t.toString(16):t.toString(16)}function $(t,e){var n;e=e||1/0;for(var r=t.length,o=null,i=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function q(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(B,"")).length<2)return"";for(;t.length%4!==0;)t+="=";return t}(t))}function J(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}}).call(this,n(39))},function(t,e,n){"use strict";e.byteLength=function(t){var e=u(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,r=u(t),s=r[0],a=r[1],c=new i(function(t,e,n){return 3*(e+n)/4-n}(0,s,a)),l=0,f=a>0?s-4:s;for(n=0;n<f;n+=4)e=o[t.charCodeAt(n)]<<18|o[t.charCodeAt(n+1)]<<12|o[t.charCodeAt(n+2)]<<6|o[t.charCodeAt(n+3)],c[l++]=e>>16&255,c[l++]=e>>8&255,c[l++]=255&e;2===a&&(e=o[t.charCodeAt(n)]<<2|o[t.charCodeAt(n+1)]>>4,c[l++]=255&e);1===a&&(e=o[t.charCodeAt(n)]<<10|o[t.charCodeAt(n+1)]<<4|o[t.charCodeAt(n+2)]>>2,c[l++]=e>>8&255,c[l++]=255&e);return c},e.fromByteArray=function(t){for(var e,n=t.length,o=n%3,i=[],s=16383,a=0,c=n-o;a<c;a+=s)i.push(l(t,a,a+s>c?c:a+s));1===o?(e=t[n-1],i.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],i.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return i.join("")};for(var r=[],o=[],i="undefined"!==typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)r[a]=s[a],o[s.charCodeAt(a)]=a;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,n){for(var o,i,s=[],a=e;a<n;a+=3)o=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,o){var i,s,a=8*o-r-1,c=(1<<a)-1,u=c>>1,l=-7,f=n?o-1:0,h=n?-1:1,p=t[e+f];for(f+=h,i=p&(1<<-l)-1,p>>=-l,l+=a;l>0;i=256*i+t[e+f],f+=h,l-=8);for(s=i&(1<<-l)-1,i>>=-l,l+=r;l>0;s=256*s+t[e+f],f+=h,l-=8);if(0===i)i=1-u;else{if(i===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),i-=u}return(p?-1:1)*s*Math.pow(2,i-r)},e.write=function(t,e,n,r,o,i){var s,a,c,u=8*i-o-1,l=(1<<u)-1,f=l>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,d=r?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+f>=1?h/c:h*Math.pow(2,1-f))*c>=2&&(s++,c/=2),s+f>=l?(a=0,s=l):s+f>=1?(a=(e*c-1)*Math.pow(2,o),s+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,o),s=0));o>=8;t[n+p]=255&a,p+=d,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;t[n+p]=255&s,p+=d,s/=256,u-=8);t[n+p-d]|=128*v}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(t,e){function n(e){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?t.exports=n=function(t){return typeof t}:t.exports=n=function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(e)}t.exports=n},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e,n){var r=n(112);t.exports=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,r)}t.exports=n},function(t,e,n){var r=n(114),o=n(115),i=n(80);t.exports=function(t){var e=o();return function(){var n,o=r(t);if(e){var s=r(this).constructor;n=Reflect.construct(o,arguments,s)}else n=o.apply(this,arguments);return i(this,n)}}},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e){t.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}},function(t,e,n){var r=n(117),o=n(118),i=n(119),s=n(120);t.exports=function(t){return r(t)||o(t)||i(t)||s()}},function(t,e,n){var r=n(81);t.exports=function(t){if(Array.isArray(t))return r(t)}},function(t,e){t.exports=function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}},function(t,e,n){var r=n(81);t.exports=function(t,e){if(t){if("string"===typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},,,function(t,e,n){"use strict";(function(t){e.test=function(){return"function"===typeof t.queueMicrotask},e.install=function(e){return function(){t.queueMicrotask(e)}}}).call(this,n(39))},function(t,e,n){"use strict";(function(t){var n=t.MutationObserver||t.WebKitMutationObserver;e.test=function(){return n},e.install=function(e){var r=0,o=new n(e),i=t.document.createTextNode("");return o.observe(i,{characterData:!0}),function(){i.data=r=++r%2}}}).call(this,n(39))},function(t,e,n){"use strict";(function(t){e.test=function(){return!t.setImmediate&&"undefined"!==typeof t.MessageChannel},e.install=function(e){var n=new t.MessageChannel;return n.port1.onmessage=e,function(){n.port2.postMessage(0)}}}).call(this,n(39))},function(t,e,n){"use strict";(function(t){e.test=function(){return"document"in t&&"onreadystatechange"in t.document.createElement("script")},e.install=function(e){return function(){var n=t.document.createElement("script");return n.onreadystatechange=function(){e(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},t.document.documentElement.appendChild(n),e}}}).call(this,n(39))},function(t,e,n){"use strict";e.test=function(){return!0},e.install=function(t){return function(){setTimeout(t,0)}}},function(t,e,n){"use strict";n.r(e);var r=n(85),o="function"===typeof Promise?Promise:n.n(r).a;e.default=o},function(t,e,n){"use strict";(function(e){var n,r,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var i=0,s=new o(l),a=e.document.createTextNode("");s.observe(a,{characterData:!0}),n=function(){a.data=i=++i%2}}else if(e.setImmediate||"undefined"===typeof e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){l(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(l,0)};else{var c=new e.MessageChannel;c.port1.onmessage=l,n=function(){c.port2.postMessage(0)}}var u=[];function l(){var t,e;r=!0;for(var n=u.length;n;){for(e=u,u=[],t=-1;++t<n;)e[t]();n=u.length}r=!1}t.exports=function(t){1!==u.push(t)||r||n()}}).call(this,n(39))},function(t,e,n){t.exports=n(131)()},function(t,e,n){"use strict";var r=n(132);function o(){}function i(){}i.resetWarningCache=o,t.exports=function(){function t(t,e,n,o,i,s){if(s!==r){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:i,resetWarningCache:o};return n.PropTypes=n,n}},function(t,e,n){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(t,e,n){"use strict";var r="function"===typeof Symbol&&Symbol.for,o=r?Symbol.for("react.element"):60103,i=r?Symbol.for("react.portal"):60106,s=r?Symbol.for("react.fragment"):60107,a=r?Symbol.for("react.strict_mode"):60108,c=r?Symbol.for("react.profiler"):60114,u=r?Symbol.for("react.provider"):60109,l=r?Symbol.for("react.context"):60110,f=r?Symbol.for("react.async_mode"):60111,h=r?Symbol.for("react.concurrent_mode"):60111,p=r?Symbol.for("react.forward_ref"):60112,d=r?Symbol.for("react.suspense"):60113,v=r?Symbol.for("react.suspense_list"):60120,y=r?Symbol.for("react.memo"):60115,m=r?Symbol.for("react.lazy"):60116,g=r?Symbol.for("react.block"):60121,b=r?Symbol.for("react.fundamental"):60117,w=r?Symbol.for("react.responder"):60118,k=r?Symbol.for("react.scope"):60119;function x(t){if("object"===typeof t&&null!==t){var e=t.$$typeof;switch(e){case o:switch(t=t.type){case f:case h:case s:case c:case a:case d:return t;default:switch(t=t&&t.$$typeof){case l:case p:case m:case y:case u:return t;default:return e}}case i:return e}}}function S(t){return x(t)===h}e.AsyncMode=f,e.ConcurrentMode=h,e.ContextConsumer=l,e.ContextProvider=u,e.Element=o,e.ForwardRef=p,e.Fragment=s,e.Lazy=m,e.Memo=y,e.Portal=i,e.Profiler=c,e.StrictMode=a,e.Suspense=d,e.isAsyncMode=function(t){return S(t)||x(t)===f},e.isConcurrentMode=S,e.isContextConsumer=function(t){return x(t)===l},e.isContextProvider=function(t){return x(t)===u},e.isElement=function(t){return"object"===typeof t&&null!==t&&t.$$typeof===o},e.isForwardRef=function(t){return x(t)===p},e.isFragment=function(t){return x(t)===s},e.isLazy=function(t){return x(t)===m},e.isMemo=function(t){return x(t)===y},e.isPortal=function(t){return x(t)===i},e.isProfiler=function(t){return x(t)===c},e.isStrictMode=function(t){return x(t)===a},e.isSuspense=function(t){return x(t)===d},e.isValidElementType=function(t){return"string"===typeof t||"function"===typeof t||t===s||t===h||t===c||t===a||t===d||t===v||"object"===typeof t&&null!==t&&(t.$$typeof===m||t.$$typeof===y||t.$$typeof===u||t.$$typeof===l||t.$$typeof===p||t.$$typeof===b||t.$$typeof===w||t.$$typeof===k||t.$$typeof===g)},e.typeOf=x},,,,,,,function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(6),o=n(49),i=n(32),s=(n(42),n(36)),a=n(16),c=n(9),u=function(t){var e=document.createElement("span");e.classList.add("ProseMirror-yjs-cursor"),e.setAttribute("style","border-color: ".concat(t.color));var n=document.createElement("div");return n.setAttribute("style","background-color: ".concat(t.color)),n.insertBefore(document.createTextNode(t.name),null),e.insertBefore(n,null),e},l=function(t,e,n){var i=a.b.getState(t),u=i.doc,l=[];return null!=i.snapshot||null!=i.prevSnapshot||null===i.binding?o.b.create(t.doc,[]):(e.getStates().forEach((function(e,a){if(a!==u.clientID&&null!=e.cursor){var f=e.user||{};null==f.color&&(f.color="#ffa500"),null==f.name&&(f.name="User: ".concat(a));var h=Object(s.b)(u,i.type,r.r(e.cursor.anchor),i.binding.mapping),p=Object(s.b)(u,i.type,r.r(e.cursor.head),i.binding.mapping);if(null!==h&&null!==p){var d=c.f(t.doc.content.size-1,0);h=c.g(h,d),p=c.g(p,d),l.push(o.a.widget(p,(function(){return n(f)}),{key:a+"",side:10}));var v=c.g(h,p),y=c.f(h,p);l.push(o.a.inline(v,y,{style:"background-color: ".concat(f.color,"70")},{inclusiveEnd:!0,inclusiveStart:!1}))}}})),o.b.create(t.doc,l))},f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.cursorBuilder,o=void 0===n?u:n,c=e.getSelection,f=void 0===c?function(t){return t.selection}:c,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"cursor";return new i.b({key:a.a,state:{init:function(e,n){return l(n,t,o)},apply:function(e,n,r,i){var s=a.b.getState(i),c=e.getMeta(a.a);return s&&s.isChangeOrigin||c&&c.awarenessUpdated?l(i,t,o):n.map(e.mapping,e.doc)}},props:{decorations:function(t){return a.a.getState(t)}},view:function(e){var n=function(){e.docView&&Object(s.c)(e,a.a,{awarenessUpdated:!0})},o=function(){var n=a.b.getState(e.state),o=t.getLocalState()||{};if(e.hasFocus()&&null!==n.binding){var i=f(e.state),c=Object(s.a)(i.anchor,n.type,n.binding.mapping),u=Object(s.a)(i.head,n.type,n.binding.mapping);null!=o.cursor&&r.n(r.r(o.cursor.anchor),c)&&r.n(r.r(o.cursor.head),u)||t.setLocalStateField(h,{anchor:c,head:u})}else null!=o.cursor&&null!==Object(s.b)(n.doc,n.type,r.r(o.cursor.anchor),n.binding.mapping)&&t.setLocalStateField(h,null)};return t.on("change",n),e.dom.addEventListener("focusin",o),e.dom.addEventListener("focusout",o),{update:o,destroy:function(){e.dom.removeEventListener("focusin",o),e.dom.removeEventListener("focusout",o),t.off("change",n),t.setLocalStateField(h,null)}}}})}},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return u}));var r=n(32),o=n(67),i=n(6),s=n(16),a=function(t){var e=s.c.getState(t).undoManager;if(null!=e)return e.undo(),!0},c=function(t){var e=s.c.getState(t).undoManager;if(null!=e)return e.redo(),!0},u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.protectedNodes,n=void 0===e?new Set(["paragraph"]):e,a=t.trackedOrigins,c=void 0===a?[]:a;return new r.b({key:s.c,state:{init:function(t,e){var r=s.b.getState(e),o=new i.i(r.type,{trackedOrigins:new Set([s.b].concat(c)),deleteFilter:function(t){return!(t instanceof i.e)||!(t.content instanceof i.c)||!(t.content.type instanceof i.h||t.content.type instanceof i.j&&n.has(t.content.type.nodeName))||0===t.content.type._length}});return{undoManager:o,prevSel:null,hasUndoOps:o.undoStack.length>0,hasRedoOps:o.redoStack.length>0}},apply:function(t,e,n,r){var i=s.b.getState(r).binding,a=e.undoManager,c=a.undoStack.length>0,u=a.redoStack.length>0;return i?{undoManager:a,prevSel:Object(o.a)(i,n),hasUndoOps:c,hasRedoOps:u}:c!==e.hasUndoOps||u!==e.hasRedoOps?Object.assign({},e,{hasUndoOps:a.undoStack.length>0,hasRedoOps:a.redoStack.length>0}):e}},view:function(t){var e=s.b.getState(t.state),n=s.c.getState(t.state).undoManager;return n.on("stack-item-added",(function(n){var r=n.stackItem,o=e.binding;o&&r.meta.set(o,s.c.getState(t.state).prevSel)})),n.on("stack-item-popped",(function(t){var n=t.stackItem,r=e.binding;r&&(r.beforeTransactionSelection=n.meta.get(r)||r.beforeTransactionSelection)})),{destroy:function(){n.destroy()}}}})}},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return u}));var r=n(1),o=n(60);function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}var c=0,u=Object(r.memo)((function(t){var e=t.children,n=i(function(t){if("manager"in t){return[{dragDropManager:t.manager},!1]}var e=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f(),n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=e;i[l]||(i[l]=Object(o.b)(t,e,n,r));return i[l]}(t.backend,t.context,t.options,t.debugMode),n=!t.context;return[e,n]}(a(t,["children"])),2),s=n[0],u=n[1];return r.useEffect((function(){return u&&c++,function(){u&&(0===--c&&(f()[l]=null))}}),[]),r.createElement(o.a.Provider,{value:s},e)}));u.displayName="DndProvider";var l=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");function f(){return"undefined"!==typeof t?t:window}}).call(this,n(39))},function(t,e,n){"use strict";var r,o=new Uint8Array(16);function i(){if(!r&&!(r="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(o)}var s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var a=function(t){return"string"===typeof t&&s.test(t)},c=[],u=0;u<256;++u)c.push((u+256).toString(16).substr(1));var l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(c[t[e+0]]+c[t[e+1]]+c[t[e+2]]+c[t[e+3]]+"-"+c[t[e+4]]+c[t[e+5]]+"-"+c[t[e+6]]+c[t[e+7]]+"-"+c[t[e+8]]+c[t[e+9]]+"-"+c[t[e+10]]+c[t[e+11]]+c[t[e+12]]+c[t[e+13]]+c[t[e+14]]+c[t[e+15]]).toLowerCase();if(!a(n))throw TypeError("Stringified UUID is invalid");return n};e.a=function(t,e,n){var r=(t=t||{}).random||(t.rng||i)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var o=0;o<16;++o)e[n+o]=r[o];return e}return l(r)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return S}));var r=n(1),o=n(8),i=n(65),s=n(34),a=n(62),c=n(57);function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=!1,f=!1,h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sourceId=null,this.internalMonitor=e.getMonitor()}var e,n,r;return e=t,(n=[{key:"receiveHandlerId",value:function(t){this.sourceId=t}},{key:"getHandlerId",value:function(){return this.sourceId}},{key:"canDrag",value:function(){Object(o.a)(!l,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return l=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{l=!1}}},{key:"isDragging",value:function(){if(!this.sourceId)return!1;Object(o.a)(!f,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return f=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{f=!1}}},{key:"subscribeToStateChange",value:function(t,e){return this.internalMonitor.subscribeToStateChange(t,e)}},{key:"isDraggingSource",value:function(t){return this.internalMonitor.isDraggingSource(t)}},{key:"isOverTarget",value:function(t,e){return this.internalMonitor.isOverTarget(t,e)}},{key:"getTargetIds",value:function(){return this.internalMonitor.getTargetIds()}},{key:"isSourcePublic",value:function(){return this.internalMonitor.isSourcePublic()}},{key:"getSourceId",value:function(){return this.internalMonitor.getSourceId()}},{key:"subscribeToOffsetChange",value:function(t){return this.internalMonitor.subscribeToOffsetChange(t)}},{key:"canDragSource",value:function(t){return this.internalMonitor.canDragSource(t)}},{key:"canDropOnTarget",value:function(t){return this.internalMonitor.canDropOnTarget(t)}},{key:"getItemType",value:function(){return this.internalMonitor.getItemType()}},{key:"getItem",value:function(){return this.internalMonitor.getItem()}},{key:"getDropResult",value:function(){return this.internalMonitor.getDropResult()}},{key:"didDrop",value:function(){return this.internalMonitor.didDrop()}},{key:"getInitialClientOffset",value:function(){return this.internalMonitor.getInitialClientOffset()}},{key:"getInitialSourceClientOffset",value:function(){return this.internalMonitor.getInitialSourceClientOffset()}},{key:"getSourceClientOffset",value:function(){return this.internalMonitor.getSourceClientOffset()}},{key:"getClientOffset",value:function(){return this.internalMonitor.getClientOffset()}},{key:"getDifferenceFromInitialOffset",value:function(){return this.internalMonitor.getDifferenceFromInitialOffset()}}])&&u(e.prototype,n),r&&u(e,r),t}(),p=n(66),d=n(59),v=n(52);function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var m=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hooks=Object(p.a)({dragSource:function(t,e){n.clearDragSource(),n.dragSourceOptions=e||null,Object(d.a)(t)?n.dragSourceRef=t:n.dragSourceNode=t,n.reconnectDragSource()},dragPreview:function(t,e){n.clearDragPreview(),n.dragPreviewOptions=e||null,Object(d.a)(t)?n.dragPreviewRef=t:n.dragPreviewNode=t,n.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}var e,n,r;return e=t,(n=[{key:"receiveHandlerId",value:function(t){this.handlerId!==t&&(this.handlerId=t,this.reconnect())}},{key:"reconnect",value:function(){this.reconnectDragSource(),this.reconnectDragPreview()}},{key:"reconnectDragSource",value:function(){var t=this.dragSource,e=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();e&&this.disconnectDragSource(),this.handlerId&&(t?e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=t,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,t,this.dragSourceOptions)):this.lastConnectedDragSource=t)}},{key:"reconnectDragPreview",value:function(){var t=this.dragPreview,e=this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();e&&this.disconnectDragPreview(),this.handlerId&&(t?e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=t,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,t,this.dragPreviewOptions)):this.lastConnectedDragPreview=t)}},{key:"didHandlerIdChange",value:function(){return this.lastConnectedHandlerId!==this.handlerId}},{key:"didConnectedDragSourceChange",value:function(){return this.lastConnectedDragSource!==this.dragSource}},{key:"didConnectedDragPreviewChange",value:function(){return this.lastConnectedDragPreview!==this.dragPreview}},{key:"didDragSourceOptionsChange",value:function(){return!Object(v.a)(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}},{key:"didDragPreviewOptionsChange",value:function(){return!Object(v.a)(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}},{key:"disconnectDragSource",value:function(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}},{key:"disconnectDragPreview",value:function(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}},{key:"clearDragSource",value:function(){this.dragSourceNode=null,this.dragSourceRef=null}},{key:"clearDragPreview",value:function(){this.dragPreviewNode=null,this.dragPreviewRef=null}},{key:"connectTarget",get:function(){return this.dragSource}},{key:"dragSourceOptions",get:function(){return this.dragSourceOptionsInternal},set:function(t){this.dragSourceOptionsInternal=t}},{key:"dragPreviewOptions",get:function(){return this.dragPreviewOptionsInternal},set:function(t){this.dragPreviewOptionsInternal=t}},{key:"dragSource",get:function(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}},{key:"dragPreview",get:function(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}}])&&y(e.prototype,n),r&&y(e,r),t}();function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return b(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function w(t){return(w="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function k(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return x(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function S(t){var e=Object(r.useRef)(t);e.current=t,Object(o.a)(null!=t.item,"item must be defined"),Object(o.a)(null!=t.item.type,"item type must be defined");var n=k(function(){var t=Object(c.a)();return[Object(r.useMemo)((function(){return new h(t)}),[t]),Object(r.useMemo)((function(){return new m(t.getBackend())}),[t])]}(),2),u=n[0],l=n[1];!function(t,e,n){var i=Object(c.a)(),u=Object(r.useMemo)((function(){return{beginDrag:function(){var n=t.current,r=n.begin,i=n.item;if(r){var s=r(e);return Object(o.a)(null==s||"object"===w(s),"dragSpec.begin() must either return an object, undefined, or null"),s||i||{}}return i||{}},canDrag:function(){return"boolean"===typeof t.current.canDrag?t.current.canDrag:"function"!==typeof t.current.canDrag||t.current.canDrag(e)},isDragging:function(n,r){var o=t.current.isDragging;return o?o(e):r===n.getSourceId()},endDrag:function(){var r=t.current.end;r&&r(e.getItem(),e),n.reconnect()}}}),[]);Object(s.a)((function(){var r=g(Object(a.a)(t.current.item.type,u,i),2),o=r[0],s=r[1];return e.receiveHandlerId(o),n.receiveHandlerId(o),s}),[])}(e,u,l);var f=Object(i.a)(u,e.current.collect||function(){return{}},(function(){return l.reconnect()})),p=Object(r.useMemo)((function(){return l.hooks.dragSource()}),[l]),d=Object(r.useMemo)((function(){return l.hooks.dragPreview()}),[l]);return Object(s.a)((function(){l.dragSourceOptions=e.current.options||null,l.reconnect()}),[l]),Object(s.a)((function(){l.dragPreviewOptions=e.current.previewOptions||null,l.reconnect()}),[l]),[f,p,d]}},function(t,e,n){"use strict";n.d(e,"a",(function(){return k}));var r=n(1),o=n(8),i=n(65),s=n(34),a=n(62),c=n(57),u=n(52),l=n(66),f=n(59);function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var p=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hooks=Object(l.a)({dropTarget:function(t,e){n.clearDropTarget(),n.dropTargetOptions=e,Object(f.a)(t)?n.dropTargetRef=t:n.dropTargetNode=t,n.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}var e,n,r;return e=t,(n=[{key:"reconnect",value:function(){var t=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();t&&this.disconnectDropTarget();var e=this.dropTarget;this.handlerId&&(e?t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=e,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,e,this.dropTargetOptions)):this.lastConnectedDropTarget=e)}},{key:"receiveHandlerId",value:function(t){t!==this.handlerId&&(this.handlerId=t,this.reconnect())}},{key:"didHandlerIdChange",value:function(){return this.lastConnectedHandlerId!==this.handlerId}},{key:"didDropTargetChange",value:function(){return this.lastConnectedDropTarget!==this.dropTarget}},{key:"didOptionsChange",value:function(){return!Object(u.a)(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}},{key:"disconnectDropTarget",value:function(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}},{key:"clearDropTarget",value:function(){this.dropTargetRef=null,this.dropTargetNode=null}},{key:"connectTarget",get:function(){return this.dropTarget}},{key:"dropTargetOptions",get:function(){return this.dropTargetOptionsInternal},set:function(t){this.dropTargetOptionsInternal=t}},{key:"dropTarget",get:function(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}}])&&h(e.prototype,n),r&&h(e,r),t}();function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var v=!1,y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.targetId=null,this.internalMonitor=e.getMonitor()}var e,n,r;return e=t,(n=[{key:"receiveHandlerId",value:function(t){this.targetId=t}},{key:"getHandlerId",value:function(){return this.targetId}},{key:"subscribeToStateChange",value:function(t,e){return this.internalMonitor.subscribeToStateChange(t,e)}},{key:"canDrop",value:function(){if(!this.targetId)return!1;Object(o.a)(!v,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return v=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{v=!1}}},{key:"isOver",value:function(t){return!!this.targetId&&this.internalMonitor.isOverTarget(this.targetId,t)}},{key:"getItemType",value:function(){return this.internalMonitor.getItemType()}},{key:"getItem",value:function(){return this.internalMonitor.getItem()}},{key:"getDropResult",value:function(){return this.internalMonitor.getDropResult()}},{key:"didDrop",value:function(){return this.internalMonitor.didDrop()}},{key:"getInitialClientOffset",value:function(){return this.internalMonitor.getInitialClientOffset()}},{key:"getInitialSourceClientOffset",value:function(){return this.internalMonitor.getInitialSourceClientOffset()}},{key:"getSourceClientOffset",value:function(){return this.internalMonitor.getSourceClientOffset()}},{key:"getClientOffset",value:function(){return this.internalMonitor.getClientOffset()}},{key:"getDifferenceFromInitialOffset",value:function(){return this.internalMonitor.getDifferenceFromInitialOffset()}}])&&d(e.prototype,n),r&&d(e,r),t}();function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return g(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function b(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(c){o=!0,i=c}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function k(t){var e=Object(r.useRef)(t);e.current=t,Object(o.a)(null!=t.accept,"accept must be defined");var n=b(function(){var t=Object(c.a)();return[Object(r.useMemo)((function(){return new y(t)}),[t]),Object(r.useMemo)((function(){return new p(t.getBackend())}),[t])]}(),2),u=n[0],l=n[1];!function(t,e,n){var o=Object(c.a)(),i=Object(r.useMemo)((function(){return{canDrop:function(){var n=t.current.canDrop;return!n||n(e.getItem(),e)},hover:function(){var n=t.current.hover;n&&n(e.getItem(),e)},drop:function(){var n=t.current.drop;if(n)return n(e.getItem(),e)}}}),[e]);Object(s.a)((function(){var r=m(Object(a.b)(t.current.accept,i,o),2),s=r[0],c=r[1];return e.receiveHandlerId(s),n.receiveHandlerId(s),c}),[e,n])}(e,u,l);var f=Object(i.a)(u,e.current.collect||function(){return{}},(function(){return l.reconnect()})),h=Object(r.useMemo)((function(){return l.hooks.dropTarget()}),[l]);return Object(s.a)((function(){l.dropTargetOptions=t.options||null,l.reconnect()}),[t.options]),[f,h]}}]]);
//# sourceMappingURL=2.9ff7904e.chunk.js.map