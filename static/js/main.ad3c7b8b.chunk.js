(this.webpackJsonp501v2=this.webpackJsonp501v2||[]).push([[0],{100:function(t,e,n){},121:function(t,e,n){},122:function(t,e){},134:function(t,e,n){},135:function(t,e,n){},136:function(t,e,n){"use strict";n.r(e);var a=n(14),r=n(1),c=n.n(r),i=n(61),s=n.n(i),o=(n(99),n(18)),u=n(142),l=n(145),d=n(87),f=n(144),p=n(89),b=(n(100),function(t){var e=Object(f.a)({item:t.item,collect:function(t){return{isDragging:!!t.isDragging()}}}),n=Object(o.a)(e,3),r=n[0].isDragging,c=n[1],i=n[2];return Object(a.jsxs)("div",{id:t.item.id,ref:i,className:"card",style:{display:r&&t.hideSourceOnDrag?"none":"flex",opacity:r?.5:1,top:t.item.y,left:t.item.x},children:[Object(a.jsx)("div",{ref:c,id:"".concat(t.item.id,"-drag-handle"),className:"card-drag-handle",children:Object(a.jsx)(p.a,{})}),t.children]})}),v="card",O=n(143),g=n(23),h=n.n(g),j=n(43),y=n(30),m=n(32),x=n(49),D=n(33),M=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=Object.assign({},e),null!==t.ychange&&(e.ychange_user=t.ychange.user,e.ychange_state=t.ychange.state),e},k={doc:{content:"block+"},paragraph:{attrs:{ychange:{default:null}},content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:function(t){return["p",M(t.attrs),0]}},blockquote:{attrs:{ychange:{default:null}},content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:function(t){return["blockquote",M(t.attrs),0]}},horizontal_rule:{attrs:{ychange:{default:null}},group:"block",parseDOM:[{tag:"hr"}],toDOM:function(t){return["hr",M(t.attrs)]}},heading:{attrs:{level:{default:1},ychange:{default:null}},content:"inline*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM:function(t){return["h"+t.attrs.level,M(t.attrs),0]}},code_block:{attrs:{ychange:{default:null}},content:"text*",marks:"",group:"block",code:!0,defining:!0,parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM:function(t){return["pre",M(t.attrs),["code",0]]}},text:{group:"inline"},image:{inline:!0,attrs:{ychange:{default:null},src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:function(t){return{src:t.getAttribute("src"),title:t.getAttribute("title"),alt:t.getAttribute("alt")}}}],toDOM:function(t){var e={src:t.attrs.src,title:t.attrs.title,alt:t.attrs.alt};return["img",M(t.attrs,e)]}},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:function(){return["br"]}}},E=new D.c({nodes:k,marks:{link:{attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:function(t){return{href:t.getAttribute("href"),title:t.getAttribute("title")}}}],toDOM:function(t){return["a",t.attrs,0]}},em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:function(){return["em",0]}},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:function(t){return"normal"!==t.style.fontWeight&&null}},{style:"font-weight",getAttrs:function(t){return/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}}],toDOM:function(){return["strong",0]}},code:{parseDOM:[{tag:"code"}],toDOM:function(){return["code",0]}},ychange:{attrs:{user:{default:null},state:{default:null}},inclusive:!1,parseDOM:[{tag:"ychange"}],toDOM:function(t){return["ychange",{ychange_user:t.attrs.user,ychange_state:t.attrs.state},0]}}}}),w=n(86),C=n(6),_=n(88),T=n(67),S=n(140),N=n(141),A=n(54),R=Object(w.a)({schema:E,menuBar:!1}),I=new C.d,F=new _.a("prosemirror-debug",I),B=I.getXmlFragment("prosemirror"),J=([Object(T.c)(B),Object(S.a)(F.awareness),Object(N.c)(),Object(A.b)({"Mod-z":N.b,"Mod-y":N.a,"Mod-Shift-z":N.a})].concat(R),n(121),function(t){var e=t.onFocus,n=t.onBlur,c=t.onChange,i=Object(r.useRef)(),s=Object(r.useState)(null),u=Object(o.a)(s,2),l=u[0],d=u[1],f=Object(r.useCallback)((function(){return{dispatchTransaction:function(t){var e=this.state.apply(t);this.updateState(e),null===c||void 0===c||c(this)},handleDOMEvents:{focus:function(t,n){var a=t.state.tr.setMeta("focused",!0);return t.dispatch(a),null===e||void 0===e||e(l),!1},blur:function(t,e){var a=t.state.tr.setMeta("focused",!1);return t.dispatch(a),null===n||void 0===n||n(l),!1}}}}),[c,n,e,l]),p=Object(r.useCallback)((function(){var e,n,a={schema:E,plugins:R};(null===(e=t.state)||void 0===e?void 0:e.doc)&&(a.doc=E.nodeFromJSON(t.state.doc),(null===(n=t.state)||void 0===n?void 0:n.selection)&&(a.selection=m.d.fromJSON(a.doc,t.state.selection)));return m.a.create(a)}),[t.state]);return Object(r.useEffect)((function(){var t=Object(y.a)({state:p()},f()),e=new x.c(i.current,t);return d(e),function(){e.destroy()}}),[]),Object(r.useEffect)((function(){null===l||void 0===l||l.setProps(f())}),[f,l]),Object(r.useEffect)((function(){null===l||void 0===l||l.updateState(p())}),[p,l]),Object(a.jsx)("div",{id:"editorContainer",children:Object(a.jsx)("div",{id:"editor",ref:i})})}),P=n(76),X=n(84),V=n.n(X);P.a.plugin(V.a);var q=new P.a("notes");function z(){return(z=Object(j.a)(h.a.mark((function t(e){var n,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=e.id||e._id,t.next=4,q.upsert(n,(function(t){return e}));case 4:return a=t.sent,t.abrupt("return",a);case 8:t.prev=8,t.t0=t.catch(0),console.log("ERROR: couldn't update ".concat(t.t0));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))).apply(this,arguments)}function L(t,e,n,a,r,c){return W.apply(this,arguments)}function W(){return(W=Object(j.a)(h.a.mark((function t(e,n,a,r,c,i){var s,o;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s={_id:e||Object(O.a)(),title:n||null,meta:a||{},state:r||{},createdTime:c||Date.now(),lastEditedTime:i||Date.now()},t.next=4,q.putIfNotExists(s);case 4:return o=t.sent,t.abrupt("return",o);case 8:t.prev=8,t.t0=t.catch(0),console.log("ERROR: couldn't create doc ".concat(t.t0));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))).apply(this,arguments)}function $(){return U.apply(this,arguments)}function U(){return(U=Object(j.a)(h.a.mark((function t(){var e;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,q.allDocs({include_docs:!0});case 3:return e=t.sent,t.abrupt("return",null===e||void 0===e?void 0:e.rows);case 7:t.prev=7,t.t0=t.catch(0),console.log("ERROR fetching all notes ".concat(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}function Y(t){return G.apply(this,arguments)}function G(){return(G=Object(j.a)(h.a.mark((function t(e){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,q.get(e);case 3:return n=t.sent,t.abrupt("return",n);case 7:t.prev=7,t.t0=t.catch(0),console.log("ERROR fetching  ".concat(e," ").concat(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}var H="SET_NOTE",K="SET_NOTE_STATE",Q="NEW_NOTE",Z=function(t,e){var n=e.type,a=e.payload;switch(n){case H:return a;case Q:var r=Date.now();return Object(y.a)(Object(y.a)({},a),{},{createdTime:r,lastEditedTime:r});case K:return Object(y.a)(Object(y.a)({},t),{},{state:a,lastEditedTime:Date.now()})}},tt=function(t){var e=t.note,n=Object(r.useReducer)(Z,e),c=Object(o.a)(n,2),i=c[0],s=c[1],u=Object(r.useCallback)(Object(j.a)(h.a.mark((function e(){var n,a,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.id){e.next=14;break}return e.next=3,Y(t.id);case 3:if(!(n=e.sent)){e.next=8;break}s({type:H,payload:n}),e.next=12;break;case 8:return e.next=10,L(t.id);case 10:a=e.sent,s({type:Q,payload:a});case 12:e.next=18;break;case 14:return e.next=16,L();case 16:r=e.sent,s({type:Q,payload:r});case 18:case"end":return e.stop()}}),e)}))),[t.id]);Object(r.useEffect)((function(){u()}),[u]);var l=Object(r.useCallback)((function(t){var e;s({type:K,payload:null===t||void 0===t||null===(e=t.state)||void 0===e?void 0:e.toJSON()})}),[]),d=Object(r.useCallback)((function(t){!function(t){z.apply(this,arguments)}(i)}),[i]);return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(J,{state:null===i||void 0===i?void 0:i.state,onChange:l,onBlur:d})})},et=n(53),nt=n(17),at=n(51),rt=n(79),ct=n.n(rt),it="ADD_ITEM_TO_CANVAS",st="REMOVE_ITEM_FROM_CANVAS",ot="UPDATE_ITEM_POSITION",ut={id:"randomID",title:"Main Canvas",items:[]},lt=window.__REDUX_DEVTOOLS_EXTENSION__||at.b,dt=Object(at.c)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{openCanvas:ut},e=arguments.length>1?arguments[1]:void 0,n=e.type,a=e.payload;switch(n){case it:var r=t.openCanvas.items;return r.find((function(t){return t.id===(null===a||void 0===a?void 0:a.id)}))||(t.openCanvas.items=ct()(r,{$push:[a]})),t;case st:return t.openCanvas.items=t.openCanvas.items.filter((function(t){return t.id!==(null===a||void 0===a?void 0:a.id)})),t;case ot:var c=t.openCanvas.items.find((function(t){return t.id===(null===a||void 0===a?void 0:a.id)}));if(!c)return t;var i=t.openCanvas.items.indexOf(c);return t.openCanvas.items=ct()(t.openCanvas.items,Object(nt.a)({},i,{$merge:Object(y.a)({},a)})),t;default:return t}}),lt());n(134);var ft=function(){return Object(a.jsx)(u.a,{backend:d.a,children:Object(a.jsx)(pt,{})})},pt=function(t){var e=Object(r.useState)({x:0,y:0}),n=Object(o.a)(e,2),c=(n[0],n[1]),i=Object(et.c)((function(t){return t.openCanvas.items})),s=Object(et.b)(),u=Object(l.a)({accept:[v],drop:function(t,e){var n=e.getDifferenceFromInitialOffset(),a=Math.round(t.x+n.x),r=Math.round(t.y+n.y);return p(t.id,a,r),{x:a,y:r}}}),d=Object(o.a)(u,2)[1],f=Object(r.useCallback)((function(t,e){var n={type:v,id:Object(O.a)(),x:t,y:e};s({type:it,payload:n})}),[s]),p=Object(r.useCallback)((function(t,e,n){s({type:ot,payload:{id:t,x:e,y:n}})}),[s]);return Object(a.jsxs)("div",{className:"canvas",ref:d,onMouseMove:function(t){c({x:t.nativeEvent.offsetX,y:t.nativeEvent.offsetY})},onDoubleClick:function(t){f(t.nativeEvent.offsetX,t.nativeEvent.offsetY)},children:[!1,Object.entries(i).map((function(t,e){var n=Object(o.a)(t,2),r=(n[0],n[1]);return Object(a.jsx)(b,{item:r,hideSourceOnDrag:!0,children:Object(a.jsx)(tt,{id:r.id})},e)}))]})},bt=(n(135),function(){var t=Object(r.useState)([]),e=Object(o.a)(t,2),n=e[0],c=e[1],i=Object(et.b)(),s=Object(r.useCallback)(Object(j.a)(h.a.mark((function t(){var e;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,$();case 2:e=t.sent,c(e);case 4:case"end":return t.stop()}}),t)}))),[c]);return Object(r.useEffect)((function(){var t;s(),t=s,q.changes({since:"now",live:!0}).on("change",(function(){return t()}))}),[s]),Object(a.jsx)("div",{className:"note-list",children:n.map((function(t,e){return Object(a.jsx)("div",{className:"note-list-item",onClick:function(){var e={id:null===t||void 0===t?void 0:t.id,type:v,x:690,y:320};i({type:it,payload:e})},children:t.id},e)}))})});var vt=function(){return Object(a.jsx)("div",{className:"App",children:Object(a.jsxs)(et.a,{store:dt,children:[Object(a.jsx)(ft,{}),Object(a.jsx)(bt,{})]})})},Ot=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,146)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,c=e.getLCP,i=e.getTTFB;n(t),a(t),r(t),c(t),i(t)}))};s.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(vt,{})}),document.getElementById("root")),Ot()},99:function(t,e,n){}},[[136,1,2]]]);
//# sourceMappingURL=main.ad3c7b8b.chunk.js.map